{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/next/dist/compiled/react/cjs/react-jsx-dev-runtime.development.js"],"sourcesContent":["/**\n * @license React\n * react-jsx-dev-runtime.development.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\n\"production\" !== process.env.NODE_ENV &&\n  (function () {\n    function getComponentNameFromType(type) {\n      if (null == type) return null;\n      if (\"function\" === typeof type)\n        return type.$$typeof === REACT_CLIENT_REFERENCE$2\n          ? null\n          : type.displayName || type.name || null;\n      if (\"string\" === typeof type) return type;\n      switch (type) {\n        case REACT_FRAGMENT_TYPE:\n          return \"Fragment\";\n        case REACT_PORTAL_TYPE:\n          return \"Portal\";\n        case REACT_PROFILER_TYPE:\n          return \"Profiler\";\n        case REACT_STRICT_MODE_TYPE:\n          return \"StrictMode\";\n        case REACT_SUSPENSE_TYPE:\n          return \"Suspense\";\n        case REACT_SUSPENSE_LIST_TYPE:\n          return \"SuspenseList\";\n      }\n      if (\"object\" === typeof type)\n        switch (\n          (\"number\" === typeof type.tag &&\n            console.error(\n              \"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"\n            ),\n          type.$$typeof)\n        ) {\n          case REACT_CONTEXT_TYPE:\n            return (type.displayName || \"Context\") + \".Provider\";\n          case REACT_CONSUMER_TYPE:\n            return (type._context.displayName || \"Context\") + \".Consumer\";\n          case REACT_FORWARD_REF_TYPE:\n            var innerType = type.render;\n            type = type.displayName;\n            type ||\n              ((type = innerType.displayName || innerType.name || \"\"),\n              (type = \"\" !== type ? \"ForwardRef(\" + type + \")\" : \"ForwardRef\"));\n            return type;\n          case REACT_MEMO_TYPE:\n            return (\n              (innerType = type.displayName || null),\n              null !== innerType\n                ? innerType\n                : getComponentNameFromType(type.type) || \"Memo\"\n            );\n          case REACT_LAZY_TYPE:\n            innerType = type._payload;\n            type = type._init;\n            try {\n              return getComponentNameFromType(type(innerType));\n            } catch (x) {}\n        }\n      return null;\n    }\n    function testStringCoercion(value) {\n      return \"\" + value;\n    }\n    function checkKeyStringCoercion(value) {\n      try {\n        testStringCoercion(value);\n        var JSCompiler_inline_result = !1;\n      } catch (e) {\n        JSCompiler_inline_result = !0;\n      }\n      if (JSCompiler_inline_result) {\n        JSCompiler_inline_result = console;\n        var JSCompiler_temp_const = JSCompiler_inline_result.error;\n        var JSCompiler_inline_result$jscomp$0 =\n          (\"function\" === typeof Symbol &&\n            Symbol.toStringTag &&\n            value[Symbol.toStringTag]) ||\n          value.constructor.name ||\n          \"Object\";\n        JSCompiler_temp_const.call(\n          JSCompiler_inline_result,\n          \"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.\",\n          JSCompiler_inline_result$jscomp$0\n        );\n        return testStringCoercion(value);\n      }\n    }\n    function disabledLog() {}\n    function disableLogs() {\n      if (0 === disabledDepth) {\n        prevLog = console.log;\n        prevInfo = console.info;\n        prevWarn = console.warn;\n        prevError = console.error;\n        prevGroup = console.group;\n        prevGroupCollapsed = console.groupCollapsed;\n        prevGroupEnd = console.groupEnd;\n        var props = {\n          configurable: !0,\n          enumerable: !0,\n          value: disabledLog,\n          writable: !0\n        };\n        Object.defineProperties(console, {\n          info: props,\n          log: props,\n          warn: props,\n          error: props,\n          group: props,\n          groupCollapsed: props,\n          groupEnd: props\n        });\n      }\n      disabledDepth++;\n    }\n    function reenableLogs() {\n      disabledDepth--;\n      if (0 === disabledDepth) {\n        var props = { configurable: !0, enumerable: !0, writable: !0 };\n        Object.defineProperties(console, {\n          log: assign({}, props, { value: prevLog }),\n          info: assign({}, props, { value: prevInfo }),\n          warn: assign({}, props, { value: prevWarn }),\n          error: assign({}, props, { value: prevError }),\n          group: assign({}, props, { value: prevGroup }),\n          groupCollapsed: assign({}, props, { value: prevGroupCollapsed }),\n          groupEnd: assign({}, props, { value: prevGroupEnd })\n        });\n      }\n      0 > disabledDepth &&\n        console.error(\n          \"disabledDepth fell below zero. This is a bug in React. Please file an issue.\"\n        );\n    }\n    function describeBuiltInComponentFrame(name) {\n      if (void 0 === prefix)\n        try {\n          throw Error();\n        } catch (x) {\n          var match = x.stack.trim().match(/\\n( *(at )?)/);\n          prefix = (match && match[1]) || \"\";\n          suffix =\n            -1 < x.stack.indexOf(\"\\n    at\")\n              ? \" (<anonymous>)\"\n              : -1 < x.stack.indexOf(\"@\")\n                ? \"@unknown:0:0\"\n                : \"\";\n        }\n      return \"\\n\" + prefix + name + suffix;\n    }\n    function describeNativeComponentFrame(fn, construct) {\n      if (!fn || reentry) return \"\";\n      var frame = componentFrameCache.get(fn);\n      if (void 0 !== frame) return frame;\n      reentry = !0;\n      frame = Error.prepareStackTrace;\n      Error.prepareStackTrace = void 0;\n      var previousDispatcher = null;\n      previousDispatcher = ReactSharedInternals.H;\n      ReactSharedInternals.H = null;\n      disableLogs();\n      try {\n        var RunInRootFrame = {\n          DetermineComponentFrameRoot: function () {\n            try {\n              if (construct) {\n                var Fake = function () {\n                  throw Error();\n                };\n                Object.defineProperty(Fake.prototype, \"props\", {\n                  set: function () {\n                    throw Error();\n                  }\n                });\n                if (\"object\" === typeof Reflect && Reflect.construct) {\n                  try {\n                    Reflect.construct(Fake, []);\n                  } catch (x) {\n                    var control = x;\n                  }\n                  Reflect.construct(fn, [], Fake);\n                } else {\n                  try {\n                    Fake.call();\n                  } catch (x$0) {\n                    control = x$0;\n                  }\n                  fn.call(Fake.prototype);\n                }\n              } else {\n                try {\n                  throw Error();\n                } catch (x$1) {\n                  control = x$1;\n                }\n                (Fake = fn()) &&\n                  \"function\" === typeof Fake.catch &&\n                  Fake.catch(function () {});\n              }\n            } catch (sample) {\n              if (sample && control && \"string\" === typeof sample.stack)\n                return [sample.stack, control.stack];\n            }\n            return [null, null];\n          }\n        };\n        RunInRootFrame.DetermineComponentFrameRoot.displayName =\n          \"DetermineComponentFrameRoot\";\n        var namePropDescriptor = Object.getOwnPropertyDescriptor(\n          RunInRootFrame.DetermineComponentFrameRoot,\n          \"name\"\n        );\n        namePropDescriptor &&\n          namePropDescriptor.configurable &&\n          Object.defineProperty(\n            RunInRootFrame.DetermineComponentFrameRoot,\n            \"name\",\n            { value: \"DetermineComponentFrameRoot\" }\n          );\n        var _RunInRootFrame$Deter =\n            RunInRootFrame.DetermineComponentFrameRoot(),\n          sampleStack = _RunInRootFrame$Deter[0],\n          controlStack = _RunInRootFrame$Deter[1];\n        if (sampleStack && controlStack) {\n          var sampleLines = sampleStack.split(\"\\n\"),\n            controlLines = controlStack.split(\"\\n\");\n          for (\n            _RunInRootFrame$Deter = namePropDescriptor = 0;\n            namePropDescriptor < sampleLines.length &&\n            !sampleLines[namePropDescriptor].includes(\n              \"DetermineComponentFrameRoot\"\n            );\n\n          )\n            namePropDescriptor++;\n          for (\n            ;\n            _RunInRootFrame$Deter < controlLines.length &&\n            !controlLines[_RunInRootFrame$Deter].includes(\n              \"DetermineComponentFrameRoot\"\n            );\n\n          )\n            _RunInRootFrame$Deter++;\n          if (\n            namePropDescriptor === sampleLines.length ||\n            _RunInRootFrame$Deter === controlLines.length\n          )\n            for (\n              namePropDescriptor = sampleLines.length - 1,\n                _RunInRootFrame$Deter = controlLines.length - 1;\n              1 <= namePropDescriptor &&\n              0 <= _RunInRootFrame$Deter &&\n              sampleLines[namePropDescriptor] !==\n                controlLines[_RunInRootFrame$Deter];\n\n            )\n              _RunInRootFrame$Deter--;\n          for (\n            ;\n            1 <= namePropDescriptor && 0 <= _RunInRootFrame$Deter;\n            namePropDescriptor--, _RunInRootFrame$Deter--\n          )\n            if (\n              sampleLines[namePropDescriptor] !==\n              controlLines[_RunInRootFrame$Deter]\n            ) {\n              if (1 !== namePropDescriptor || 1 !== _RunInRootFrame$Deter) {\n                do\n                  if (\n                    (namePropDescriptor--,\n                    _RunInRootFrame$Deter--,\n                    0 > _RunInRootFrame$Deter ||\n                      sampleLines[namePropDescriptor] !==\n                        controlLines[_RunInRootFrame$Deter])\n                  ) {\n                    var _frame =\n                      \"\\n\" +\n                      sampleLines[namePropDescriptor].replace(\n                        \" at new \",\n                        \" at \"\n                      );\n                    fn.displayName &&\n                      _frame.includes(\"<anonymous>\") &&\n                      (_frame = _frame.replace(\"<anonymous>\", fn.displayName));\n                    \"function\" === typeof fn &&\n                      componentFrameCache.set(fn, _frame);\n                    return _frame;\n                  }\n                while (1 <= namePropDescriptor && 0 <= _RunInRootFrame$Deter);\n              }\n              break;\n            }\n        }\n      } finally {\n        (reentry = !1),\n          (ReactSharedInternals.H = previousDispatcher),\n          reenableLogs(),\n          (Error.prepareStackTrace = frame);\n      }\n      sampleLines = (sampleLines = fn ? fn.displayName || fn.name : \"\")\n        ? describeBuiltInComponentFrame(sampleLines)\n        : \"\";\n      \"function\" === typeof fn && componentFrameCache.set(fn, sampleLines);\n      return sampleLines;\n    }\n    function describeUnknownElementTypeFrameInDEV(type) {\n      if (null == type) return \"\";\n      if (\"function\" === typeof type) {\n        var prototype = type.prototype;\n        return describeNativeComponentFrame(\n          type,\n          !(!prototype || !prototype.isReactComponent)\n        );\n      }\n      if (\"string\" === typeof type) return describeBuiltInComponentFrame(type);\n      switch (type) {\n        case REACT_SUSPENSE_TYPE:\n          return describeBuiltInComponentFrame(\"Suspense\");\n        case REACT_SUSPENSE_LIST_TYPE:\n          return describeBuiltInComponentFrame(\"SuspenseList\");\n      }\n      if (\"object\" === typeof type)\n        switch (type.$$typeof) {\n          case REACT_FORWARD_REF_TYPE:\n            return (type = describeNativeComponentFrame(type.render, !1)), type;\n          case REACT_MEMO_TYPE:\n            return describeUnknownElementTypeFrameInDEV(type.type);\n          case REACT_LAZY_TYPE:\n            prototype = type._payload;\n            type = type._init;\n            try {\n              return describeUnknownElementTypeFrameInDEV(type(prototype));\n            } catch (x) {}\n        }\n      return \"\";\n    }\n    function getOwner() {\n      var dispatcher = ReactSharedInternals.A;\n      return null === dispatcher ? null : dispatcher.getOwner();\n    }\n    function hasValidKey(config) {\n      if (hasOwnProperty.call(config, \"key\")) {\n        var getter = Object.getOwnPropertyDescriptor(config, \"key\").get;\n        if (getter && getter.isReactWarning) return !1;\n      }\n      return void 0 !== config.key;\n    }\n    function defineKeyPropWarningGetter(props, displayName) {\n      function warnAboutAccessingKey() {\n        specialPropKeyWarningShown ||\n          ((specialPropKeyWarningShown = !0),\n          console.error(\n            \"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)\",\n            displayName\n          ));\n      }\n      warnAboutAccessingKey.isReactWarning = !0;\n      Object.defineProperty(props, \"key\", {\n        get: warnAboutAccessingKey,\n        configurable: !0\n      });\n    }\n    function elementRefGetterWithDeprecationWarning() {\n      var componentName = getComponentNameFromType(this.type);\n      didWarnAboutElementRef[componentName] ||\n        ((didWarnAboutElementRef[componentName] = !0),\n        console.error(\n          \"Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.\"\n        ));\n      componentName = this.props.ref;\n      return void 0 !== componentName ? componentName : null;\n    }\n    function ReactElement(type, key, self, source, owner, props) {\n      self = props.ref;\n      type = {\n        $$typeof: REACT_ELEMENT_TYPE,\n        type: type,\n        key: key,\n        props: props,\n        _owner: owner\n      };\n      null !== (void 0 !== self ? self : null)\n        ? Object.defineProperty(type, \"ref\", {\n            enumerable: !1,\n            get: elementRefGetterWithDeprecationWarning\n          })\n        : Object.defineProperty(type, \"ref\", { enumerable: !1, value: null });\n      type._store = {};\n      Object.defineProperty(type._store, \"validated\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: 0\n      });\n      Object.defineProperty(type, \"_debugInfo\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: null\n      });\n      Object.freeze && (Object.freeze(type.props), Object.freeze(type));\n      return type;\n    }\n    function jsxDEVImpl(\n      type,\n      config,\n      maybeKey,\n      isStaticChildren,\n      source,\n      self\n    ) {\n      if (\n        \"string\" === typeof type ||\n        \"function\" === typeof type ||\n        type === REACT_FRAGMENT_TYPE ||\n        type === REACT_PROFILER_TYPE ||\n        type === REACT_STRICT_MODE_TYPE ||\n        type === REACT_SUSPENSE_TYPE ||\n        type === REACT_SUSPENSE_LIST_TYPE ||\n        type === REACT_OFFSCREEN_TYPE ||\n        (\"object\" === typeof type &&\n          null !== type &&\n          (type.$$typeof === REACT_LAZY_TYPE ||\n            type.$$typeof === REACT_MEMO_TYPE ||\n            type.$$typeof === REACT_CONTEXT_TYPE ||\n            type.$$typeof === REACT_CONSUMER_TYPE ||\n            type.$$typeof === REACT_FORWARD_REF_TYPE ||\n            type.$$typeof === REACT_CLIENT_REFERENCE$1 ||\n            void 0 !== type.getModuleId))\n      ) {\n        var children = config.children;\n        if (void 0 !== children)\n          if (isStaticChildren)\n            if (isArrayImpl(children)) {\n              for (\n                isStaticChildren = 0;\n                isStaticChildren < children.length;\n                isStaticChildren++\n              )\n                validateChildKeys(children[isStaticChildren], type);\n              Object.freeze && Object.freeze(children);\n            } else\n              console.error(\n                \"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\"\n              );\n          else validateChildKeys(children, type);\n      } else {\n        children = \"\";\n        if (\n          void 0 === type ||\n          (\"object\" === typeof type &&\n            null !== type &&\n            0 === Object.keys(type).length)\n        )\n          children +=\n            \" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\";\n        null === type\n          ? (isStaticChildren = \"null\")\n          : isArrayImpl(type)\n            ? (isStaticChildren = \"array\")\n            : void 0 !== type && type.$$typeof === REACT_ELEMENT_TYPE\n              ? ((isStaticChildren =\n                  \"<\" +\n                  (getComponentNameFromType(type.type) || \"Unknown\") +\n                  \" />\"),\n                (children =\n                  \" Did you accidentally export a JSX literal instead of a component?\"))\n              : (isStaticChildren = typeof type);\n        console.error(\n          \"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",\n          isStaticChildren,\n          children\n        );\n      }\n      if (hasOwnProperty.call(config, \"key\")) {\n        children = getComponentNameFromType(type);\n        var keys = Object.keys(config).filter(function (k) {\n          return \"key\" !== k;\n        });\n        isStaticChildren =\n          0 < keys.length\n            ? \"{key: someKey, \" + keys.join(\": ..., \") + \": ...}\"\n            : \"{key: someKey}\";\n        didWarnAboutKeySpread[children + isStaticChildren] ||\n          ((keys =\n            0 < keys.length ? \"{\" + keys.join(\": ..., \") + \": ...}\" : \"{}\"),\n          console.error(\n            'A props object containing a \"key\" prop is being spread into JSX:\\n  let props = %s;\\n  <%s {...props} />\\nReact keys must be passed directly to JSX without using spread:\\n  let props = %s;\\n  <%s key={someKey} {...props} />',\n            isStaticChildren,\n            children,\n            keys,\n            children\n          ),\n          (didWarnAboutKeySpread[children + isStaticChildren] = !0));\n      }\n      children = null;\n      void 0 !== maybeKey &&\n        (checkKeyStringCoercion(maybeKey), (children = \"\" + maybeKey));\n      hasValidKey(config) &&\n        (checkKeyStringCoercion(config.key), (children = \"\" + config.key));\n      if (\"key\" in config) {\n        maybeKey = {};\n        for (var propName in config)\n          \"key\" !== propName && (maybeKey[propName] = config[propName]);\n      } else maybeKey = config;\n      children &&\n        defineKeyPropWarningGetter(\n          maybeKey,\n          \"function\" === typeof type\n            ? type.displayName || type.name || \"Unknown\"\n            : type\n        );\n      return ReactElement(type, children, self, source, getOwner(), maybeKey);\n    }\n    function validateChildKeys(node, parentType) {\n      if (\n        \"object\" === typeof node &&\n        node &&\n        node.$$typeof !== REACT_CLIENT_REFERENCE\n      )\n        if (isArrayImpl(node))\n          for (var i = 0; i < node.length; i++) {\n            var child = node[i];\n            isValidElement(child) && validateExplicitKey(child, parentType);\n          }\n        else if (isValidElement(node))\n          node._store && (node._store.validated = 1);\n        else if (\n          (null === node || \"object\" !== typeof node\n            ? (i = null)\n            : ((i =\n                (MAYBE_ITERATOR_SYMBOL && node[MAYBE_ITERATOR_SYMBOL]) ||\n                node[\"@@iterator\"]),\n              (i = \"function\" === typeof i ? i : null)),\n          \"function\" === typeof i &&\n            i !== node.entries &&\n            ((i = i.call(node)), i !== node))\n        )\n          for (; !(node = i.next()).done; )\n            isValidElement(node.value) &&\n              validateExplicitKey(node.value, parentType);\n    }\n    function isValidElement(object) {\n      return (\n        \"object\" === typeof object &&\n        null !== object &&\n        object.$$typeof === REACT_ELEMENT_TYPE\n      );\n    }\n    function validateExplicitKey(element, parentType) {\n      if (\n        element._store &&\n        !element._store.validated &&\n        null == element.key &&\n        ((element._store.validated = 1),\n        (parentType = getCurrentComponentErrorInfo(parentType)),\n        !ownerHasKeyUseWarning[parentType])\n      ) {\n        ownerHasKeyUseWarning[parentType] = !0;\n        var childOwner = \"\";\n        element &&\n          null != element._owner &&\n          element._owner !== getOwner() &&\n          ((childOwner = null),\n          \"number\" === typeof element._owner.tag\n            ? (childOwner = getComponentNameFromType(element._owner.type))\n            : \"string\" === typeof element._owner.name &&\n              (childOwner = element._owner.name),\n          (childOwner = \" It was passed a child from \" + childOwner + \".\"));\n        var prevGetCurrentStack = ReactSharedInternals.getCurrentStack;\n        ReactSharedInternals.getCurrentStack = function () {\n          var stack = describeUnknownElementTypeFrameInDEV(element.type);\n          prevGetCurrentStack && (stack += prevGetCurrentStack() || \"\");\n          return stack;\n        };\n        console.error(\n          'Each child in a list should have a unique \"key\" prop.%s%s See https://react.dev/link/warning-keys for more information.',\n          parentType,\n          childOwner\n        );\n        ReactSharedInternals.getCurrentStack = prevGetCurrentStack;\n      }\n    }\n    function getCurrentComponentErrorInfo(parentType) {\n      var info = \"\",\n        owner = getOwner();\n      owner &&\n        (owner = getComponentNameFromType(owner.type)) &&\n        (info = \"\\n\\nCheck the render method of `\" + owner + \"`.\");\n      info ||\n        ((parentType = getComponentNameFromType(parentType)) &&\n          (info =\n            \"\\n\\nCheck the top-level render call using <\" + parentType + \">.\"));\n      return info;\n    }\n    var React = require(\"next/dist/compiled/react\"),\n      REACT_ELEMENT_TYPE = Symbol.for(\"react.transitional.element\"),\n      REACT_PORTAL_TYPE = Symbol.for(\"react.portal\"),\n      REACT_FRAGMENT_TYPE = Symbol.for(\"react.fragment\"),\n      REACT_STRICT_MODE_TYPE = Symbol.for(\"react.strict_mode\"),\n      REACT_PROFILER_TYPE = Symbol.for(\"react.profiler\");\n    Symbol.for(\"react.provider\");\n    var REACT_CONSUMER_TYPE = Symbol.for(\"react.consumer\"),\n      REACT_CONTEXT_TYPE = Symbol.for(\"react.context\"),\n      REACT_FORWARD_REF_TYPE = Symbol.for(\"react.forward_ref\"),\n      REACT_SUSPENSE_TYPE = Symbol.for(\"react.suspense\"),\n      REACT_SUSPENSE_LIST_TYPE = Symbol.for(\"react.suspense_list\"),\n      REACT_MEMO_TYPE = Symbol.for(\"react.memo\"),\n      REACT_LAZY_TYPE = Symbol.for(\"react.lazy\"),\n      REACT_OFFSCREEN_TYPE = Symbol.for(\"react.offscreen\"),\n      MAYBE_ITERATOR_SYMBOL = Symbol.iterator,\n      REACT_CLIENT_REFERENCE$2 = Symbol.for(\"react.client.reference\"),\n      ReactSharedInternals =\n        React.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,\n      hasOwnProperty = Object.prototype.hasOwnProperty,\n      assign = Object.assign,\n      REACT_CLIENT_REFERENCE$1 = Symbol.for(\"react.client.reference\"),\n      isArrayImpl = Array.isArray,\n      disabledDepth = 0,\n      prevLog,\n      prevInfo,\n      prevWarn,\n      prevError,\n      prevGroup,\n      prevGroupCollapsed,\n      prevGroupEnd;\n    disabledLog.__reactDisabledLog = !0;\n    var prefix,\n      suffix,\n      reentry = !1;\n    var componentFrameCache = new (\n      \"function\" === typeof WeakMap ? WeakMap : Map\n    )();\n    var REACT_CLIENT_REFERENCE = Symbol.for(\"react.client.reference\"),\n      specialPropKeyWarningShown;\n    var didWarnAboutElementRef = {};\n    var didWarnAboutKeySpread = {},\n      ownerHasKeyUseWarning = {};\n    exports.Fragment = REACT_FRAGMENT_TYPE;\n    exports.jsxDEV = function (\n      type,\n      config,\n      maybeKey,\n      isStaticChildren,\n      source,\n      self\n    ) {\n      return jsxDEVImpl(type, config, maybeKey, isStaticChildren, source, self);\n    };\n  })();\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 402, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 407, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/next/dist/compiled/react/jsx-dev-runtime.js"],"sourcesContent":["'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-dev-runtime.production.js');\n} else {\n  module.exports = require('./cjs/react-jsx-dev-runtime.development.js');\n}\n"],"names":[],"mappings":"AAEI;AAFJ;AAEA,uCAA2C;;AAE3C,OAAO;IACL,OAAO,OAAO;AAChB","ignoreList":[0]}},
    {"offset": {"line": 414, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 419, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/next/dist/compiled/events/events.js"],"sourcesContent":["(function(){\"use strict\";var e={864:function(e){var t=typeof Reflect===\"object\"?Reflect:null;var n=t&&typeof t.apply===\"function\"?t.apply:function ReflectApply(e,t,n){return Function.prototype.apply.call(e,t,n)};var r;if(t&&typeof t.ownKeys===\"function\"){r=t.ownKeys}else if(Object.getOwnPropertySymbols){r=function ReflectOwnKeys(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}}else{r=function ReflectOwnKeys(e){return Object.getOwnPropertyNames(e)}}function ProcessEmitWarning(e){if(console&&console.warn)console.warn(e)}var i=Number.isNaN||function NumberIsNaN(e){return e!==e};function EventEmitter(){EventEmitter.init.call(this)}e.exports=EventEmitter;e.exports.once=once;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=undefined;var s=10;function checkListener(e){if(typeof e!==\"function\"){throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof e)}}Object.defineProperty(EventEmitter,\"defaultMaxListeners\",{enumerable:true,get:function(){return s},set:function(e){if(typeof e!==\"number\"||e<0||i(e)){throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received '+e+\".\")}s=e}});EventEmitter.init=function(){if(this._events===undefined||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined};EventEmitter.prototype.setMaxListeners=function setMaxListeners(e){if(typeof e!==\"number\"||e<0||i(e)){throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received '+e+\".\")}this._maxListeners=e;return this};function _getMaxListeners(e){if(e._maxListeners===undefined)return EventEmitter.defaultMaxListeners;return e._maxListeners}EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function emit(e){var t=[];for(var r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e===\"error\";var s=this._events;if(s!==undefined)i=i&&s.error===undefined;else if(!i)return false;if(i){var o;if(t.length>0)o=t[0];if(o instanceof Error){throw o}var f=new Error(\"Unhandled error.\"+(o?\" (\"+o.message+\")\":\"\"));f.context=o;throw f}var u=s[e];if(u===undefined)return false;if(typeof u===\"function\"){n(u,this,t)}else{var a=u.length;var c=arrayClone(u,a);for(var r=0;r<a;++r)n(c[r],this,t)}return true};function _addListener(e,t,n,r){var i;var s;var o;checkListener(n);s=e._events;if(s===undefined){s=e._events=Object.create(null);e._eventsCount=0}else{if(s.newListener!==undefined){e.emit(\"newListener\",t,n.listener?n.listener:n);s=e._events}o=s[t]}if(o===undefined){o=s[t]=n;++e._eventsCount}else{if(typeof o===\"function\"){o=s[t]=r?[n,o]:[o,n]}else if(r){o.unshift(n)}else{o.push(n)}i=_getMaxListeners(e);if(i>0&&o.length>i&&!o.warned){o.warned=true;var f=new Error(\"Possible EventEmitter memory leak detected. \"+o.length+\" \"+String(t)+\" listeners \"+\"added. Use emitter.setMaxListeners() to \"+\"increase limit\");f.name=\"MaxListenersExceededWarning\";f.emitter=e;f.type=t;f.count=o.length;ProcessEmitWarning(f)}}return e}EventEmitter.prototype.addListener=function addListener(e,t){return _addListener(this,e,t,false)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function prependListener(e,t){return _addListener(this,e,t,true)};function onceWrapper(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;if(arguments.length===0)return this.listener.call(this.target);return this.listener.apply(this.target,arguments)}}function _onceWrap(e,t,n){var r={fired:false,wrapFn:undefined,target:e,type:t,listener:n};var i=onceWrapper.bind(r);i.listener=n;r.wrapFn=i;return i}EventEmitter.prototype.once=function once(e,t){checkListener(t);this.on(e,_onceWrap(this,e,t));return this};EventEmitter.prototype.prependOnceListener=function prependOnceListener(e,t){checkListener(t);this.prependListener(e,_onceWrap(this,e,t));return this};EventEmitter.prototype.removeListener=function removeListener(e,t){var n,r,i,s,o;checkListener(t);r=this._events;if(r===undefined)return this;n=r[e];if(n===undefined)return this;if(n===t||n.listener===t){if(--this._eventsCount===0)this._events=Object.create(null);else{delete r[e];if(r.removeListener)this.emit(\"removeListener\",e,n.listener||t)}}else if(typeof n!==\"function\"){i=-1;for(s=n.length-1;s>=0;s--){if(n[s]===t||n[s].listener===t){o=n[s].listener;i=s;break}}if(i<0)return this;if(i===0)n.shift();else{spliceOne(n,i)}if(n.length===1)r[e]=n[0];if(r.removeListener!==undefined)this.emit(\"removeListener\",e,o||t)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function removeAllListeners(e){var t,n,r;n=this._events;if(n===undefined)return this;if(n.removeListener===undefined){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else if(n[e]!==undefined){if(--this._eventsCount===0)this._events=Object.create(null);else delete n[e]}return this}if(arguments.length===0){var i=Object.keys(n);var s;for(r=0;r<i.length;++r){s=i[r];if(s===\"removeListener\")continue;this.removeAllListeners(s)}this.removeAllListeners(\"removeListener\");this._events=Object.create(null);this._eventsCount=0;return this}t=n[e];if(typeof t===\"function\"){this.removeListener(e,t)}else if(t!==undefined){for(r=t.length-1;r>=0;r--){this.removeListener(e,t[r])}}return this};function _listeners(e,t,n){var r=e._events;if(r===undefined)return[];var i=r[t];if(i===undefined)return[];if(typeof i===\"function\")return n?[i.listener||i]:[i];return n?unwrapListeners(i):arrayClone(i,i.length)}EventEmitter.prototype.listeners=function listeners(e){return _listeners(this,e,true)};EventEmitter.prototype.rawListeners=function rawListeners(e){return _listeners(this,e,false)};EventEmitter.listenerCount=function(e,t){if(typeof e.listenerCount===\"function\"){return e.listenerCount(t)}else{return listenerCount.call(e,t)}};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(e){var t=this._events;if(t!==undefined){var n=t[e];if(typeof n===\"function\"){return 1}else if(n!==undefined){return n.length}}return 0}EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?r(this._events):[]};function arrayClone(e,t){var n=new Array(t);for(var r=0;r<t;++r)n[r]=e[r];return n}function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function unwrapListeners(e){var t=new Array(e.length);for(var n=0;n<t.length;++n){t[n]=e[n].listener||e[n]}return t}function once(e,t){return new Promise((function(n,r){function errorListener(n){e.removeListener(t,resolver);r(n)}function resolver(){if(typeof e.removeListener===\"function\"){e.removeListener(\"error\",errorListener)}n([].slice.call(arguments))}eventTargetAgnosticAddListener(e,t,resolver,{once:true});if(t!==\"error\"){addErrorHandlerIfEventEmitter(e,errorListener,{once:true})}}))}function addErrorHandlerIfEventEmitter(e,t,n){if(typeof e.on===\"function\"){eventTargetAgnosticAddListener(e,\"error\",t,n)}}function eventTargetAgnosticAddListener(e,t,n,r){if(typeof e.on===\"function\"){if(r.once){e.once(t,n)}else{e.on(t,n)}}else if(typeof e.addEventListener===\"function\"){e.addEventListener(t,(function wrapListener(i){if(r.once){e.removeEventListener(t,wrapListener)}n(i)}))}else{throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type '+typeof e)}}}};var t={};function __nccwpck_require__(n){var r=t[n];if(r!==undefined){return r.exports}var i=t[n]={exports:{}};var s=true;try{e[n](i,i.exports,__nccwpck_require__);s=false}finally{if(s)delete t[n]}return i.exports}if(typeof __nccwpck_require__!==\"undefined\")__nccwpck_require__.ab=__dirname+\"/\";var n=__nccwpck_require__(864);module.exports=n})();"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 801, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 806, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/next/dist/compiled/buffer/index.js"],"sourcesContent":["(function(){var e={675:function(e,r){\"use strict\";r.byteLength=byteLength;r.toByteArray=toByteArray;r.fromByteArray=fromByteArray;var t=[];var f=[];var n=typeof Uint8Array!==\"undefined\"?Uint8Array:Array;var i=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";for(var o=0,u=i.length;o<u;++o){t[o]=i[o];f[i.charCodeAt(o)]=o}f[\"-\".charCodeAt(0)]=62;f[\"_\".charCodeAt(0)]=63;function getLens(e){var r=e.length;if(r%4>0){throw new Error(\"Invalid string. Length must be a multiple of 4\")}var t=e.indexOf(\"=\");if(t===-1)t=r;var f=t===r?0:4-t%4;return[t,f]}function byteLength(e){var r=getLens(e);var t=r[0];var f=r[1];return(t+f)*3/4-f}function _byteLength(e,r,t){return(r+t)*3/4-t}function toByteArray(e){var r;var t=getLens(e);var i=t[0];var o=t[1];var u=new n(_byteLength(e,i,o));var a=0;var s=o>0?i-4:i;var h;for(h=0;h<s;h+=4){r=f[e.charCodeAt(h)]<<18|f[e.charCodeAt(h+1)]<<12|f[e.charCodeAt(h+2)]<<6|f[e.charCodeAt(h+3)];u[a++]=r>>16&255;u[a++]=r>>8&255;u[a++]=r&255}if(o===2){r=f[e.charCodeAt(h)]<<2|f[e.charCodeAt(h+1)]>>4;u[a++]=r&255}if(o===1){r=f[e.charCodeAt(h)]<<10|f[e.charCodeAt(h+1)]<<4|f[e.charCodeAt(h+2)]>>2;u[a++]=r>>8&255;u[a++]=r&255}return u}function tripletToBase64(e){return t[e>>18&63]+t[e>>12&63]+t[e>>6&63]+t[e&63]}function encodeChunk(e,r,t){var f;var n=[];for(var i=r;i<t;i+=3){f=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255);n.push(tripletToBase64(f))}return n.join(\"\")}function fromByteArray(e){var r;var f=e.length;var n=f%3;var i=[];var o=16383;for(var u=0,a=f-n;u<a;u+=o){i.push(encodeChunk(e,u,u+o>a?a:u+o))}if(n===1){r=e[f-1];i.push(t[r>>2]+t[r<<4&63]+\"==\")}else if(n===2){r=(e[f-2]<<8)+e[f-1];i.push(t[r>>10]+t[r>>4&63]+t[r<<2&63]+\"=\")}return i.join(\"\")}},72:function(e,r,t){\"use strict\";\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */var f=t(675);var n=t(783);var i=typeof Symbol===\"function\"&&typeof Symbol.for===\"function\"?Symbol.for(\"nodejs.util.inspect.custom\"):null;r.Buffer=Buffer;r.SlowBuffer=SlowBuffer;r.INSPECT_MAX_BYTES=50;var o=2147483647;r.kMaxLength=o;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!==\"undefined\"&&typeof console.error===\"function\"){console.error(\"This browser lacks typed array (Uint8Array) support which is required by \"+\"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.\")}function typedArraySupport(){try{var e=new Uint8Array(1);var r={foo:function(){return 42}};Object.setPrototypeOf(r,Uint8Array.prototype);Object.setPrototypeOf(e,r);return e.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,\"parent\",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(Buffer.prototype,\"offset\",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.byteOffset}});function createBuffer(e){if(e>o){throw new RangeError('The value \"'+e+'\" is invalid for option \"size\"')}var r=new Uint8Array(e);Object.setPrototypeOf(r,Buffer.prototype);return r}function Buffer(e,r,t){if(typeof e===\"number\"){if(typeof r===\"string\"){throw new TypeError('The \"string\" argument must be of type string. Received type number')}return allocUnsafe(e)}return from(e,r,t)}Buffer.poolSize=8192;function from(e,r,t){if(typeof e===\"string\"){return fromString(e,r)}if(ArrayBuffer.isView(e)){return fromArrayLike(e)}if(e==null){throw new TypeError(\"The first argument must be one of type string, Buffer, ArrayBuffer, Array, \"+\"or Array-like Object. Received type \"+typeof e)}if(isInstance(e,ArrayBuffer)||e&&isInstance(e.buffer,ArrayBuffer)){return fromArrayBuffer(e,r,t)}if(typeof SharedArrayBuffer!==\"undefined\"&&(isInstance(e,SharedArrayBuffer)||e&&isInstance(e.buffer,SharedArrayBuffer))){return fromArrayBuffer(e,r,t)}if(typeof e===\"number\"){throw new TypeError('The \"value\" argument must not be of type number. Received type number')}var f=e.valueOf&&e.valueOf();if(f!=null&&f!==e){return Buffer.from(f,r,t)}var n=fromObject(e);if(n)return n;if(typeof Symbol!==\"undefined\"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]===\"function\"){return Buffer.from(e[Symbol.toPrimitive](\"string\"),r,t)}throw new TypeError(\"The first argument must be one of type string, Buffer, ArrayBuffer, Array, \"+\"or Array-like Object. Received type \"+typeof e)}Buffer.from=function(e,r,t){return from(e,r,t)};Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype);Object.setPrototypeOf(Buffer,Uint8Array);function assertSize(e){if(typeof e!==\"number\"){throw new TypeError('\"size\" argument must be of type number')}else if(e<0){throw new RangeError('The value \"'+e+'\" is invalid for option \"size\"')}}function alloc(e,r,t){assertSize(e);if(e<=0){return createBuffer(e)}if(r!==undefined){return typeof t===\"string\"?createBuffer(e).fill(r,t):createBuffer(e).fill(r)}return createBuffer(e)}Buffer.alloc=function(e,r,t){return alloc(e,r,t)};function allocUnsafe(e){assertSize(e);return createBuffer(e<0?0:checked(e)|0)}Buffer.allocUnsafe=function(e){return allocUnsafe(e)};Buffer.allocUnsafeSlow=function(e){return allocUnsafe(e)};function fromString(e,r){if(typeof r!==\"string\"||r===\"\"){r=\"utf8\"}if(!Buffer.isEncoding(r)){throw new TypeError(\"Unknown encoding: \"+r)}var t=byteLength(e,r)|0;var f=createBuffer(t);var n=f.write(e,r);if(n!==t){f=f.slice(0,n)}return f}function fromArrayLike(e){var r=e.length<0?0:checked(e.length)|0;var t=createBuffer(r);for(var f=0;f<r;f+=1){t[f]=e[f]&255}return t}function fromArrayBuffer(e,r,t){if(r<0||e.byteLength<r){throw new RangeError('\"offset\" is outside of buffer bounds')}if(e.byteLength<r+(t||0)){throw new RangeError('\"length\" is outside of buffer bounds')}var f;if(r===undefined&&t===undefined){f=new Uint8Array(e)}else if(t===undefined){f=new Uint8Array(e,r)}else{f=new Uint8Array(e,r,t)}Object.setPrototypeOf(f,Buffer.prototype);return f}function fromObject(e){if(Buffer.isBuffer(e)){var r=checked(e.length)|0;var t=createBuffer(r);if(t.length===0){return t}e.copy(t,0,0,r);return t}if(e.length!==undefined){if(typeof e.length!==\"number\"||numberIsNaN(e.length)){return createBuffer(0)}return fromArrayLike(e)}if(e.type===\"Buffer\"&&Array.isArray(e.data)){return fromArrayLike(e.data)}}function checked(e){if(e>=o){throw new RangeError(\"Attempt to allocate Buffer larger than maximum \"+\"size: 0x\"+o.toString(16)+\" bytes\")}return e|0}function SlowBuffer(e){if(+e!=e){e=0}return Buffer.alloc(+e)}Buffer.isBuffer=function isBuffer(e){return e!=null&&e._isBuffer===true&&e!==Buffer.prototype};Buffer.compare=function compare(e,r){if(isInstance(e,Uint8Array))e=Buffer.from(e,e.offset,e.byteLength);if(isInstance(r,Uint8Array))r=Buffer.from(r,r.offset,r.byteLength);if(!Buffer.isBuffer(e)||!Buffer.isBuffer(r)){throw new TypeError('The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array')}if(e===r)return 0;var t=e.length;var f=r.length;for(var n=0,i=Math.min(t,f);n<i;++n){if(e[n]!==r[n]){t=e[n];f=r[n];break}}if(t<f)return-1;if(f<t)return 1;return 0};Buffer.isEncoding=function isEncoding(e){switch(String(e).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return true;default:return false}};Buffer.concat=function concat(e,r){if(!Array.isArray(e)){throw new TypeError('\"list\" argument must be an Array of Buffers')}if(e.length===0){return Buffer.alloc(0)}var t;if(r===undefined){r=0;for(t=0;t<e.length;++t){r+=e[t].length}}var f=Buffer.allocUnsafe(r);var n=0;for(t=0;t<e.length;++t){var i=e[t];if(isInstance(i,Uint8Array)){i=Buffer.from(i)}if(!Buffer.isBuffer(i)){throw new TypeError('\"list\" argument must be an Array of Buffers')}i.copy(f,n);n+=i.length}return f};function byteLength(e,r){if(Buffer.isBuffer(e)){return e.length}if(ArrayBuffer.isView(e)||isInstance(e,ArrayBuffer)){return e.byteLength}if(typeof e!==\"string\"){throw new TypeError('The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. '+\"Received type \"+typeof e)}var t=e.length;var f=arguments.length>2&&arguments[2]===true;if(!f&&t===0)return 0;var n=false;for(;;){switch(r){case\"ascii\":case\"latin1\":case\"binary\":return t;case\"utf8\":case\"utf-8\":return utf8ToBytes(e).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return t*2;case\"hex\":return t>>>1;case\"base64\":return base64ToBytes(e).length;default:if(n){return f?-1:utf8ToBytes(e).length}r=(\"\"+r).toLowerCase();n=true}}}Buffer.byteLength=byteLength;function slowToString(e,r,t){var f=false;if(r===undefined||r<0){r=0}if(r>this.length){return\"\"}if(t===undefined||t>this.length){t=this.length}if(t<=0){return\"\"}t>>>=0;r>>>=0;if(t<=r){return\"\"}if(!e)e=\"utf8\";while(true){switch(e){case\"hex\":return hexSlice(this,r,t);case\"utf8\":case\"utf-8\":return utf8Slice(this,r,t);case\"ascii\":return asciiSlice(this,r,t);case\"latin1\":case\"binary\":return latin1Slice(this,r,t);case\"base64\":return base64Slice(this,r,t);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return utf16leSlice(this,r,t);default:if(f)throw new TypeError(\"Unknown encoding: \"+e);e=(e+\"\").toLowerCase();f=true}}}Buffer.prototype._isBuffer=true;function swap(e,r,t){var f=e[r];e[r]=e[t];e[t]=f}Buffer.prototype.swap16=function swap16(){var e=this.length;if(e%2!==0){throw new RangeError(\"Buffer size must be a multiple of 16-bits\")}for(var r=0;r<e;r+=2){swap(this,r,r+1)}return this};Buffer.prototype.swap32=function swap32(){var e=this.length;if(e%4!==0){throw new RangeError(\"Buffer size must be a multiple of 32-bits\")}for(var r=0;r<e;r+=4){swap(this,r,r+3);swap(this,r+1,r+2)}return this};Buffer.prototype.swap64=function swap64(){var e=this.length;if(e%8!==0){throw new RangeError(\"Buffer size must be a multiple of 64-bits\")}for(var r=0;r<e;r+=8){swap(this,r,r+7);swap(this,r+1,r+6);swap(this,r+2,r+5);swap(this,r+3,r+4)}return this};Buffer.prototype.toString=function toString(){var e=this.length;if(e===0)return\"\";if(arguments.length===0)return utf8Slice(this,0,e);return slowToString.apply(this,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(e){if(!Buffer.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");if(this===e)return true;return Buffer.compare(this,e)===0};Buffer.prototype.inspect=function inspect(){var e=\"\";var t=r.INSPECT_MAX_BYTES;e=this.toString(\"hex\",0,t).replace(/(.{2})/g,\"$1 \").trim();if(this.length>t)e+=\" ... \";return\"<Buffer \"+e+\">\"};if(i){Buffer.prototype[i]=Buffer.prototype.inspect}Buffer.prototype.compare=function compare(e,r,t,f,n){if(isInstance(e,Uint8Array)){e=Buffer.from(e,e.offset,e.byteLength)}if(!Buffer.isBuffer(e)){throw new TypeError('The \"target\" argument must be one of type Buffer or Uint8Array. '+\"Received type \"+typeof e)}if(r===undefined){r=0}if(t===undefined){t=e?e.length:0}if(f===undefined){f=0}if(n===undefined){n=this.length}if(r<0||t>e.length||f<0||n>this.length){throw new RangeError(\"out of range index\")}if(f>=n&&r>=t){return 0}if(f>=n){return-1}if(r>=t){return 1}r>>>=0;t>>>=0;f>>>=0;n>>>=0;if(this===e)return 0;var i=n-f;var o=t-r;var u=Math.min(i,o);var a=this.slice(f,n);var s=e.slice(r,t);for(var h=0;h<u;++h){if(a[h]!==s[h]){i=a[h];o=s[h];break}}if(i<o)return-1;if(o<i)return 1;return 0};function bidirectionalIndexOf(e,r,t,f,n){if(e.length===0)return-1;if(typeof t===\"string\"){f=t;t=0}else if(t>2147483647){t=2147483647}else if(t<-2147483648){t=-2147483648}t=+t;if(numberIsNaN(t)){t=n?0:e.length-1}if(t<0)t=e.length+t;if(t>=e.length){if(n)return-1;else t=e.length-1}else if(t<0){if(n)t=0;else return-1}if(typeof r===\"string\"){r=Buffer.from(r,f)}if(Buffer.isBuffer(r)){if(r.length===0){return-1}return arrayIndexOf(e,r,t,f,n)}else if(typeof r===\"number\"){r=r&255;if(typeof Uint8Array.prototype.indexOf===\"function\"){if(n){return Uint8Array.prototype.indexOf.call(e,r,t)}else{return Uint8Array.prototype.lastIndexOf.call(e,r,t)}}return arrayIndexOf(e,[r],t,f,n)}throw new TypeError(\"val must be string, number or Buffer\")}function arrayIndexOf(e,r,t,f,n){var i=1;var o=e.length;var u=r.length;if(f!==undefined){f=String(f).toLowerCase();if(f===\"ucs2\"||f===\"ucs-2\"||f===\"utf16le\"||f===\"utf-16le\"){if(e.length<2||r.length<2){return-1}i=2;o/=2;u/=2;t/=2}}function read(e,r){if(i===1){return e[r]}else{return e.readUInt16BE(r*i)}}var a;if(n){var s=-1;for(a=t;a<o;a++){if(read(e,a)===read(r,s===-1?0:a-s)){if(s===-1)s=a;if(a-s+1===u)return s*i}else{if(s!==-1)a-=a-s;s=-1}}}else{if(t+u>o)t=o-u;for(a=t;a>=0;a--){var h=true;for(var c=0;c<u;c++){if(read(e,a+c)!==read(r,c)){h=false;break}}if(h)return a}}return-1}Buffer.prototype.includes=function includes(e,r,t){return this.indexOf(e,r,t)!==-1};Buffer.prototype.indexOf=function indexOf(e,r,t){return bidirectionalIndexOf(this,e,r,t,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(e,r,t){return bidirectionalIndexOf(this,e,r,t,false)};function hexWrite(e,r,t,f){t=Number(t)||0;var n=e.length-t;if(!f){f=n}else{f=Number(f);if(f>n){f=n}}var i=r.length;if(f>i/2){f=i/2}for(var o=0;o<f;++o){var u=parseInt(r.substr(o*2,2),16);if(numberIsNaN(u))return o;e[t+o]=u}return o}function utf8Write(e,r,t,f){return blitBuffer(utf8ToBytes(r,e.length-t),e,t,f)}function asciiWrite(e,r,t,f){return blitBuffer(asciiToBytes(r),e,t,f)}function latin1Write(e,r,t,f){return asciiWrite(e,r,t,f)}function base64Write(e,r,t,f){return blitBuffer(base64ToBytes(r),e,t,f)}function ucs2Write(e,r,t,f){return blitBuffer(utf16leToBytes(r,e.length-t),e,t,f)}Buffer.prototype.write=function write(e,r,t,f){if(r===undefined){f=\"utf8\";t=this.length;r=0}else if(t===undefined&&typeof r===\"string\"){f=r;t=this.length;r=0}else if(isFinite(r)){r=r>>>0;if(isFinite(t)){t=t>>>0;if(f===undefined)f=\"utf8\"}else{f=t;t=undefined}}else{throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\")}var n=this.length-r;if(t===undefined||t>n)t=n;if(e.length>0&&(t<0||r<0)||r>this.length){throw new RangeError(\"Attempt to write outside buffer bounds\")}if(!f)f=\"utf8\";var i=false;for(;;){switch(f){case\"hex\":return hexWrite(this,e,r,t);case\"utf8\":case\"utf-8\":return utf8Write(this,e,r,t);case\"ascii\":return asciiWrite(this,e,r,t);case\"latin1\":case\"binary\":return latin1Write(this,e,r,t);case\"base64\":return base64Write(this,e,r,t);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return ucs2Write(this,e,r,t);default:if(i)throw new TypeError(\"Unknown encoding: \"+f);f=(\"\"+f).toLowerCase();i=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(e,r,t){if(r===0&&t===e.length){return f.fromByteArray(e)}else{return f.fromByteArray(e.slice(r,t))}}function utf8Slice(e,r,t){t=Math.min(e.length,t);var f=[];var n=r;while(n<t){var i=e[n];var o=null;var u=i>239?4:i>223?3:i>191?2:1;if(n+u<=t){var a,s,h,c;switch(u){case 1:if(i<128){o=i}break;case 2:a=e[n+1];if((a&192)===128){c=(i&31)<<6|a&63;if(c>127){o=c}}break;case 3:a=e[n+1];s=e[n+2];if((a&192)===128&&(s&192)===128){c=(i&15)<<12|(a&63)<<6|s&63;if(c>2047&&(c<55296||c>57343)){o=c}}break;case 4:a=e[n+1];s=e[n+2];h=e[n+3];if((a&192)===128&&(s&192)===128&&(h&192)===128){c=(i&15)<<18|(a&63)<<12|(s&63)<<6|h&63;if(c>65535&&c<1114112){o=c}}}}if(o===null){o=65533;u=1}else if(o>65535){o-=65536;f.push(o>>>10&1023|55296);o=56320|o&1023}f.push(o);n+=u}return decodeCodePointsArray(f)}var u=4096;function decodeCodePointsArray(e){var r=e.length;if(r<=u){return String.fromCharCode.apply(String,e)}var t=\"\";var f=0;while(f<r){t+=String.fromCharCode.apply(String,e.slice(f,f+=u))}return t}function asciiSlice(e,r,t){var f=\"\";t=Math.min(e.length,t);for(var n=r;n<t;++n){f+=String.fromCharCode(e[n]&127)}return f}function latin1Slice(e,r,t){var f=\"\";t=Math.min(e.length,t);for(var n=r;n<t;++n){f+=String.fromCharCode(e[n])}return f}function hexSlice(e,r,t){var f=e.length;if(!r||r<0)r=0;if(!t||t<0||t>f)t=f;var n=\"\";for(var i=r;i<t;++i){n+=s[e[i]]}return n}function utf16leSlice(e,r,t){var f=e.slice(r,t);var n=\"\";for(var i=0;i<f.length;i+=2){n+=String.fromCharCode(f[i]+f[i+1]*256)}return n}Buffer.prototype.slice=function slice(e,r){var t=this.length;e=~~e;r=r===undefined?t:~~r;if(e<0){e+=t;if(e<0)e=0}else if(e>t){e=t}if(r<0){r+=t;if(r<0)r=0}else if(r>t){r=t}if(r<e)r=e;var f=this.subarray(e,r);Object.setPrototypeOf(f,Buffer.prototype);return f};function checkOffset(e,r,t){if(e%1!==0||e<0)throw new RangeError(\"offset is not uint\");if(e+r>t)throw new RangeError(\"Trying to access beyond buffer length\")}Buffer.prototype.readUIntLE=function readUIntLE(e,r,t){e=e>>>0;r=r>>>0;if(!t)checkOffset(e,r,this.length);var f=this[e];var n=1;var i=0;while(++i<r&&(n*=256)){f+=this[e+i]*n}return f};Buffer.prototype.readUIntBE=function readUIntBE(e,r,t){e=e>>>0;r=r>>>0;if(!t){checkOffset(e,r,this.length)}var f=this[e+--r];var n=1;while(r>0&&(n*=256)){f+=this[e+--r]*n}return f};Buffer.prototype.readUInt8=function readUInt8(e,r){e=e>>>0;if(!r)checkOffset(e,1,this.length);return this[e]};Buffer.prototype.readUInt16LE=function readUInt16LE(e,r){e=e>>>0;if(!r)checkOffset(e,2,this.length);return this[e]|this[e+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(e,r){e=e>>>0;if(!r)checkOffset(e,2,this.length);return this[e]<<8|this[e+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};Buffer.prototype.readIntLE=function readIntLE(e,r,t){e=e>>>0;r=r>>>0;if(!t)checkOffset(e,r,this.length);var f=this[e];var n=1;var i=0;while(++i<r&&(n*=256)){f+=this[e+i]*n}n*=128;if(f>=n)f-=Math.pow(2,8*r);return f};Buffer.prototype.readIntBE=function readIntBE(e,r,t){e=e>>>0;r=r>>>0;if(!t)checkOffset(e,r,this.length);var f=r;var n=1;var i=this[e+--f];while(f>0&&(n*=256)){i+=this[e+--f]*n}n*=128;if(i>=n)i-=Math.pow(2,8*r);return i};Buffer.prototype.readInt8=function readInt8(e,r){e=e>>>0;if(!r)checkOffset(e,1,this.length);if(!(this[e]&128))return this[e];return(255-this[e]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(e,r){e=e>>>0;if(!r)checkOffset(e,2,this.length);var t=this[e]|this[e+1]<<8;return t&32768?t|4294901760:t};Buffer.prototype.readInt16BE=function readInt16BE(e,r){e=e>>>0;if(!r)checkOffset(e,2,this.length);var t=this[e+1]|this[e]<<8;return t&32768?t|4294901760:t};Buffer.prototype.readInt32LE=function readInt32LE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};Buffer.prototype.readFloatLE=function readFloatLE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return n.read(this,e,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return n.read(this,e,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(e,r){e=e>>>0;if(!r)checkOffset(e,8,this.length);return n.read(this,e,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(e,r){e=e>>>0;if(!r)checkOffset(e,8,this.length);return n.read(this,e,false,52,8)};function checkInt(e,r,t,f,n,i){if(!Buffer.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(r>n||r<i)throw new RangeError('\"value\" argument is out of bounds');if(t+f>e.length)throw new RangeError(\"Index out of range\")}Buffer.prototype.writeUIntLE=function writeUIntLE(e,r,t,f){e=+e;r=r>>>0;t=t>>>0;if(!f){var n=Math.pow(2,8*t)-1;checkInt(this,e,r,t,n,0)}var i=1;var o=0;this[r]=e&255;while(++o<t&&(i*=256)){this[r+o]=e/i&255}return r+t};Buffer.prototype.writeUIntBE=function writeUIntBE(e,r,t,f){e=+e;r=r>>>0;t=t>>>0;if(!f){var n=Math.pow(2,8*t)-1;checkInt(this,e,r,t,n,0)}var i=t-1;var o=1;this[r+i]=e&255;while(--i>=0&&(o*=256)){this[r+i]=e/o&255}return r+t};Buffer.prototype.writeUInt8=function writeUInt8(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,1,255,0);this[r]=e&255;return r+1};Buffer.prototype.writeUInt16LE=function writeUInt16LE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,2,65535,0);this[r]=e&255;this[r+1]=e>>>8;return r+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,2,65535,0);this[r]=e>>>8;this[r+1]=e&255;return r+2};Buffer.prototype.writeUInt32LE=function writeUInt32LE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,4,4294967295,0);this[r+3]=e>>>24;this[r+2]=e>>>16;this[r+1]=e>>>8;this[r]=e&255;return r+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,4,4294967295,0);this[r]=e>>>24;this[r+1]=e>>>16;this[r+2]=e>>>8;this[r+3]=e&255;return r+4};Buffer.prototype.writeIntLE=function writeIntLE(e,r,t,f){e=+e;r=r>>>0;if(!f){var n=Math.pow(2,8*t-1);checkInt(this,e,r,t,n-1,-n)}var i=0;var o=1;var u=0;this[r]=e&255;while(++i<t&&(o*=256)){if(e<0&&u===0&&this[r+i-1]!==0){u=1}this[r+i]=(e/o>>0)-u&255}return r+t};Buffer.prototype.writeIntBE=function writeIntBE(e,r,t,f){e=+e;r=r>>>0;if(!f){var n=Math.pow(2,8*t-1);checkInt(this,e,r,t,n-1,-n)}var i=t-1;var o=1;var u=0;this[r+i]=e&255;while(--i>=0&&(o*=256)){if(e<0&&u===0&&this[r+i+1]!==0){u=1}this[r+i]=(e/o>>0)-u&255}return r+t};Buffer.prototype.writeInt8=function writeInt8(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,1,127,-128);if(e<0)e=255+e+1;this[r]=e&255;return r+1};Buffer.prototype.writeInt16LE=function writeInt16LE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,2,32767,-32768);this[r]=e&255;this[r+1]=e>>>8;return r+2};Buffer.prototype.writeInt16BE=function writeInt16BE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,2,32767,-32768);this[r]=e>>>8;this[r+1]=e&255;return r+2};Buffer.prototype.writeInt32LE=function writeInt32LE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,4,2147483647,-2147483648);this[r]=e&255;this[r+1]=e>>>8;this[r+2]=e>>>16;this[r+3]=e>>>24;return r+4};Buffer.prototype.writeInt32BE=function writeInt32BE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,4,2147483647,-2147483648);if(e<0)e=4294967295+e+1;this[r]=e>>>24;this[r+1]=e>>>16;this[r+2]=e>>>8;this[r+3]=e&255;return r+4};function checkIEEE754(e,r,t,f,n,i){if(t+f>e.length)throw new RangeError(\"Index out of range\");if(t<0)throw new RangeError(\"Index out of range\")}function writeFloat(e,r,t,f,i){r=+r;t=t>>>0;if(!i){checkIEEE754(e,r,t,4,34028234663852886e22,-34028234663852886e22)}n.write(e,r,t,f,23,4);return t+4}Buffer.prototype.writeFloatLE=function writeFloatLE(e,r,t){return writeFloat(this,e,r,true,t)};Buffer.prototype.writeFloatBE=function writeFloatBE(e,r,t){return writeFloat(this,e,r,false,t)};function writeDouble(e,r,t,f,i){r=+r;t=t>>>0;if(!i){checkIEEE754(e,r,t,8,17976931348623157e292,-17976931348623157e292)}n.write(e,r,t,f,52,8);return t+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(e,r,t){return writeDouble(this,e,r,true,t)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(e,r,t){return writeDouble(this,e,r,false,t)};Buffer.prototype.copy=function copy(e,r,t,f){if(!Buffer.isBuffer(e))throw new TypeError(\"argument should be a Buffer\");if(!t)t=0;if(!f&&f!==0)f=this.length;if(r>=e.length)r=e.length;if(!r)r=0;if(f>0&&f<t)f=t;if(f===t)return 0;if(e.length===0||this.length===0)return 0;if(r<0){throw new RangeError(\"targetStart out of bounds\")}if(t<0||t>=this.length)throw new RangeError(\"Index out of range\");if(f<0)throw new RangeError(\"sourceEnd out of bounds\");if(f>this.length)f=this.length;if(e.length-r<f-t){f=e.length-r+t}var n=f-t;if(this===e&&typeof Uint8Array.prototype.copyWithin===\"function\"){this.copyWithin(r,t,f)}else if(this===e&&t<r&&r<f){for(var i=n-1;i>=0;--i){e[i+r]=this[i+t]}}else{Uint8Array.prototype.set.call(e,this.subarray(t,f),r)}return n};Buffer.prototype.fill=function fill(e,r,t,f){if(typeof e===\"string\"){if(typeof r===\"string\"){f=r;r=0;t=this.length}else if(typeof t===\"string\"){f=t;t=this.length}if(f!==undefined&&typeof f!==\"string\"){throw new TypeError(\"encoding must be a string\")}if(typeof f===\"string\"&&!Buffer.isEncoding(f)){throw new TypeError(\"Unknown encoding: \"+f)}if(e.length===1){var n=e.charCodeAt(0);if(f===\"utf8\"&&n<128||f===\"latin1\"){e=n}}}else if(typeof e===\"number\"){e=e&255}else if(typeof e===\"boolean\"){e=Number(e)}if(r<0||this.length<r||this.length<t){throw new RangeError(\"Out of range index\")}if(t<=r){return this}r=r>>>0;t=t===undefined?this.length:t>>>0;if(!e)e=0;var i;if(typeof e===\"number\"){for(i=r;i<t;++i){this[i]=e}}else{var o=Buffer.isBuffer(e)?e:Buffer.from(e,f);var u=o.length;if(u===0){throw new TypeError('The value \"'+e+'\" is invalid for argument \"value\"')}for(i=0;i<t-r;++i){this[i+r]=o[i%u]}}return this};var a=/[^+/0-9A-Za-z-_]/g;function base64clean(e){e=e.split(\"=\")[0];e=e.trim().replace(a,\"\");if(e.length<2)return\"\";while(e.length%4!==0){e=e+\"=\"}return e}function utf8ToBytes(e,r){r=r||Infinity;var t;var f=e.length;var n=null;var i=[];for(var o=0;o<f;++o){t=e.charCodeAt(o);if(t>55295&&t<57344){if(!n){if(t>56319){if((r-=3)>-1)i.push(239,191,189);continue}else if(o+1===f){if((r-=3)>-1)i.push(239,191,189);continue}n=t;continue}if(t<56320){if((r-=3)>-1)i.push(239,191,189);n=t;continue}t=(n-55296<<10|t-56320)+65536}else if(n){if((r-=3)>-1)i.push(239,191,189)}n=null;if(t<128){if((r-=1)<0)break;i.push(t)}else if(t<2048){if((r-=2)<0)break;i.push(t>>6|192,t&63|128)}else if(t<65536){if((r-=3)<0)break;i.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((r-=4)<0)break;i.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else{throw new Error(\"Invalid code point\")}}return i}function asciiToBytes(e){var r=[];for(var t=0;t<e.length;++t){r.push(e.charCodeAt(t)&255)}return r}function utf16leToBytes(e,r){var t,f,n;var i=[];for(var o=0;o<e.length;++o){if((r-=2)<0)break;t=e.charCodeAt(o);f=t>>8;n=t%256;i.push(n);i.push(f)}return i}function base64ToBytes(e){return f.toByteArray(base64clean(e))}function blitBuffer(e,r,t,f){for(var n=0;n<f;++n){if(n+t>=r.length||n>=e.length)break;r[n+t]=e[n]}return n}function isInstance(e,r){return e instanceof r||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===r.name}function numberIsNaN(e){return e!==e}var s=function(){var e=\"0123456789abcdef\";var r=new Array(256);for(var t=0;t<16;++t){var f=t*16;for(var n=0;n<16;++n){r[f+n]=e[t]+e[n]}}return r}()},783:function(e,r){\n/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nr.read=function(e,r,t,f,n){var i,o;var u=n*8-f-1;var a=(1<<u)-1;var s=a>>1;var h=-7;var c=t?n-1:0;var l=t?-1:1;var p=e[r+c];c+=l;i=p&(1<<-h)-1;p>>=-h;h+=u;for(;h>0;i=i*256+e[r+c],c+=l,h-=8){}o=i&(1<<-h)-1;i>>=-h;h+=f;for(;h>0;o=o*256+e[r+c],c+=l,h-=8){}if(i===0){i=1-s}else if(i===a){return o?NaN:(p?-1:1)*Infinity}else{o=o+Math.pow(2,f);i=i-s}return(p?-1:1)*o*Math.pow(2,i-f)};r.write=function(e,r,t,f,n,i){var o,u,a;var s=i*8-n-1;var h=(1<<s)-1;var c=h>>1;var l=n===23?Math.pow(2,-24)-Math.pow(2,-77):0;var p=f?0:i-1;var y=f?1:-1;var g=r<0||r===0&&1/r<0?1:0;r=Math.abs(r);if(isNaN(r)||r===Infinity){u=isNaN(r)?1:0;o=h}else{o=Math.floor(Math.log(r)/Math.LN2);if(r*(a=Math.pow(2,-o))<1){o--;a*=2}if(o+c>=1){r+=l/a}else{r+=l*Math.pow(2,1-c)}if(r*a>=2){o++;a/=2}if(o+c>=h){u=0;o=h}else if(o+c>=1){u=(r*a-1)*Math.pow(2,n);o=o+c}else{u=r*Math.pow(2,c-1)*Math.pow(2,n);o=0}}for(;n>=8;e[t+p]=u&255,p+=y,u/=256,n-=8){}o=o<<n|u;s+=n;for(;s>0;e[t+p]=o&255,p+=y,o/=256,s-=8){}e[t+p-y]|=g*128}}};var r={};function __nccwpck_require__(t){var f=r[t];if(f!==undefined){return f.exports}var n=r[t]={exports:{}};var i=true;try{e[t](n,n.exports,__nccwpck_require__);i=false}finally{if(i)delete r[t]}return n.exports}if(typeof __nccwpck_require__!==\"undefined\")__nccwpck_require__.ab=__dirname+\"/\";var t=__nccwpck_require__(72);module.exports=t})();"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2328, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2333, "column": 0}, "map": {"version":3,"file":"handle.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/syntax/src/handle.ts"],"sourcesContent":["export const INVALID_HANDLE = 'handle.invalid'\n\n// Currently these are registration-time restrictions, not protocol-level\n// restrictions. We have a couple accounts in the wild that we need to clean up\n// before hard-disallow.\n// See also: https://en.wikipedia.org/wiki/Top-level_domain#Reserved_domains\nexport const DISALLOWED_TLDS = [\n  '.local',\n  '.arpa',\n  '.invalid',\n  '.localhost',\n  '.internal',\n  '.example',\n  '.alt',\n  // policy could concievably change on \".onion\" some day\n  '.onion',\n  // NOTE: .test is allowed in testing and devopment. In practical terms\n  // \"should\" \"never\" actually resolve and get registered in production\n]\n\n// Handle constraints, in English:\n//  - must be a possible domain name\n//    - RFC-1035 is commonly referenced, but has been updated. eg, RFC-3696,\n//      section 2. and RFC-3986, section 3. can now have leading numbers (eg,\n//      4chan.org)\n//    - \"labels\" (sub-names) are made of ASCII letters, digits, hyphens\n//    - can not start or end with a hyphen\n//    - TLD (last component) should not start with a digit\n//    - can't end with a hyphen (can end with digit)\n//    - each segment must be between 1 and 63 characters (not including any periods)\n//    - overall length can't be more than 253 characters\n//    - separated by (ASCII) periods; does not start or end with period\n//    - case insensitive\n//    - domains (handles) are equal if they are the same lower-case\n//    - punycode allowed for internationalization\n//  - no whitespace, null bytes, joining chars, etc\n//  - does not validate whether domain or TLD exists, or is a reserved or\n//    special TLD (eg, .onion or .local)\n//  - does not validate punycode\nexport const ensureValidHandle = (handle: string): void => {\n  // check that all chars are boring ASCII\n  if (!/^[a-zA-Z0-9.-]*$/.test(handle)) {\n    throw new InvalidHandleError(\n      'Disallowed characters in handle (ASCII letters, digits, dashes, periods only)',\n    )\n  }\n\n  if (handle.length > 253) {\n    throw new InvalidHandleError('Handle is too long (253 chars max)')\n  }\n  const labels = handle.split('.')\n  if (labels.length < 2) {\n    throw new InvalidHandleError('Handle domain needs at least two parts')\n  }\n  for (let i = 0; i < labels.length; i++) {\n    const l = labels[i]\n    if (l.length < 1) {\n      throw new InvalidHandleError('Handle parts can not be empty')\n    }\n    if (l.length > 63) {\n      throw new InvalidHandleError('Handle part too long (max 63 chars)')\n    }\n    if (l.endsWith('-') || l.startsWith('-')) {\n      throw new InvalidHandleError(\n        'Handle parts can not start or end with hyphens',\n      )\n    }\n    if (i + 1 === labels.length && !/^[a-zA-Z]/.test(l)) {\n      throw new InvalidHandleError(\n        'Handle final component (TLD) must start with ASCII letter',\n      )\n    }\n  }\n}\n\n// simple regex translation of above constraints\nexport const ensureValidHandleRegex = (handle: string): void => {\n  if (\n    !/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?$/.test(\n      handle,\n    )\n  ) {\n    throw new InvalidHandleError(\"Handle didn't validate via regex\")\n  }\n  if (handle.length > 253) {\n    throw new InvalidHandleError('Handle is too long (253 chars max)')\n  }\n}\n\nexport const normalizeHandle = (handle: string): string => {\n  return handle.toLowerCase()\n}\n\nexport const normalizeAndEnsureValidHandle = (handle: string): string => {\n  const normalized = normalizeHandle(handle)\n  ensureValidHandle(normalized)\n  return normalized\n}\n\nexport const isValidHandle = (handle: string): boolean => {\n  try {\n    ensureValidHandle(handle)\n  } catch (err) {\n    if (err instanceof InvalidHandleError) {\n      return false\n    }\n    throw err\n  }\n\n  return true\n}\n\nexport const isValidTld = (handle: string): boolean => {\n  return !DISALLOWED_TLDS.some((domain) => handle.endsWith(domain))\n}\n\nexport class InvalidHandleError extends Error {}\nexport class ReservedHandleError extends Error {}\nexport class UnsupportedDomainError extends Error {}\nexport class DisallowedDomainError extends Error {}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2450, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2455, "column": 0}, "map": {"version":3,"file":"did.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/syntax/src/did.ts"],"sourcesContent":["// Human-readable constraints:\n//   - valid W3C DID (https://www.w3.org/TR/did-core/#did-syntax)\n//      - entire URI is ASCII: [a-zA-Z0-9._:%-]\n//      - always starts \"did:\" (lower-case)\n//      - method name is one or more lower-case letters, followed by \":\"\n//      - remaining identifier can have any of the above chars, but can not end in \":\"\n//      - it seems that a bunch of \":\" can be included, and don't need spaces between\n//      - \"%\" is used only for \"percent encoding\" and must be followed by two hex characters (and thus can't end in \"%\")\n//      - query (\"?\") and fragment (\"#\") stuff is defined for \"DID URIs\", but not as part of identifier itself\n//      - \"The current specification does not take a position on the maximum length of a DID\"\n//   - in current atproto, only allowing did:plc and did:web. But not *forcing* this at lexicon layer\n//   - hard length limit of 8KBytes\n//   - not going to validate \"percent encoding\" here\nexport const ensureValidDid = (did: string): void => {\n  if (!did.startsWith('did:')) {\n    throw new InvalidDidError('DID requires \"did:\" prefix')\n  }\n\n  // check that all chars are boring ASCII\n  if (!/^[a-zA-Z0-9._:%-]*$/.test(did)) {\n    throw new InvalidDidError(\n      'Disallowed characters in DID (ASCII letters, digits, and a couple other characters only)',\n    )\n  }\n\n  const { length, 1: method } = did.split(':')\n  if (length < 3) {\n    throw new InvalidDidError(\n      'DID requires prefix, method, and method-specific content',\n    )\n  }\n\n  if (!/^[a-z]+$/.test(method)) {\n    throw new InvalidDidError('DID method must be lower-case letters')\n  }\n\n  if (did.endsWith(':') || did.endsWith('%')) {\n    throw new InvalidDidError('DID can not end with \":\" or \"%\"')\n  }\n\n  if (did.length > 2 * 1024) {\n    throw new InvalidDidError('DID is too long (2048 chars max)')\n  }\n}\n\nexport const ensureValidDidRegex = (did: string): void => {\n  // simple regex to enforce most constraints via just regex and length.\n  // hand wrote this regex based on above constraints\n  if (!/^did:[a-z]+:[a-zA-Z0-9._:%-]*[a-zA-Z0-9._-]$/.test(did)) {\n    throw new InvalidDidError(\"DID didn't validate via regex\")\n  }\n\n  if (did.length > 2 * 1024) {\n    throw new InvalidDidError('DID is too long (2048 chars max)')\n  }\n}\n\nexport class InvalidDidError extends Error {}\n"],"names":[],"mappings":";;;;;AAAA,8BAA8B;AAC9B,iEAAiE;AACjE,+CAA+C;AAC/C,2CAA2C;AAC3C,wEAAwE;AACxE,sFAAsF;AACtF,qFAAqF;AACrF,wHAAwH;AACxH,8GAA8G;AAC9G,6FAA6F;AAC7F,qGAAqG;AACrG,mCAAmC;AACnC,oDAAoD;AAC7C,MAAM,cAAc,GAAG,CAAC,GAAW,EAAQ,EAAE;IAClD,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC;QAC5B,MAAM,IAAI,eAAe,CAAC,4BAA4B,CAAC,CAAA;IACzD,CAAC;IAED,wCAAwC;IACxC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;QACrC,MAAM,IAAI,eAAe,CACvB,0FAA0F,CAC3F,CAAA;IACH,CAAC;IAED,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,MAAM,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;IAC5C,IAAI,MAAM,GAAG,CAAC,EAAE,CAAC;QACf,MAAM,IAAI,eAAe,CACvB,0DAA0D,CAC3D,CAAA;IACH,CAAC;IAED,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;QAC7B,MAAM,IAAI,eAAe,CAAC,uCAAuC,CAAC,CAAA;IACpE,CAAC;IAED,IAAI,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;QAC3C,MAAM,IAAI,eAAe,CAAC,iCAAiC,CAAC,CAAA;IAC9D,CAAC;IAED,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC;QAC1B,MAAM,IAAI,eAAe,CAAC,kCAAkC,CAAC,CAAA;IAC/D,CAAC;AACH,CAAC,CAAA;AA9BY,QAAA,cAAc,GAAA,eA8B1B;AAEM,MAAM,mBAAmB,GAAG,CAAC,GAAW,EAAQ,EAAE;IACvD,sEAAsE;IACtE,mDAAmD;IACnD,IAAI,CAAC,8CAA8C,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;QAC9D,MAAM,IAAI,eAAe,CAAC,+BAA+B,CAAC,CAAA;IAC5D,CAAC;IAED,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC;QAC1B,MAAM,IAAI,eAAe,CAAC,kCAAkC,CAAC,CAAA;IAC/D,CAAC;AACH,CAAC,CAAA;AAVY,QAAA,mBAAmB,GAAA,oBAU/B;AAED,MAAa,eAAgB,SAAQ,KAAK;CAAG;AAA7C,QAAA,eAAA,GAAA,gBAA6C","ignoreList":[0]}},
    {"offset": {"line": 2510, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2515, "column": 0}, "map": {"version":3,"file":"nsid.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/syntax/src/nsid.ts"],"sourcesContent":["/*\nGrammar:\n\nalpha     = \"a\" / \"b\" / \"c\" / \"d\" / \"e\" / \"f\" / \"g\" / \"h\" / \"i\" / \"j\" / \"k\" / \"l\" / \"m\" / \"n\" / \"o\" / \"p\" / \"q\" / \"r\" / \"s\" / \"t\" / \"u\" / \"v\" / \"w\" / \"x\" / \"y\" / \"z\" / \"A\" / \"B\" / \"C\" / \"D\" / \"E\" / \"F\" / \"G\" / \"H\" / \"I\" / \"J\" / \"K\" / \"L\" / \"M\" / \"N\" / \"O\" / \"P\" / \"Q\" / \"R\" / \"S\" / \"T\" / \"U\" / \"V\" / \"W\" / \"X\" / \"Y\" / \"Z\"\nnumber    = \"1\" / \"2\" / \"3\" / \"4\" / \"5\" / \"6\" / \"7\" / \"8\" / \"9\" / \"0\"\ndelim     = \".\"\nsegment   = alpha *( alpha / number / \"-\" )\nauthority = segment *( delim segment )\nname      = alpha *( alpha )\nnsid      = authority delim name\n\n*/\n\nexport class NSID {\n  segments: string[] = []\n\n  static parse(nsid: string): NSID {\n    return new NSID(nsid)\n  }\n\n  static create(authority: string, name: string): NSID {\n    const segments = [...authority.split('.').reverse(), name].join('.')\n    return new NSID(segments)\n  }\n\n  static isValid(nsid: string): boolean {\n    try {\n      NSID.parse(nsid)\n      return true\n    } catch (e) {\n      return false\n    }\n  }\n\n  constructor(nsid: string) {\n    ensureValidNsid(nsid)\n    this.segments = nsid.split('.')\n  }\n\n  get authority() {\n    return this.segments\n      .slice(0, this.segments.length - 1)\n      .reverse()\n      .join('.')\n  }\n\n  get name() {\n    return this.segments.at(this.segments.length - 1)\n  }\n\n  toString() {\n    return this.segments.join('.')\n  }\n}\n\n// Human readable constraints on NSID:\n// - a valid domain in reversed notation\n// - followed by an additional period-separated name, which is camel-case letters\nexport const ensureValidNsid = (nsid: string): void => {\n  const toCheck = nsid\n\n  // check that all chars are boring ASCII\n  if (!/^[a-zA-Z0-9.-]*$/.test(toCheck)) {\n    throw new InvalidNsidError(\n      'Disallowed characters in NSID (ASCII letters, digits, dashes, periods only)',\n    )\n  }\n\n  if (toCheck.length > 253 + 1 + 63) {\n    throw new InvalidNsidError('NSID is too long (317 chars max)')\n  }\n  const labels = toCheck.split('.')\n  if (labels.length < 3) {\n    throw new InvalidNsidError('NSID needs at least three parts')\n  }\n  for (let i = 0; i < labels.length; i++) {\n    const l = labels[i]\n    if (l.length < 1) {\n      throw new InvalidNsidError('NSID parts can not be empty')\n    }\n    if (l.length > 63) {\n      throw new InvalidNsidError('NSID part too long (max 63 chars)')\n    }\n    if (l.endsWith('-') || l.startsWith('-')) {\n      throw new InvalidNsidError('NSID parts can not start or end with hyphen')\n    }\n    if (/^[0-9]/.test(l) && i === 0) {\n      throw new InvalidNsidError('NSID first part may not start with a digit')\n    }\n    if (!/^[a-zA-Z]+$/.test(l) && i + 1 === labels.length) {\n      throw new InvalidNsidError('NSID name part must be only letters')\n    }\n  }\n}\n\nexport const ensureValidNsidRegex = (nsid: string): void => {\n  // simple regex to enforce most constraints via just regex and length.\n  // hand wrote this regex based on above constraints\n  if (\n    !/^[a-zA-Z]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(\\.[a-zA-Z]([a-zA-Z]{0,61}[a-zA-Z])?)$/.test(\n      nsid,\n    )\n  ) {\n    throw new InvalidNsidError(\"NSID didn't validate via regex\")\n  }\n  if (nsid.length > 253 + 1 + 63) {\n    throw new InvalidNsidError('NSID is too long (317 chars max)')\n  }\n}\n\nexport class InvalidNsidError extends Error {}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2621, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2626, "column": 0}, "map": {"version":3,"file":"aturi_validation.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/syntax/src/aturi_validation.ts"],"sourcesContent":["import { ensureValidHandle, ensureValidHandleRegex } from './handle'\nimport { ensureValidDid, ensureValidDidRegex } from './did'\nimport { ensureValidNsid, ensureValidNsidRegex } from './nsid'\n\n// Human-readable constraints on ATURI:\n//   - following regular URLs, a 8KByte hard total length limit\n//   - follows ATURI docs on website\n//      - all ASCII characters, no whitespace. non-ASCII could be URL-encoded\n//      - starts \"at://\"\n//      - \"authority\" is a valid DID or a valid handle\n//      - optionally, follow \"authority\" with \"/\" and valid NSID as start of path\n//      - optionally, if NSID given, follow that with \"/\" and rkey\n//      - rkey path component can include URL-encoded (\"percent encoded\"), or:\n//          ALPHA / DIGIT / \"-\" / \".\" / \"_\" / \"~\" / \":\" / \"@\" / \"!\" / \"$\" / \"&\" / \"'\" / \"(\" / \")\" / \"*\" / \"+\" / \",\" / \";\" / \"=\"\n//          [a-zA-Z0-9._~:@!$&'\\(\\)*+,;=-]\n//      - rkey must have at least one char\n//      - regardless of path component, a fragment can follow  as \"#\" and then a JSON pointer (RFC-6901)\nexport const ensureValidAtUri = (uri: string) => {\n  // JSON pointer is pretty different from rest of URI, so split that out first\n  const uriParts = uri.split('#')\n  if (uriParts.length > 2) {\n    throw new Error('ATURI can have at most one \"#\", separating fragment out')\n  }\n  const fragmentPart = uriParts[1] || null\n  uri = uriParts[0]\n\n  // check that all chars are boring ASCII\n  if (!/^[a-zA-Z0-9._~:@!$&')(*+,;=%/-]*$/.test(uri)) {\n    throw new Error('Disallowed characters in ATURI (ASCII)')\n  }\n\n  const parts = uri.split('/')\n  if (parts.length >= 3 && (parts[0] !== 'at:' || parts[1].length !== 0)) {\n    throw new Error('ATURI must start with \"at://\"')\n  }\n  if (parts.length < 3) {\n    throw new Error('ATURI requires at least method and authority sections')\n  }\n\n  try {\n    if (parts[2].startsWith('did:')) {\n      ensureValidDid(parts[2])\n    } else {\n      ensureValidHandle(parts[2])\n    }\n  } catch {\n    throw new Error('ATURI authority must be a valid handle or DID')\n  }\n\n  if (parts.length >= 4) {\n    if (parts[3].length === 0) {\n      throw new Error(\n        'ATURI can not have a slash after authority without a path segment',\n      )\n    }\n    try {\n      ensureValidNsid(parts[3])\n    } catch {\n      throw new Error(\n        'ATURI requires first path segment (if supplied) to be valid NSID',\n      )\n    }\n  }\n\n  if (parts.length >= 5) {\n    if (parts[4].length === 0) {\n      throw new Error(\n        'ATURI can not have a slash after collection, unless record key is provided',\n      )\n    }\n    // would validate rkey here, but there are basically no constraints!\n  }\n\n  if (parts.length >= 6) {\n    throw new Error(\n      'ATURI path can have at most two parts, and no trailing slash',\n    )\n  }\n\n  if (uriParts.length >= 2 && fragmentPart == null) {\n    throw new Error('ATURI fragment must be non-empty and start with slash')\n  }\n\n  if (fragmentPart != null) {\n    if (fragmentPart.length === 0 || fragmentPart[0] !== '/') {\n      throw new Error('ATURI fragment must be non-empty and start with slash')\n    }\n    // NOTE: enforcing *some* checks here for sanity. Eg, at least no whitespace\n    if (!/^\\/[a-zA-Z0-9._~:@!$&')(*+,;=%[\\]/-]*$/.test(fragmentPart)) {\n      throw new Error('Disallowed characters in ATURI fragment (ASCII)')\n    }\n  }\n\n  if (uri.length > 8 * 1024) {\n    throw new Error('ATURI is far too long')\n  }\n}\n\nexport const ensureValidAtUriRegex = (uri: string): void => {\n  // simple regex to enforce most constraints via just regex and length.\n  // hand wrote this regex based on above constraints. whew!\n  const aturiRegex =\n    /^at:\\/\\/(?<authority>[a-zA-Z0-9._:%-]+)(\\/(?<collection>[a-zA-Z0-9-.]+)(\\/(?<rkey>[a-zA-Z0-9._~:@!$&%')(*+,;=-]+))?)?(#(?<fragment>\\/[a-zA-Z0-9._~:@!$&%')(*+,;=\\-[\\]/\\\\]*))?$/\n  const rm = uri.match(aturiRegex)\n  if (!rm || !rm.groups) {\n    throw new Error(\"ATURI didn't validate via regex\")\n  }\n  const groups = rm.groups\n\n  try {\n    ensureValidHandleRegex(groups.authority)\n  } catch {\n    try {\n      ensureValidDidRegex(groups.authority)\n    } catch {\n      throw new Error('ATURI authority must be a valid handle or DID')\n    }\n  }\n\n  if (groups.collection) {\n    try {\n      ensureValidNsidRegex(groups.collection)\n    } catch {\n      throw new Error('ATURI collection path segment must be a valid NSID')\n    }\n  }\n\n  if (uri.length > 8 * 1024) {\n    throw new Error('ATURI is far too long')\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2741, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2746, "column": 0}, "map": {"version":3,"file":"aturi.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/syntax/src/aturi.ts"],"sourcesContent":["export * from './aturi_validation'\n\nexport const ATP_URI_REGEX =\n  // proto-    --did--------------   --name----------------   --path----   --query--   --hash--\n  /^(at:\\/\\/)?((?:did:[a-z0-9:%-]+)|(?:[a-z0-9][a-z0-9.:-]*))(\\/[^?#\\s]*)?(\\?[^#\\s]+)?(#[^\\s]+)?$/i\n//                       --path-----   --query--  --hash--\nconst RELATIVE_REGEX = /^(\\/[^?#\\s]*)?(\\?[^#\\s]+)?(#[^\\s]+)?$/i\n\nexport class AtUri {\n  hash: string\n  host: string\n  pathname: string\n  searchParams: URLSearchParams\n\n  constructor(uri: string, base?: string) {\n    let parsed\n    if (base) {\n      parsed = parse(base)\n      if (!parsed) {\n        throw new Error(`Invalid at uri: ${base}`)\n      }\n      const relativep = parseRelative(uri)\n      if (!relativep) {\n        throw new Error(`Invalid path: ${uri}`)\n      }\n      Object.assign(parsed, relativep)\n    } else {\n      parsed = parse(uri)\n      if (!parsed) {\n        throw new Error(`Invalid at uri: ${uri}`)\n      }\n    }\n\n    this.hash = parsed.hash\n    this.host = parsed.host\n    this.pathname = parsed.pathname\n    this.searchParams = parsed.searchParams\n  }\n\n  static make(handleOrDid: string, collection?: string, rkey?: string) {\n    let str = handleOrDid\n    if (collection) str += '/' + collection\n    if (rkey) str += '/' + rkey\n    return new AtUri(str)\n  }\n\n  get protocol() {\n    return 'at:'\n  }\n\n  get origin() {\n    return `at://${this.host}`\n  }\n\n  get hostname() {\n    return this.host\n  }\n\n  set hostname(v: string) {\n    this.host = v\n  }\n\n  get search() {\n    return this.searchParams.toString()\n  }\n\n  set search(v: string) {\n    this.searchParams = new URLSearchParams(v)\n  }\n\n  get collection() {\n    return this.pathname.split('/').filter(Boolean)[0] || ''\n  }\n\n  set collection(v: string) {\n    const parts = this.pathname.split('/').filter(Boolean)\n    parts[0] = v\n    this.pathname = parts.join('/')\n  }\n\n  get rkey() {\n    return this.pathname.split('/').filter(Boolean)[1] || ''\n  }\n\n  set rkey(v: string) {\n    const parts = this.pathname.split('/').filter(Boolean)\n    if (!parts[0]) parts[0] = 'undefined'\n    parts[1] = v\n    this.pathname = parts.join('/')\n  }\n\n  get href() {\n    return this.toString()\n  }\n\n  toString() {\n    let path = this.pathname || '/'\n    if (!path.startsWith('/')) {\n      path = `/${path}`\n    }\n    let qs = this.searchParams.toString()\n    if (qs && !qs.startsWith('?')) {\n      qs = `?${qs}`\n    }\n    let hash = this.hash\n    if (hash && !hash.startsWith('#')) {\n      hash = `#${hash}`\n    }\n    return `at://${this.host}${path}${qs}${hash}`\n  }\n}\n\nfunction parse(str: string) {\n  const match = ATP_URI_REGEX.exec(str)\n  if (match) {\n    return {\n      hash: match[5] || '',\n      host: match[2] || '',\n      pathname: match[3] || '',\n      searchParams: new URLSearchParams(match[4] || ''),\n    }\n  }\n  return undefined\n}\n\nfunction parseRelative(str: string) {\n  const match = RELATIVE_REGEX.exec(str)\n  if (match) {\n    return {\n      hash: match[3] || '',\n      pathname: match[1] || '',\n      searchParams: new URLSearchParams(match[2] || ''),\n    }\n  }\n  return undefined\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2907, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2912, "column": 0}, "map": {"version":3,"file":"tid.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/syntax/src/tid.ts"],"sourcesContent":["export const ensureValidTid = (tid: string): void => {\n  if (tid.length !== 13) {\n    throw new InvalidTidError('TID must be 13 characters')\n  }\n  // simple regex to enforce most constraints via just regex and length.\n  if (!/^[234567abcdefghij][234567abcdefghijklmnopqrstuvwxyz]{12}$/.test(tid)) {\n    throw new InvalidTidError('TID syntax not valid (regex)')\n  }\n}\n\nexport const isValidTid = (tid: string): boolean => {\n  try {\n    ensureValidTid(tid)\n  } catch (err) {\n    if (err instanceof InvalidTidError) {\n      return false\n    }\n    throw err\n  }\n\n  return true\n}\n\nexport class InvalidTidError extends Error {}\n"],"names":[],"mappings":";;;;;AAAO,MAAM,cAAc,GAAG,CAAC,GAAW,EAAQ,EAAE;IAClD,IAAI,GAAG,CAAC,MAAM,KAAK,EAAE,EAAE,CAAC;QACtB,MAAM,IAAI,eAAe,CAAC,2BAA2B,CAAC,CAAA;IACxD,CAAC;IACD,sEAAsE;IACtE,IAAI,CAAC,4DAA4D,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;QAC5E,MAAM,IAAI,eAAe,CAAC,8BAA8B,CAAC,CAAA;IAC3D,CAAC;AACH,CAAC,CAAA;AARY,QAAA,cAAc,GAAA,eAQ1B;AAEM,MAAM,UAAU,GAAG,CAAC,GAAW,EAAW,EAAE;IACjD,IAAI,CAAC;QACH,CAAA,GAAA,QAAA,cAAc,EAAC,GAAG,CAAC,CAAA;IACrB,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;QACb,IAAI,GAAG,YAAY,eAAe,EAAE,CAAC;YACnC,OAAO,KAAK,CAAA;QACd,CAAC;QACD,MAAM,GAAG,CAAA;IACX,CAAC;IAED,OAAO,IAAI,CAAA;AACb,CAAC,CAAA;AAXY,QAAA,UAAU,GAAA,WAWtB;AAED,MAAa,eAAgB,SAAQ,KAAK;CAAG;AAA7C,QAAA,eAAA,GAAA,gBAA6C","ignoreList":[0]}},
    {"offset": {"line": 2942, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2947, "column": 0}, "map": {"version":3,"file":"recordkey.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/syntax/src/recordkey.ts"],"sourcesContent":["export const ensureValidRecordKey = (rkey: string): void => {\n  if (rkey.length > 512 || rkey.length < 1) {\n    throw new InvalidRecordKeyError('record key must be 1 to 512 characters')\n  }\n  // simple regex to enforce most constraints via just regex and length.\n  if (!/^[a-zA-Z0-9_~.:-]{1,512}$/.test(rkey)) {\n    throw new InvalidRecordKeyError('record key syntax not valid (regex)')\n  }\n  if (rkey === '.' || rkey === '..')\n    throw new InvalidRecordKeyError('record key can not be \".\" or \"..\"')\n}\n\nexport const isValidRecordKey = (rkey: string): boolean => {\n  try {\n    ensureValidRecordKey(rkey)\n  } catch (err) {\n    if (err instanceof InvalidRecordKeyError) {\n      return false\n    }\n    throw err\n  }\n\n  return true\n}\n\nexport class InvalidRecordKeyError extends Error {}\n"],"names":[],"mappings":";;;;;AAAO,MAAM,oBAAoB,GAAG,CAAC,IAAY,EAAQ,EAAE;IACzD,IAAI,IAAI,CAAC,MAAM,GAAG,GAAG,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QACzC,MAAM,IAAI,qBAAqB,CAAC,wCAAwC,CAAC,CAAA;IAC3E,CAAC;IACD,sEAAsE;IACtE,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;QAC5C,MAAM,IAAI,qBAAqB,CAAC,qCAAqC,CAAC,CAAA;IACxE,CAAC;IACD,IAAI,IAAI,KAAK,GAAG,IAAI,IAAI,KAAK,IAAI,EAC/B,MAAM,IAAI,qBAAqB,CAAC,mCAAmC,CAAC,CAAA;AACxE,CAAC,CAAA;AAVY,QAAA,oBAAoB,GAAA,qBAUhC;AAEM,MAAM,gBAAgB,GAAG,CAAC,IAAY,EAAW,EAAE;IACxD,IAAI,CAAC;QACH,CAAA,GAAA,QAAA,oBAAoB,EAAC,IAAI,CAAC,CAAA;IAC5B,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;QACb,IAAI,GAAG,YAAY,qBAAqB,EAAE,CAAC;YACzC,OAAO,KAAK,CAAA;QACd,CAAC;QACD,MAAM,GAAG,CAAA;IACX,CAAC;IAED,OAAO,IAAI,CAAA;AACb,CAAC,CAAA;AAXY,QAAA,gBAAgB,GAAA,iBAW5B;AAED,MAAa,qBAAsB,SAAQ,KAAK;CAAG;AAAnD,QAAA,qBAAA,GAAA,sBAAmD","ignoreList":[0]}},
    {"offset": {"line": 2978, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2983, "column": 0}, "map": {"version":3,"file":"datetime.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/syntax/src/datetime.ts"],"sourcesContent":["/* Validates datetime string against atproto Lexicon 'datetime' format.\n * Syntax is described at: https://atproto.com/specs/lexicon#datetime\n */\nexport const ensureValidDatetime = (dtStr: string): void => {\n  const date = new Date(dtStr)\n  // must parse as ISO 8601; this also verifies semantics like month is not 13 or 00\n  if (isNaN(date.getTime())) {\n    throw new InvalidDatetimeError('datetime did not parse as ISO 8601')\n  }\n  if (date.toISOString().startsWith('-')) {\n    throw new InvalidDatetimeError('datetime normalized to a negative time')\n  }\n  // regex and other checks for RFC-3339\n  if (\n    !/^[0-9]{4}-[01][0-9]-[0-3][0-9]T[0-2][0-9]:[0-6][0-9]:[0-6][0-9](.[0-9]{1,20})?(Z|([+-][0-2][0-9]:[0-5][0-9]))$/.test(\n      dtStr,\n    )\n  ) {\n    throw new InvalidDatetimeError(\"datetime didn't validate via regex\")\n  }\n  if (dtStr.length > 64) {\n    throw new InvalidDatetimeError('datetime is too long (64 chars max)')\n  }\n  if (dtStr.endsWith('-00:00')) {\n    throw new InvalidDatetimeError(\n      'datetime can not use \"-00:00\" for UTC timezone',\n    )\n  }\n  if (dtStr.startsWith('000')) {\n    throw new InvalidDatetimeError('datetime so close to year zero not allowed')\n  }\n}\n\n/* Same logic as ensureValidDatetime(), but returns a boolean instead of throwing an exception.\n */\nexport const isValidDatetime = (dtStr: string): boolean => {\n  try {\n    ensureValidDatetime(dtStr)\n  } catch (err) {\n    if (err instanceof InvalidDatetimeError) {\n      return false\n    }\n    throw err\n  }\n\n  return true\n}\n\n/* Takes a flexible datetime string and normalizes representation.\n *\n * This function will work with any valid atproto datetime (eg, anything which isValidDatetime() is true for). It *additionally* is more flexible about accepting datetimes that don't comply to RFC 3339, or are missing timezone information, and normalizing them to a valid datetime.\n *\n * One use-case is a consistent, sortable string. Another is to work with older invalid createdAt datetimes.\n *\n * Successful output will be a valid atproto datetime with millisecond precision (3 sub-second digits) and UTC timezone with trailing 'Z' syntax. Throws `InvalidDatetimeError` if the input string could not be parsed as a datetime, even with permissive parsing.\n *\n * Expected output format: YYYY-MM-DDTHH:mm:ss.sssZ\n */\nexport const normalizeDatetime = (dtStr: string): string => {\n  if (isValidDatetime(dtStr)) {\n    const outStr = new Date(dtStr).toISOString()\n    if (isValidDatetime(outStr)) {\n      return outStr\n    }\n  }\n\n  // check if this permissive datetime is missing a timezone\n  if (!/.*(([+-]\\d\\d:?\\d\\d)|[a-zA-Z])$/.test(dtStr)) {\n    const date = new Date(dtStr + 'Z')\n    if (!isNaN(date.getTime())) {\n      const tzStr = date.toISOString()\n      if (isValidDatetime(tzStr)) {\n        return tzStr\n      }\n    }\n  }\n\n  // finally try parsing as simple datetime\n  const date = new Date(dtStr)\n  if (isNaN(date.getTime())) {\n    throw new InvalidDatetimeError(\n      'datetime did not parse as any timestamp format',\n    )\n  }\n  const isoStr = date.toISOString()\n  if (isValidDatetime(isoStr)) {\n    return isoStr\n  } else {\n    throw new InvalidDatetimeError(\n      'datetime normalized to invalid timestamp string',\n    )\n  }\n}\n\n/* Variant of normalizeDatetime() which always returns a valid datetime strings.\n *\n * If a InvalidDatetimeError is encountered, returns the UNIX epoch time as a UTC datetime (1970-01-01T00:00:00.000Z).\n */\nexport const normalizeDatetimeAlways = (dtStr: string): string => {\n  try {\n    return normalizeDatetime(dtStr)\n  } catch (err) {\n    if (err instanceof InvalidDatetimeError) {\n      return new Date(0).toISOString()\n    }\n    throw err\n  }\n}\n\n/* Indicates a datetime string did not pass full atproto Lexicon datetime string format checks.\n */\nexport class InvalidDatetimeError extends Error {}\n"],"names":[],"mappings":";;;;;AAAA;;GAEG,CACI,MAAM,mBAAmB,GAAG,CAAC,KAAa,EAAQ,EAAE;IACzD,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,CAAA;IAC5B,kFAAkF;IAClF,IAAI,KAAK,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC;QAC1B,MAAM,IAAI,oBAAoB,CAAC,oCAAoC,CAAC,CAAA;IACtE,CAAC;IACD,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;QACvC,MAAM,IAAI,oBAAoB,CAAC,wCAAwC,CAAC,CAAA;IAC1E,CAAC;IACD,sCAAsC;IACtC,IACE,CAAC,gHAAgH,CAAC,IAAI,CACpH,KAAK,CACN,EACD,CAAC;QACD,MAAM,IAAI,oBAAoB,CAAC,oCAAoC,CAAC,CAAA;IACtE,CAAC;IACD,IAAI,KAAK,CAAC,MAAM,GAAG,EAAE,EAAE,CAAC;QACtB,MAAM,IAAI,oBAAoB,CAAC,qCAAqC,CAAC,CAAA;IACvE,CAAC;IACD,IAAI,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC;QAC7B,MAAM,IAAI,oBAAoB,CAC5B,gDAAgD,CACjD,CAAA;IACH,CAAC;IACD,IAAI,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE,CAAC;QAC5B,MAAM,IAAI,oBAAoB,CAAC,4CAA4C,CAAC,CAAA;IAC9E,CAAC;AACH,CAAC,CAAA;AA5BY,QAAA,mBAAmB,GAAA,oBA4B/B;AAED;GACG,CACI,MAAM,eAAe,GAAG,CAAC,KAAa,EAAW,EAAE;IACxD,IAAI,CAAC;QACH,CAAA,GAAA,QAAA,mBAAmB,EAAC,KAAK,CAAC,CAAA;IAC5B,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;QACb,IAAI,GAAG,YAAY,oBAAoB,EAAE,CAAC;YACxC,OAAO,KAAK,CAAA;QACd,CAAC;QACD,MAAM,GAAG,CAAA;IACX,CAAC;IAED,OAAO,IAAI,CAAA;AACb,CAAC,CAAA;AAXY,QAAA,eAAe,GAAA,gBAW3B;AAED;;;;;;;;;GASG,CACI,MAAM,iBAAiB,GAAG,CAAC,KAAa,EAAU,EAAE;IACzD,IAAI,CAAA,GAAA,QAAA,eAAe,EAAC,KAAK,CAAC,EAAE,CAAC;QAC3B,MAAM,MAAM,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,WAAW,EAAE,CAAA;QAC5C,IAAI,CAAA,GAAA,QAAA,eAAe,EAAC,MAAM,CAAC,EAAE,CAAC;YAC5B,OAAO,MAAM,CAAA;QACf,CAAC;IACH,CAAC;IAED,0DAA0D;IAC1D,IAAI,CAAC,gCAAgC,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC;QAClD,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,CAAA;QAClC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC;YAC3B,MAAM,KAAK,GAAG,IAAI,CAAC,WAAW,EAAE,CAAA;YAChC,IAAI,CAAA,GAAA,QAAA,eAAe,EAAC,KAAK,CAAC,EAAE,CAAC;gBAC3B,OAAO,KAAK,CAAA;YACd,CAAC;QACH,CAAC;IACH,CAAC;IAED,yCAAyC;IACzC,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,CAAA;IAC5B,IAAI,KAAK,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC;QAC1B,MAAM,IAAI,oBAAoB,CAC5B,gDAAgD,CACjD,CAAA;IACH,CAAC;IACD,MAAM,MAAM,GAAG,IAAI,CAAC,WAAW,EAAE,CAAA;IACjC,IAAI,CAAA,GAAA,QAAA,eAAe,EAAC,MAAM,CAAC,EAAE,CAAC;QAC5B,OAAO,MAAM,CAAA;IACf,CAAC,MAAM,CAAC;QACN,MAAM,IAAI,oBAAoB,CAC5B,iDAAiD,CAClD,CAAA;IACH,CAAC;AACH,CAAC,CAAA;AAlCY,QAAA,iBAAiB,GAAA,kBAkC7B;AAED;;;GAGG,CACI,MAAM,uBAAuB,GAAG,CAAC,KAAa,EAAU,EAAE;IAC/D,IAAI,CAAC;QACH,OAAO,CAAA,GAAA,QAAA,iBAAiB,EAAC,KAAK,CAAC,CAAA;IACjC,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;QACb,IAAI,GAAG,YAAY,oBAAoB,EAAE,CAAC;YACxC,OAAO,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAA;QAClC,CAAC;QACD,MAAM,GAAG,CAAA;IACX,CAAC;AACH,CAAC,CAAA;AATY,QAAA,uBAAuB,GAAA,wBASnC;AAED;GACG,CACH,MAAa,oBAAqB,SAAQ,KAAK;CAAG;AAAlD,QAAA,oBAAA,GAAA,qBAAkD","ignoreList":[0]}},
    {"offset": {"line": 3084, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3089, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/syntax/src/index.ts"],"sourcesContent":["export * from './handle'\nexport * from './did'\nexport * from './nsid'\nexport * from './aturi'\nexport * from './tid'\nexport * from './recordkey'\nexport * from './datetime'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,uHAAA,SAAwB;AACxB,oHAAA,SAAqB;AACrB,qHAAA,SAAsB;AACtB,sHAAA,SAAuB;AACvB,oHAAA,SAAqB;AACrB,0HAAA,SAA2B;AAC3B,yHAAA,SAA0B","ignoreList":[0]}},
    {"offset": {"line": 3119, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3124, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/util.ts"],"sourcesContent":["import { z } from 'zod'\nimport { Lexicons } from './lexicons'\nimport { LexRefVariant, LexUserType } from './types'\n\nexport function toLexUri(str: string, baseUri?: string): string {\n  if (str.split('#').length > 2) {\n    throw new Error('Uri can only have one hash segment')\n  }\n\n  if (str.startsWith('lex:')) {\n    return str\n  }\n  if (str.startsWith('#')) {\n    if (!baseUri) {\n      throw new Error(`Unable to resolve uri without anchor: ${str}`)\n    }\n    return `${baseUri}${str}`\n  }\n  return `lex:${str}`\n}\n\nexport function toConcreteTypes(\n  lexicons: Lexicons,\n  def: LexRefVariant | LexUserType,\n): LexUserType[] {\n  if (def.type === 'ref') {\n    return [lexicons.getDefOrThrow(def.ref)]\n  } else if (def.type === 'union') {\n    return def.refs.map((ref) => lexicons.getDefOrThrow(ref)).flat()\n  } else {\n    return [def]\n  }\n}\n\nexport function requiredPropertiesRefinement<\n  ObjectType extends {\n    required?: string[]\n    properties?: Record<string, unknown>\n  },\n>(object: ObjectType, ctx: z.RefinementCtx) {\n  // Required fields check\n  if (object.required === undefined) {\n    return\n  }\n\n  if (!Array.isArray(object.required)) {\n    ctx.addIssue({\n      code: z.ZodIssueCode.invalid_type,\n      received: typeof object.required,\n      expected: 'array',\n    })\n    return\n  }\n\n  if (object.properties === undefined) {\n    if (object.required.length > 0) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: `Required fields defined but no properties defined`,\n      })\n    }\n    return\n  }\n\n  for (const field of object.required) {\n    if (object.properties[field] === undefined) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: `Required field \"${field}\" not defined`,\n      })\n    }\n  }\n}\n"],"names":[],"mappings":";;;;AAIA,QAAA,QAAA,GAAA,SAeC;AAED,QAAA,eAAA,GAAA,gBAWC;AAED,QAAA,4BAAA,GAAA,6BAsCC;AAxED,MAAA,uBAAuB;AAIvB,SAAgB,QAAQ,CAAC,GAAW,EAAE,OAAgB;IACpD,IAAI,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QAC9B,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAA;IACvD,CAAC;IAED,IAAI,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC;QAC3B,OAAO,GAAG,CAAA;IACZ,CAAC;IACD,IAAI,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;QACxB,IAAI,CAAC,OAAO,EAAE,CAAC;YACb,MAAM,IAAI,KAAK,CAAC,CAAA,sCAAA,EAAyC,GAAG,EAAE,CAAC,CAAA;QACjE,CAAC;QACD,OAAO,GAAG,OAAO,GAAG,GAAG,EAAE,CAAA;IAC3B,CAAC;IACD,OAAO,CAAA,IAAA,EAAO,GAAG,EAAE,CAAA;AACrB,CAAC;AAED,SAAgB,eAAe,CAC7B,QAAkB,EAClB,GAAgC;IAEhC,IAAI,GAAG,CAAC,IAAI,KAAK,KAAK,EAAE,CAAC;QACvB,OAAO;YAAC,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,GAAG,CAAC;SAAC,CAAA;IAC1C,CAAC,MAAM,IAAI,GAAG,CAAC,IAAI,KAAK,OAAO,EAAE,CAAC;QAChC,OAAO,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAG,CAAD,OAAS,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,CAAA;IAClE,CAAC,MAAM,CAAC;QACN,OAAO;YAAC,GAAG;SAAC,CAAA;IACd,CAAC;AACH,CAAC;AAED,SAAgB,4BAA4B,CAK1C,MAAkB,EAAE,GAAoB;IACxC,wBAAwB;IACxB,IAAI,MAAM,CAAC,QAAQ,KAAK,SAAS,EAAE,CAAC;QAClC,OAAM;IACR,CAAC;IAED,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC;QACpC,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,YAAY;YACjC,QAAQ,EAAE,OAAO,MAAM,CAAC,QAAQ;YAChC,QAAQ,EAAE,OAAO;SAClB,CAAC,CAAA;QACF,OAAM;IACR,CAAC;IAED,IAAI,MAAM,CAAC,UAAU,KAAK,SAAS,EAAE,CAAC;QACpC,IAAI,MAAM,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YAC/B,GAAG,CAAC,QAAQ,CAAC;gBACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;gBAC3B,OAAO,EAAE,CAAA,iDAAA,CAAmD;aAC7D,CAAC,CAAA;QACJ,CAAC;QACD,OAAM;IACR,CAAC;IAED,KAAK,MAAM,KAAK,IAAI,MAAM,CAAC,QAAQ,CAAE,CAAC;QACpC,IAAI,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,SAAS,EAAE,CAAC;YAC3C,GAAG,CAAC,QAAQ,CAAC;gBACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;gBAC3B,OAAO,EAAE,CAAA,gBAAA,EAAmB,KAAK,CAAA,aAAA,CAAe;aACjD,CAAC,CAAA;QACJ,CAAC;IACH,CAAC;AACH,CAAC","ignoreList":[0]}},
    {"offset": {"line": 3191, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3196, "column": 0}, "map": {"version":3,"file":"types.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/types.ts"],"sourcesContent":["import { z } from 'zod'\nimport { NSID } from '@atproto/syntax'\nimport { requiredPropertiesRefinement } from './util'\n\n// primitives\n// =\n\nexport const lexBoolean = z\n  .object({\n    type: z.literal('boolean'),\n    description: z.string().optional(),\n    default: z.boolean().optional(),\n    const: z.boolean().optional(),\n  })\n  .strict()\nexport type LexBoolean = z.infer<typeof lexBoolean>\n\nexport const lexInteger = z\n  .object({\n    type: z.literal('integer'),\n    description: z.string().optional(),\n    default: z.number().int().optional(),\n    minimum: z.number().int().optional(),\n    maximum: z.number().int().optional(),\n    enum: z.number().int().array().optional(),\n    const: z.number().int().optional(),\n  })\n  .strict()\nexport type LexInteger = z.infer<typeof lexInteger>\n\nexport const lexStringFormat = z.enum([\n  'datetime',\n  'uri',\n  'at-uri',\n  'did',\n  'handle',\n  'at-identifier',\n  'nsid',\n  'cid',\n  'language',\n  'tid',\n  'record-key',\n])\nexport type LexStringFormat = z.infer<typeof lexStringFormat>\n\nexport const lexString = z\n  .object({\n    type: z.literal('string'),\n    format: lexStringFormat.optional(),\n    description: z.string().optional(),\n    default: z.string().optional(),\n    minLength: z.number().int().optional(),\n    maxLength: z.number().int().optional(),\n    minGraphemes: z.number().int().optional(),\n    maxGraphemes: z.number().int().optional(),\n    enum: z.string().array().optional(),\n    const: z.string().optional(),\n    knownValues: z.string().array().optional(),\n  })\n  .strict()\nexport type LexString = z.infer<typeof lexString>\n\nexport const lexUnknown = z\n  .object({\n    type: z.literal('unknown'),\n    description: z.string().optional(),\n  })\n  .strict()\nexport type LexUnknown = z.infer<typeof lexUnknown>\n\nexport const lexPrimitive = z.discriminatedUnion('type', [\n  lexBoolean,\n  lexInteger,\n  lexString,\n  lexUnknown,\n])\nexport type LexPrimitive = z.infer<typeof lexPrimitive>\n\n// ipld types\n// =\n\nexport const lexBytes = z\n  .object({\n    type: z.literal('bytes'),\n    description: z.string().optional(),\n    maxLength: z.number().optional(),\n    minLength: z.number().optional(),\n  })\n  .strict()\nexport type LexBytes = z.infer<typeof lexBytes>\n\nexport const lexCidLink = z\n  .object({\n    type: z.literal('cid-link'),\n    description: z.string().optional(),\n  })\n  .strict()\nexport type LexCidLink = z.infer<typeof lexCidLink>\n\nexport const lexIpldType = z.discriminatedUnion('type', [lexBytes, lexCidLink])\nexport type LexIpldType = z.infer<typeof lexIpldType>\n\n// references\n// =\n\nexport const lexRef = z\n  .object({\n    type: z.literal('ref'),\n    description: z.string().optional(),\n    ref: z.string(),\n  })\n  .strict()\nexport type LexRef = z.infer<typeof lexRef>\n\nexport const lexRefUnion = z\n  .object({\n    type: z.literal('union'),\n    description: z.string().optional(),\n    refs: z.string().array(),\n    closed: z.boolean().optional(),\n  })\n  .strict()\nexport type LexRefUnion = z.infer<typeof lexRefUnion>\n\nexport const lexRefVariant = z.discriminatedUnion('type', [lexRef, lexRefUnion])\nexport type LexRefVariant = z.infer<typeof lexRefVariant>\n\n// blobs\n// =\n\nexport const lexBlob = z\n  .object({\n    type: z.literal('blob'),\n    description: z.string().optional(),\n    accept: z.string().array().optional(),\n    maxSize: z.number().optional(),\n  })\n  .strict()\nexport type LexBlob = z.infer<typeof lexBlob>\n\n// complex types\n// =\n\nexport const lexArray = z\n  .object({\n    type: z.literal('array'),\n    description: z.string().optional(),\n    items: z.discriminatedUnion('type', [\n      // lexPrimitive\n      lexBoolean,\n      lexInteger,\n      lexString,\n      lexUnknown,\n      // lexIpldType\n      lexBytes,\n      lexCidLink,\n      // lexRefVariant\n      lexRef,\n      lexRefUnion,\n      // other\n      lexBlob,\n    ]),\n    minLength: z.number().int().optional(),\n    maxLength: z.number().int().optional(),\n  })\n  .strict()\nexport type LexArray = z.infer<typeof lexArray>\n\nexport const lexPrimitiveArray = lexArray.merge(\n  z\n    .object({\n      items: lexPrimitive,\n    })\n    .strict(),\n)\nexport type LexPrimitiveArray = z.infer<typeof lexPrimitiveArray>\n\nexport const lexToken = z\n  .object({\n    type: z.literal('token'),\n    description: z.string().optional(),\n  })\n  .strict()\nexport type LexToken = z.infer<typeof lexToken>\n\nexport const lexObject = z\n  .object({\n    type: z.literal('object'),\n    description: z.string().optional(),\n    required: z.string().array().optional(),\n    nullable: z.string().array().optional(),\n    properties: z.record(\n      z.discriminatedUnion('type', [\n        lexArray,\n\n        // lexPrimitive\n        lexBoolean,\n        lexInteger,\n        lexString,\n        lexUnknown,\n        // lexIpldType\n        lexBytes,\n        lexCidLink,\n        // lexRefVariant\n        lexRef,\n        lexRefUnion,\n        // other\n        lexBlob,\n      ]),\n    ),\n  })\n  .strict()\n  .superRefine(requiredPropertiesRefinement)\nexport type LexObject = z.infer<typeof lexObject>\n\n// xrpc\n// =\n\nexport const lexXrpcParameters = z\n  .object({\n    type: z.literal('params'),\n    description: z.string().optional(),\n    required: z.string().array().optional(),\n    properties: z.record(\n      z.discriminatedUnion('type', [\n        lexPrimitiveArray,\n\n        // lexPrimitive\n        lexBoolean,\n        lexInteger,\n        lexString,\n        lexUnknown,\n      ]),\n    ),\n  })\n  .strict()\n  .superRefine(requiredPropertiesRefinement)\nexport type LexXrpcParameters = z.infer<typeof lexXrpcParameters>\n\nexport const lexXrpcBody = z\n  .object({\n    description: z.string().optional(),\n    encoding: z.string(),\n    // @NOTE using discriminatedUnion with a refined schema requires zod >= 4\n    schema: z.union([lexRefVariant, lexObject]).optional(),\n  })\n  .strict()\nexport type LexXrpcBody = z.infer<typeof lexXrpcBody>\n\nexport const lexXrpcSubscriptionMessage = z\n  .object({\n    description: z.string().optional(),\n    // @NOTE using discriminatedUnion with a refined schema requires zod >= 4\n    schema: z.union([lexRefVariant, lexObject]).optional(),\n  })\n  .strict()\nexport type LexXrpcSubscriptionMessage = z.infer<\n  typeof lexXrpcSubscriptionMessage\n>\n\nexport const lexXrpcError = z\n  .object({\n    name: z.string(),\n    description: z.string().optional(),\n  })\n  .strict()\nexport type LexXrpcError = z.infer<typeof lexXrpcError>\n\nexport const lexXrpcQuery = z\n  .object({\n    type: z.literal('query'),\n    description: z.string().optional(),\n    parameters: lexXrpcParameters.optional(),\n    output: lexXrpcBody.optional(),\n    errors: lexXrpcError.array().optional(),\n  })\n  .strict()\nexport type LexXrpcQuery = z.infer<typeof lexXrpcQuery>\n\nexport const lexXrpcProcedure = z\n  .object({\n    type: z.literal('procedure'),\n    description: z.string().optional(),\n    parameters: lexXrpcParameters.optional(),\n    input: lexXrpcBody.optional(),\n    output: lexXrpcBody.optional(),\n    errors: lexXrpcError.array().optional(),\n  })\n  .strict()\nexport type LexXrpcProcedure = z.infer<typeof lexXrpcProcedure>\n\nexport const lexXrpcSubscription = z\n  .object({\n    type: z.literal('subscription'),\n    description: z.string().optional(),\n    parameters: lexXrpcParameters.optional(),\n    message: lexXrpcSubscriptionMessage.optional(),\n    errors: lexXrpcError.array().optional(),\n  })\n  .strict()\nexport type LexXrpcSubscription = z.infer<typeof lexXrpcSubscription>\n\n// database\n// =\n\nexport const lexRecord = z\n  .object({\n    type: z.literal('record'),\n    description: z.string().optional(),\n    key: z.string().optional(),\n    record: lexObject,\n  })\n  .strict()\nexport type LexRecord = z.infer<typeof lexRecord>\n\n// core\n// =\n\n// We need to use `z.custom` here because\n// lexXrpcProperty and lexObject are refined\n// `z.union` would work, but it's too slow\n// see #915 for details\nexport const lexUserType = z.custom<\n  | LexRecord\n  | LexXrpcQuery\n  | LexXrpcProcedure\n  | LexXrpcSubscription\n  | LexBlob\n  | LexArray\n  | LexToken\n  | LexObject\n  | LexBoolean\n  | LexInteger\n  | LexString\n  | LexBytes\n  | LexCidLink\n  | LexUnknown\n>(\n  (val) => {\n    if (!val || typeof val !== 'object') {\n      return\n    }\n\n    if (val['type'] === undefined) {\n      return\n    }\n\n    switch (val['type']) {\n      case 'record':\n        return lexRecord.parse(val)\n\n      case 'query':\n        return lexXrpcQuery.parse(val)\n      case 'procedure':\n        return lexXrpcProcedure.parse(val)\n      case 'subscription':\n        return lexXrpcSubscription.parse(val)\n\n      case 'blob':\n        return lexBlob.parse(val)\n\n      case 'array':\n        return lexArray.parse(val)\n      case 'token':\n        return lexToken.parse(val)\n      case 'object':\n        return lexObject.parse(val)\n\n      case 'boolean':\n        return lexBoolean.parse(val)\n      case 'integer':\n        return lexInteger.parse(val)\n      case 'string':\n        return lexString.parse(val)\n      case 'bytes':\n        return lexBytes.parse(val)\n      case 'cid-link':\n        return lexCidLink.parse(val)\n      case 'unknown':\n        return lexUnknown.parse(val)\n    }\n  },\n  (val) => {\n    if (!val || typeof val !== 'object') {\n      return {\n        message: 'Must be an object',\n        fatal: true,\n      }\n    }\n\n    if (val['type'] === undefined) {\n      return {\n        message: 'Must have a type',\n        fatal: true,\n      }\n    }\n\n    if (typeof val['type'] !== 'string') {\n      return {\n        message: 'Type property must be a string',\n        fatal: true,\n      }\n    }\n\n    return {\n      message: `Invalid type: ${val['type']} must be one of: record, query, procedure, subscription, blob, array, token, object, boolean, integer, string, bytes, cid-link, unknown`,\n      fatal: true,\n    }\n  },\n)\nexport type LexUserType = z.infer<typeof lexUserType>\n\nexport const lexiconDoc = z\n  .object({\n    lexicon: z.literal(1),\n    id: z.string().refine((v: string) => NSID.isValid(v), {\n      message: 'Must be a valid NSID',\n    }),\n    revision: z.number().optional(),\n    description: z.string().optional(),\n    defs: z.record(lexUserType),\n  })\n  .strict()\n  .superRefine((doc, ctx) => {\n    for (const defId in doc.defs) {\n      const def = doc.defs[defId]\n      if (\n        defId !== 'main' &&\n        (def.type === 'record' ||\n          def.type === 'procedure' ||\n          def.type === 'query' ||\n          def.type === 'subscription')\n      ) {\n        ctx.addIssue({\n          code: z.ZodIssueCode.custom,\n          message: `Records, procedures, queries, and subscriptions must be the main definition.`,\n        })\n      }\n    }\n  })\nexport type LexiconDoc = z.infer<typeof lexiconDoc>\n\n// helpers\n// =\n\nexport function isValidLexiconDoc(v: unknown): v is LexiconDoc {\n  return lexiconDoc.safeParse(v).success\n}\n\nexport function isObj(obj: unknown): obj is Record<string, unknown> {\n  return obj !== null && typeof obj === 'object'\n}\n\nexport function hasProp<K extends PropertyKey>(\n  data: object,\n  prop: K,\n): data is Record<K, unknown> {\n  return prop in data\n}\n\nexport const discriminatedObject = z.object({ $type: z.string() })\nexport type DiscriminatedObject = z.infer<typeof discriminatedObject>\nexport function isDiscriminatedObject(\n  value: unknown,\n): value is DiscriminatedObject {\n  return discriminatedObject.safeParse(value).success\n}\n\nexport function parseLexiconDoc(v: unknown): LexiconDoc {\n  lexiconDoc.parse(v)\n  return v as LexiconDoc\n}\n\nexport type ValidationResult =\n  | {\n      success: true\n      value: unknown\n    }\n  | {\n      success: false\n      error: ValidationError\n    }\n\nexport class ValidationError extends Error {}\nexport class InvalidLexiconError extends Error {}\nexport class LexiconDefNotFoundError extends Error {}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 3537, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3542, "column": 0}, "map": {"version":3,"file":"blob-refs.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/blob-refs.ts"],"sourcesContent":["import { check, ipldToJson, schema } from '@atproto/common-web'\nimport { CID } from 'multiformats/cid'\nimport { z } from 'zod'\n\nexport const typedJsonBlobRef = z\n  .object({\n    $type: z.literal('blob'),\n    ref: schema.cid,\n    mimeType: z.string(),\n    size: z.number(),\n  })\n  .strict()\nexport type TypedJsonBlobRef = z.infer<typeof typedJsonBlobRef>\n\nexport const untypedJsonBlobRef = z\n  .object({\n    cid: z.string(),\n    mimeType: z.string(),\n  })\n  .strict()\nexport type UntypedJsonBlobRef = z.infer<typeof untypedJsonBlobRef>\n\nexport const jsonBlobRef = z.union([typedJsonBlobRef, untypedJsonBlobRef])\nexport type JsonBlobRef = z.infer<typeof jsonBlobRef>\n\nexport class BlobRef {\n  public original: JsonBlobRef\n\n  constructor(\n    public ref: CID,\n    public mimeType: string,\n    public size: number,\n    original?: JsonBlobRef,\n  ) {\n    this.original = original ?? {\n      $type: 'blob',\n      ref,\n      mimeType,\n      size,\n    }\n  }\n\n  static asBlobRef(obj: unknown): BlobRef | null {\n    if (check.is(obj, jsonBlobRef)) {\n      return BlobRef.fromJsonRef(obj)\n    }\n    return null\n  }\n\n  static fromJsonRef(json: JsonBlobRef): BlobRef {\n    if (check.is(json, typedJsonBlobRef)) {\n      return new BlobRef(json.ref, json.mimeType, json.size)\n    } else {\n      return new BlobRef(CID.parse(json.cid), json.mimeType, -1, json)\n    }\n  }\n\n  ipld(): TypedJsonBlobRef {\n    return {\n      $type: 'blob',\n      ref: this.ref,\n      mimeType: this.mimeType,\n      size: this.size,\n    }\n  }\n\n  toJSON() {\n    return ipldToJson(this.ipld())\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,8CAA+D;AAC/D,MAAA,oCAAsC;AACtC,MAAA,uBAAuB;AAEV,QAAA,gBAAgB,GAAG,MAAA,CAAC,CAC9B,MAAM,CAAC;IACN,KAAK,EAAE,MAAA,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC;IACxB,GAAG,EAAE,aAAA,MAAM,CAAC,GAAG;IACf,QAAQ,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;IACpB,IAAI,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;CACjB,CAAC,CACD,MAAM,EAAE,CAAA;AAGE,QAAA,kBAAkB,GAAG,MAAA,CAAC,CAChC,MAAM,CAAC;IACN,GAAG,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;IACf,QAAQ,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;CACrB,CAAC,CACD,MAAM,EAAE,CAAA;AAGE,QAAA,WAAW,GAAG,MAAA,CAAC,CAAC,KAAK,CAAC;IAAC,QAAA,gBAAgB;IAAE,QAAA,kBAAkB;CAAC,CAAC,CAAA;AAG1E,MAAa,OAAO;IAGlB,YACS,GAAQ,EACR,QAAgB,EAChB,IAAY,EACnB,QAAsB,CAAA;QAHtB,OAAA,cAAA,CAAA,IAAA,EAAA,OAAA;;;;mBAAO,GAAG;WAAK;QACf,OAAA,cAAA,CAAA,IAAA,EAAA,YAAA;;;;mBAAO,QAAQ;WAAQ;QACvB,OAAA,cAAA,CAAA,IAAA,EAAA,QAAA;;;;mBAAO,IAAI;WAAQ;QALd,OAAA,cAAA,CAAA,IAAA,EAAA,YAAA;;;;;WAAqB;QAQ1B,IAAI,CAAC,QAAQ,GAAG,QAAQ,IAAI;YAC1B,KAAK,EAAE,MAAM;YACb,GAAG;YACH,QAAQ;YACR,IAAI;SACL,CAAA;IACH,CAAC;IAED,MAAM,CAAC,SAAS,CAAC,GAAY,EAAA;QAC3B,IAAI,aAAA,KAAK,CAAC,EAAE,CAAC,GAAG,EAAE,QAAA,WAAW,CAAC,EAAE,CAAC;YAC/B,OAAO,OAAO,CAAC,WAAW,CAAC,GAAG,CAAC,CAAA;QACjC,CAAC;QACD,OAAO,IAAI,CAAA;IACb,CAAC;IAED,MAAM,CAAC,WAAW,CAAC,IAAiB,EAAA;QAClC,IAAI,aAAA,KAAK,CAAC,EAAE,CAAC,IAAI,EAAE,QAAA,gBAAgB,CAAC,EAAE,CAAC;YACrC,OAAO,IAAI,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;QACxD,CAAC,MAAM,CAAC;YACN,OAAO,IAAI,OAAO,CAAC,MAAA,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,CAAA;QAClE,CAAC;IACH,CAAC;IAED,IAAI,GAAA;QACF,OAAO;YACL,KAAK,EAAE,MAAM;YACb,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,IAAI,EAAE,IAAI,CAAC,IAAI;SAChB,CAAA;IACH,CAAC;IAED,MAAM,GAAA;QACJ,OAAO,CAAA,GAAA,aAAA,UAAU,EAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAA;IAChC,CAAC;CACF;AA5CD,QAAA,OAAA,GAAA,QA4CC","ignoreList":[0]}},
    {"offset": {"line": 3623, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3628, "column": 0}, "map": {"version":3,"file":"blob.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/validators/blob.ts"],"sourcesContent":["import { BlobRef } from '../blob-refs'\nimport { Lexicons } from '../lexicons'\nimport { LexUserType, ValidationResult, ValidationError } from '../types'\n\nexport function blob(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  // check\n  if (!value || !(value instanceof BlobRef)) {\n    return {\n      success: false,\n      error: new ValidationError(`${path} should be a blob ref`),\n    }\n  }\n  return { success: true, value }\n}\n"],"names":[],"mappings":";;;;AAIA,QAAA,IAAA,GAAA,KAcC;AAlBD,MAAA,sCAAsC;AAEtC,MAAA,8BAAyE;AAEzE,SAAgB,IAAI,CAClB,QAAkB,EAClB,IAAY,EACZ,GAAgB,EAChB,KAAc;IAEd,QAAQ;IACR,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,YAAY,YAAA,OAAO,CAAC,EAAE,CAAC;QAC1C,OAAO;YACL,OAAO,EAAE,KAAK;YACd,KAAK,EAAE,IAAI,QAAA,eAAe,CAAC,GAAG,IAAI,CAAA,qBAAA,CAAuB,CAAC;SAC3D,CAAA;IACH,CAAC;IACD,OAAO;QAAE,OAAO,EAAE,IAAI;QAAE,KAAK;IAAA,CAAE,CAAA;AACjC,CAAC","ignoreList":[0]}},
    {"offset": {"line": 3648, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3653, "column": 0}, "map": {"version":3,"file":"formats.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/validators/formats.ts"],"sourcesContent":["import { isValidISODateString } from 'iso-datestring-validator'\nimport { CID } from 'multiformats/cid'\nimport { ValidationResult, ValidationError } from '../types'\nimport {\n  ensureValidDid,\n  ensureValidHandle,\n  ensureValidNsid,\n  ensureValidAtUri,\n  ensureValidTid,\n  ensureValidRecordKey,\n} from '@atproto/syntax'\nimport { validateLanguage } from '@atproto/common-web'\n\nexport function datetime(path: string, value: string): ValidationResult {\n  try {\n    if (!isValidISODateString(value)) {\n      throw new Error()\n    }\n  } catch {\n    return {\n      success: false,\n      error: new ValidationError(\n        `${path} must be an valid atproto datetime (both RFC-3339 and ISO-8601)`,\n      ),\n    }\n  }\n  return { success: true, value }\n}\n\nexport function uri(path: string, value: string): ValidationResult {\n  const isUri = value.match(/^\\w+:(?:\\/\\/)?[^\\s/][^\\s]*$/) !== null\n  if (!isUri) {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a uri`),\n    }\n  }\n  return { success: true, value }\n}\n\nexport function atUri(path: string, value: string): ValidationResult {\n  try {\n    ensureValidAtUri(value)\n  } catch {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a valid at-uri`),\n    }\n  }\n\n  return { success: true, value }\n}\n\nexport function did(path: string, value: string): ValidationResult {\n  try {\n    ensureValidDid(value)\n  } catch {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a valid did`),\n    }\n  }\n\n  return { success: true, value }\n}\n\nexport function handle(path: string, value: string): ValidationResult {\n  try {\n    ensureValidHandle(value)\n  } catch {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a valid handle`),\n    }\n  }\n\n  return { success: true, value }\n}\n\nexport function atIdentifier(path: string, value: string): ValidationResult {\n  // We can discriminate based on the \"did:\" prefix\n  if (value.startsWith('did:')) {\n    const didResult = did(path, value)\n    if (didResult.success) return didResult\n  } else {\n    const handleResult = handle(path, value)\n    if (handleResult.success) return handleResult\n  }\n\n  return {\n    success: false,\n    error: new ValidationError(`${path} must be a valid did or a handle`),\n  }\n}\n\nexport function nsid(path: string, value: string): ValidationResult {\n  try {\n    ensureValidNsid(value)\n  } catch {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a valid nsid`),\n    }\n  }\n  return { success: true, value }\n}\n\nexport function cid(path: string, value: string): ValidationResult {\n  try {\n    CID.parse(value)\n  } catch {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a cid string`),\n    }\n  }\n  return { success: true, value }\n}\n\n// The language format validates well-formed BCP 47 language tags: https://www.rfc-editor.org/info/bcp47\nexport function language(path: string, value: string): ValidationResult {\n  if (validateLanguage(value)) {\n    return { success: true, value }\n  }\n  return {\n    success: false,\n    error: new ValidationError(\n      `${path} must be a well-formed BCP 47 language tag`,\n    ),\n  }\n}\n\nexport function tid(path: string, value: string): ValidationResult {\n  try {\n    ensureValidTid(value)\n  } catch {\n    return {\n      success: false,\n      error: new ValidationError(\n        `${path} must be a valid TID (timestamp identifier)`,\n      ),\n    }\n  }\n  return { success: true, value }\n}\n\nexport function recordKey(path: string, value: string): ValidationResult {\n  try {\n    ensureValidRecordKey(value)\n  } catch {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a valid Record Key`),\n    }\n  }\n  return { success: true, value }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 3827, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3832, "column": 0}, "map": {"version":3,"file":"primitives.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/validators/primitives.ts"],"sourcesContent":["import { utf8Len, graphemeLen } from '@atproto/common-web'\nimport { CID } from 'multiformats/cid'\nimport { Lexicons } from '../lexicons'\nimport * as formats from './formats'\nimport {\n  LexUserType,\n  LexBoolean,\n  LexInteger,\n  LexString,\n  ValidationResult,\n  ValidationError,\n  LexBytes,\n} from '../types'\n\nexport function validate(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  switch (def.type) {\n    case 'boolean':\n      return boolean(lexicons, path, def, value)\n    case 'integer':\n      return integer(lexicons, path, def, value)\n    case 'string':\n      return string(lexicons, path, def, value)\n    case 'bytes':\n      return bytes(lexicons, path, def, value)\n    case 'cid-link':\n      return cidLink(lexicons, path, def, value)\n    case 'unknown':\n      return unknown(lexicons, path, def, value)\n    default:\n      return {\n        success: false,\n        error: new ValidationError(`Unexpected lexicon type: ${def.type}`),\n      }\n  }\n}\n\nexport function boolean(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  def = def as LexBoolean\n\n  // type\n  const type = typeof value\n  if (type === 'undefined') {\n    if (typeof def.default === 'boolean') {\n      return { success: true, value: def.default }\n    }\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a boolean`),\n    }\n  } else if (type !== 'boolean') {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a boolean`),\n    }\n  }\n\n  // const\n  if (typeof def.const === 'boolean') {\n    if (value !== def.const) {\n      return {\n        success: false,\n        error: new ValidationError(`${path} must be ${def.const}`),\n      }\n    }\n  }\n\n  return { success: true, value }\n}\n\nexport function integer(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  def = def as LexInteger\n\n  // type\n  const type = typeof value\n  if (type === 'undefined') {\n    if (typeof def.default === 'number') {\n      return { success: true, value: def.default }\n    }\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be an integer`),\n    }\n  } else if (!Number.isInteger(value)) {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be an integer`),\n    }\n  }\n\n  // const\n  if (typeof def.const === 'number') {\n    if (value !== def.const) {\n      return {\n        success: false,\n        error: new ValidationError(`${path} must be ${def.const}`),\n      }\n    }\n  }\n\n  // enum\n  if (Array.isArray(def.enum)) {\n    if (!def.enum.includes(value as number)) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} must be one of (${def.enum.join('|')})`,\n        ),\n      }\n    }\n  }\n\n  // maximum\n  if (typeof def.maximum === 'number') {\n    if ((value as number) > def.maximum) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} can not be greater than ${def.maximum}`,\n        ),\n      }\n    }\n  }\n\n  // minimum\n  if (typeof def.minimum === 'number') {\n    if ((value as number) < def.minimum) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} can not be less than ${def.minimum}`,\n        ),\n      }\n    }\n  }\n\n  return { success: true, value }\n}\n\nexport function string(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  def = def as LexString\n\n  // type\n  if (typeof value === 'undefined') {\n    if (typeof def.default === 'string') {\n      return { success: true, value: def.default }\n    }\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a string`),\n    }\n  } else if (typeof value !== 'string') {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a string`),\n    }\n  }\n\n  // const\n  if (typeof def.const === 'string') {\n    if (value !== def.const) {\n      return {\n        success: false,\n        error: new ValidationError(`${path} must be ${def.const}`),\n      }\n    }\n  }\n\n  // enum\n  if (Array.isArray(def.enum)) {\n    if (!def.enum.includes(value as string)) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} must be one of (${def.enum.join('|')})`,\n        ),\n      }\n    }\n  }\n\n  // maxLength and minLength\n  if (typeof def.minLength === 'number' || typeof def.maxLength === 'number') {\n    // If the JavaScript string length * 3 is below the maximum limit,\n    // its UTF8 length (which <= .length * 3) will also be below.\n    if (typeof def.minLength === 'number' && value.length * 3 < def.minLength) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} must not be shorter than ${def.minLength} characters`,\n        ),\n      }\n    }\n\n    // If the JavaScript string length * 3 is within the maximum limit,\n    // its UTF8 length (which <= .length * 3) will also be within.\n    // When there's no minimal length, this lets us skip the UTF8 length check.\n    let canSkipUtf8LenChecks = false\n    if (\n      typeof def.minLength === 'undefined' &&\n      typeof def.maxLength === 'number' &&\n      value.length * 3 <= def.maxLength\n    ) {\n      canSkipUtf8LenChecks = true\n    }\n\n    if (!canSkipUtf8LenChecks) {\n      const len = utf8Len(value)\n\n      if (typeof def.maxLength === 'number') {\n        if (len > def.maxLength) {\n          return {\n            success: false,\n            error: new ValidationError(\n              `${path} must not be longer than ${def.maxLength} characters`,\n            ),\n          }\n        }\n      }\n\n      if (typeof def.minLength === 'number') {\n        if (len < def.minLength) {\n          return {\n            success: false,\n            error: new ValidationError(\n              `${path} must not be shorter than ${def.minLength} characters`,\n            ),\n          }\n        }\n      }\n    }\n  }\n\n  // maxGraphemes and minGraphemes\n  if (\n    typeof def.maxGraphemes === 'number' ||\n    typeof def.minGraphemes === 'number'\n  ) {\n    let needsMaxGraphemesCheck = false\n    let needsMinGraphemesCheck = false\n\n    if (typeof def.maxGraphemes === 'number') {\n      if (value.length <= def.maxGraphemes) {\n        // If the JavaScript string length (UTF-16) is within the maximum limit,\n        // its grapheme length (which <= .length) will also be within.\n        needsMaxGraphemesCheck = false\n      } else {\n        needsMaxGraphemesCheck = true\n      }\n    }\n\n    if (typeof def.minGraphemes === 'number') {\n      if (value.length < def.minGraphemes) {\n        // If the JavaScript string length (UTF-16) is below the minimal limit,\n        // its grapheme length (which <= .length) will also be below.\n        // Fail early.\n        return {\n          success: false,\n          error: new ValidationError(\n            `${path} must not be shorter than ${def.minGraphemes} graphemes`,\n          ),\n        }\n      } else {\n        needsMinGraphemesCheck = true\n      }\n    }\n\n    if (needsMaxGraphemesCheck || needsMinGraphemesCheck) {\n      const len = graphemeLen(value)\n\n      if (typeof def.maxGraphemes === 'number') {\n        if (len > def.maxGraphemes) {\n          return {\n            success: false,\n            error: new ValidationError(\n              `${path} must not be longer than ${def.maxGraphemes} graphemes`,\n            ),\n          }\n        }\n      }\n\n      if (typeof def.minGraphemes === 'number') {\n        if (len < def.minGraphemes) {\n          return {\n            success: false,\n            error: new ValidationError(\n              `${path} must not be shorter than ${def.minGraphemes} graphemes`,\n            ),\n          }\n        }\n      }\n    }\n  }\n\n  if (typeof def.format === 'string') {\n    switch (def.format) {\n      case 'datetime':\n        return formats.datetime(path, value)\n      case 'uri':\n        return formats.uri(path, value)\n      case 'at-uri':\n        return formats.atUri(path, value)\n      case 'did':\n        return formats.did(path, value)\n      case 'handle':\n        return formats.handle(path, value)\n      case 'at-identifier':\n        return formats.atIdentifier(path, value)\n      case 'nsid':\n        return formats.nsid(path, value)\n      case 'cid':\n        return formats.cid(path, value)\n      case 'language':\n        return formats.language(path, value)\n      case 'tid':\n        return formats.tid(path, value)\n      case 'record-key':\n        return formats.recordKey(path, value)\n    }\n  }\n\n  return { success: true, value }\n}\n\nexport function bytes(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  def = def as LexBytes\n\n  if (!value || !(value instanceof Uint8Array)) {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a byte array`),\n    }\n  }\n\n  // maxLength\n  if (typeof def.maxLength === 'number') {\n    if (value.byteLength > def.maxLength) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} must not be larger than ${def.maxLength} bytes`,\n        ),\n      }\n    }\n  }\n\n  // minLength\n  if (typeof def.minLength === 'number') {\n    if (value.byteLength < def.minLength) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} must not be smaller than ${def.minLength} bytes`,\n        ),\n      }\n    }\n  }\n\n  return { success: true, value }\n}\n\nexport function cidLink(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  if (CID.asCID(value) === null) {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be a CID`),\n    }\n  }\n\n  return { success: true, value }\n}\n\nexport function unknown(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  // type\n  if (!value || typeof value !== 'object') {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be an object`),\n    }\n  }\n\n  return { success: true, value }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4206, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4211, "column": 0}, "map": {"version":3,"file":"complex.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/validators/complex.ts"],"sourcesContent":["import { Lexicons } from '../lexicons'\nimport {\n  LexArray,\n  LexObject,\n  LexRefVariant,\n  LexUserType,\n  ValidationError,\n  ValidationResult,\n  isDiscriminatedObject,\n} from '../types'\nimport { toConcreteTypes, toLexUri } from '../util'\n\nimport { blob } from './blob'\nimport { boolean, integer, string, bytes, cidLink, unknown } from './primitives'\n\nexport function validate(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  switch (def.type) {\n    case 'boolean':\n      return boolean(lexicons, path, def, value)\n    case 'integer':\n      return integer(lexicons, path, def, value)\n    case 'string':\n      return string(lexicons, path, def, value)\n    case 'bytes':\n      return bytes(lexicons, path, def, value)\n    case 'cid-link':\n      return cidLink(lexicons, path, def, value)\n    case 'unknown':\n      return unknown(lexicons, path, def, value)\n    case 'object':\n      return object(lexicons, path, def, value)\n    case 'array':\n      return array(lexicons, path, def, value)\n    case 'blob':\n      return blob(lexicons, path, def, value)\n    default:\n      return {\n        success: false,\n        error: new ValidationError(`Unexpected lexicon type: ${def.type}`),\n      }\n  }\n}\n\nexport function array(\n  lexicons: Lexicons,\n  path: string,\n  def: LexArray,\n  value: unknown,\n): ValidationResult {\n  // type\n  if (!Array.isArray(value)) {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be an array`),\n    }\n  }\n\n  // maxLength\n  if (typeof def.maxLength === 'number') {\n    if ((value as Array<unknown>).length > def.maxLength) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} must not have more than ${def.maxLength} elements`,\n        ),\n      }\n    }\n  }\n\n  // minLength\n  if (typeof def.minLength === 'number') {\n    if ((value as Array<unknown>).length < def.minLength) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} must not have fewer than ${def.minLength} elements`,\n        ),\n      }\n    }\n  }\n\n  // items\n  const itemsDef = def.items\n  for (let i = 0; i < (value as Array<unknown>).length; i++) {\n    const itemValue = value[i]\n    const itemPath = `${path}/${i}`\n    const res = validateOneOf(lexicons, itemPath, itemsDef, itemValue)\n    if (!res.success) {\n      return res\n    }\n  }\n\n  return { success: true, value }\n}\n\nexport function object(\n  lexicons: Lexicons,\n  path: string,\n  def: LexUserType,\n  value: unknown,\n): ValidationResult {\n  def = def as LexObject\n\n  // type\n  if (!value || typeof value !== 'object') {\n    return {\n      success: false,\n      error: new ValidationError(`${path} must be an object`),\n    }\n  }\n\n  const requiredProps = new Set(def.required)\n  const nullableProps = new Set(def.nullable)\n\n  // properties\n  let resultValue = value\n  if (typeof def.properties === 'object') {\n    for (const key in def.properties) {\n      if (value[key] === null && nullableProps.has(key)) {\n        continue\n      }\n      const propDef = def.properties[key]\n      if (typeof value[key] === 'undefined' && !requiredProps.has(key)) {\n        // Fast path for non-required undefined props.\n        if (\n          propDef.type === 'integer' ||\n          propDef.type === 'boolean' ||\n          propDef.type === 'string'\n        ) {\n          if (typeof propDef.default === 'undefined') {\n            continue\n          }\n        } else {\n          // Other types have no defaults.\n          continue\n        }\n      }\n      const propPath = `${path}/${key}`\n      const validated = validateOneOf(lexicons, propPath, propDef, value[key])\n      const propValue = validated.success ? validated.value : value[key]\n      const propIsUndefined = typeof propValue === 'undefined'\n      // Return error for bad validation, giving required rule precedence\n      if (propIsUndefined && requiredProps.has(key)) {\n        return {\n          success: false,\n          error: new ValidationError(`${path} must have the property \"${key}\"`),\n        }\n      } else if (!propIsUndefined && !validated.success) {\n        return validated\n      }\n      // Adjust value based on e.g. applied defaults, cloning shallowly if there was a changed value\n      if (propValue !== value[key]) {\n        if (resultValue === value) {\n          // Lazy shallow clone\n          resultValue = { ...value }\n        }\n        resultValue[key] = propValue\n      }\n    }\n  }\n\n  return { success: true, value: resultValue }\n}\n\nexport function validateOneOf(\n  lexicons: Lexicons,\n  path: string,\n  def: LexRefVariant | LexUserType,\n  value: unknown,\n  mustBeObj = false, // this is the only type constraint we need currently (used by xrpc body schema validators)\n): ValidationResult {\n  let error\n\n  let concreteDefs\n  if (def.type === 'union') {\n    if (!isDiscriminatedObject(value)) {\n      return {\n        success: false,\n        error: new ValidationError(\n          `${path} must be an object which includes the \"$type\" property`,\n        ),\n      }\n    }\n    if (!refsContainType(def.refs, value.$type)) {\n      if (def.closed) {\n        return {\n          success: false,\n          error: new ValidationError(\n            `${path} $type must be one of ${def.refs.join(', ')}`,\n          ),\n        }\n      }\n      return { success: true, value }\n    } else {\n      concreteDefs = toConcreteTypes(lexicons, {\n        type: 'ref',\n        ref: value.$type,\n      })\n    }\n  } else {\n    concreteDefs = toConcreteTypes(lexicons, def)\n  }\n\n  for (const concreteDef of concreteDefs) {\n    const result = mustBeObj\n      ? object(lexicons, path, concreteDef, value)\n      : validate(lexicons, path, concreteDef, value)\n    if (result.success) {\n      return result\n    }\n    error ??= result.error\n  }\n  if (concreteDefs.length > 1) {\n    return {\n      success: false,\n      error: new ValidationError(\n        `${path} did not match any of the expected definitions`,\n      ),\n    }\n  }\n  return { success: false, error }\n}\n\n// to avoid bugs like #0189 this needs to handle both\n// explicit and implicit #main\nconst refsContainType = (refs: string[], type: string) => {\n  const lexUri = toLexUri(type)\n  if (refs.includes(lexUri)) {\n    return true\n  }\n\n  if (lexUri.endsWith('#main')) {\n    return refs.includes(lexUri.replace('#main', ''))\n  } else {\n    return refs.includes(lexUri + '#main')\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4411, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4416, "column": 0}, "map": {"version":3,"file":"xrpc.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/validators/xrpc.ts"],"sourcesContent":["import { Lexicons } from '../lexicons'\nimport { LexXrpcParameters, ValidationResult, ValidationError } from '../types'\n\nimport * as PrimitiveValidators from './primitives'\nimport { array } from './complex'\n\nexport function params(\n  lexicons: Lexicons,\n  path: string,\n  def: LexXrpcParameters,\n  val: unknown,\n): ValidationResult {\n  // type\n  const value = val && typeof val === 'object' ? val : {}\n\n  const requiredProps = new Set(def.required ?? [])\n\n  // properties\n  let resultValue = value\n  if (typeof def.properties === 'object') {\n    for (const key in def.properties) {\n      const propDef = def.properties[key]\n      const validated =\n        propDef.type === 'array'\n          ? array(lexicons, key, propDef, value[key])\n          : PrimitiveValidators.validate(lexicons, key, propDef, value[key])\n      const propValue = validated.success ? validated.value : value[key]\n      const propIsUndefined = typeof propValue === 'undefined'\n      // Return error for bad validation, giving required rule precedence\n      if (propIsUndefined && requiredProps.has(key)) {\n        return {\n          success: false,\n          error: new ValidationError(`${path} must have the property \"${key}\"`),\n        }\n      } else if (!propIsUndefined && !validated.success) {\n        return validated\n      }\n      // Adjust value based on e.g. applied defaults, cloning shallowly if there was a changed value\n      if (propValue !== value[key]) {\n        if (resultValue === value) {\n          // Lazy shallow clone\n          resultValue = { ...value }\n        }\n        resultValue[key] = propValue\n      }\n    }\n  }\n\n  return { success: true, value: resultValue }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,QAAA,MAAA,GAAA,OA2CC;AAhDD,MAAA,8BAA+E;AAE/E,MAAA,sBAAA,sCAAmD;AACnD,MAAA,iCAAiC;AAEjC,SAAgB,MAAM,CACpB,QAAkB,EAClB,IAAY,EACZ,GAAsB,EACtB,GAAY;IAEZ,OAAO;IACP,MAAM,KAAK,GAAG,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA,CAAE,CAAA;IAEvD,MAAM,aAAa,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAA;IAEjD,aAAa;IACb,IAAI,WAAW,GAAG,KAAK,CAAA;IACvB,IAAI,OAAO,GAAG,CAAC,UAAU,KAAK,QAAQ,EAAE,CAAC;QACvC,IAAK,MAAM,GAAG,IAAI,GAAG,CAAC,UAAU,CAAE,CAAC;YACjC,MAAM,OAAO,GAAG,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAA;YACnC,MAAM,SAAS,GACb,OAAO,CAAC,IAAI,KAAK,OAAO,GACpB,CAAA,GAAA,UAAA,KAAK,EAAC,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,GACzC,mBAAmB,CAAC,QAAQ,CAAC,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAA;YACtE,MAAM,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;YAClE,MAAM,eAAe,GAAG,OAAO,SAAS,KAAK,WAAW,CAAA;YACxD,mEAAmE;YACnE,IAAI,eAAe,IAAI,aAAa,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC9C,OAAO;oBACL,OAAO,EAAE,KAAK;oBACd,KAAK,EAAE,IAAI,QAAA,eAAe,CAAC,GAAG,IAAI,CAAA,yBAAA,EAA4B,GAAG,CAAA,CAAA,CAAG,CAAC;iBACtE,CAAA;YACH,CAAC,MAAM,IAAI,CAAC,eAAe,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;gBAClD,OAAO,SAAS,CAAA;YAClB,CAAC;YACD,8FAA8F;YAC9F,IAAI,SAAS,KAAK,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC7B,IAAI,WAAW,KAAK,KAAK,EAAE,CAAC;oBAC1B,qBAAqB;oBACrB,WAAW,GAAG;wBAAE,GAAG,KAAK;oBAAA,CAAE,CAAA;gBAC5B,CAAC;gBACD,WAAW,CAAC,GAAG,CAAC,GAAG,SAAS,CAAA;YAC9B,CAAC;QACH,CAAC;IACH,CAAC;IAED,OAAO;QAAE,OAAO,EAAE,IAAI;QAAE,KAAK,EAAE,WAAW;IAAA,CAAE,CAAA;AAC9C,CAAC","ignoreList":[0]}},
    {"offset": {"line": 4495, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4500, "column": 0}, "map": {"version":3,"file":"validation.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/validation.ts"],"sourcesContent":["import { Lexicons } from './lexicons'\nimport {\n  LexRecord,\n  LexRefVariant,\n  LexUserType,\n  LexXrpcProcedure,\n  LexXrpcQuery,\n  LexXrpcSubscription,\n} from './types'\n\nimport { object, validateOneOf } from './validators/complex'\nimport { params } from './validators/xrpc'\n\nexport function assertValidRecord(\n  lexicons: Lexicons,\n  def: LexRecord,\n  value: unknown,\n) {\n  const res = object(lexicons, 'Record', def.record, value)\n  if (!res.success) throw res.error\n  return res.value\n}\n\nexport function assertValidXrpcParams(\n  lexicons: Lexicons,\n  def: LexXrpcProcedure | LexXrpcQuery | LexXrpcSubscription,\n  value: unknown,\n) {\n  if (def.parameters) {\n    const res = params(lexicons, 'Params', def.parameters, value)\n    if (!res.success) throw res.error\n    return res.value\n  }\n}\n\nexport function assertValidXrpcInput(\n  lexicons: Lexicons,\n  def: LexXrpcProcedure,\n  value: unknown,\n) {\n  if (def.input?.schema) {\n    // loop: all input schema definitions\n    return assertValidOneOf(lexicons, 'Input', def.input.schema, value, true)\n  }\n}\n\nexport function assertValidXrpcOutput(\n  lexicons: Lexicons,\n  def: LexXrpcProcedure | LexXrpcQuery,\n  value: unknown,\n) {\n  if (def.output?.schema) {\n    // loop: all output schema definitions\n    return assertValidOneOf(lexicons, 'Output', def.output.schema, value, true)\n  }\n}\n\nexport function assertValidXrpcMessage(\n  lexicons: Lexicons,\n  def: LexXrpcSubscription,\n  value: unknown,\n) {\n  if (def.message?.schema) {\n    // loop: all output schema definitions\n    return assertValidOneOf(\n      lexicons,\n      'Message',\n      def.message.schema,\n      value,\n      true,\n    )\n  }\n}\n\nfunction assertValidOneOf(\n  lexicons: Lexicons,\n  path: string,\n  def: LexRefVariant | LexUserType,\n  value: unknown,\n  mustBeObj = false,\n) {\n  const res = validateOneOf(lexicons, path, def, value, mustBeObj)\n  if (!res.success) throw res.error\n  return res.value\n}\n"],"names":[],"mappings":";;;;AAaA,QAAA,iBAAA,GAAA,kBAQC;AAED,QAAA,qBAAA,GAAA,sBAUC;AAED,QAAA,oBAAA,GAAA,qBASC;AAED,QAAA,qBAAA,GAAA,sBASC;AAED,QAAA,sBAAA,GAAA,uBAeC;AA9DD,MAAA,4CAA4D;AAC5D,MAAA,sCAA0C;AAE1C,SAAgB,iBAAiB,CAC/B,QAAkB,EAClB,GAAc,EACd,KAAc;IAEd,MAAM,GAAG,GAAG,CAAA,GAAA,UAAA,MAAM,EAAC,QAAQ,EAAE,QAAQ,EAAE,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;IACzD,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,MAAM,GAAG,CAAC,KAAK,CAAA;IACjC,OAAO,GAAG,CAAC,KAAK,CAAA;AAClB,CAAC;AAED,SAAgB,qBAAqB,CACnC,QAAkB,EAClB,GAA0D,EAC1D,KAAc;IAEd,IAAI,GAAG,CAAC,UAAU,EAAE,CAAC;QACnB,MAAM,GAAG,GAAG,CAAA,GAAA,OAAA,MAAM,EAAC,QAAQ,EAAE,QAAQ,EAAE,GAAG,CAAC,UAAU,EAAE,KAAK,CAAC,CAAA;QAC7D,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,MAAM,GAAG,CAAC,KAAK,CAAA;QACjC,OAAO,GAAG,CAAC,KAAK,CAAA;IAClB,CAAC;AACH,CAAC;AAED,SAAgB,oBAAoB,CAClC,QAAkB,EAClB,GAAqB,EACrB,KAAc;IAEd,IAAI,GAAG,CAAC,KAAK,EAAE,MAAM,EAAE,CAAC;QACtB,qCAAqC;QACrC,OAAO,gBAAgB,CAAC,QAAQ,EAAE,OAAO,EAAE,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAA;IAC3E,CAAC;AACH,CAAC;AAED,SAAgB,qBAAqB,CACnC,QAAkB,EAClB,GAAoC,EACpC,KAAc;IAEd,IAAI,GAAG,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC;QACvB,sCAAsC;QACtC,OAAO,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,EAAE,GAAG,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAA;IAC7E,CAAC;AACH,CAAC;AAED,SAAgB,sBAAsB,CACpC,QAAkB,EAClB,GAAwB,EACxB,KAAc;IAEd,IAAI,GAAG,CAAC,OAAO,EAAE,MAAM,EAAE,CAAC;QACxB,sCAAsC;QACtC,OAAO,gBAAgB,CACrB,QAAQ,EACR,SAAS,EACT,GAAG,CAAC,OAAO,CAAC,MAAM,EAClB,KAAK,EACL,IAAI,CACL,CAAA;IACH,CAAC;AACH,CAAC;AAED,SAAS,gBAAgB,CACvB,QAAkB,EAClB,IAAY,EACZ,GAAgC,EAChC,KAAc,EACd,SAAS,GAAG,KAAK;IAEjB,MAAM,GAAG,GAAG,CAAA,GAAA,UAAA,aAAa,EAAC,QAAQ,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,SAAS,CAAC,CAAA;IAChE,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,MAAM,GAAG,CAAC,KAAK,CAAA;IACjC,OAAO,GAAG,CAAC,KAAK,CAAA;AAClB,CAAC","ignoreList":[0]}},
    {"offset": {"line": 4546, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4551, "column": 0}, "map": {"version":3,"file":"lexicons.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/lexicons.ts"],"sourcesContent":["import {\n  LexiconDoc,\n  LexRecord,\n  LexUserType,\n  LexiconDefNotFoundError,\n  InvalidLexiconError,\n  ValidationResult,\n  ValidationError,\n  isObj,\n  hasProp,\n} from './types'\nimport {\n  assertValidRecord,\n  assertValidXrpcParams,\n  assertValidXrpcInput,\n  assertValidXrpcOutput,\n  assertValidXrpcMessage,\n} from './validation'\nimport { toLexUri } from './util'\nimport * as ComplexValidators from './validators/complex'\n\n/**\n * A collection of compiled lexicons.\n */\nexport class Lexicons implements Iterable<LexiconDoc> {\n  docs: Map<string, LexiconDoc> = new Map()\n  defs: Map<string, LexUserType> = new Map()\n\n  constructor(docs?: Iterable<LexiconDoc>) {\n    if (docs) {\n      for (const doc of docs) {\n        this.add(doc)\n      }\n    }\n  }\n\n  /**\n   * @example clone a lexicon:\n   * ```ts\n   * const clone = new Lexicons(originalLexicon)\n   * ```\n   *\n   * @example get docs array:\n   * ```ts\n   * const docs = Array.from(lexicons)\n   * ```\n   */\n  [Symbol.iterator](): Iterator<LexiconDoc> {\n    return this.docs.values()\n  }\n\n  /**\n   * Add a lexicon doc.\n   */\n  add(doc: LexiconDoc): void {\n    const uri = toLexUri(doc.id)\n    if (this.docs.has(uri)) {\n      throw new Error(`${uri} has already been registered`)\n    }\n\n    // WARNING\n    // mutates the object\n    // -prf\n    resolveRefUris(doc, uri)\n\n    this.docs.set(uri, doc)\n    for (const [defUri, def] of iterDefs(doc)) {\n      this.defs.set(defUri, def)\n    }\n  }\n\n  /**\n   * Remove a lexicon doc.\n   */\n  remove(uri: string) {\n    uri = toLexUri(uri)\n    const doc = this.docs.get(uri)\n    if (!doc) {\n      throw new Error(`Unable to remove \"${uri}\": does not exist`)\n    }\n    for (const [defUri, _def] of iterDefs(doc)) {\n      this.defs.delete(defUri)\n    }\n    this.docs.delete(uri)\n  }\n\n  /**\n   * Get a lexicon doc.\n   */\n  get(uri: string): LexiconDoc | undefined {\n    uri = toLexUri(uri)\n    return this.docs.get(uri)\n  }\n\n  /**\n   * Get a definition.\n   */\n  getDef(uri: string): LexUserType | undefined {\n    uri = toLexUri(uri)\n    return this.defs.get(uri)\n  }\n\n  /**\n   * Get a def, throw if not found. Throws on not found.\n   */\n  getDefOrThrow<T extends LexUserType['type'] = LexUserType['type']>(\n    uri: string,\n    types?: readonly T[],\n  ): Extract<LexUserType, { type: T }>\n  getDefOrThrow(\n    uri: string,\n    types?: readonly LexUserType['type'][],\n  ): LexUserType {\n    const def = this.getDef(uri)\n    if (!def) {\n      throw new LexiconDefNotFoundError(`Lexicon not found: ${uri}`)\n    }\n    if (types && !types.includes(def.type)) {\n      throw new InvalidLexiconError(\n        `Not a ${types.join(' or ')} lexicon: ${uri}`,\n      )\n    }\n    return def\n  }\n\n  /**\n   * Validate a record or object.\n   */\n  validate(lexUri: string, value: unknown): ValidationResult {\n    lexUri = toLexUri(lexUri)\n    const def = this.getDefOrThrow(lexUri, ['record', 'object'])\n    if (!isObj(value)) {\n      throw new ValidationError(`Value must be an object`)\n    }\n    if (def.type === 'record') {\n      return ComplexValidators.object(this, 'Record', def.record, value)\n    } else if (def.type === 'object') {\n      return ComplexValidators.object(this, 'Object', def, value)\n    } else {\n      // shouldn't happen\n      throw new InvalidLexiconError('Definition must be a record or object')\n    }\n  }\n\n  /**\n   * Validate a record and throw on any error.\n   */\n  assertValidRecord(lexUri: string, value: unknown) {\n    lexUri = toLexUri(lexUri)\n    const def = this.getDefOrThrow(lexUri, ['record'])\n    if (!isObj(value)) {\n      throw new ValidationError(`Record must be an object`)\n    }\n    if (!hasProp(value, '$type') || typeof value.$type !== 'string') {\n      throw new ValidationError(`Record/$type must be a string`)\n    }\n    const $type = (value as Record<string, string>).$type || ''\n    if (toLexUri($type) !== lexUri) {\n      throw new ValidationError(\n        `Invalid $type: must be ${lexUri}, got ${$type}`,\n      )\n    }\n    return assertValidRecord(this, def as LexRecord, value)\n  }\n\n  /**\n   * Validate xrpc query params and throw on any error.\n   */\n  assertValidXrpcParams(lexUri: string, value: unknown) {\n    lexUri = toLexUri(lexUri)\n    const def = this.getDefOrThrow(lexUri, [\n      'query',\n      'procedure',\n      'subscription',\n    ])\n    return assertValidXrpcParams(this, def, value)\n  }\n\n  /**\n   * Validate xrpc input body and throw on any error.\n   */\n  assertValidXrpcInput(lexUri: string, value: unknown) {\n    lexUri = toLexUri(lexUri)\n    const def = this.getDefOrThrow(lexUri, ['procedure'])\n    return assertValidXrpcInput(this, def, value)\n  }\n\n  /**\n   * Validate xrpc output body and throw on any error.\n   */\n  assertValidXrpcOutput(lexUri: string, value: unknown) {\n    lexUri = toLexUri(lexUri)\n    const def = this.getDefOrThrow(lexUri, ['query', 'procedure'])\n    return assertValidXrpcOutput(this, def, value)\n  }\n\n  /**\n   * Validate xrpc subscription message and throw on any error.\n   */\n  assertValidXrpcMessage<T = unknown>(lexUri: string, value: unknown): T {\n    lexUri = toLexUri(lexUri)\n    const def = this.getDefOrThrow(lexUri, ['subscription'])\n    return assertValidXrpcMessage(this, def, value) as T\n  }\n\n  /**\n   * Resolve a lex uri given a ref\n   */\n  resolveLexUri(lexUri: string, ref: string) {\n    lexUri = toLexUri(lexUri)\n    return toLexUri(ref, lexUri)\n  }\n}\n\nfunction* iterDefs(doc: LexiconDoc): Generator<[string, LexUserType]> {\n  for (const defId in doc.defs) {\n    yield [`lex:${doc.id}#${defId}`, doc.defs[defId]]\n    if (defId === 'main') {\n      yield [`lex:${doc.id}`, doc.defs[defId]]\n    }\n  }\n}\n\n// WARNING\n// this method mutates objects\n// -prf\nfunction resolveRefUris(obj: any, baseUri: string): any {\n  for (const k in obj) {\n    if (obj.type === 'ref') {\n      obj.ref = toLexUri(obj.ref, baseUri)\n    } else if (obj.type === 'union') {\n      obj.refs = obj.refs.map((ref) => toLexUri(ref, baseUri))\n    } else if (Array.isArray(obj[k])) {\n      obj[k] = obj[k].map((item: any) => {\n        if (typeof item === 'string') {\n          return item.startsWith('#') ? toLexUri(item, baseUri) : item\n        } else if (item && typeof item === 'object') {\n          return resolveRefUris(item, baseUri)\n        }\n        return item\n      })\n    } else if (obj[k] && typeof obj[k] === 'object') {\n      obj[k] = resolveRefUris(obj[k], baseUri)\n    }\n  }\n  return obj\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4803, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4808, "column": 0}, "map": {"version":3,"file":"serialize.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/serialize.ts"],"sourcesContent":["import {\n  check,\n  IpldValue,\n  ipldToJson,\n  jsonToIpld,\n  JsonValue,\n} from '@atproto/common-web'\nimport { CID } from 'multiformats/cid'\nimport { BlobRef, jsonBlobRef } from './blob-refs'\n\nexport type LexValue =\n  | IpldValue\n  | BlobRef\n  | Array<LexValue>\n  | { [key: string]: LexValue }\n\nexport type RepoRecord = Record<string, LexValue>\n\n// @NOTE avoiding use of check.is() here only because it makes\n// these implementations slow, and they often live in hot paths.\n\nexport const lexToIpld = (val: LexValue): IpldValue => {\n  // walk arrays\n  if (Array.isArray(val)) {\n    return val.map((item) => lexToIpld(item))\n  }\n  // objects\n  if (val && typeof val === 'object') {\n    // convert blobs, leaving the original encoding so that we don't change CIDs on re-encode\n    if (val instanceof BlobRef) {\n      return val.original\n    }\n    // retain cids & bytes\n    if (CID.asCID(val) || val instanceof Uint8Array) {\n      return val\n    }\n    // walk plain objects\n    const toReturn = {}\n    for (const key of Object.keys(val)) {\n      toReturn[key] = lexToIpld(val[key])\n    }\n    return toReturn\n  }\n  // pass through\n  return val\n}\n\nexport const ipldToLex = (val: IpldValue): LexValue => {\n  // map arrays\n  if (Array.isArray(val)) {\n    return val.map((item) => ipldToLex(item))\n  }\n  // objects\n  if (val && typeof val === 'object') {\n    // convert blobs, using hints to avoid expensive is() check\n    if (\n      (val['$type'] === 'blob' ||\n        (typeof val['cid'] === 'string' &&\n          typeof val['mimeType'] === 'string')) &&\n      check.is(val, jsonBlobRef)\n    ) {\n      return BlobRef.fromJsonRef(val)\n    }\n    // retain cids, bytes\n    if (CID.asCID(val) || val instanceof Uint8Array) {\n      return val\n    }\n    // map plain objects\n    const toReturn = {}\n    for (const key of Object.keys(val)) {\n      toReturn[key] = ipldToLex(val[key])\n    }\n    return toReturn\n  }\n  // pass through\n  return val\n}\n\nexport const lexToJson = (val: LexValue): JsonValue => {\n  return ipldToJson(lexToIpld(val))\n}\n\nexport const stringifyLex = (val: LexValue): string => {\n  return JSON.stringify(lexToJson(val))\n}\n\nexport const jsonToLex = (val: JsonValue): LexValue => {\n  return ipldToLex(jsonToIpld(val))\n}\n\nexport const jsonStringToLex = (val: string): LexValue => {\n  return jsonToLex(JSON.parse(val))\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4886, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4891, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/lexicon/src/index.ts"],"sourcesContent":["export * from './types'\nexport * from './lexicons'\nexport * from './blob-refs'\nexport * from './serialize'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,uHAAA,SAAuB;AACvB,0HAAA,SAA0B;AAC1B,2HAAA,SAA2B;AAC3B,2HAAA,SAA2B","ignoreList":[0]}},
    {"offset": {"line": 4918, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4923, "column": 0}, "map": {"version":3,"file":"check.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/check.ts"],"sourcesContent":["// Explicitly not using \"zod\" types here to avoid mismatching types due to\n// version differences.\n\nexport interface Checkable<T> {\n  parse: (obj: unknown) => T\n  safeParse: (\n    obj: unknown,\n  ) => { success: true; data: T } | { success: false; error: Error }\n}\n\nexport interface Def<T> {\n  name: string\n  schema: Checkable<T>\n}\n\nexport const is = <T>(obj: unknown, def: Checkable<T>): obj is T => {\n  return def.safeParse(obj).success\n}\n\nexport const create =\n  <T>(def: Checkable<T>) =>\n  (v: unknown): v is T =>\n    def.safeParse(v).success\n\nexport const assure = <T>(def: Checkable<T>, obj: unknown): T => {\n  return def.parse(obj)\n}\n\nexport const isObject = (obj: unknown): obj is Record<string, unknown> => {\n  return typeof obj === 'object' && obj !== null\n}\n"],"names":[],"mappings":";AAAA,0EAA0E;AAC1E,uBAAuB;;;;;AAchB,MAAM,EAAE,GAAG,CAAI,GAAY,EAAE,GAAiB,EAAY,EAAE;IACjE,OAAO,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,OAAO,CAAA;AACnC,CAAC,CAAA;AAFY,QAAA,EAAE,GAAA,GAEd;AAEM,MAAM,MAAM,GACjB,CAAI,GAAiB,EAAE,CACvB,CADyB,AACxB,CAAU,EAAU,CACnB,CADqB,EAClB,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAA;AAHf,QAAA,MAAM,GAAA,OAGS;AAErB,MAAM,MAAM,GAAG,CAAI,GAAiB,EAAE,GAAY,EAAK,EAAE;IAC9D,OAAO,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;AACvB,CAAC,CAAA;AAFY,QAAA,MAAM,GAAA,OAElB;AAEM,MAAM,QAAQ,GAAG,CAAC,GAAY,EAAkC,EAAE;IACvE,OAAO,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,KAAK,IAAI,CAAA;AAChD,CAAC,CAAA;AAFY,QAAA,QAAQ,GAAA,SAEpB","ignoreList":[0]}},
    {"offset": {"line": 4944, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4949, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/util.ts"],"sourcesContent":["export const noUndefinedVals = <T>(\n  obj: Record<string, T | undefined>,\n): Record<string, T> => {\n  Object.keys(obj).forEach((k) => {\n    if (obj[k] === undefined) {\n      delete obj[k]\n    }\n  })\n  return obj as Record<string, T>\n}\n\n/**\n * Returns a shallow copy of the object without the specified keys. If the input\n * is nullish, it returns the input.\n */\nexport function omit<\n  T extends undefined | null | Record<string, unknown>,\n  K extends keyof NonNullable<T>,\n>(\n  object: T,\n  rejectedKeys: readonly K[],\n): T extends undefined ? undefined : T extends null ? null : Omit<T, K>\nexport function omit(\n  src: undefined | null | Record<string, unknown>,\n  rejectedKeys: readonly string[],\n): undefined | null | Record<string, unknown> {\n  // Hot path\n\n  if (!src) return src\n\n  const dst = {}\n  const srcKeys = Object.keys(src)\n  for (let i = 0; i < srcKeys.length; i++) {\n    const key = srcKeys[i]\n    if (!rejectedKeys.includes(key)) {\n      dst[key] = src[key]\n    }\n  }\n  return dst\n}\n\nexport const jitter = (maxMs: number) => {\n  return Math.round((Math.random() - 0.5) * maxMs * 2)\n}\n\nexport const wait = (ms: number) => {\n  return new Promise((res) => setTimeout(res, ms))\n}\n\nexport type BailableWait = {\n  bail: () => void\n  wait: () => Promise<void>\n}\n\nexport const bailableWait = (ms: number): BailableWait => {\n  let bail\n  const waitPromise = new Promise<void>((res) => {\n    const timeout = setTimeout(res, ms)\n    bail = () => {\n      clearTimeout(timeout)\n      res()\n    }\n  })\n  return { bail, wait: () => waitPromise }\n}\n\nexport const flattenUint8Arrays = (arrs: Uint8Array[]): Uint8Array => {\n  const length = arrs.reduce((acc, cur) => {\n    return acc + cur.length\n  }, 0)\n  const flattened = new Uint8Array(length)\n  let offset = 0\n  arrs.forEach((arr) => {\n    flattened.set(arr, offset)\n    offset += arr.length\n  })\n  return flattened\n}\n\nexport const streamToBuffer = async (\n  stream: AsyncIterable<Uint8Array>,\n): Promise<Uint8Array> => {\n  const arrays: Uint8Array[] = []\n  for await (const chunk of stream) {\n    arrays.push(chunk)\n  }\n  return flattenUint8Arrays(arrays)\n}\n\nconst S32_CHAR = '234567abcdefghijklmnopqrstuvwxyz'\n\nexport const s32encode = (i: number): string => {\n  let s = ''\n  while (i) {\n    const c = i % 32\n    i = Math.floor(i / 32)\n    s = S32_CHAR.charAt(c) + s\n  }\n  return s\n}\n\nexport const s32decode = (s: string): number => {\n  let i = 0\n  for (const c of s) {\n    i = i * 32 + S32_CHAR.indexOf(c)\n  }\n  return i\n}\n\nexport const asyncFilter = async <T>(\n  arr: T[],\n  fn: (t: T) => Promise<boolean>,\n) => {\n  const results = await Promise.all(arr.map((t) => fn(t)))\n  return arr.filter((_, i) => results[i])\n}\n\nexport const isErrnoException = (\n  err: unknown,\n): err is NodeJS.ErrnoException => {\n  return !!err && err['code']\n}\n\nexport const errHasMsg = (err: unknown, msg: string): boolean => {\n  return !!err && typeof err === 'object' && err['message'] === msg\n}\n\nexport const chunkArray = <T>(arr: T[], chunkSize: number): T[][] => {\n  return arr.reduce((acc, cur, i) => {\n    const chunkI = Math.floor(i / chunkSize)\n    if (!acc[chunkI]) {\n      acc[chunkI] = []\n    }\n    acc[chunkI].push(cur)\n    return acc\n  }, [] as T[][])\n}\n\nexport const range = (num: number): number[] => {\n  const nums: number[] = []\n  for (let i = 0; i < num; i++) {\n    nums.push(i)\n  }\n  return nums\n}\n\nexport const dedupeStrs = (strs: string[]): string[] => {\n  return [...new Set(strs)]\n}\n\nexport const parseIntWithFallback = <T>(\n  value: string | undefined,\n  fallback: T,\n): number | T => {\n  const parsed = parseInt(value || '', 10)\n  return isNaN(parsed) ? fallback : parsed\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 5083, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5088, "column": 0}, "map": {"version":3,"file":"arrays.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/arrays.ts"],"sourcesContent":["export const keyBy = <T>(arr: T[], key: string): Record<string, T> => {\n  return arr.reduce(\n    (acc, cur) => {\n      acc[cur[key]] = cur\n      return acc\n    },\n    {} as Record<string, T>,\n  )\n}\n\nexport const mapDefined = <T, S>(\n  arr: T[],\n  fn: (obj: T) => S | undefined,\n): S[] => {\n  const output: S[] = []\n  for (const item of arr) {\n    const val = fn(item)\n    if (val !== undefined) {\n      output.push(val)\n    }\n  }\n  return output\n}\n"],"names":[],"mappings":";;;;;AAAO,MAAM,KAAK,GAAG,CAAI,GAAQ,EAAE,GAAW,EAAqB,EAAE;IACnE,OAAO,GAAG,CAAC,MAAM,CACf,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;QACX,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAA;QACnB,OAAO,GAAG,CAAA;IACZ,CAAC,EACD,CAAA,CAAuB,CACxB,CAAA;AACH,CAAC,CAAA;AARY,QAAA,KAAK,GAAA,MAQjB;AAEM,MAAM,UAAU,GAAG,CACxB,GAAQ,EACR,EAA6B,EACxB,EAAE;IACP,MAAM,MAAM,GAAQ,EAAE,CAAA;IACtB,KAAK,MAAM,IAAI,IAAI,GAAG,CAAE,CAAC;QACvB,MAAM,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,CAAA;QACpB,IAAI,GAAG,KAAK,SAAS,EAAE,CAAC;YACtB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;QAClB,CAAC;IACH,CAAC;IACD,OAAO,MAAM,CAAA;AACf,CAAC,CAAA;AAZY,QAAA,UAAU,GAAA,WAYtB","ignoreList":[0]}},
    {"offset": {"line": 5111, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5116, "column": 0}, "map": {"version":3,"file":"async.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/async.ts"],"sourcesContent":["import { bailableWait } from './util'\n\n// reads values from a generator into a list\n// breaks when isDone signals `true` AND `waitFor` completes OR when a max length is reached\n// NOTE: does not signal generator to close. it *will* continue to produce values\nexport const readFromGenerator = async <T>(\n  gen: AsyncGenerator<T>,\n  isDone: (last?: T) => Promise<boolean> | boolean,\n  waitFor: Promise<unknown> = Promise.resolve(),\n  maxLength = Number.MAX_SAFE_INTEGER,\n): Promise<T[]> => {\n  const evts: T[] = []\n  let bail: undefined | (() => void)\n  let hasBroke = false\n  const awaitDone = async () => {\n    if (await isDone(evts.at(-1))) {\n      return true\n    }\n    const bailable = bailableWait(20)\n    await bailable.wait()\n    bail = bailable.bail\n    if (hasBroke) return false\n    return await awaitDone()\n  }\n  const breakOn: Promise<void> = new Promise((resolve) => {\n    waitFor.then(() => {\n      awaitDone().then(() => resolve())\n    })\n  })\n\n  try {\n    while (evts.length < maxLength) {\n      const maybeEvt = await Promise.race([gen.next(), breakOn])\n      if (!maybeEvt) break\n      const evt = maybeEvt as IteratorResult<T>\n      if (evt.done) break\n      evts.push(evt.value)\n    }\n  } finally {\n    hasBroke = true\n    bail && bail()\n  }\n  return evts\n}\n\nexport type Deferrable = {\n  resolve: () => void\n  complete: Promise<void>\n}\n\nexport const createDeferrable = (): Deferrable => {\n  let resolve\n  const promise: Promise<void> = new Promise((res) => {\n    resolve = () => res()\n  })\n  return { resolve, complete: promise }\n}\n\nexport const createDeferrables = (count: number): Deferrable[] => {\n  const list: Deferrable[] = []\n  for (let i = 0; i < count; i++) {\n    list.push(createDeferrable())\n  }\n  return list\n}\n\nexport const allComplete = async (deferrables: Deferrable[]): Promise<void> => {\n  await Promise.all(deferrables.map((d) => d.complete))\n}\n\nexport class AsyncBuffer<T> {\n  private buffer: T[] = []\n  private promise: Promise<void>\n  private resolve: () => void\n  private closed = false\n  private toThrow: unknown | undefined\n\n  constructor(public maxSize?: number) {\n    // Initializing to satisfy types/build, immediately reset by resetPromise()\n    this.promise = Promise.resolve()\n    this.resolve = () => null\n    this.resetPromise()\n  }\n\n  get curr(): T[] {\n    return this.buffer\n  }\n\n  get size(): number {\n    return this.buffer.length\n  }\n\n  get isClosed(): boolean {\n    return this.closed\n  }\n\n  resetPromise() {\n    this.promise = new Promise<void>((r) => (this.resolve = r))\n  }\n\n  push(item: T) {\n    this.buffer.push(item)\n    this.resolve()\n  }\n\n  pushMany(items: T[]) {\n    items.forEach((i) => this.buffer.push(i))\n    this.resolve()\n  }\n\n  async *events(): AsyncGenerator<T> {\n    while (true) {\n      if (this.closed && this.buffer.length === 0) {\n        if (this.toThrow) {\n          throw this.toThrow\n        } else {\n          return\n        }\n      }\n      await this.promise\n      if (this.toThrow) {\n        throw this.toThrow\n      }\n      if (this.maxSize && this.size > this.maxSize) {\n        throw new AsyncBufferFullError(this.maxSize)\n      }\n      const [first, ...rest] = this.buffer\n      if (first) {\n        this.buffer = rest\n        yield first\n      } else {\n        this.resetPromise()\n      }\n    }\n  }\n\n  throw(err: unknown) {\n    this.toThrow = err\n    this.closed = true\n    this.resolve()\n  }\n\n  close() {\n    this.closed = true\n    this.resolve()\n  }\n}\n\nexport class AsyncBufferFullError extends Error {\n  constructor(maxSize: number) {\n    super(`ReachedMaxBufferSize: ${maxSize}`)\n  }\n}\n\n/**\n * Utility function that behaves like {@link Promise.allSettled} but returns the\n * same result as {@link Promise.all} in case every promise is fulfilled, and\n * throws an {@link AggregateError} if there are more than one errors.\n */\nexport function allFulfilled<T extends readonly unknown[] | []>(\n  promises: T,\n): Promise<{ -readonly [P in keyof T]: Awaited<T[P]> }>\nexport function allFulfilled<T>(\n  promises: Iterable<T | PromiseLike<T>>,\n): Promise<Awaited<T>[]>\nexport function allFulfilled(\n  promises: Iterable<Promise<unknown>>,\n): Promise<unknown[]> {\n  return Promise.allSettled(promises).then(handleAllSettledErrors)\n}\n\nexport function handleAllSettledErrors<\n  T extends readonly PromiseSettledResult<unknown>[] | [],\n>(\n  results: T,\n): {\n  -readonly [P in keyof T]: T[P] extends PromiseSettledResult<infer U>\n    ? U\n    : never\n}\nexport function handleAllSettledErrors<T>(\n  results: PromiseSettledResult<T>[],\n): T[]\nexport function handleAllSettledErrors(\n  results: PromiseSettledResult<unknown>[],\n): unknown[] {\n  const errors = results.filter(isRejectedResult).map(extractReason)\n  if (errors.length === 0) {\n    // No need to filter here, it is safe to assume that all promises are fulfilled\n    return (results as PromiseFulfilledResult<unknown>[]).map(extractValue)\n  }\n  if (errors.length === 1) {\n    throw errors[0]\n  }\n  throw new AggregateError(\n    errors,\n    `Multiple errors: ${errors.map(stringifyReason).join('\\n')}`,\n  )\n}\n\nexport function isRejectedResult(\n  result: PromiseSettledResult<unknown>,\n): result is PromiseRejectedResult {\n  return result.status === 'rejected'\n}\n\nfunction extractReason(result: PromiseRejectedResult): unknown {\n  return result.reason\n}\n\nexport function isFulfilledResult<T>(\n  result: PromiseSettledResult<T>,\n): result is PromiseFulfilledResult<T> {\n  return result.status === 'fulfilled'\n}\n\nfunction extractValue<T>(result: PromiseFulfilledResult<T>): T {\n  return result.value\n}\n\nfunction stringifyReason(reason: unknown): string {\n  if (reason instanceof Error) {\n    return reason.message\n  }\n  return String(reason)\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 5326, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5331, "column": 0}, "map": {"version":3,"file":"tid.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/tid.ts"],"sourcesContent":["import { s32encode, s32decode } from './util'\n\nconst TID_LEN = 13\n\nlet lastTimestamp = 0\nlet timestampCount = 0\nlet clockid: number | null = null\n\nfunction dedash(str: string): string {\n  return str.replaceAll('-', '')\n}\n\nexport class TID {\n  str: string\n\n  constructor(str: string) {\n    const noDashes = dedash(str)\n    if (noDashes.length !== TID_LEN) {\n      throw new Error(`Poorly formatted TID: ${noDashes.length} length`)\n    }\n    this.str = noDashes\n  }\n\n  static next(prev?: TID): TID {\n    // javascript does not have microsecond precision\n    // instead, we append a counter to the timestamp to indicate if multiple timestamps were created within the same millisecond\n    // take max of current time & last timestamp to prevent tids moving backwards if system clock drifts backwards\n    const time = Math.max(Date.now(), lastTimestamp)\n    if (time === lastTimestamp) {\n      timestampCount++\n    }\n    lastTimestamp = time\n    const timestamp = time * 1000 + timestampCount\n    // the bottom 32 clock ids can be randomized & are not guaranteed to be collision resistant\n    // we use the same clockid for all tids coming from this machine\n    if (clockid === null) {\n      clockid = Math.floor(Math.random() * 32)\n    }\n    const tid = TID.fromTime(timestamp, clockid)\n    if (!prev || tid.newerThan(prev)) {\n      return tid\n    }\n    return TID.fromTime(prev.timestamp() + 1, clockid)\n  }\n\n  static nextStr(prev?: string): string {\n    return TID.next(prev ? new TID(prev) : undefined).toString()\n  }\n\n  static fromTime(timestamp: number, clockid: number): TID {\n    // base32 encode with encoding variant sort (s32)\n    const str = `${s32encode(timestamp)}${s32encode(clockid).padStart(2, '2')}`\n    return new TID(str)\n  }\n\n  static fromStr(str: string): TID {\n    return new TID(str)\n  }\n\n  static oldestFirst(a: TID, b: TID): number {\n    return a.compareTo(b)\n  }\n\n  static newestFirst(a: TID, b: TID): number {\n    return b.compareTo(a)\n  }\n\n  static is(str: string): boolean {\n    return dedash(str).length === TID_LEN\n  }\n\n  timestamp(): number {\n    return s32decode(this.str.slice(0, 11))\n  }\n\n  clockid(): number {\n    return s32decode(this.str.slice(11, 13))\n  }\n\n  formatted(): string {\n    const str = this.toString()\n    return `${str.slice(0, 4)}-${str.slice(4, 7)}-${str.slice(\n      7,\n      11,\n    )}-${str.slice(11, 13)}`\n  }\n\n  toString(): string {\n    return this.str\n  }\n\n  // newer > older\n  compareTo(other: TID): number {\n    if (this.str > other.str) return 1\n    if (this.str < other.str) return -1\n    return 0\n  }\n\n  equals(other: TID): boolean {\n    return this.str === other.str\n  }\n\n  newerThan(other: TID): boolean {\n    return this.compareTo(other) > 0\n  }\n\n  olderThan(other: TID): boolean {\n    return this.compareTo(other) < 0\n  }\n}\n\nexport default TID\n"],"names":[],"mappings":";;;;;AAAA,MAAA,2BAA6C;AAE7C,MAAM,OAAO,GAAG,EAAE,CAAA;AAElB,IAAI,aAAa,GAAG,CAAC,CAAA;AACrB,IAAI,cAAc,GAAG,CAAC,CAAA;AACtB,IAAI,OAAO,GAAkB,IAAI,CAAA;AAEjC,SAAS,MAAM,CAAC,GAAW;IACzB,OAAO,GAAG,CAAC,UAAU,CAAC,GAAG,EAAE,EAAE,CAAC,CAAA;AAChC,CAAC;AAED,MAAa,GAAG;IAGd,YAAY,GAAW,CAAA;QAFvB,OAAA,cAAA,CAAA,IAAA,EAAA,OAAA;;;;;WAAW;QAGT,MAAM,QAAQ,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;QAC5B,IAAI,QAAQ,CAAC,MAAM,KAAK,OAAO,EAAE,CAAC;YAChC,MAAM,IAAI,KAAK,CAAC,CAAA,sBAAA,EAAyB,QAAQ,CAAC,MAAM,CAAA,OAAA,CAAS,CAAC,CAAA;QACpE,CAAC;QACD,IAAI,CAAC,GAAG,GAAG,QAAQ,CAAA;IACrB,CAAC;IAED,MAAM,CAAC,IAAI,CAAC,IAAU,EAAA;QACpB,iDAAiD;QACjD,4HAA4H;QAC5H,8GAA8G;QAC9G,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,EAAE,aAAa,CAAC,CAAA;QAChD,IAAI,IAAI,KAAK,aAAa,EAAE,CAAC;YAC3B,cAAc,EAAE,CAAA;QAClB,CAAC;QACD,aAAa,GAAG,IAAI,CAAA;QACpB,MAAM,SAAS,GAAG,IAAI,GAAG,IAAI,GAAG,cAAc,CAAA;QAC9C,2FAA2F;QAC3F,gEAAgE;QAChE,IAAI,OAAO,KAAK,IAAI,EAAE,CAAC;YACrB,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAA;QAC1C,CAAC;QACD,MAAM,GAAG,GAAG,GAAG,CAAC,QAAQ,CAAC,SAAS,EAAE,OAAO,CAAC,CAAA;QAC5C,IAAI,CAAC,IAAI,IAAI,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC;YACjC,OAAO,GAAG,CAAA;QACZ,CAAC;QACD,OAAO,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC,EAAE,OAAO,CAAC,CAAA;IACpD,CAAC;IAED,MAAM,CAAC,OAAO,CAAC,IAAa,EAAA;QAC1B,OAAO,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,QAAQ,EAAE,CAAA;IAC9D,CAAC;IAED,MAAM,CAAC,QAAQ,CAAC,SAAiB,EAAE,OAAe,EAAA;QAChD,iDAAiD;QACjD,MAAM,GAAG,GAAG,GAAG,CAAA,GAAA,OAAA,SAAS,EAAC,SAAS,CAAC,GAAG,CAAA,GAAA,OAAA,SAAS,EAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,CAAA;QAC3E,OAAO,IAAI,GAAG,CAAC,GAAG,CAAC,CAAA;IACrB,CAAC;IAED,MAAM,CAAC,OAAO,CAAC,GAAW,EAAA;QACxB,OAAO,IAAI,GAAG,CAAC,GAAG,CAAC,CAAA;IACrB,CAAC;IAED,MAAM,CAAC,WAAW,CAAC,CAAM,EAAE,CAAM,EAAA;QAC/B,OAAO,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAA;IACvB,CAAC;IAED,MAAM,CAAC,WAAW,CAAC,CAAM,EAAE,CAAM,EAAA;QAC/B,OAAO,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAA;IACvB,CAAC;IAED,MAAM,CAAC,EAAE,CAAC,GAAW,EAAA;QACnB,OAAO,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM,KAAK,OAAO,CAAA;IACvC,CAAC;IAED,SAAS,GAAA;QACP,OAAO,CAAA,GAAA,OAAA,SAAS,EAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAA;IACzC,CAAC;IAED,OAAO,GAAA;QACL,OAAO,CAAA,GAAA,OAAA,SAAS,EAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAA;IAC1C,CAAC;IAED,SAAS,GAAA;QACP,MAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAA;QAC3B,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA,CAAA,EAAI,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA,CAAA,EAAI,GAAG,CAAC,KAAK,CACvD,CAAC,EACD,EAAE,CACH,CAAA,CAAA,EAAI,GAAG,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAA;IAC1B,CAAC;IAED,QAAQ,GAAA;QACN,OAAO,IAAI,CAAC,GAAG,CAAA;IACjB,CAAC;IAED,gBAAgB;IAChB,SAAS,CAAC,KAAU,EAAA;QAClB,IAAI,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,EAAE,OAAO,CAAC,CAAA;QAClC,IAAI,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC,CAAA;QACnC,OAAO,CAAC,CAAA;IACV,CAAC;IAED,MAAM,CAAC,KAAU,EAAA;QACf,OAAO,IAAI,CAAC,GAAG,KAAK,KAAK,CAAC,GAAG,CAAA;IAC/B,CAAC;IAED,SAAS,CAAC,KAAU,EAAA;QAClB,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;IAClC,CAAC;IAED,SAAS,CAAC,KAAU,EAAA;QAClB,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;IAClC,CAAC;CACF;AAjGD,QAAA,GAAA,GAAA,IAiGC;AAED,QAAA,OAAA,GAAe,GAAG,CAAA","ignoreList":[0]}},
    {"offset": {"line": 5430, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5435, "column": 0}, "map": {"version":3,"file":"ipld.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/ipld.ts"],"sourcesContent":["import { CID } from 'multiformats/cid'\nimport * as ui8 from 'uint8arrays'\n\nexport type JsonValue =\n  | boolean\n  | number\n  | string\n  | null\n  | undefined\n  | unknown\n  | Array<JsonValue>\n  | { [key: string]: JsonValue }\n\nexport type IpldValue =\n  | JsonValue\n  | CID\n  | Uint8Array\n  | Array<IpldValue>\n  | { [key: string]: IpldValue }\n\n// @NOTE avoiding use of check.is() here only because it makes\n// these implementations slow, and they often live in hot paths.\n\nexport const jsonToIpld = (val: JsonValue): IpldValue => {\n  // walk arrays\n  if (Array.isArray(val)) {\n    return val.map((item) => jsonToIpld(item))\n  }\n  // objects\n  if (val && typeof val === 'object') {\n    // check for dag json values\n    if (typeof val['$link'] === 'string' && Object.keys(val).length === 1) {\n      return CID.parse(val['$link'])\n    }\n    if (typeof val['$bytes'] === 'string' && Object.keys(val).length === 1) {\n      return ui8.fromString(val['$bytes'], 'base64')\n    }\n    // walk plain objects\n    const toReturn = {}\n    for (const key of Object.keys(val)) {\n      toReturn[key] = jsonToIpld(val[key])\n    }\n    return toReturn\n  }\n  // pass through\n  return val\n}\n\nexport const ipldToJson = (val: IpldValue): JsonValue => {\n  // walk arrays\n  if (Array.isArray(val)) {\n    return val.map((item) => ipldToJson(item))\n  }\n  // objects\n  if (val && typeof val === 'object') {\n    // convert bytes\n    if (val instanceof Uint8Array) {\n      return {\n        $bytes: ui8.toString(val, 'base64'),\n      }\n    }\n    // convert cids\n    if (CID.asCID(val)) {\n      return {\n        $link: (val as CID).toString(),\n      }\n    }\n    // walk plain objects\n    const toReturn = {}\n    for (const key of Object.keys(val)) {\n      toReturn[key] = ipldToJson(val[key])\n    }\n    return toReturn\n  }\n  // pass through\n  return val as JsonValue\n}\n\nexport const ipldEquals = (a: IpldValue, b: IpldValue): boolean => {\n  // walk arrays\n  if (Array.isArray(a) && Array.isArray(b)) {\n    if (a.length !== b.length) return false\n    for (let i = 0; i < a.length; i++) {\n      if (!ipldEquals(a[i], b[i])) return false\n    }\n    return true\n  }\n  // objects\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\n    // check bytes\n    if (a instanceof Uint8Array && b instanceof Uint8Array) {\n      return ui8.equals(a, b)\n    }\n    // check cids\n    if (CID.asCID(a) && CID.asCID(b)) {\n      return CID.asCID(a)?.equals(CID.asCID(b))\n    }\n    // walk plain objects\n    if (Object.keys(a).length !== Object.keys(b).length) return false\n    for (const key of Object.keys(a)) {\n      if (!ipldEquals(a[key], b[key])) return false\n    }\n    return true\n  }\n  return a === b\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 5561, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5566, "column": 0}, "map": {"version":3,"file":"retry.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/retry.ts"],"sourcesContent":["import { wait } from './util'\n\nexport type RetryOptions = {\n  maxRetries?: number\n  getWaitMs?: (n: number) => number | null\n}\n\nexport async function retry<T>(\n  fn: () => Promise<T>,\n  opts: RetryOptions & {\n    retryable?: (err: unknown) => boolean\n  } = {},\n): Promise<T> {\n  const { maxRetries = 3, retryable = () => true, getWaitMs = backoffMs } = opts\n  let retries = 0\n  let doneError: unknown\n  while (!doneError) {\n    try {\n      return await fn()\n    } catch (err) {\n      const waitMs = getWaitMs(retries)\n      const willRetry =\n        retries < maxRetries && waitMs !== null && retryable(err)\n      if (willRetry) {\n        retries += 1\n        if (waitMs !== 0) {\n          await wait(waitMs)\n        }\n      } else {\n        doneError = err\n      }\n    }\n  }\n  throw doneError\n}\n\nexport function createRetryable(retryable: (err: unknown) => boolean) {\n  return async <T>(fn: () => Promise<T>, opts?: RetryOptions) =>\n    retry(fn, { ...opts, retryable })\n}\n\n// Waits exponential backoff with max and jitter: ~100, ~200, ~400, ~800, ~1000, ~1000, ...\nexport function backoffMs(n: number, multiplier = 100, max = 1000) {\n  const exponentialMs = Math.pow(2, n) * multiplier\n  const ms = Math.min(exponentialMs, max)\n  return jitter(ms)\n}\n\n// Adds randomness +/-15% of value\nfunction jitter(value: number) {\n  const delta = value * 0.15\n  return value + randomRange(-delta, delta)\n}\n\nfunction randomRange(from: number, to: number) {\n  const rand = Math.random() * (to - from)\n  return rand + from\n}\n"],"names":[],"mappings":";;;;AAOA,QAAA,KAAA,GAAA,MA2BC;AAED,QAAA,eAAA,GAAA,gBAGC;AAGD,QAAA,SAAA,GAAA,UAIC;AA9CD,MAAA,2BAA6B;AAOtB,KAAK,UAAU,KAAK,CACzB,EAAoB,EACpB,OAEI,CAAA,CAAE;IAEN,MAAM,EAAE,UAAU,GAAG,CAAC,EAAE,SAAS,GAAG,GAAG,CAAG,CAAD,GAAK,EAAE,SAAS,GAAG,SAAS,EAAE,GAAG,IAAI,CAAA;IAC9E,IAAI,OAAO,GAAG,CAAC,CAAA;IACf,IAAI,SAAkB,CAAA;IACtB,MAAO,CAAC,SAAS,CAAE,CAAC;QAClB,IAAI,CAAC;YACH,OAAO,MAAM,EAAE,EAAE,CAAA;QACnB,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;YACb,MAAM,MAAM,GAAG,SAAS,CAAC,OAAO,CAAC,CAAA;YACjC,MAAM,SAAS,GACb,OAAO,GAAG,UAAU,IAAI,MAAM,KAAK,IAAI,IAAI,SAAS,CAAC,GAAG,CAAC,CAAA;YAC3D,IAAI,SAAS,EAAE,CAAC;gBACd,OAAO,IAAI,CAAC,CAAA;gBACZ,IAAI,MAAM,KAAK,CAAC,EAAE,CAAC;oBACjB,MAAM,CAAA,GAAA,OAAA,IAAI,EAAC,MAAM,CAAC,CAAA;gBACpB,CAAC;YACH,CAAC,MAAM,CAAC;gBACN,SAAS,GAAG,GAAG,CAAA;YACjB,CAAC;QACH,CAAC;IACH,CAAC;IACD,MAAM,SAAS,CAAA;AACjB,CAAC;AAED,SAAgB,eAAe,CAAC,SAAoC;IAClE,OAAO,KAAK,EAAK,EAAoB,EAAE,IAAmB,EAAE,CAC1D,CAD4D,IACvD,CAAC,EAAE,EAAE;YAAE,GAAG,IAAI;YAAE,SAAS;QAAA,CAAE,CAAC,CAAA;AACrC,CAAC;AAED,2FAA2F;AAC3F,SAAgB,SAAS,CAAC,CAAS,EAAE,UAAU,GAAG,GAAG,EAAE,GAAG,GAAG,IAAI;IAC/D,MAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,UAAU,CAAA;IACjD,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,GAAG,CAAC,CAAA;IACvC,OAAO,MAAM,CAAC,EAAE,CAAC,CAAA;AACnB,CAAC;AAED,kCAAkC;AAClC,SAAS,MAAM,CAAC,KAAa;IAC3B,MAAM,KAAK,GAAG,KAAK,GAAG,IAAI,CAAA;IAC1B,OAAO,KAAK,GAAG,WAAW,CAAC,CAAC,KAAK,EAAE,KAAK,CAAC,CAAA;AAC3C,CAAC;AAED,SAAS,WAAW,CAAC,IAAY,EAAE,EAAU;IAC3C,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE,GAAG,IAAI,CAAC,CAAA;IACxC,OAAO,IAAI,GAAG,IAAI,CAAA;AACpB,CAAC","ignoreList":[0]}},
    {"offset": {"line": 5617, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5622, "column": 0}, "map": {"version":3,"file":"types.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/types.ts"],"sourcesContent":["import { CID } from 'multiformats/cid'\nimport { z } from 'zod'\nimport { Def } from './check'\n\nconst cidSchema = z\n  .any()\n  .refine((obj: unknown) => CID.asCID(obj) !== null, {\n    message: 'Not a CID',\n  })\n  .transform((obj: unknown) => CID.asCID(obj) as CID)\n\nexport const schema = {\n  cid: cidSchema,\n  bytes: z.instanceof(Uint8Array),\n  string: z.string(),\n  array: z.array(z.unknown()),\n  map: z.record(z.string(), z.unknown()),\n  unknown: z.unknown(),\n}\n\nexport const def = {\n  cid: {\n    name: 'cid',\n    schema: schema.cid,\n  } as Def<CID>,\n  bytes: {\n    name: 'bytes',\n    schema: schema.bytes,\n  } as Def<Uint8Array>,\n  string: {\n    name: 'string',\n    schema: schema.string,\n  } as Def<string>,\n  map: {\n    name: 'map',\n    schema: schema.map,\n  } as Def<Record<string, unknown>>,\n  unknown: {\n    name: 'unknown',\n    schema: schema.unknown,\n  } as Def<unknown>,\n}\n\nexport type ArrayEl<A> = A extends readonly (infer T)[] ? T : never\n\nexport type NotEmptyArray<T> = [T, ...T[]]\n"],"names":[],"mappings":";;;;;AAAA,MAAA,oCAAsC;AACtC,MAAA,uBAAuB;AAGvB,MAAM,SAAS,GAAG,MAAA,CAAC,CAChB,GAAG,EAAE,CACL,MAAM,CAAC,CAAC,GAAY,EAAE,CAAG,CAAD,KAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,IAAI,EAAE;IACjD,OAAO,EAAE,WAAW;CACrB,CAAC,CACD,SAAS,CAAC,CAAC,GAAY,EAAE,CAAG,CAAD,KAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAQ,CAAC,CAAA;AAExC,QAAA,MAAM,GAAG;IACpB,GAAG,EAAE,SAAS;IACd,KAAK,EAAE,MAAA,CAAC,CAAC,UAAU,CAAC,UAAU,CAAC;IAC/B,MAAM,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;IAClB,KAAK,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,MAAA,CAAC,CAAC,OAAO,EAAE,CAAC;IAC3B,GAAG,EAAE,MAAA,CAAC,CAAC,MAAM,CAAC,MAAA,CAAC,CAAC,MAAM,EAAE,EAAE,MAAA,CAAC,CAAC,OAAO,EAAE,CAAC;IACtC,OAAO,EAAE,MAAA,CAAC,CAAC,OAAO,EAAE;CACrB,CAAA;AAEY,QAAA,GAAG,GAAG;IACjB,GAAG,EAAE;QACH,IAAI,EAAE,KAAK;QACX,MAAM,EAAE,QAAA,MAAM,CAAC,GAAG;KACP;IACb,KAAK,EAAE;QACL,IAAI,EAAE,OAAO;QACb,MAAM,EAAE,QAAA,MAAM,CAAC,KAAK;KACF;IACpB,MAAM,EAAE;QACN,IAAI,EAAE,QAAQ;QACd,MAAM,EAAE,QAAA,MAAM,CAAC,MAAM;KACP;IAChB,GAAG,EAAE;QACH,IAAI,EAAE,KAAK;QACX,MAAM,EAAE,QAAA,MAAM,CAAC,GAAG;KACa;IACjC,OAAO,EAAE;QACP,IAAI,EAAE,SAAS;QACf,MAAM,EAAE,QAAA,MAAM,CAAC,OAAO;KACP;CAClB,CAAA","ignoreList":[0]}},
    {"offset": {"line": 5662, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5667, "column": 0}, "map": {"version":3,"file":"times.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/times.ts"],"sourcesContent":["export const SECOND = 1000\nexport const MINUTE = SECOND * 60\nexport const HOUR = MINUTE * 60\nexport const DAY = HOUR * 24\n\nexport const lessThanAgoMs = (time: Date, range: number) => {\n  return Date.now() < time.getTime() + range\n}\n\nexport const addHoursToDate = (hours: number, startingDate?: Date): Date => {\n  // When date is passed, clone before calling `setHours()` so that we are not mutating the original date\n  const currentDate = startingDate ? new Date(startingDate) : new Date()\n  currentDate.setHours(currentDate.getHours() + hours)\n  return currentDate\n}\n"],"names":[],"mappings":";;;;;AAAa,QAAA,MAAM,GAAG,IAAI,CAAA;AACb,QAAA,MAAM,GAAG,QAAA,MAAM,GAAG,EAAE,CAAA;AACpB,QAAA,IAAI,GAAG,QAAA,MAAM,GAAG,EAAE,CAAA;AAClB,QAAA,GAAG,GAAG,QAAA,IAAI,GAAG,EAAE,CAAA;AAErB,MAAM,aAAa,GAAG,CAAC,IAAU,EAAE,KAAa,EAAE,EAAE;IACzD,OAAO,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,OAAO,EAAE,GAAG,KAAK,CAAA;AAC5C,CAAC,CAAA;AAFY,QAAA,aAAa,GAAA,cAEzB;AAEM,MAAM,cAAc,GAAG,CAAC,KAAa,EAAE,YAAmB,EAAQ,EAAE;IACzE,uGAAuG;IACvG,MAAM,WAAW,GAAG,YAAY,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,EAAE,CAAA;IACtE,WAAW,CAAC,QAAQ,CAAC,WAAW,CAAC,QAAQ,EAAE,GAAG,KAAK,CAAC,CAAA;IACpD,OAAO,WAAW,CAAA;AACpB,CAAC,CAAA;AALY,QAAA,cAAc,GAAA,eAK1B","ignoreList":[0]}},
    {"offset": {"line": 5687, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5692, "column": 0}, "map": {"version":3,"file":"strings.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/strings.ts"],"sourcesContent":["import Graphemer from 'graphemer'\nimport * as ui8 from 'uint8arrays'\n\n// counts the number of bytes in a utf8 string\nexport const utf8Len = (str: string): number => {\n  return new TextEncoder().encode(str).byteLength\n}\n\n// counts the number of graphemes (user-displayed characters) in a string\nexport const graphemeLen = (str: string): number => {\n  const splitter = new Graphemer()\n  return splitter.countGraphemes(str)\n}\n\nexport const utf8ToB64Url = (utf8: string): string => {\n  return ui8.toString(ui8.fromString(utf8, 'utf8'), 'base64url')\n}\n\nexport const b64UrlToUtf8 = (b64: string): string => {\n  return ui8.toString(ui8.fromString(b64, 'base64url'), 'utf8')\n}\n\nexport const parseLanguage = (langTag: string): LanguageTag | null => {\n  const parsed = langTag.match(bcp47Regexp)\n  if (!parsed?.groups) return null\n  const parts = parsed.groups\n  return {\n    grandfathered: parts.grandfathered,\n    language: parts.language,\n    extlang: parts.extlang,\n    script: parts.script,\n    region: parts.region,\n    variant: parts.variant,\n    extension: parts.extension,\n    privateUse: parts.privateUseA || parts.privateUseB,\n  }\n}\n\nexport const validateLanguage = (langTag: string): boolean => {\n  return bcp47Regexp.test(langTag)\n}\n\nexport type LanguageTag = {\n  grandfathered?: string\n  language?: string\n  extlang?: string\n  script?: string\n  region?: string\n  variant?: string\n  extension?: string\n  privateUse?: string\n}\n\n// Validates well-formed BCP 47 syntax: https://www.rfc-editor.org/rfc/rfc5646.html#section-2.1\nconst bcp47Regexp =\n  /^((?<grandfathered>(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))|((?<language>([A-Za-z]{2,3}(-(?<extlang>[A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-(?<script>[A-Za-z]{4}))?(-(?<region>[A-Za-z]{2}|[0-9]{3}))?(-(?<variant>[A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-(?<extension>[0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(?<privateUseA>x(-[A-Za-z0-9]{1,8})+))?)|(?<privateUseB>x(-[A-Za-z0-9]{1,8})+))$/\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAA,cAAA,sCAAiC;AACjC,MAAA,MAAA,qCAAkC;AAElC,8CAA8C;AACvC,MAAM,OAAO,GAAG,CAAC,GAAW,EAAU,EAAE;IAC7C,OAAO,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,UAAU,CAAA;AACjD,CAAC,CAAA;AAFY,QAAA,OAAO,GAAA,QAEnB;AAED,yEAAyE;AAClE,MAAM,WAAW,GAAG,CAAC,GAAW,EAAU,EAAE;IACjD,MAAM,QAAQ,GAAG,IAAI,YAAA,OAAS,EAAE,CAAA;IAChC,OAAO,QAAQ,CAAC,cAAc,CAAC,GAAG,CAAC,CAAA;AACrC,CAAC,CAAA;AAHY,QAAA,WAAW,GAAA,YAGvB;AAEM,MAAM,YAAY,GAAG,CAAC,IAAY,EAAU,EAAE;IACnD,OAAO,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,EAAE,MAAM,CAAC,EAAE,WAAW,CAAC,CAAA;AAChE,CAAC,CAAA;AAFY,QAAA,YAAY,GAAA,aAExB;AAEM,MAAM,YAAY,GAAG,CAAC,GAAW,EAAU,EAAE;IAClD,OAAO,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,EAAE,WAAW,CAAC,EAAE,MAAM,CAAC,CAAA;AAC/D,CAAC,CAAA;AAFY,QAAA,YAAY,GAAA,aAExB;AAEM,MAAM,aAAa,GAAG,CAAC,OAAe,EAAsB,EAAE;IACnE,MAAM,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA;IACzC,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,OAAO,IAAI,CAAA;IAChC,MAAM,KAAK,GAAG,MAAM,CAAC,MAAM,CAAA;IAC3B,OAAO;QACL,aAAa,EAAE,KAAK,CAAC,aAAa;QAClC,QAAQ,EAAE,KAAK,CAAC,QAAQ;QACxB,OAAO,EAAE,KAAK,CAAC,OAAO;QACtB,MAAM,EAAE,KAAK,CAAC,MAAM;QACpB,MAAM,EAAE,KAAK,CAAC,MAAM;QACpB,OAAO,EAAE,KAAK,CAAC,OAAO;QACtB,SAAS,EAAE,KAAK,CAAC,SAAS;QAC1B,UAAU,EAAE,KAAK,CAAC,WAAW,IAAI,KAAK,CAAC,WAAW;KACnD,CAAA;AACH,CAAC,CAAA;AAdY,QAAA,aAAa,GAAA,cAczB;AAEM,MAAM,gBAAgB,GAAG,CAAC,OAAe,EAAW,EAAE;IAC3D,OAAO,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;AAClC,CAAC,CAAA;AAFY,QAAA,gBAAgB,GAAA,iBAE5B;AAaD,+FAA+F;AAC/F,MAAM,WAAW,GACf,mlBAAmlB,CAAA","ignoreList":[0]}},
    {"offset": {"line": 5778, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5783, "column": 0}, "map": {"version":3,"file":"did-doc.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/did-doc.ts"],"sourcesContent":["import { z } from 'zod'\n\n// Parsing atproto data\n// --------\n\nexport const isValidDidDoc = (doc: unknown): doc is DidDocument => {\n  return didDocument.safeParse(doc).success\n}\n\nexport const getDid = (doc: DidDocument): string => {\n  const id = doc.id\n  if (typeof id !== 'string') {\n    throw new Error('No `id` on document')\n  }\n  return id\n}\n\nexport const getHandle = (doc: DidDocument): string | undefined => {\n  const aka = doc.alsoKnownAs\n  if (aka) {\n    for (let i = 0; i < aka.length; i++) {\n      const alias = aka[i]\n      if (alias.startsWith('at://')) {\n        // strip off \"at://\" prefix\n        return alias.slice(5)\n      }\n    }\n  }\n  return undefined\n}\n\n// @NOTE we parse to type/publicKeyMultibase to avoid the dependency on @atproto/crypto\nexport const getSigningKey = (\n  doc: DidDocument,\n): { type: string; publicKeyMultibase: string } | undefined => {\n  return getVerificationMaterial(doc, 'atproto')\n}\n\nexport const getVerificationMaterial = (\n  doc: DidDocument,\n  keyId: string,\n): { type: string; publicKeyMultibase: string } | undefined => {\n  // /!\\ Hot path\n\n  const key = findItemById(doc, 'verificationMethod', `#${keyId}`)\n  if (!key) {\n    return undefined\n  }\n\n  if (!key.publicKeyMultibase) {\n    return undefined\n  }\n\n  return {\n    type: key.type,\n    publicKeyMultibase: key.publicKeyMultibase,\n  }\n}\n\nexport const getSigningDidKey = (doc: DidDocument): string | undefined => {\n  const parsed = getSigningKey(doc)\n  if (!parsed) return\n  return `did:key:${parsed.publicKeyMultibase}`\n}\n\nexport const getPdsEndpoint = (doc: DidDocument): string | undefined => {\n  return getServiceEndpoint(doc, {\n    id: '#atproto_pds',\n    type: 'AtprotoPersonalDataServer',\n  })\n}\n\nexport const getFeedGenEndpoint = (doc: DidDocument): string | undefined => {\n  return getServiceEndpoint(doc, {\n    id: '#bsky_fg',\n    type: 'BskyFeedGenerator',\n  })\n}\n\nexport const getNotifEndpoint = (doc: DidDocument): string | undefined => {\n  return getServiceEndpoint(doc, {\n    id: '#bsky_notif',\n    type: 'BskyNotificationService',\n  })\n}\n\nexport const getServiceEndpoint = (\n  doc: DidDocument,\n  opts: { id: string; type?: string },\n) => {\n  // /!\\ Hot path\n\n  const service = findItemById(doc, 'service', opts.id)\n  if (!service) {\n    return undefined\n  }\n\n  if (opts.type && service.type !== opts.type) {\n    return undefined\n  }\n\n  if (typeof service.serviceEndpoint !== 'string') {\n    return undefined\n  }\n\n  return validateUrl(service.serviceEndpoint)\n}\n\nfunction findItemById<\n  D extends DidDocument,\n  T extends 'verificationMethod' | 'service',\n>(doc: D, type: T, id: string): NonNullable<D[T]>[number] | undefined\nfunction findItemById(\n  doc: DidDocument,\n  type: 'verificationMethod' | 'service',\n  id: string,\n) {\n  // /!\\ Hot path\n\n  const items = doc[type]\n  if (items) {\n    for (let i = 0; i < items.length; i++) {\n      const item = items[i]\n      const itemId = item.id\n\n      if (\n        itemId[0] === '#'\n          ? itemId === id\n          : // Optimized version of: itemId === `${doc.id}${id}`\n            itemId.length === doc.id.length + id.length &&\n            itemId[doc.id.length] === '#' &&\n            itemId.endsWith(id) &&\n            itemId.startsWith(doc.id) // <== We could probably skip this check\n      ) {\n        return item\n      }\n    }\n  }\n  return undefined\n}\n\n// Check protocol and hostname to prevent potential SSRF\nconst validateUrl = (urlStr: string): string | undefined => {\n  if (!urlStr.startsWith('http://') && !urlStr.startsWith('https://')) {\n    return undefined\n  }\n\n  if (!canParseUrl(urlStr)) {\n    return undefined\n  }\n\n  return urlStr\n}\n\nconst canParseUrl =\n  URL.canParse ??\n  // URL.canParse is not available in Node.js < 18.17.0\n  ((urlStr: string): boolean => {\n    try {\n      new URL(urlStr)\n      return true\n    } catch {\n      return false\n    }\n  })\n\n// Types\n// --------\n\nconst verificationMethod = z.object({\n  id: z.string(),\n  type: z.string(),\n  controller: z.string(),\n  publicKeyMultibase: z.string().optional(),\n})\n\nconst service = z.object({\n  id: z.string(),\n  type: z.string(),\n  serviceEndpoint: z.union([z.string(), z.record(z.unknown())]),\n})\n\nexport const didDocument = z.object({\n  id: z.string(),\n  alsoKnownAs: z.array(z.string()).optional(),\n  verificationMethod: z.array(verificationMethod).optional(),\n  service: z.array(service).optional(),\n})\n\nexport type DidDocument = z.infer<typeof didDocument>\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 5935, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5940, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/common-web/src/index.ts"],"sourcesContent":["export * as check from './check'\nexport * as util from './util'\n\nexport * from './arrays'\nexport * from './async'\nexport * from './util'\nexport * from './tid'\nexport * from './ipld'\nexport * from './retry'\nexport * from './types'\nexport * from './times'\nexport * from './strings'\nexport * from './did-doc'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,QAAA,KAAA,GAAA,iCAAgC;AAChC,QAAA,IAAA,GAAA,gCAA8B;AAE9B,2HAAA,SAAwB;AACxB,0HAAA,SAAuB;AACvB,yHAAA,SAAsB;AACtB,wHAAA,SAAqB;AACrB,yHAAA,SAAsB;AACtB,0HAAA,SAAuB;AACvB,0HAAA,SAAuB;AACvB,0HAAA,SAAuB;AACvB,4HAAA,SAAyB;AACzB,4HAAA,SAAyB","ignoreList":[0]}},
    {"offset": {"line": 5993, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5999, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/vendor/varint.js"],"sourcesContent":["var encode_1 = encode;\nvar MSB = 128, REST = 127, MSBALL = ~REST, INT = Math.pow(2, 31);\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n  while (num >= INT) {\n    out[offset++] = num & 255 | MSB;\n    num /= 128;\n  }\n  while (num & MSBALL) {\n    out[offset++] = num & 255 | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  encode.bytes = offset - oldOffset + 1;\n  return out;\n}\nvar decode = read;\nvar MSB$1 = 128, REST$1 = 127;\nfunction read(buf, offset) {\n  var res = 0, offset = offset || 0, shift = 0, counter = offset, b, l = buf.length;\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint');\n    }\n    b = buf[counter++];\n    res += shift < 28 ? (b & REST$1) << shift : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1);\n  read.bytes = counter - offset;\n  return res;\n}\nvar N1 = Math.pow(2, 7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\nvar length = function (value) {\n  return value < N1 ? 1 : value < N2 ? 2 : value < N3 ? 3 : value < N4 ? 4 : value < N5 ? 5 : value < N6 ? 6 : value < N7 ? 7 : value < N8 ? 8 : value < N9 ? 9 : 10;\n};\nvar varint = {\n  encode: encode_1,\n  decode: decode,\n  encodingLength: length\n};\nvar _brrp_varint = varint;\nexport default _brrp_varint;"],"names":[],"mappings":";;;AAAA,IAAI,WAAW;AACf,IAAI,MAAM,KAAK,OAAO,KAAK,SAAS,CAAC,MAAM,MAAM,KAAK,GAAG,CAAC,GAAG;AAC7D,SAAS,OAAO,GAAG,EAAE,GAAG,EAAE,MAAM;IAC9B,MAAM,OAAO,EAAE;IACf,SAAS,UAAU;IACnB,IAAI,YAAY;IAChB,MAAO,OAAO,IAAK;QACjB,GAAG,CAAC,SAAS,GAAG,MAAM,MAAM;QAC5B,OAAO;IACT;IACA,MAAO,MAAM,OAAQ;QACnB,GAAG,CAAC,SAAS,GAAG,MAAM,MAAM;QAC5B,SAAS;IACX;IACA,GAAG,CAAC,OAAO,GAAG,MAAM;IACpB,OAAO,KAAK,GAAG,SAAS,YAAY;IACpC,OAAO;AACT;AACA,IAAI,SAAS;AACb,IAAI,QAAQ,KAAK,SAAS;AAC1B,SAAS,KAAK,GAAG,EAAE,MAAM;IACvB,IAAI,MAAM,GAAG,SAAS,UAAU,GAAG,QAAQ,GAAG,UAAU,QAAQ,GAAG,IAAI,IAAI,MAAM;IACjF,GAAG;QACD,IAAI,WAAW,GAAG;YAChB,KAAK,KAAK,GAAG;YACb,MAAM,IAAI,WAAW;QACvB;QACA,IAAI,GAAG,CAAC,UAAU;QAClB,OAAO,QAAQ,KAAK,CAAC,IAAI,MAAM,KAAK,QAAQ,CAAC,IAAI,MAAM,IAAI,KAAK,GAAG,CAAC,GAAG;QACvE,SAAS;IACX,QAAS,KAAK,MAAO;IACrB,KAAK,KAAK,GAAG,UAAU;IACvB,OAAO;AACT;AACA,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG;AACrB,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG;AACrB,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG;AACrB,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG;AACrB,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG;AACrB,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG;AACrB,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG;AACrB,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG;AACrB,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG;AACrB,IAAI,SAAS,SAAU,KAAK;IAC1B,OAAO,QAAQ,KAAK,IAAI,QAAQ,KAAK,IAAI,QAAQ,KAAK,IAAI,QAAQ,KAAK,IAAI,QAAQ,KAAK,IAAI,QAAQ,KAAK,IAAI,QAAQ,KAAK,IAAI,QAAQ,KAAK,IAAI,QAAQ,KAAK,IAAI;AAClK;AACA,IAAI,SAAS;IACX,QAAQ;IACR,QAAQ;IACR,gBAAgB;AAClB;AACA,IAAI,eAAe;uCACJ","ignoreList":[0]}},
    {"offset": {"line": 6055, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6061, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/varint.js"],"sourcesContent":["import varint from '../vendor/varint.js';\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset);\n  return [\n    code,\n    varint.decode.bytes\n  ];\n};\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset);\n  return target;\n};\nexport const encodingLength = int => {\n  return varint.encodingLength(int);\n};"],"names":[],"mappings":";;;;;AAAA;;AACO,MAAM,SAAS,CAAC,MAAM,SAAS,CAAC;IACrC,MAAM,OAAO,0JAAA,CAAA,UAAM,CAAC,MAAM,CAAC,MAAM;IACjC,OAAO;QACL;QACA,0JAAA,CAAA,UAAM,CAAC,MAAM,CAAC,KAAK;KACpB;AACH;AACO,MAAM,WAAW,CAAC,KAAK,QAAQ,SAAS,CAAC;IAC9C,0JAAA,CAAA,UAAM,CAAC,MAAM,CAAC,KAAK,QAAQ;IAC3B,OAAO;AACT;AACO,MAAM,iBAAiB,CAAA;IAC5B,OAAO,0JAAA,CAAA,UAAM,CAAC,cAAc,CAAC;AAC/B","ignoreList":[0]}},
    {"offset": {"line": 6082, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6088, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bytes.js"],"sourcesContent":["const empty = new Uint8Array(0);\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '');\nconst fromHex = hex => {\n  const hexes = hex.match(/../g);\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty;\n};\nconst equals = (aa, bb) => {\n  if (aa === bb)\n    return true;\n  if (aa.byteLength !== bb.byteLength) {\n    return false;\n  }\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false;\n    }\n  }\n  return true;\n};\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array')\n    return o;\n  if (o instanceof ArrayBuffer)\n    return new Uint8Array(o);\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength);\n  }\n  throw new Error('Unknown type, must be binary type');\n};\nconst isBinary = o => o instanceof ArrayBuffer || ArrayBuffer.isView(o);\nconst fromString = str => new TextEncoder().encode(str);\nconst toString = b => new TextDecoder().decode(b);\nexport {\n  equals,\n  coerce,\n  isBinary,\n  fromHex,\n  toHex,\n  fromString,\n  toString,\n  empty\n};"],"names":[],"mappings":";;;;;;;;;;AAAA,MAAM,QAAQ,IAAI,WAAW;AAC7B,MAAM,QAAQ,CAAA,IAAK,EAAE,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,MAAM;AACrF,MAAM,UAAU,CAAA;IACd,MAAM,QAAQ,IAAI,KAAK,CAAC;IACxB,OAAO,QAAQ,IAAI,WAAW,MAAM,GAAG,CAAC,CAAA,IAAK,SAAS,GAAG,QAAQ;AACnE;AACA,MAAM,SAAS,CAAC,IAAI;IAClB,IAAI,OAAO,IACT,OAAO;IACT,IAAI,GAAG,UAAU,KAAK,GAAG,UAAU,EAAE;QACnC,OAAO;IACT;IACA,IAAK,IAAI,KAAK,GAAG,KAAK,GAAG,UAAU,EAAE,KAAM;QACzC,IAAI,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,GAAG,EAAE;YACrB,OAAO;QACT;IACF;IACA,OAAO;AACT;AACA,MAAM,SAAS,CAAA;IACb,IAAI,aAAa,cAAc,EAAE,WAAW,CAAC,IAAI,KAAK,cACpD,OAAO;IACT,IAAI,aAAa,aACf,OAAO,IAAI,WAAW;IACxB,IAAI,YAAY,MAAM,CAAC,IAAI;QACzB,OAAO,IAAI,WAAW,EAAE,MAAM,EAAE,EAAE,UAAU,EAAE,EAAE,UAAU;IAC5D;IACA,MAAM,IAAI,MAAM;AAClB;AACA,MAAM,WAAW,CAAA,IAAK,aAAa,eAAe,YAAY,MAAM,CAAC;AACrE,MAAM,aAAa,CAAA,MAAO,IAAI,cAAc,MAAM,CAAC;AACnD,MAAM,WAAW,CAAA,IAAK,IAAI,cAAc,MAAM,CAAC","ignoreList":[0]}},
    {"offset": {"line": 6128, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6134, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/hashes/digest.js"],"sourcesContent":["import {\n  coerce,\n  equals as equalBytes\n} from '../bytes.js';\nimport * as varint from '../varint.js';\nexport const create = (code, digest) => {\n  const size = digest.byteLength;\n  const sizeOffset = varint.encodingLength(code);\n  const digestOffset = sizeOffset + varint.encodingLength(size);\n  const bytes = new Uint8Array(digestOffset + size);\n  varint.encodeTo(code, bytes, 0);\n  varint.encodeTo(size, bytes, sizeOffset);\n  bytes.set(digest, digestOffset);\n  return new Digest(code, size, digest, bytes);\n};\nexport const decode = multihash => {\n  const bytes = coerce(multihash);\n  const [code, sizeOffset] = varint.decode(bytes);\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset));\n  const digest = bytes.subarray(sizeOffset + digestOffset);\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length');\n  }\n  return new Digest(code, size, digest, bytes);\n};\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true;\n  } else {\n    return a.code === b.code && a.size === b.size && equalBytes(a.bytes, b.bytes);\n  }\n};\nexport class Digest {\n  constructor(code, size, digest, bytes) {\n    this.code = code;\n    this.size = size;\n    this.digest = digest;\n    this.bytes = bytes;\n  }\n}"],"names":[],"mappings":";;;;;;AAAA;AAIA;;;AACO,MAAM,SAAS,CAAC,MAAM;IAC3B,MAAM,OAAO,OAAO,UAAU;IAC9B,MAAM,aAAa,wJAAO,cAAc,CAAC;IACzC,MAAM,eAAe,aAAa,wJAAO,cAAc,CAAC;IACxD,MAAM,QAAQ,IAAI,WAAW,eAAe;IAC5C,wJAAO,QAAQ,CAAC,MAAM,OAAO;IAC7B,wJAAO,QAAQ,CAAC,MAAM,OAAO;IAC7B,MAAM,GAAG,CAAC,QAAQ;IAClB,OAAO,IAAI,OAAO,MAAM,MAAM,QAAQ;AACxC;AACO,MAAM,SAAS,CAAA;IACpB,MAAM,QAAQ,CAAA,GAAA,sJAAA,CAAA,SAAM,AAAD,EAAE;IACrB,MAAM,CAAC,MAAM,WAAW,GAAG,wJAAO,MAAM,CAAC;IACzC,MAAM,CAAC,MAAM,aAAa,GAAG,wJAAO,MAAM,CAAC,MAAM,QAAQ,CAAC;IAC1D,MAAM,SAAS,MAAM,QAAQ,CAAC,aAAa;IAC3C,IAAI,OAAO,UAAU,KAAK,MAAM;QAC9B,MAAM,IAAI,MAAM;IAClB;IACA,OAAO,IAAI,OAAO,MAAM,MAAM,QAAQ;AACxC;AACO,MAAM,SAAS,CAAC,GAAG;IACxB,IAAI,MAAM,GAAG;QACX,OAAO;IACT,OAAO;QACL,OAAO,EAAE,IAAI,KAAK,EAAE,IAAI,IAAI,EAAE,IAAI,KAAK,EAAE,IAAI,IAAI,CAAA,GAAA,sJAAA,CAAA,SAAU,AAAD,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK;IAC9E;AACF;AACO,MAAM;IACX,YAAY,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,CAAE;QACrC,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,KAAK,GAAG;IACf;AACF","ignoreList":[0]}},
    {"offset": {"line": 6179, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6185, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/vendor/base-x.js"],"sourcesContent":["function base(ALPHABET, name) {\n  if (ALPHABET.length >= 255) {\n    throw new TypeError('Alphabet too long');\n  }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) {\n      throw new TypeError(x + ' is ambiguous');\n    }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256);\n  var iFACTOR = Math.log(256) / Math.log(BASE);\n  function encode(source) {\n    if (source instanceof Uint8Array);\n    else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) {\n      throw new TypeError('Expected Uint8Array');\n    }\n    if (source.length === 0) {\n      return '';\n    }\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n    var size = (pend - pbegin) * iFACTOR + 1 >>> 0;\n    var b58 = new Uint8Array(size);\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && it1 !== -1; it1--, i++) {\n        carry += 256 * b58[it1] >>> 0;\n        b58[it1] = carry % BASE >>> 0;\n        carry = carry / BASE >>> 0;\n      }\n      if (carry !== 0) {\n        throw new Error('Non-zero carry');\n      }\n      length = i;\n      pbegin++;\n    }\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) {\n      str += ALPHABET.charAt(b58[it2]);\n    }\n    return str;\n  }\n  function decodeUnsafe(source) {\n    if (typeof source !== 'string') {\n      throw new TypeError('Expected String');\n    }\n    if (source.length === 0) {\n      return new Uint8Array();\n    }\n    var psz = 0;\n    if (source[psz] === ' ') {\n      return;\n    }\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n    var size = (source.length - psz) * FACTOR + 1 >>> 0;\n    var b256 = new Uint8Array(size);\n    while (source[psz]) {\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n      if (carry === 255) {\n        return;\n      }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && it3 !== -1; it3--, i++) {\n        carry += BASE * b256[it3] >>> 0;\n        b256[it3] = carry % 256 >>> 0;\n        carry = carry / 256 >>> 0;\n      }\n      if (carry !== 0) {\n        throw new Error('Non-zero carry');\n      }\n      length = i;\n      psz++;\n    }\n    if (source[psz] === ' ') {\n      return;\n    }\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch;\n  }\n  function decode(string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) {\n      return buffer;\n    }\n    throw new Error(`Non-${ name } character`);\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  };\n}\nvar src = base;\nvar _brrp__multiformats_scope_baseX = src;\nexport default _brrp__multiformats_scope_baseX;"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 6321, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6327, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base.js"],"sourcesContent":["import basex from '../../vendor/base-x.js';\nimport { coerce } from '../bytes.js';\nclass Encoder {\n  constructor(name, prefix, baseEncode) {\n    this.name = name;\n    this.prefix = prefix;\n    this.baseEncode = baseEncode;\n  }\n  encode(bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${ this.prefix }${ this.baseEncode(bytes) }`;\n    } else {\n      throw Error('Unknown type, must be binary type');\n    }\n  }\n}\nclass Decoder {\n  constructor(name, prefix, baseDecode) {\n    this.name = name;\n    this.prefix = prefix;\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character');\n    }\n    this.prefixCodePoint = prefix.codePointAt(0);\n    this.baseDecode = baseDecode;\n  }\n  decode(text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${ JSON.stringify(text) }, ${ this.name } decoder only supports inputs prefixed with ${ this.prefix }`);\n      }\n      return this.baseDecode(text.slice(this.prefix.length));\n    } else {\n      throw Error('Can only multibase decode strings');\n    }\n  }\n  or(decoder) {\n    return or(this, decoder);\n  }\n}\nclass ComposedDecoder {\n  constructor(decoders) {\n    this.decoders = decoders;\n  }\n  or(decoder) {\n    return or(this, decoder);\n  }\n  decode(input) {\n    const prefix = input[0];\n    const decoder = this.decoders[prefix];\n    if (decoder) {\n      return decoder.decode(input);\n    } else {\n      throw RangeError(`Unable to decode multibase string ${ JSON.stringify(input) }, only inputs prefixed with ${ Object.keys(this.decoders) } are supported`);\n    }\n  }\n}\nexport const or = (left, right) => new ComposedDecoder({\n  ...left.decoders || { [left.prefix]: left },\n  ...right.decoders || { [right.prefix]: right }\n});\nexport class Codec {\n  constructor(name, prefix, baseEncode, baseDecode) {\n    this.name = name;\n    this.prefix = prefix;\n    this.baseEncode = baseEncode;\n    this.baseDecode = baseDecode;\n    this.encoder = new Encoder(name, prefix, baseEncode);\n    this.decoder = new Decoder(name, prefix, baseDecode);\n  }\n  encode(input) {\n    return this.encoder.encode(input);\n  }\n  decode(input) {\n    return this.decoder.decode(input);\n  }\n}\nexport const from = ({name, prefix, encode, decode}) => new Codec(name, prefix, encode, decode);\nexport const baseX = ({prefix, name, alphabet}) => {\n  const {encode, decode} = basex(alphabet, name);\n  return from({\n    prefix,\n    name,\n    encode,\n    decode: text => coerce(decode(text))\n  });\n};\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  const codes = {};\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i;\n  }\n  let end = string.length;\n  while (string[end - 1] === '=') {\n    --end;\n  }\n  const out = new Uint8Array(end * bitsPerChar / 8 | 0);\n  let bits = 0;\n  let buffer = 0;\n  let written = 0;\n  for (let i = 0; i < end; ++i) {\n    const value = codes[string[i]];\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${ name } character`);\n    }\n    buffer = buffer << bitsPerChar | value;\n    bits += bitsPerChar;\n    if (bits >= 8) {\n      bits -= 8;\n      out[written++] = 255 & buffer >> bits;\n    }\n  }\n  if (bits >= bitsPerChar || 255 & buffer << 8 - bits) {\n    throw new SyntaxError('Unexpected end of data');\n  }\n  return out;\n};\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '=';\n  const mask = (1 << bitsPerChar) - 1;\n  let out = '';\n  let bits = 0;\n  let buffer = 0;\n  for (let i = 0; i < data.length; ++i) {\n    buffer = buffer << 8 | data[i];\n    bits += 8;\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar;\n      out += alphabet[mask & buffer >> bits];\n    }\n  }\n  if (bits) {\n    out += alphabet[mask & buffer << bitsPerChar - bits];\n  }\n  if (pad) {\n    while (out.length * bitsPerChar & 7) {\n      out += '=';\n    }\n  }\n  return out;\n};\nexport const rfc4648 = ({name, prefix, bitsPerChar, alphabet}) => {\n  return from({\n    prefix,\n    name,\n    encode(input) {\n      return encode(input, alphabet, bitsPerChar);\n    },\n    decode(input) {\n      return decode(input, alphabet, bitsPerChar, name);\n    }\n  });\n};"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 6493, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6499, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base58.js"],"sourcesContent":["import { baseX } from './base.js';\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n});\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n});"],"names":[],"mappings":";;;;AAAA;;AACO,MAAM,YAAY,CAAA,GAAA,8JAAA,CAAA,QAAK,AAAD,EAAE;IAC7B,MAAM;IACN,QAAQ;IACR,UAAU;AACZ;AACO,MAAM,eAAe,CAAA,GAAA,8JAAA,CAAA,QAAK,AAAD,EAAE;IAChC,MAAM;IACN,QAAQ;IACR,UAAU;AACZ","ignoreList":[0]}},
    {"offset": {"line": 6515, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6521, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base32.js"],"sourcesContent":["import { rfc4648 } from './base.js';\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n});\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n});\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n});\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n});\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n});\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n});\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n});\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n});\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n});"],"names":[],"mappings":";;;;;;;;;;;AAAA;;AACO,MAAM,SAAS,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC5B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,cAAc,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IACjC,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,YAAY,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC/B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,iBAAiB,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IACpC,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,YAAY,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC/B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,iBAAiB,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IACpC,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,eAAe,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAClC,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,oBAAoB,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IACvC,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,UAAU,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC7B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf","ignoreList":[0]}},
    {"offset": {"line": 6588, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6594, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/cid.js"],"sourcesContent":["import * as varint from './varint.js';\nimport * as Digest from './hashes/digest.js';\nimport { base58btc } from './bases/base58.js';\nimport { base32 } from './bases/base32.js';\nimport { coerce } from './bytes.js';\nexport class CID {\n  constructor(version, code, multihash, bytes) {\n    this.code = code;\n    this.version = version;\n    this.multihash = multihash;\n    this.bytes = bytes;\n    this.byteOffset = bytes.byteOffset;\n    this.byteLength = bytes.byteLength;\n    this.asCID = this;\n    this._baseCache = new Map();\n    Object.defineProperties(this, {\n      byteOffset: hidden,\n      byteLength: hidden,\n      code: readonly,\n      version: readonly,\n      multihash: readonly,\n      bytes: readonly,\n      _baseCache: hidden,\n      asCID: hidden\n    });\n  }\n  toV0() {\n    switch (this.version) {\n    case 0: {\n        return this;\n      }\n    default: {\n        const {code, multihash} = this;\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0');\n        }\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0');\n        }\n        return CID.createV0(multihash);\n      }\n    }\n  }\n  toV1() {\n    switch (this.version) {\n    case 0: {\n        const {code, digest} = this.multihash;\n        const multihash = Digest.create(code, digest);\n        return CID.createV1(this.code, multihash);\n      }\n    case 1: {\n        return this;\n      }\n    default: {\n        throw Error(`Can not convert CID version ${ this.version } to version 0. This is a bug please report`);\n      }\n    }\n  }\n  equals(other) {\n    return other && this.code === other.code && this.version === other.version && Digest.equals(this.multihash, other.multihash);\n  }\n  toString(base) {\n    const {bytes, version, _baseCache} = this;\n    switch (version) {\n    case 0:\n      return toStringV0(bytes, _baseCache, base || base58btc.encoder);\n    default:\n      return toStringV1(bytes, _baseCache, base || base32.encoder);\n    }\n  }\n  toJSON() {\n    return {\n      code: this.code,\n      version: this.version,\n      hash: this.multihash.bytes\n    };\n  }\n  get [Symbol.toStringTag]() {\n    return 'CID';\n  }\n  [Symbol.for('nodejs.util.inspect.custom')]() {\n    return 'CID(' + this.toString() + ')';\n  }\n  static isCID(value) {\n    deprecate(/^0\\.0/, IS_CID_DEPRECATION);\n    return !!(value && (value[cidSymbol] || value.asCID === value));\n  }\n  get toBaseEncodedString() {\n    throw new Error('Deprecated, use .toString()');\n  }\n  get codec() {\n    throw new Error('\"codec\" property is deprecated, use integer \"code\" property instead');\n  }\n  get buffer() {\n    throw new Error('Deprecated .buffer property, use .bytes to get Uint8Array instead');\n  }\n  get multibaseName() {\n    throw new Error('\"multibaseName\" property is deprecated');\n  }\n  get prefix() {\n    throw new Error('\"prefix\" property is deprecated');\n  }\n  static asCID(value) {\n    if (value instanceof CID) {\n      return value;\n    } else if (value != null && value.asCID === value) {\n      const {version, code, multihash, bytes} = value;\n      return new CID(version, code, multihash, bytes || encodeCID(version, code, multihash.bytes));\n    } else if (value != null && value[cidSymbol] === true) {\n      const {version, multihash, code} = value;\n      const digest = Digest.decode(multihash);\n      return CID.create(version, code, digest);\n    } else {\n      return null;\n    }\n  }\n  static create(version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported');\n    }\n    switch (version) {\n    case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(`Version 0 CID must use dag-pb (code: ${ DAG_PB_CODE }) block encoding`);\n        } else {\n          return new CID(version, code, digest, digest.bytes);\n        }\n      }\n    case 1: {\n        const bytes = encodeCID(version, code, digest.bytes);\n        return new CID(version, code, digest, bytes);\n      }\n    default: {\n        throw new Error('Invalid version');\n      }\n    }\n  }\n  static createV0(digest) {\n    return CID.create(0, DAG_PB_CODE, digest);\n  }\n  static createV1(code, digest) {\n    return CID.create(1, code, digest);\n  }\n  static decode(bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes);\n    if (remainder.length) {\n      throw new Error('Incorrect length');\n    }\n    return cid;\n  }\n  static decodeFirst(bytes) {\n    const specs = CID.inspectBytes(bytes);\n    const prefixSize = specs.size - specs.multihashSize;\n    const multihashBytes = coerce(bytes.subarray(prefixSize, prefixSize + specs.multihashSize));\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length');\n    }\n    const digestBytes = multihashBytes.subarray(specs.multihashSize - specs.digestSize);\n    const digest = new Digest.Digest(specs.multihashCode, specs.digestSize, digestBytes, multihashBytes);\n    const cid = specs.version === 0 ? CID.createV0(digest) : CID.createV1(specs.codec, digest);\n    return [\n      cid,\n      bytes.subarray(specs.size)\n    ];\n  }\n  static inspectBytes(initialBytes) {\n    let offset = 0;\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset));\n      offset += length;\n      return i;\n    };\n    let version = next();\n    let codec = DAG_PB_CODE;\n    if (version === 18) {\n      version = 0;\n      offset = 0;\n    } else if (version === 1) {\n      codec = next();\n    }\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${ version }`);\n    }\n    const prefixSize = offset;\n    const multihashCode = next();\n    const digestSize = next();\n    const size = offset + digestSize;\n    const multihashSize = size - prefixSize;\n    return {\n      version,\n      codec,\n      multihashCode,\n      digestSize,\n      multihashSize,\n      size\n    };\n  }\n  static parse(source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base);\n    const cid = CID.decode(bytes);\n    cid._baseCache.set(prefix, source);\n    return cid;\n  }\n}\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n  case 'Q': {\n      const decoder = base || base58btc;\n      return [\n        base58btc.prefix,\n        decoder.decode(`${ base58btc.prefix }${ source }`)\n      ];\n    }\n  case base58btc.prefix: {\n      const decoder = base || base58btc;\n      return [\n        base58btc.prefix,\n        decoder.decode(source)\n      ];\n    }\n  case base32.prefix: {\n      const decoder = base || base32;\n      return [\n        base32.prefix,\n        decoder.decode(source)\n      ];\n    }\n  default: {\n      if (base == null) {\n        throw Error('To parse non base32 or base58btc encoded CID multibase decoder must be provided');\n      }\n      return [\n        source[0],\n        base.decode(source)\n      ];\n    }\n  }\n};\nconst toStringV0 = (bytes, cache, base) => {\n  const {prefix} = base;\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${ base.name } encoding`);\n  }\n  const cid = cache.get(prefix);\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1);\n    cache.set(prefix, cid);\n    return cid;\n  } else {\n    return cid;\n  }\n};\nconst toStringV1 = (bytes, cache, base) => {\n  const {prefix} = base;\n  const cid = cache.get(prefix);\n  if (cid == null) {\n    const cid = base.encode(bytes);\n    cache.set(prefix, cid);\n    return cid;\n  } else {\n    return cid;\n  }\n};\nconst DAG_PB_CODE = 112;\nconst SHA_256_CODE = 18;\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version);\n  const hashOffset = codeOffset + varint.encodingLength(code);\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength);\n  varint.encodeTo(version, bytes, 0);\n  varint.encodeTo(code, bytes, codeOffset);\n  bytes.set(multihash, hashOffset);\n  return bytes;\n};\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID');\nconst readonly = {\n  writable: false,\n  configurable: false,\n  enumerable: true\n};\nconst hidden = {\n  writable: false,\n  enumerable: false,\n  configurable: false\n};\nconst version = '0.0.0-dev';\nconst deprecate = (range, message) => {\n  if (range.test(version)) {\n    console.warn(message);\n  } else {\n    throw new Error(message);\n  }\n};\nconst IS_CID_DEPRECATION = `CID.isCID(v) is deprecated and will be removed in the next major release.\nFollowing code pattern:\n\nif (CID.isCID(value)) {\n  doSomethingWithCID(value)\n}\n\nIs replaced with:\n\nconst cid = CID.asCID(value)\nif (cid) {\n  // Make sure to use cid instead of value\n  doSomethingWithCID(cid)\n}\n`;"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 6922, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6928, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/identity.js"],"sourcesContent":["import { from } from './base.js';\nimport {\n  fromString,\n  toString\n} from '../bytes.js';\nexport const identity = from({\n  prefix: '\\0',\n  name: 'identity',\n  encode: buf => toString(buf),\n  decode: str => fromString(str)\n});"],"names":[],"mappings":";;;AAAA;AACA;;;AAIO,MAAM,WAAW,CAAA,GAAA,8JAAA,CAAA,OAAI,AAAD,EAAE;IAC3B,QAAQ;IACR,MAAM;IACN,QAAQ,CAAA,MAAO,CAAA,GAAA,sJAAA,CAAA,WAAQ,AAAD,EAAE;IACxB,QAAQ,CAAA,MAAO,CAAA,GAAA,sJAAA,CAAA,aAAU,AAAD,EAAE;AAC5B","ignoreList":[0]}},
    {"offset": {"line": 6941, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6947, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base2.js"],"sourcesContent":["import { rfc4648 } from './base.js';\nexport const base2 = rfc4648({\n  prefix: '0',\n  name: 'base2',\n  alphabet: '01',\n  bitsPerChar: 1\n});"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,QAAQ,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC3B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf","ignoreList":[0]}},
    {"offset": {"line": 6958, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6964, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base8.js"],"sourcesContent":["import { rfc4648 } from './base.js';\nexport const base8 = rfc4648({\n  prefix: '7',\n  name: 'base8',\n  alphabet: '01234567',\n  bitsPerChar: 3\n});"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,QAAQ,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC3B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf","ignoreList":[0]}},
    {"offset": {"line": 6975, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6981, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base10.js"],"sourcesContent":["import { baseX } from './base.js';\nexport const base10 = baseX({\n  prefix: '9',\n  name: 'base10',\n  alphabet: '0123456789'\n});"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,SAAS,CAAA,GAAA,8JAAA,CAAA,QAAK,AAAD,EAAE;IAC1B,QAAQ;IACR,MAAM;IACN,UAAU;AACZ","ignoreList":[0]}},
    {"offset": {"line": 6991, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6997, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base16.js"],"sourcesContent":["import { rfc4648 } from './base.js';\nexport const base16 = rfc4648({\n  prefix: 'f',\n  name: 'base16',\n  alphabet: '0123456789abcdef',\n  bitsPerChar: 4\n});\nexport const base16upper = rfc4648({\n  prefix: 'F',\n  name: 'base16upper',\n  alphabet: '0123456789ABCDEF',\n  bitsPerChar: 4\n});"],"names":[],"mappings":";;;;AAAA;;AACO,MAAM,SAAS,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC5B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,cAAc,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IACjC,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf","ignoreList":[0]}},
    {"offset": {"line": 7015, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7021, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base36.js"],"sourcesContent":["import { baseX } from './base.js';\nexport const base36 = baseX({\n  prefix: 'k',\n  name: 'base36',\n  alphabet: '0123456789abcdefghijklmnopqrstuvwxyz'\n});\nexport const base36upper = baseX({\n  prefix: 'K',\n  name: 'base36upper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n});"],"names":[],"mappings":";;;;AAAA;;AACO,MAAM,SAAS,CAAA,GAAA,8JAAA,CAAA,QAAK,AAAD,EAAE;IAC1B,QAAQ;IACR,MAAM;IACN,UAAU;AACZ;AACO,MAAM,cAAc,CAAA,GAAA,8JAAA,CAAA,QAAK,AAAD,EAAE;IAC/B,QAAQ;IACR,MAAM;IACN,UAAU;AACZ","ignoreList":[0]}},
    {"offset": {"line": 7037, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7043, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base64.js"],"sourcesContent":["import { rfc4648 } from './base.js';\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n});\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n});\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n});\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n});"],"names":[],"mappings":";;;;;;AAAA;;AACO,MAAM,SAAS,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC5B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,YAAY,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC/B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,YAAY,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAC/B,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf;AACO,MAAM,eAAe,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE;IAClC,QAAQ;IACR,MAAM;IACN,UAAU;IACV,aAAa;AACf","ignoreList":[0]}},
    {"offset": {"line": 7075, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7081, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/bases/base256emoji.js"],"sourcesContent":["import { from } from './base.js';\nconst alphabet = Array.from('\\uD83D\\uDE80\\uD83E\\uDE90\\u2604\\uD83D\\uDEF0\\uD83C\\uDF0C\\uD83C\\uDF11\\uD83C\\uDF12\\uD83C\\uDF13\\uD83C\\uDF14\\uD83C\\uDF15\\uD83C\\uDF16\\uD83C\\uDF17\\uD83C\\uDF18\\uD83C\\uDF0D\\uD83C\\uDF0F\\uD83C\\uDF0E\\uD83D\\uDC09\\u2600\\uD83D\\uDCBB\\uD83D\\uDDA5\\uD83D\\uDCBE\\uD83D\\uDCBF\\uD83D\\uDE02\\u2764\\uD83D\\uDE0D\\uD83E\\uDD23\\uD83D\\uDE0A\\uD83D\\uDE4F\\uD83D\\uDC95\\uD83D\\uDE2D\\uD83D\\uDE18\\uD83D\\uDC4D\\uD83D\\uDE05\\uD83D\\uDC4F\\uD83D\\uDE01\\uD83D\\uDD25\\uD83E\\uDD70\\uD83D\\uDC94\\uD83D\\uDC96\\uD83D\\uDC99\\uD83D\\uDE22\\uD83E\\uDD14\\uD83D\\uDE06\\uD83D\\uDE44\\uD83D\\uDCAA\\uD83D\\uDE09\\u263A\\uD83D\\uDC4C\\uD83E\\uDD17\\uD83D\\uDC9C\\uD83D\\uDE14\\uD83D\\uDE0E\\uD83D\\uDE07\\uD83C\\uDF39\\uD83E\\uDD26\\uD83C\\uDF89\\uD83D\\uDC9E\\u270C\\u2728\\uD83E\\uDD37\\uD83D\\uDE31\\uD83D\\uDE0C\\uD83C\\uDF38\\uD83D\\uDE4C\\uD83D\\uDE0B\\uD83D\\uDC97\\uD83D\\uDC9A\\uD83D\\uDE0F\\uD83D\\uDC9B\\uD83D\\uDE42\\uD83D\\uDC93\\uD83E\\uDD29\\uD83D\\uDE04\\uD83D\\uDE00\\uD83D\\uDDA4\\uD83D\\uDE03\\uD83D\\uDCAF\\uD83D\\uDE48\\uD83D\\uDC47\\uD83C\\uDFB6\\uD83D\\uDE12\\uD83E\\uDD2D\\u2763\\uD83D\\uDE1C\\uD83D\\uDC8B\\uD83D\\uDC40\\uD83D\\uDE2A\\uD83D\\uDE11\\uD83D\\uDCA5\\uD83D\\uDE4B\\uD83D\\uDE1E\\uD83D\\uDE29\\uD83D\\uDE21\\uD83E\\uDD2A\\uD83D\\uDC4A\\uD83E\\uDD73\\uD83D\\uDE25\\uD83E\\uDD24\\uD83D\\uDC49\\uD83D\\uDC83\\uD83D\\uDE33\\u270B\\uD83D\\uDE1A\\uD83D\\uDE1D\\uD83D\\uDE34\\uD83C\\uDF1F\\uD83D\\uDE2C\\uD83D\\uDE43\\uD83C\\uDF40\\uD83C\\uDF37\\uD83D\\uDE3B\\uD83D\\uDE13\\u2B50\\u2705\\uD83E\\uDD7A\\uD83C\\uDF08\\uD83D\\uDE08\\uD83E\\uDD18\\uD83D\\uDCA6\\u2714\\uD83D\\uDE23\\uD83C\\uDFC3\\uD83D\\uDC90\\u2639\\uD83C\\uDF8A\\uD83D\\uDC98\\uD83D\\uDE20\\u261D\\uD83D\\uDE15\\uD83C\\uDF3A\\uD83C\\uDF82\\uD83C\\uDF3B\\uD83D\\uDE10\\uD83D\\uDD95\\uD83D\\uDC9D\\uD83D\\uDE4A\\uD83D\\uDE39\\uD83D\\uDDE3\\uD83D\\uDCAB\\uD83D\\uDC80\\uD83D\\uDC51\\uD83C\\uDFB5\\uD83E\\uDD1E\\uD83D\\uDE1B\\uD83D\\uDD34\\uD83D\\uDE24\\uD83C\\uDF3C\\uD83D\\uDE2B\\u26BD\\uD83E\\uDD19\\u2615\\uD83C\\uDFC6\\uD83E\\uDD2B\\uD83D\\uDC48\\uD83D\\uDE2E\\uD83D\\uDE46\\uD83C\\uDF7B\\uD83C\\uDF43\\uD83D\\uDC36\\uD83D\\uDC81\\uD83D\\uDE32\\uD83C\\uDF3F\\uD83E\\uDDE1\\uD83C\\uDF81\\u26A1\\uD83C\\uDF1E\\uD83C\\uDF88\\u274C\\u270A\\uD83D\\uDC4B\\uD83D\\uDE30\\uD83E\\uDD28\\uD83D\\uDE36\\uD83E\\uDD1D\\uD83D\\uDEB6\\uD83D\\uDCB0\\uD83C\\uDF53\\uD83D\\uDCA2\\uD83E\\uDD1F\\uD83D\\uDE41\\uD83D\\uDEA8\\uD83D\\uDCA8\\uD83E\\uDD2C\\u2708\\uD83C\\uDF80\\uD83C\\uDF7A\\uD83E\\uDD13\\uD83D\\uDE19\\uD83D\\uDC9F\\uD83C\\uDF31\\uD83D\\uDE16\\uD83D\\uDC76\\uD83E\\uDD74\\u25B6\\u27A1\\u2753\\uD83D\\uDC8E\\uD83D\\uDCB8\\u2B07\\uD83D\\uDE28\\uD83C\\uDF1A\\uD83E\\uDD8B\\uD83D\\uDE37\\uD83D\\uDD7A\\u26A0\\uD83D\\uDE45\\uD83D\\uDE1F\\uD83D\\uDE35\\uD83D\\uDC4E\\uD83E\\uDD32\\uD83E\\uDD20\\uD83E\\uDD27\\uD83D\\uDCCC\\uD83D\\uDD35\\uD83D\\uDC85\\uD83E\\uDDD0\\uD83D\\uDC3E\\uD83C\\uDF52\\uD83D\\uDE17\\uD83E\\uDD11\\uD83C\\uDF0A\\uD83E\\uDD2F\\uD83D\\uDC37\\u260E\\uD83D\\uDCA7\\uD83D\\uDE2F\\uD83D\\uDC86\\uD83D\\uDC46\\uD83C\\uDFA4\\uD83D\\uDE47\\uD83C\\uDF51\\u2744\\uD83C\\uDF34\\uD83D\\uDCA3\\uD83D\\uDC38\\uD83D\\uDC8C\\uD83D\\uDCCD\\uD83E\\uDD40\\uD83E\\uDD22\\uD83D\\uDC45\\uD83D\\uDCA1\\uD83D\\uDCA9\\uD83D\\uDC50\\uD83D\\uDCF8\\uD83D\\uDC7B\\uD83E\\uDD10\\uD83E\\uDD2E\\uD83C\\uDFBC\\uD83E\\uDD75\\uD83D\\uDEA9\\uD83C\\uDF4E\\uD83C\\uDF4A\\uD83D\\uDC7C\\uD83D\\uDC8D\\uD83D\\uDCE3\\uD83E\\uDD42');\nconst alphabetBytesToChars = alphabet.reduce((p, c, i) => {\n  p[i] = c;\n  return p;\n}, []);\nconst alphabetCharsToBytes = alphabet.reduce((p, c, i) => {\n  p[c.codePointAt(0)] = i;\n  return p;\n}, []);\nfunction encode(data) {\n  return data.reduce((p, c) => {\n    p += alphabetBytesToChars[c];\n    return p;\n  }, '');\n}\nfunction decode(str) {\n  const byts = [];\n  for (const char of str) {\n    const byt = alphabetCharsToBytes[char.codePointAt(0)];\n    if (byt === undefined) {\n      throw new Error(`Non-base256emoji character: ${ char }`);\n    }\n    byts.push(byt);\n  }\n  return new Uint8Array(byts);\n}\nexport const base256emoji = from({\n  prefix: '\\uD83D\\uDE80',\n  name: 'base256emoji',\n  encode,\n  decode\n});"],"names":[],"mappings":";;;AAAA;;AACA,MAAM,WAAW,MAAM,IAAI,CAAC;AAC5B,MAAM,uBAAuB,SAAS,MAAM,CAAC,CAAC,GAAG,GAAG;IAClD,CAAC,CAAC,EAAE,GAAG;IACP,OAAO;AACT,GAAG,EAAE;AACL,MAAM,uBAAuB,SAAS,MAAM,CAAC,CAAC,GAAG,GAAG;IAClD,CAAC,CAAC,EAAE,WAAW,CAAC,GAAG,GAAG;IACtB,OAAO;AACT,GAAG,EAAE;AACL,SAAS,OAAO,IAAI;IAClB,OAAO,KAAK,MAAM,CAAC,CAAC,GAAG;QACrB,KAAK,oBAAoB,CAAC,EAAE;QAC5B,OAAO;IACT,GAAG;AACL;AACA,SAAS,OAAO,GAAG;IACjB,MAAM,OAAO,EAAE;IACf,KAAK,MAAM,QAAQ,IAAK;QACtB,MAAM,MAAM,oBAAoB,CAAC,KAAK,WAAW,CAAC,GAAG;QACrD,IAAI,QAAQ,WAAW;YACrB,MAAM,IAAI,MAAM,CAAC,4BAA4B,EAAG,MAAO;QACzD;QACA,KAAK,IAAI,CAAC;IACZ;IACA,OAAO,IAAI,WAAW;AACxB;AACO,MAAM,eAAe,CAAA,GAAA,8JAAA,CAAA,OAAI,AAAD,EAAE;IAC/B,QAAQ;IACR,MAAM;IACN;IACA;AACF","ignoreList":[0]}},
    {"offset": {"line": 7118, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7124, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/hashes/hasher.js"],"sourcesContent":["import * as Digest from './digest.js';\nexport const from = ({name, code, encode}) => new Hasher(name, code, encode);\nexport class Hasher {\n  constructor(name, code, encode) {\n    this.name = name;\n    this.code = code;\n    this.encode = encode;\n  }\n  digest(input) {\n    if (input instanceof Uint8Array) {\n      const result = this.encode(input);\n      return result instanceof Uint8Array ? Digest.create(this.code, result) : result.then(digest => Digest.create(this.code, digest));\n    } else {\n      throw Error('Unknown type, must be binary type');\n    }\n  }\n}"],"names":[],"mappings":";;;;AAAA;;AACO,MAAM,OAAO,CAAC,EAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAC,GAAK,IAAI,OAAO,MAAM,MAAM;AAC9D,MAAM;IACX,YAAY,IAAI,EAAE,IAAI,EAAE,MAAM,CAAE;QAC9B,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,MAAM,GAAG;IAChB;IACA,OAAO,KAAK,EAAE;QACZ,IAAI,iBAAiB,YAAY;YAC/B,MAAM,SAAS,IAAI,CAAC,MAAM,CAAC;YAC3B,OAAO,kBAAkB,aAAa,kKAAO,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,UAAU,OAAO,IAAI,CAAC,CAAA,SAAU,kKAAO,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE;QAC1H,OAAO;YACL,MAAM,MAAM;QACd;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 7146, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7152, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/hashes/sha2-browser.js"],"sourcesContent":["import { from } from './hasher.js';\nconst sha = name => async data => new Uint8Array(await crypto.subtle.digest(name, data));\nexport const sha256 = from({\n  name: 'sha2-256',\n  code: 18,\n  encode: sha('SHA-256')\n});\nexport const sha512 = from({\n  name: 'sha2-512',\n  code: 19,\n  encode: sha('SHA-512')\n});"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,MAAM,CAAA,OAAQ,OAAM,OAAQ,IAAI,WAAW,MAAM,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM;AAC3E,MAAM,SAAS,CAAA,GAAA,iKAAA,CAAA,OAAI,AAAD,EAAE;IACzB,MAAM;IACN,MAAM;IACN,QAAQ,IAAI;AACd;AACO,MAAM,SAAS,CAAA,GAAA,iKAAA,CAAA,OAAI,AAAD,EAAE;IACzB,MAAM;IACN,MAAM;IACN,QAAQ,IAAI;AACd","ignoreList":[0]}},
    {"offset": {"line": 7169, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7175, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/hashes/identity.js"],"sourcesContent":["import { coerce } from '../bytes.js';\nimport * as Digest from './digest.js';\nconst code = 0;\nconst name = 'identity';\nconst encode = coerce;\nconst digest = input => Digest.create(code, encode(input));\nexport const identity = {\n  code,\n  name,\n  encode,\n  digest\n};"],"names":[],"mappings":";;;AAAA;AACA;;;AACA,MAAM,OAAO;AACb,MAAM,OAAO;AACb,MAAM,SAAS,sJAAA,CAAA,SAAM;AACrB,MAAM,SAAS,CAAA,QAAS,kKAAO,MAAM,CAAC,MAAM,OAAO;AAC5C,MAAM,WAAW;IACtB;IACA;IACA;IACA;AACF","ignoreList":[0]}},
    {"offset": {"line": 7192, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7198, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/codecs/raw.js"],"sourcesContent":["import { coerce } from '../bytes.js';\nexport const name = 'raw';\nexport const code = 85;\nexport const encode = node => coerce(node);\nexport const decode = data => coerce(data);"],"names":[],"mappings":";;;;;;AAAA;;AACO,MAAM,OAAO;AACb,MAAM,OAAO;AACb,MAAM,SAAS,CAAA,OAAQ,CAAA,GAAA,sJAAA,CAAA,SAAM,AAAD,EAAE;AAC9B,MAAM,SAAS,CAAA,OAAQ,CAAA,GAAA,sJAAA,CAAA,SAAM,AAAD,EAAE","ignoreList":[0]}},
    {"offset": {"line": 7210, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7216, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/codecs/json.js"],"sourcesContent":["const textEncoder = new TextEncoder();\nconst textDecoder = new TextDecoder();\nexport const name = 'json';\nexport const code = 512;\nexport const encode = node => textEncoder.encode(JSON.stringify(node));\nexport const decode = data => JSON.parse(textDecoder.decode(data));"],"names":[],"mappings":";;;;;;AAAA,MAAM,cAAc,IAAI;AACxB,MAAM,cAAc,IAAI;AACjB,MAAM,OAAO;AACb,MAAM,OAAO;AACb,MAAM,SAAS,CAAA,OAAQ,YAAY,MAAM,CAAC,KAAK,SAAS,CAAC;AACzD,MAAM,SAAS,CAAA,OAAQ,KAAK,KAAK,CAAC,YAAY,MAAM,CAAC","ignoreList":[0]}},
    {"offset": {"line": 7228, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7234, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 7241, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7260, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/multiformats/esm/src/basics.js"],"sourcesContent":["import * as identityBase from './bases/identity.js';\nimport * as base2 from './bases/base2.js';\nimport * as base8 from './bases/base8.js';\nimport * as base10 from './bases/base10.js';\nimport * as base16 from './bases/base16.js';\nimport * as base32 from './bases/base32.js';\nimport * as base36 from './bases/base36.js';\nimport * as base58 from './bases/base58.js';\nimport * as base64 from './bases/base64.js';\nimport * as base256emoji from './bases/base256emoji.js';\nimport * as sha2 from './hashes/sha2.js';\nimport * as identity from './hashes/identity.js';\nimport * as raw from './codecs/raw.js';\nimport * as json from './codecs/json.js';\nimport {\n  CID,\n  hasher,\n  digest,\n  varint,\n  bytes\n} from './index.js';\nconst bases = {\n  ...identityBase,\n  ...base2,\n  ...base8,\n  ...base10,\n  ...base16,\n  ...base32,\n  ...base36,\n  ...base58,\n  ...base64,\n  ...base256emoji\n};\nconst hashes = {\n  ...sha2,\n  ...identity\n};\nconst codecs = {\n  raw,\n  json\n};\nexport {\n  CID,\n  hasher,\n  digest,\n  varint,\n  bytes,\n  hashes,\n  bases,\n  codecs\n};"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AAQA,MAAM,QAAQ;IACZ,GAAG,kKAAY;IACf,GAAG,+JAAK;IACR,GAAG,+JAAK;IACR,GAAG,gKAAM;IACT,GAAG,gKAAM;IACT,GAAG,gKAAM;IACT,GAAG,gKAAM;IACT,GAAG,gKAAM;IACT,GAAG,gKAAM;IACT,GAAG,sKAAY;AACjB;AACA,MAAM,SAAS;IACb,GAAG,0KAAI;IACP,GAAG,mKAAQ;AACb;AACA,MAAM,SAAS;IACb,KAAA;IACA,MAAA;AACF","ignoreList":[0]}},
    {"offset": {"line": 7315, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7344, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/uint8arrays/esm/src/compare.js"],"sourcesContent":["export function compare(a, b) {\n  for (let i = 0; i < a.byteLength; i++) {\n    if (a[i] < b[i]) {\n      return -1;\n    }\n    if (a[i] > b[i]) {\n      return 1;\n    }\n  }\n  if (a.byteLength > b.byteLength) {\n    return 1;\n  }\n  if (a.byteLength < b.byteLength) {\n    return -1;\n  }\n  return 0;\n}"],"names":[],"mappings":";;;AAAO,SAAS,QAAQ,CAAC,EAAE,CAAC;IAC1B,IAAK,IAAI,IAAI,GAAG,IAAI,EAAE,UAAU,EAAE,IAAK;QACrC,IAAI,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE;YACf,OAAO,CAAC;QACV;QACA,IAAI,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE;YACf,OAAO;QACT;IACF;IACA,IAAI,EAAE,UAAU,GAAG,EAAE,UAAU,EAAE;QAC/B,OAAO;IACT;IACA,IAAI,EAAE,UAAU,GAAG,EAAE,UAAU,EAAE;QAC/B,OAAO,CAAC;IACV;IACA,OAAO;AACT","ignoreList":[0]}},
    {"offset": {"line": 7364, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7370, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/uint8arrays/esm/src/concat.js"],"sourcesContent":["export function concat(arrays, length) {\n  if (!length) {\n    length = arrays.reduce((acc, curr) => acc + curr.length, 0);\n  }\n  const output = new Uint8Array(length);\n  let offset = 0;\n  for (const arr of arrays) {\n    output.set(arr, offset);\n    offset += arr.length;\n  }\n  return output;\n}"],"names":[],"mappings":";;;AAAO,SAAS,OAAO,MAAM,EAAE,MAAM;IACnC,IAAI,CAAC,QAAQ;QACX,SAAS,OAAO,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,MAAM,EAAE;IAC3D;IACA,MAAM,SAAS,IAAI,WAAW;IAC9B,IAAI,SAAS;IACb,KAAK,MAAM,OAAO,OAAQ;QACxB,OAAO,GAAG,CAAC,KAAK;QAChB,UAAU,IAAI,MAAM;IACtB;IACA,OAAO;AACT","ignoreList":[0]}},
    {"offset": {"line": 7385, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7391, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/uint8arrays/esm/src/equals.js"],"sourcesContent":["export function equals(a, b) {\n  if (a === b) {\n    return true;\n  }\n  if (a.byteLength !== b.byteLength) {\n    return false;\n  }\n  for (let i = 0; i < a.byteLength; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}"],"names":[],"mappings":";;;AAAO,SAAS,OAAO,CAAC,EAAE,CAAC;IACzB,IAAI,MAAM,GAAG;QACX,OAAO;IACT;IACA,IAAI,EAAE,UAAU,KAAK,EAAE,UAAU,EAAE;QACjC,OAAO;IACT;IACA,IAAK,IAAI,IAAI,GAAG,IAAI,EAAE,UAAU,EAAE,IAAK;QACrC,IAAI,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,EAAE;YACjB,OAAO;QACT;IACF;IACA,OAAO;AACT","ignoreList":[0]}},
    {"offset": {"line": 7408, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7414, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/uint8arrays/esm/src/util/bases.js"],"sourcesContent":["import { bases } from 'multiformats/basics';\nfunction createCodec(name, prefix, encode, decode) {\n  return {\n    name,\n    prefix,\n    encoder: {\n      name,\n      prefix,\n      encode\n    },\n    decoder: { decode }\n  };\n}\nconst string = createCodec('utf8', 'u', buf => {\n  const decoder = new TextDecoder('utf8');\n  return 'u' + decoder.decode(buf);\n}, str => {\n  const encoder = new TextEncoder();\n  return encoder.encode(str.substring(1));\n});\nconst ascii = createCodec('ascii', 'a', buf => {\n  let string = 'a';\n  for (let i = 0; i < buf.length; i++) {\n    string += String.fromCharCode(buf[i]);\n  }\n  return string;\n}, str => {\n  str = str.substring(1);\n  const buf = new Uint8Array(str.length);\n  for (let i = 0; i < str.length; i++) {\n    buf[i] = str.charCodeAt(i);\n  }\n  return buf;\n});\nconst BASES = {\n  utf8: string,\n  'utf-8': string,\n  hex: bases.base16,\n  latin1: ascii,\n  ascii: ascii,\n  binary: ascii,\n  ...bases\n};\nexport default BASES;"],"names":[],"mappings":";;;AAAA;AAAA;;AACA,SAAS,YAAY,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM;IAC/C,OAAO;QACL;QACA;QACA,SAAS;YACP;YACA;YACA;QACF;QACA,SAAS;YAAE;QAAO;IACpB;AACF;AACA,MAAM,SAAS,YAAY,QAAQ,KAAK,CAAA;IACtC,MAAM,UAAU,IAAI,YAAY;IAChC,OAAO,MAAM,QAAQ,MAAM,CAAC;AAC9B,GAAG,CAAA;IACD,MAAM,UAAU,IAAI;IACpB,OAAO,QAAQ,MAAM,CAAC,IAAI,SAAS,CAAC;AACtC;AACA,MAAM,QAAQ,YAAY,SAAS,KAAK,CAAA;IACtC,IAAI,SAAS;IACb,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,MAAM,EAAE,IAAK;QACnC,UAAU,OAAO,YAAY,CAAC,GAAG,CAAC,EAAE;IACtC;IACA,OAAO;AACT,GAAG,CAAA;IACD,MAAM,IAAI,SAAS,CAAC;IACpB,MAAM,MAAM,IAAI,WAAW,IAAI,MAAM;IACrC,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,MAAM,EAAE,IAAK;QACnC,GAAG,CAAC,EAAE,GAAG,IAAI,UAAU,CAAC;IAC1B;IACA,OAAO;AACT;AACA,MAAM,QAAQ;IACZ,MAAM;IACN,SAAS;IACT,KAAK,uKAAA,CAAA,QAAK,CAAC,MAAM;IACjB,QAAQ;IACR,OAAO;IACP,QAAQ;IACR,GAAG,uKAAA,CAAA,QAAK;AACV;uCACe","ignoreList":[0]}},
    {"offset": {"line": 7465, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7471, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/uint8arrays/esm/src/from-string.js"],"sourcesContent":["import bases from './util/bases.js';\nexport function fromString(string, encoding = 'utf8') {\n  const base = bases[encoding];\n  if (!base) {\n    throw new Error(`Unsupported encoding \"${ encoding }\"`);\n  }\n  return base.decoder.decode(`${ base.prefix }${ string }`);\n}"],"names":[],"mappings":";;;AAAA;;AACO,SAAS,WAAW,MAAM,EAAE,WAAW,MAAM;IAClD,MAAM,OAAO,6JAAA,CAAA,UAAK,CAAC,SAAS;IAC5B,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAG,SAAU,CAAC,CAAC;IACxD;IACA,OAAO,KAAK,OAAO,CAAC,MAAM,CAAC,GAAI,KAAK,MAAM,GAAK,QAAS;AAC1D","ignoreList":[0]}},
    {"offset": {"line": 7483, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7489, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/uint8arrays/esm/src/to-string.js"],"sourcesContent":["import bases from './util/bases.js';\nexport function toString(array, encoding = 'utf8') {\n  const base = bases[encoding];\n  if (!base) {\n    throw new Error(`Unsupported encoding \"${ encoding }\"`);\n  }\n  return base.encoder.encode(array).substring(1);\n}"],"names":[],"mappings":";;;AAAA;;AACO,SAAS,SAAS,KAAK,EAAE,WAAW,MAAM;IAC/C,MAAM,OAAO,6JAAA,CAAA,UAAK,CAAC,SAAS;IAC5B,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAG,SAAU,CAAC,CAAC;IACxD;IACA,OAAO,KAAK,OAAO,CAAC,MAAM,CAAC,OAAO,SAAS,CAAC;AAC9C","ignoreList":[0]}},
    {"offset": {"line": 7501, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7507, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/uint8arrays/esm/src/xor.js"],"sourcesContent":["export function xor(a, b) {\n  if (a.length !== b.length) {\n    throw new Error('Inputs should have the same length');\n  }\n  const result = new Uint8Array(a.length);\n  for (let i = 0; i < a.length; i++) {\n    result[i] = a[i] ^ b[i];\n  }\n  return result;\n}"],"names":[],"mappings":";;;AAAO,SAAS,IAAI,CAAC,EAAE,CAAC;IACtB,IAAI,EAAE,MAAM,KAAK,EAAE,MAAM,EAAE;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,MAAM,SAAS,IAAI,WAAW,EAAE,MAAM;IACtC,IAAK,IAAI,IAAI,GAAG,IAAI,EAAE,MAAM,EAAE,IAAK;QACjC,MAAM,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE;IACzB;IACA,OAAO;AACT","ignoreList":[0]}},
    {"offset": {"line": 7520, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7526, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 7534, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7590, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/iso-datestring-validator/dist/index.js"],"sourcesContent":["(()=>{\"use strict\";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})}},t={};function r(e,t){return void 0===t&&(t=\"-\"),new RegExp(\"^(?!0{4}\"+t+\"0{2}\"+t+\"0{2})((?=[0-9]{4}\"+t+\"(((0[^2])|1[0-2])|02(?=\"+t+\"(([0-1][0-9])|2[0-8])))\"+t+\"[0-9]{2})|(?=((([13579][26])|([2468][048])|(0[48]))0{2})|([0-9]{2}((((0|[2468])[48])|[2468][048])|([13579][26])))\"+t+\"02\"+t+\"29))([0-9]{4})\"+t+\"(?!((0[469])|11)\"+t+\"31)((0[1,3-9]|1[0-2])|(02(?!\"+t+\"3)))\"+t+\"(0[1-9]|[1-2][0-9]|3[0-1])$\").test(e)}function n(e){var t=/\\D/.exec(e);return t?t[0]:\"\"}function i(e,t,r){void 0===t&&(t=\":\"),void 0===r&&(r=!1);var i=new RegExp(\"^([0-1]|2(?=([0-3])|4\"+t+\"00))[0-9]\"+t+\"[0-5][0-9](\"+t+\"([0-5]|6(?=0))[0-9])?(.[0-9]{1,9})?$\");if(!r||!/[Z+\\-]/.test(e))return i.test(e);if(/Z$/.test(e))return i.test(e.replace(\"Z\",\"\"));var o=e.includes(\"+\"),a=e.split(/[+-]/),u=a[0],d=a[1];return i.test(u)&&function(e,t,r){return void 0===r&&(r=\":\"),new RegExp(t?\"^(0(?!(2\"+r+\"4)|0\"+r+\"3)|1(?=([0-1]|2(?=\"+r+\"[04])|[34](?=\"+r+\"0))))([03469](?=\"+r+\"[03])|[17](?=\"+r+\"0)|2(?=\"+r+\"[04])|5(?=\"+r+\"[034])|8(?=\"+r+\"[04]))\"+r+\"([03](?=0)|4(?=5))[05]$\":\"^(0(?=[^0])|1(?=[0-2]))([39](?=\"+r+\"[03])|[0-24-8](?=\"+r+\"00))\"+r+\"[03]0$\").test(e)}(d,o,n(d))}function o(e){var t=e.split(\"T\"),o=t[0],a=t[1],u=r(o,n(o));if(!a)return!1;var d,s=(d=a.match(/([^Z+\\-\\d])(?=\\d+\\1)/),Array.isArray(d)?d[0]:\"\");return u&&i(a,s,!0)}function a(e,t){return void 0===t&&(t=\"-\"),new RegExp(\"^[0-9]{4}\"+t+\"(0(?=[^0])|1(?=[0-2]))[0-9]$\").test(e)}e.r(t),e.d(t,{isValidDate:()=>r,isValidISODateString:()=>o,isValidTime:()=>i,isValidYearMonth:()=>a});var u=exports;for(var d in t)u[d]=t[d];t.__esModule&&Object.defineProperty(u,\"__esModule\",{value:!0})})();"],"names":[],"mappings":"AAAA,CAAC;IAAK;IAAa,IAAI,IAAE;QAAC,GAAE,CAAC,GAAE;YAAK,IAAI,IAAI,KAAK,EAAE,EAAE,CAAC,CAAC,GAAE,MAAI,CAAC,EAAE,CAAC,CAAC,GAAE,MAAI,OAAO,cAAc,CAAC,GAAE,GAAE;gBAAC,YAAW,CAAC;gBAAE,KAAI,CAAC,CAAC,EAAE;YAAA;QAAE;QAAE,GAAE,CAAC,GAAE,IAAI,OAAO,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAE;QAAG,GAAE,CAAA;YAAI,eAAa,OAAO,UAAQ,OAAO,WAAW,IAAE,OAAO,cAAc,CAAC,GAAE,OAAO,WAAW,EAAC;gBAAC,OAAM;YAAQ,IAAG,OAAO,cAAc,CAAC,GAAE,cAAa;gBAAC,OAAM,CAAC;YAAC;QAAE;IAAC,GAAE,IAAE,CAAC;IAAE,SAAS,EAAE,CAAC,EAAC,CAAC;QAAE,OAAO,KAAK,MAAI,KAAG,CAAC,IAAE,GAAG,GAAE,IAAI,OAAO,aAAW,IAAE,SAAO,IAAE,sBAAoB,IAAE,4BAA0B,IAAE,4BAA0B,IAAE,sHAAoH,IAAE,OAAK,IAAE,mBAAiB,IAAE,qBAAmB,IAAE,iCAA+B,IAAE,SAAO,IAAE,+BAA+B,IAAI,CAAC;IAAE;IAAC,SAAS,EAAE,CAAC;QAAE,IAAI,IAAE,KAAK,IAAI,CAAC;QAAG,OAAO,IAAE,CAAC,CAAC,EAAE,GAAC;IAAE;IAAC,SAAS,EAAE,CAAC,EAAC,CAAC,EAAC,CAAC;QAAE,KAAK,MAAI,KAAG,CAAC,IAAE,GAAG,GAAE,KAAK,MAAI,KAAG,CAAC,IAAE,CAAC,CAAC;QAAE,IAAI,IAAE,IAAI,OAAO,0BAAwB,IAAE,cAAY,IAAE,gBAAc,IAAE;QAAwC,IAAG,CAAC,KAAG,CAAC,SAAS,IAAI,CAAC,IAAG,OAAO,EAAE,IAAI,CAAC;QAAG,IAAG,KAAK,IAAI,CAAC,IAAG,OAAO,EAAE,IAAI,CAAC,EAAE,OAAO,CAAC,KAAI;QAAK,IAAI,IAAE,EAAE,QAAQ,CAAC,MAAK,IAAE,EAAE,KAAK,CAAC,SAAQ,IAAE,CAAC,CAAC,EAAE,EAAC,IAAE,CAAC,CAAC,EAAE;QAAC,OAAO,EAAE,IAAI,CAAC,MAAI,SAAS,CAAC,EAAC,CAAC,EAAC,CAAC;YAAE,OAAO,KAAK,MAAI,KAAG,CAAC,IAAE,GAAG,GAAE,IAAI,OAAO,IAAE,aAAW,IAAE,SAAO,IAAE,uBAAqB,IAAE,kBAAgB,IAAE,qBAAmB,IAAE,kBAAgB,IAAE,YAAU,IAAE,eAAa,IAAE,gBAAc,IAAE,WAAS,IAAE,4BAA0B,oCAAkC,IAAE,sBAAoB,IAAE,SAAO,IAAE,UAAU,IAAI,CAAC;QAAE,EAAE,GAAE,GAAE,EAAE;IAAG;IAAC,SAAS,EAAE,CAAC;QAAE,IAAI,IAAE,EAAE,KAAK,CAAC,MAAK,IAAE,CAAC,CAAC,EAAE,EAAC,IAAE,CAAC,CAAC,EAAE,EAAC,IAAE,EAAE,GAAE,EAAE;QAAI,IAAG,CAAC,GAAE,OAAM,CAAC;QAAE,IAAI,GAAE,IAAE,CAAC,IAAE,EAAE,KAAK,CAAC,yBAAwB,MAAM,OAAO,CAAC,KAAG,CAAC,CAAC,EAAE,GAAC,EAAE;QAAE,OAAO,KAAG,EAAE,GAAE,GAAE,CAAC;IAAE;IAAC,SAAS,EAAE,CAAC,EAAC,CAAC;QAAE,OAAO,KAAK,MAAI,KAAG,CAAC,IAAE,GAAG,GAAE,IAAI,OAAO,cAAY,IAAE,gCAAgC,IAAI,CAAC;IAAE;IAAC,EAAE,CAAC,CAAC,IAAG,EAAE,CAAC,CAAC,GAAE;QAAC,aAAY,IAAI;QAAE,sBAAqB,IAAI;QAAE,aAAY,IAAI;QAAE,kBAAiB,IAAI;IAAC;IAAG,IAAI,IAAE;IAAQ,IAAI,IAAI,KAAK,EAAE,CAAC,CAAC,EAAE,GAAC,CAAC,CAAC,EAAE;IAAC,EAAE,UAAU,IAAE,OAAO,cAAc,CAAC,GAAE,cAAa;QAAC,OAAM,CAAC;IAAC;AAAE,CAAC","ignoreList":[0]}},
    {"offset": {"line": 7646, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7651, "column": 0}, "map": {"version":3,"file":"types.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/xrpc/src/types.ts"],"sourcesContent":["import { z } from 'zod'\nimport { ValidationError } from '@atproto/lexicon'\n\nexport type QueryParams = Record<string, any>\nexport type HeadersMap = Record<string, string>\n\nexport type {\n  /** @deprecated not to be confused with the WHATWG Headers constructor */\n  HeadersMap as Headers,\n}\n\nexport type Gettable<T> = T | (() => T)\n\nexport interface CallOptions {\n  encoding?: string\n  signal?: AbortSignal\n  headers?: HeadersMap\n}\n\nexport const errorResponseBody = z.object({\n  error: z.string().optional(),\n  message: z.string().optional(),\n})\nexport type ErrorResponseBody = z.infer<typeof errorResponseBody>\n\nexport enum ResponseType {\n  Unknown = 1,\n  InvalidResponse = 2,\n  Success = 200,\n  InvalidRequest = 400,\n  AuthRequired = 401,\n  Forbidden = 403,\n  XRPCNotSupported = 404,\n  NotAcceptable = 406,\n  PayloadTooLarge = 413,\n  UnsupportedMediaType = 415,\n  RateLimitExceeded = 429,\n  InternalServerError = 500,\n  MethodNotImplemented = 501,\n  UpstreamFailure = 502,\n  NotEnoughResources = 503,\n  UpstreamTimeout = 504,\n}\n\nexport function httpResponseCodeToEnum(status: number): ResponseType {\n  if (status in ResponseType) {\n    return status\n  } else if (status >= 100 && status < 200) {\n    return ResponseType.XRPCNotSupported\n  } else if (status >= 200 && status < 300) {\n    return ResponseType.Success\n  } else if (status >= 300 && status < 400) {\n    return ResponseType.XRPCNotSupported\n  } else if (status >= 400 && status < 500) {\n    return ResponseType.InvalidRequest\n  } else {\n    return ResponseType.InternalServerError\n  }\n}\n\nexport const ResponseTypeNames = {\n  [ResponseType.Unknown]: 'Unknown',\n  [ResponseType.InvalidResponse]: 'InvalidResponse',\n  [ResponseType.Success]: 'Success',\n  [ResponseType.InvalidRequest]: 'InvalidRequest',\n  [ResponseType.AuthRequired]: 'AuthenticationRequired',\n  [ResponseType.Forbidden]: 'Forbidden',\n  [ResponseType.XRPCNotSupported]: 'XRPCNotSupported',\n  [ResponseType.PayloadTooLarge]: 'PayloadTooLarge',\n  [ResponseType.UnsupportedMediaType]: 'UnsupportedMediaType',\n  [ResponseType.RateLimitExceeded]: 'RateLimitExceeded',\n  [ResponseType.InternalServerError]: 'InternalServerError',\n  [ResponseType.MethodNotImplemented]: 'MethodNotImplemented',\n  [ResponseType.UpstreamFailure]: 'UpstreamFailure',\n  [ResponseType.NotEnoughResources]: 'NotEnoughResources',\n  [ResponseType.UpstreamTimeout]: 'UpstreamTimeout',\n}\n\nexport function httpResponseCodeToName(status: number): string {\n  return ResponseTypeNames[httpResponseCodeToEnum(status)]\n}\n\nexport const ResponseTypeStrings = {\n  [ResponseType.Unknown]: 'Unknown',\n  [ResponseType.InvalidResponse]: 'Invalid Response',\n  [ResponseType.Success]: 'Success',\n  [ResponseType.InvalidRequest]: 'Invalid Request',\n  [ResponseType.AuthRequired]: 'Authentication Required',\n  [ResponseType.Forbidden]: 'Forbidden',\n  [ResponseType.XRPCNotSupported]: 'XRPC Not Supported',\n  [ResponseType.PayloadTooLarge]: 'Payload Too Large',\n  [ResponseType.UnsupportedMediaType]: 'Unsupported Media Type',\n  [ResponseType.RateLimitExceeded]: 'Rate Limit Exceeded',\n  [ResponseType.InternalServerError]: 'Internal Server Error',\n  [ResponseType.MethodNotImplemented]: 'Method Not Implemented',\n  [ResponseType.UpstreamFailure]: 'Upstream Failure',\n  [ResponseType.NotEnoughResources]: 'Not Enough Resources',\n  [ResponseType.UpstreamTimeout]: 'Upstream Timeout',\n}\n\nexport function httpResponseCodeToString(status: number): string {\n  return ResponseTypeStrings[httpResponseCodeToEnum(status)]\n}\n\nexport class XRPCResponse {\n  success = true\n\n  constructor(\n    public data: any,\n    public headers: HeadersMap,\n  ) {}\n}\n\nexport class XRPCError extends Error {\n  success = false\n\n  public status: ResponseType\n\n  constructor(\n    statusCode: number,\n    public error: string = httpResponseCodeToName(statusCode),\n    message?: string,\n    public headers?: HeadersMap,\n    options?: ErrorOptions,\n  ) {\n    super(message || error || httpResponseCodeToString(statusCode), options)\n\n    this.status = httpResponseCodeToEnum(statusCode)\n\n    // Pre 2022 runtimes won't handle the \"options\" constructor argument\n    const cause = options?.cause\n    if (this.cause === undefined && cause !== undefined) {\n      this.cause = cause\n    }\n  }\n\n  static from(cause: unknown, fallbackStatus?: ResponseType): XRPCError {\n    if (cause instanceof XRPCError) {\n      return cause\n    }\n\n    // Type cast the cause to an Error if it is one\n    const causeErr = cause instanceof Error ? cause : undefined\n\n    // Try and find a Response object in the cause\n    const causeResponse: Response | undefined =\n      cause instanceof Response\n        ? cause\n        : cause?.['response'] instanceof Response\n          ? cause['response']\n          : undefined\n\n    const statusCode: unknown =\n      // Extract status code from \"http-errors\" like errors\n      causeErr?.['statusCode'] ??\n      causeErr?.['status'] ??\n      // Use the status code from the response object as fallback\n      causeResponse?.status\n\n    // Convert the status code to a ResponseType\n    const status: ResponseType =\n      typeof statusCode === 'number'\n        ? httpResponseCodeToEnum(statusCode)\n        : fallbackStatus ?? ResponseType.Unknown\n\n    const message = causeErr?.message ?? String(cause)\n\n    const headers = causeResponse\n      ? Object.fromEntries(causeResponse.headers.entries())\n      : undefined\n\n    return new XRPCError(status, undefined, message, headers, { cause })\n  }\n}\n\nexport class XRPCInvalidResponseError extends XRPCError {\n  constructor(\n    public lexiconNsid: string,\n    public validationError: ValidationError,\n    public responseBody: unknown,\n  ) {\n    super(\n      ResponseType.InvalidResponse,\n      ResponseTypeStrings[ResponseType.InvalidResponse],\n      `The server gave an invalid response and may be out of date.`,\n      undefined,\n      { cause: validationError },\n    )\n  }\n}\n"],"names":[],"mappings":";;;;;AA4CA,QAAA,sBAAA,GAAA,uBAcC;AAoBD,QAAA,sBAAA,GAAA,uBAEC;AAoBD,QAAA,wBAAA,GAAA,yBAEC;AAtGD,MAAA,uBAAuB;AAmBV,QAAA,iBAAiB,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACxC,KAAK,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IAC5B,OAAO,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;CAC/B,CAAC,CAAA;AAGF,IAAY,YAiBX;AAjBD,CAAA,SAAY,YAAY;IACtB,YAAA,CAAA,YAAA,CAAA,UAAA,GAAA,EAAA,GAAA,SAAW,CAAA;IACX,YAAA,CAAA,YAAA,CAAA,kBAAA,GAAA,EAAA,GAAA,iBAAmB,CAAA;IACnB,YAAA,CAAA,YAAA,CAAA,UAAA,GAAA,IAAA,GAAA,SAAa,CAAA;IACb,YAAA,CAAA,YAAA,CAAA,iBAAA,GAAA,IAAA,GAAA,gBAAoB,CAAA;IACpB,YAAA,CAAA,YAAA,CAAA,eAAA,GAAA,IAAA,GAAA,cAAkB,CAAA;IAClB,YAAA,CAAA,YAAA,CAAA,YAAA,GAAA,IAAA,GAAA,WAAe,CAAA;IACf,YAAA,CAAA,YAAA,CAAA,mBAAA,GAAA,IAAA,GAAA,kBAAsB,CAAA;IACtB,YAAA,CAAA,YAAA,CAAA,gBAAA,GAAA,IAAA,GAAA,eAAmB,CAAA;IACnB,YAAA,CAAA,YAAA,CAAA,kBAAA,GAAA,IAAA,GAAA,iBAAqB,CAAA;IACrB,YAAA,CAAA,YAAA,CAAA,uBAAA,GAAA,IAAA,GAAA,sBAA0B,CAAA;IAC1B,YAAA,CAAA,YAAA,CAAA,oBAAA,GAAA,IAAA,GAAA,mBAAuB,CAAA;IACvB,YAAA,CAAA,YAAA,CAAA,sBAAA,GAAA,IAAA,GAAA,qBAAyB,CAAA;IACzB,YAAA,CAAA,YAAA,CAAA,uBAAA,GAAA,IAAA,GAAA,sBAA0B,CAAA;IAC1B,YAAA,CAAA,YAAA,CAAA,kBAAA,GAAA,IAAA,GAAA,iBAAqB,CAAA;IACrB,YAAA,CAAA,YAAA,CAAA,qBAAA,GAAA,IAAA,GAAA,oBAAwB,CAAA;IACxB,YAAA,CAAA,YAAA,CAAA,kBAAA,GAAA,IAAA,GAAA,iBAAqB,CAAA;AACvB,CAAC,EAjBW,YAAY,IAAA,CAAA,QAAA,YAAA,GAAZ,YAAY,GAAA,CAAA,CAAA,GAiBvB;AAED,SAAgB,sBAAsB,CAAC,MAAc;IACnD,IAAI,MAAM,IAAI,YAAY,EAAE,CAAC;QAC3B,OAAO,MAAM,CAAA;IACf,CAAC,MAAM,IAAI,MAAM,IAAI,GAAG,IAAI,MAAM,GAAG,GAAG,EAAE,CAAC;QACzC,OAAO,YAAY,CAAC,gBAAgB,CAAA;IACtC,CAAC,MAAM,IAAI,MAAM,IAAI,GAAG,IAAI,MAAM,GAAG,GAAG,EAAE,CAAC;QACzC,OAAO,YAAY,CAAC,OAAO,CAAA;IAC7B,CAAC,MAAM,IAAI,MAAM,IAAI,GAAG,IAAI,MAAM,GAAG,GAAG,EAAE,CAAC;QACzC,OAAO,YAAY,CAAC,gBAAgB,CAAA;IACtC,CAAC,MAAM,IAAI,MAAM,IAAI,GAAG,IAAI,MAAM,GAAG,GAAG,EAAE,CAAC;QACzC,OAAO,YAAY,CAAC,cAAc,CAAA;IACpC,CAAC,MAAM,CAAC;QACN,OAAO,YAAY,CAAC,mBAAmB,CAAA;IACzC,CAAC;AACH,CAAC;AAEY,QAAA,iBAAiB,GAAG;IAC/B,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,SAAS;IACjC,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE,iBAAiB;IACjD,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,SAAS;IACjC,CAAC,YAAY,CAAC,cAAc,CAAC,EAAE,gBAAgB;IAC/C,CAAC,YAAY,CAAC,YAAY,CAAC,EAAE,wBAAwB;IACrD,CAAC,YAAY,CAAC,SAAS,CAAC,EAAE,WAAW;IACrC,CAAC,YAAY,CAAC,gBAAgB,CAAC,EAAE,kBAAkB;IACnD,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE,iBAAiB;IACjD,CAAC,YAAY,CAAC,oBAAoB,CAAC,EAAE,sBAAsB;IAC3D,CAAC,YAAY,CAAC,iBAAiB,CAAC,EAAE,mBAAmB;IACrD,CAAC,YAAY,CAAC,mBAAmB,CAAC,EAAE,qBAAqB;IACzD,CAAC,YAAY,CAAC,oBAAoB,CAAC,EAAE,sBAAsB;IAC3D,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE,iBAAiB;IACjD,CAAC,YAAY,CAAC,kBAAkB,CAAC,EAAE,oBAAoB;IACvD,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE,iBAAiB;CAClD,CAAA;AAED,SAAgB,sBAAsB,CAAC,MAAc;IACnD,OAAO,QAAA,iBAAiB,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC,CAAA;AAC1D,CAAC;AAEY,QAAA,mBAAmB,GAAG;IACjC,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,SAAS;IACjC,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE,kBAAkB;IAClD,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,SAAS;IACjC,CAAC,YAAY,CAAC,cAAc,CAAC,EAAE,iBAAiB;IAChD,CAAC,YAAY,CAAC,YAAY,CAAC,EAAE,yBAAyB;IACtD,CAAC,YAAY,CAAC,SAAS,CAAC,EAAE,WAAW;IACrC,CAAC,YAAY,CAAC,gBAAgB,CAAC,EAAE,oBAAoB;IACrD,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE,mBAAmB;IACnD,CAAC,YAAY,CAAC,oBAAoB,CAAC,EAAE,wBAAwB;IAC7D,CAAC,YAAY,CAAC,iBAAiB,CAAC,EAAE,qBAAqB;IACvD,CAAC,YAAY,CAAC,mBAAmB,CAAC,EAAE,uBAAuB;IAC3D,CAAC,YAAY,CAAC,oBAAoB,CAAC,EAAE,wBAAwB;IAC7D,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE,kBAAkB;IAClD,CAAC,YAAY,CAAC,kBAAkB,CAAC,EAAE,sBAAsB;IACzD,CAAC,YAAY,CAAC,eAAe,CAAC,EAAE,kBAAkB;CACnD,CAAA;AAED,SAAgB,wBAAwB,CAAC,MAAc;IACrD,OAAO,QAAA,mBAAmB,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC,CAAA;AAC5D,CAAC;AAED,MAAa,YAAY;IAGvB,YACS,IAAS,EACT,OAAmB,CAAA;QAD1B,OAAA,cAAA,CAAA,IAAA,EAAA,QAAA;;;;mBAAO,IAAI;WAAK;QAChB,OAAA,cAAA,CAAA,IAAA,EAAA,WAAA;;;;mBAAO,OAAO;WAAY;QAJ5B,OAAA,cAAA,CAAA,IAAA,EAAA,WAAA;;;;mBAAU,IAAI;WAAA;IAKX,CAAC;CACL;AAPD,QAAA,YAAA,GAAA,aAOC;AAED,MAAa,SAAU,SAAQ,KAAK;IAKlC,YACE,UAAkB,EACX,QAAgB,sBAAsB,CAAC,UAAU,CAAC,EACzD,OAAgB,EACT,OAAoB,EAC3B,OAAsB,CAAA;QAEtB,KAAK,CAAC,OAAO,IAAI,KAAK,IAAI,wBAAwB,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,CAAA;QALxE,OAAA,cAAA,CAAA,IAAA,EAAA,SAAA;;;;mBAAO,KAAK;WAA6C;QAEzD,OAAA,cAAA,CAAA,IAAA,EAAA,WAAA;;;;mBAAO,OAAO;WAAa;QAR7B,OAAA,cAAA,CAAA,IAAA,EAAA,WAAA;;;;mBAAU,KAAK;WAAA;QAER,OAAA,cAAA,CAAA,IAAA,EAAA,UAAA;;;;;WAAoB;QAWzB,IAAI,CAAC,MAAM,GAAG,sBAAsB,CAAC,UAAU,CAAC,CAAA;QAEhD,oEAAoE;QACpE,MAAM,KAAK,GAAG,OAAO,EAAE,KAAK,CAAA;QAC5B,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;YACpD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QACpB,CAAC;IACH,CAAC;IAED,MAAM,CAAC,IAAI,CAAC,KAAc,EAAE,cAA6B,EAAA;QACvD,IAAI,KAAK,YAAY,SAAS,EAAE,CAAC;YAC/B,OAAO,KAAK,CAAA;QACd,CAAC;QAED,+CAA+C;QAC/C,MAAM,QAAQ,GAAG,KAAK,YAAY,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,SAAS,CAAA;QAE3D,8CAA8C;QAC9C,MAAM,aAAa,GACjB,KAAK,YAAY,QAAQ,GACrB,KAAK,GACL,KAAK,EAAE,CAAC,UAAU,CAAC,YAAY,QAAQ,GACrC,KAAK,CAAC,UAAU,CAAC,GACjB,SAAS,CAAA;QAEjB,MAAM,UAAU,GACd,qDAAqD;QACrD,QAAQ,EAAE,CAAC,YAAY,CAAC,IACxB,QAAQ,EAAE,CAAC,QAAQ,CAAC,IACpB,2DAA2D;QAC3D,aAAa,EAAE,MAAM,CAAA;QAEvB,4CAA4C;QAC5C,MAAM,MAAM,GACV,OAAO,UAAU,KAAK,QAAQ,GAC1B,sBAAsB,CAAC,UAAU,CAAC,GAClC,cAAc,IAAI,YAAY,CAAC,OAAO,CAAA;QAE5C,MAAM,OAAO,GAAG,QAAQ,EAAE,OAAO,IAAI,MAAM,CAAC,KAAK,CAAC,CAAA;QAElD,MAAM,OAAO,GAAG,aAAa,GACzB,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC,GACnD,SAAS,CAAA;QAEb,OAAO,IAAI,SAAS,CAAC,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE;YAAE,KAAK;QAAA,CAAE,CAAC,CAAA;IACtE,CAAC;CACF;AA5DD,QAAA,SAAA,GAAA,UA4DC;AAED,MAAa,wBAAyB,SAAQ,SAAS;IACrD,YACS,WAAmB,EACnB,eAAgC,EAChC,YAAqB,CAAA;QAE5B,KAAK,CACH,YAAY,CAAC,eAAe,EAC5B,QAAA,mBAAmB,CAAC,YAAY,CAAC,eAAe,CAAC,EACjD,CAAA,2DAAA,CAA6D,EAC7D,SAAS,EACT;YAAE,KAAK,EAAE,eAAe;QAAA,CAAE,CAC3B,CAAA;QAVD,OAAA,cAAA,CAAA,IAAA,EAAA,eAAA;;;;mBAAO,WAAW;WAAQ;QAC1B,OAAA,cAAA,CAAA,IAAA,EAAA,mBAAA;;;;mBAAO,eAAe;WAAiB;QACvC,OAAA,cAAA,CAAA,IAAA,EAAA,gBAAA;;;;mBAAO,YAAY;WAAS;IAS9B,CAAC;CACF;AAdD,QAAA,wBAAA,GAAA,yBAcC","ignoreList":[0]}},
    {"offset": {"line": 7842, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7847, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/xrpc/src/util.ts"],"sourcesContent":["import {\n  jsonStringToLex,\n  LexXrpcProcedure,\n  LexXrpcQuery,\n  stringifyLex,\n} from '@atproto/lexicon'\nimport {\n  CallOptions,\n  errorResponseBody,\n  ErrorResponseBody,\n  Gettable,\n  QueryParams,\n  ResponseType,\n  XRPCError,\n} from './types'\n\nconst ReadableStream =\n  globalThis.ReadableStream ||\n  (class {\n    constructor() {\n      // This anonymous class will never pass any \"instanceof\" check and cannot\n      // be instantiated.\n      throw new Error('ReadableStream is not supported in this environment')\n    }\n  } as typeof globalThis.ReadableStream)\n\nexport function isErrorResponseBody(v: unknown): v is ErrorResponseBody {\n  return errorResponseBody.safeParse(v).success\n}\n\nexport function getMethodSchemaHTTPMethod(\n  schema: LexXrpcProcedure | LexXrpcQuery,\n) {\n  if (schema.type === 'procedure') {\n    return 'post'\n  }\n  return 'get'\n}\n\nexport function constructMethodCallUri(\n  nsid: string,\n  schema: LexXrpcProcedure | LexXrpcQuery,\n  serviceUri: URL,\n  params?: QueryParams,\n): string {\n  const uri = new URL(constructMethodCallUrl(nsid, schema, params), serviceUri)\n  return uri.toString()\n}\n\nexport function constructMethodCallUrl(\n  nsid: string,\n  schema: LexXrpcProcedure | LexXrpcQuery,\n  params?: QueryParams,\n): string {\n  const pathname = `/xrpc/${encodeURIComponent(nsid)}`\n  if (!params) return pathname\n\n  const searchParams: [string, string][] = []\n\n  for (const [key, value] of Object.entries(params)) {\n    const paramSchema = schema.parameters?.properties?.[key]\n    if (!paramSchema) {\n      throw new Error(`Invalid query parameter: ${key}`)\n    }\n    if (value !== undefined) {\n      if (paramSchema.type === 'array') {\n        const values = Array.isArray(value) ? value : [value]\n        for (const val of values) {\n          searchParams.push([\n            key,\n            encodeQueryParam(paramSchema.items.type, val),\n          ])\n        }\n      } else {\n        searchParams.push([key, encodeQueryParam(paramSchema.type, value)])\n      }\n    }\n  }\n\n  if (!searchParams.length) return pathname\n\n  return `${pathname}?${new URLSearchParams(searchParams).toString()}`\n}\n\nexport function encodeQueryParam(\n  type:\n    | 'string'\n    | 'float'\n    | 'integer'\n    | 'boolean'\n    | 'datetime'\n    | 'array'\n    | 'unknown',\n  value: any,\n): string {\n  if (type === 'string' || type === 'unknown') {\n    return String(value)\n  }\n  if (type === 'float') {\n    return String(Number(value))\n  } else if (type === 'integer') {\n    return String(Number(value) | 0)\n  } else if (type === 'boolean') {\n    return value ? 'true' : 'false'\n  } else if (type === 'datetime') {\n    if (value instanceof Date) {\n      return value.toISOString()\n    }\n    return String(value)\n  }\n  throw new Error(`Unsupported query param type: ${type}`)\n}\n\nexport function constructMethodCallHeaders(\n  schema: LexXrpcProcedure | LexXrpcQuery,\n  data?: unknown,\n  opts?: CallOptions,\n): Headers {\n  // Not using `new Headers(opts?.headers)` to avoid duplicating headers values\n  // due to inconsistent casing in headers name. In case of multiple headers\n  // with the same name (but using a different case), the last one will be used.\n\n  // new Headers({ 'content-type': 'foo', 'Content-Type': 'bar' }).get('content-type')\n  // => 'foo, bar'\n  const headers = new Headers()\n\n  if (opts?.headers) {\n    for (const name in opts.headers) {\n      if (headers.has(name)) {\n        throw new TypeError(`Duplicate header: ${name}`)\n      }\n\n      const value = opts.headers[name]\n      if (value != null) {\n        headers.set(name, value)\n      }\n    }\n  }\n\n  if (schema.type === 'procedure') {\n    if (opts?.encoding) {\n      headers.set('content-type', opts.encoding)\n    } else if (!headers.has('content-type') && typeof data !== 'undefined') {\n      // Special handling of BodyInit types before falling back to JSON encoding\n      if (\n        data instanceof ArrayBuffer ||\n        data instanceof ReadableStream ||\n        ArrayBuffer.isView(data)\n      ) {\n        headers.set('content-type', 'application/octet-stream')\n      } else if (data instanceof FormData) {\n        // Note: The multipart form data boundary is missing from the header\n        // we set here, making that header invalid. This special case will be\n        // handled in encodeMethodCallBody()\n        headers.set('content-type', 'multipart/form-data')\n      } else if (data instanceof URLSearchParams) {\n        headers.set(\n          'content-type',\n          'application/x-www-form-urlencoded;charset=UTF-8',\n        )\n      } else if (isBlobLike(data)) {\n        headers.set('content-type', data.type || 'application/octet-stream')\n      } else if (typeof data === 'string') {\n        headers.set('content-type', 'text/plain;charset=UTF-8')\n      }\n      // At this point, data is not a valid BodyInit type.\n      else if (isIterable(data)) {\n        headers.set('content-type', 'application/octet-stream')\n      } else if (\n        typeof data === 'boolean' ||\n        typeof data === 'number' ||\n        typeof data === 'string' ||\n        typeof data === 'object' // covers \"null\"\n      ) {\n        headers.set('content-type', 'application/json')\n      } else {\n        // symbol, function, bigint\n        throw new XRPCError(\n          ResponseType.InvalidRequest,\n          `Unsupported data type: ${typeof data}`,\n        )\n      }\n    }\n  }\n  return headers\n}\n\nexport function combineHeaders(\n  headersInit: undefined | HeadersInit,\n  defaultHeaders?: Iterable<[string, undefined | Gettable<null | string>]>,\n): undefined | HeadersInit {\n  if (!defaultHeaders) return headersInit\n\n  let headers: Headers | undefined = undefined\n\n  for (const [name, definition] of defaultHeaders) {\n    // Ignore undefined values (allowed for convenience when using\n    // Object.entries).\n    if (definition === undefined) continue\n\n    // Lazy initialization of the headers object\n    headers ??= new Headers(headersInit)\n\n    if (headers.has(name)) continue\n\n    const value = typeof definition === 'function' ? definition() : definition\n\n    if (typeof value === 'string') headers.set(name, value)\n    else if (value === null) headers.delete(name)\n    else throw new TypeError(`Invalid \"${name}\" header value: ${typeof value}`)\n  }\n\n  return headers ?? headersInit\n}\n\nfunction isBlobLike(value: unknown): value is Blob {\n  if (value == null) return false\n  if (typeof value !== 'object') return false\n  if (typeof Blob === 'function' && value instanceof Blob) return true\n\n  // Support for Blobs provided by libraries that don't use the native Blob\n  // (e.g. fetch-blob from node-fetch).\n  // https://github.com/node-fetch/fetch-blob/blob/a1a182e5978811407bef4ea1632b517567dda01f/index.js#L233-L244\n\n  const tag = value[Symbol.toStringTag]\n  if (tag === 'Blob' || tag === 'File') {\n    return 'stream' in value && typeof value.stream === 'function'\n  }\n\n  return false\n}\n\nexport function isBodyInit(value: unknown): value is BodyInit {\n  switch (typeof value) {\n    case 'string':\n      return true\n    case 'object':\n      return (\n        value instanceof ArrayBuffer ||\n        value instanceof FormData ||\n        value instanceof URLSearchParams ||\n        value instanceof ReadableStream ||\n        ArrayBuffer.isView(value) ||\n        isBlobLike(value)\n      )\n    default:\n      return false\n  }\n}\n\nexport function isIterable(\n  value: unknown,\n): value is Iterable<unknown> | AsyncIterable<unknown> {\n  return (\n    value != null &&\n    typeof value === 'object' &&\n    (Symbol.iterator in value || Symbol.asyncIterator in value)\n  )\n}\n\nexport function encodeMethodCallBody(\n  headers: Headers,\n  data?: unknown,\n): BodyInit | undefined {\n  // Silently ignore the body if there is no content-type header.\n  const contentType = headers.get('content-type')\n  if (!contentType) {\n    return undefined\n  }\n\n  if (typeof data === 'undefined') {\n    // This error would be returned by the server, but we can catch it earlier\n    // to avoid un-necessary requests. Note that a content-length of 0 does not\n    // necessary mean that the body is \"empty\" (e.g. an empty txt file).\n    throw new XRPCError(\n      ResponseType.InvalidRequest,\n      `A request body is expected but none was provided`,\n    )\n  }\n\n  if (isBodyInit(data)) {\n    if (data instanceof FormData && contentType === 'multipart/form-data') {\n      // fetch() will encode FormData payload itself, but it won't override the\n      // content-type header if already present. This would cause the boundary\n      // to be missing from the content-type header, resulting in a 400 error.\n      // Deleting the content-type header here to let fetch() re-create it.\n      headers.delete('content-type')\n    }\n\n    // Will be encoded by the fetch API.\n    return data\n  }\n\n  if (isIterable(data)) {\n    // Note that some environments support using Iterable & AsyncIterable as the\n    // body (e.g. Node's fetch), but not all of them do (browsers).\n    return iterableToReadableStream(data)\n  }\n\n  if (contentType.startsWith('text/')) {\n    return new TextEncoder().encode(String(data))\n  }\n  if (contentType.startsWith('application/json')) {\n    const json = stringifyLex(data)\n    // Server would return a 400 error if the JSON is invalid (e.g. trying to\n    // JSONify a function, or an object that implements toJSON() poorly).\n    if (json === undefined) {\n      throw new XRPCError(\n        ResponseType.InvalidRequest,\n        `Failed to encode request body as JSON`,\n      )\n    }\n    return new TextEncoder().encode(json)\n  }\n\n  // At this point, \"data\" is not a valid BodyInit value, and we don't know how\n  // to encode it into one. Passing it to fetch would result in an error. Let's\n  // throw our own error instead.\n\n  const type =\n    !data || typeof data !== 'object'\n      ? typeof data\n      : data.constructor !== Object &&\n          typeof data.constructor === 'function' &&\n          typeof data.constructor?.name === 'string'\n        ? data.constructor.name\n        : 'object'\n\n  throw new XRPCError(\n    ResponseType.InvalidRequest,\n    `Unable to encode ${type} as ${contentType} data`,\n  )\n}\n\n/**\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/from_static}\n */\nfunction iterableToReadableStream(\n  iterable: Iterable<unknown> | AsyncIterable<unknown>,\n): ReadableStream<Uint8Array> {\n  // Use the native ReadableStream.from() if available.\n  if ('from' in ReadableStream && typeof ReadableStream.from === 'function') {\n    return ReadableStream.from(iterable)\n  }\n\n  // If you see this error, consider using a polyfill for ReadableStream. For\n  // example, the \"web-streams-polyfill\" package:\n  // https://github.com/MattiasBuelens/web-streams-polyfill\n\n  throw new TypeError(\n    'ReadableStream.from() is not supported in this environment. ' +\n      'It is required to support using iterables as the request body. ' +\n      'Consider using a polyfill or re-write your code to use a different body type.',\n  )\n}\n\nexport function httpResponseBodyParse(\n  mimeType: string | null,\n  data: ArrayBuffer | undefined,\n): any {\n  try {\n    if (mimeType) {\n      if (mimeType.includes('application/json')) {\n        const str = new TextDecoder().decode(data)\n        return jsonStringToLex(str)\n      }\n      if (mimeType.startsWith('text/')) {\n        return new TextDecoder().decode(data)\n      }\n    }\n    if (data instanceof ArrayBuffer) {\n      return new Uint8Array(data)\n    }\n    return data\n  } catch (cause) {\n    throw new XRPCError(\n      ResponseType.InvalidResponse,\n      undefined,\n      `Failed to parse response body: ${String(cause)}`,\n      undefined,\n      { cause },\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AA0BA,QAAA,mBAAA,GAAA,oBAEC;AAED,QAAA,yBAAA,GAAA,0BAOC;AAED,QAAA,sBAAA,GAAA,uBAQC;AAED,QAAA,sBAAA,GAAA,uBAiCC;AAED,QAAA,gBAAA,GAAA,iBA2BC;AAED,QAAA,0BAAA,GAAA,2BAwEC;AAED,QAAA,cAAA,GAAA,eA0BC;AAmBD,QAAA,UAAA,GAAA,WAgBC;AAED,QAAA,UAAA,GAAA,WAQC;AAED,QAAA,oBAAA,GAAA,qBAwEC;AAwBD,QAAA,qBAAA,GAAA,sBA2BC;AA/XD,MAAA,wCAKyB;AACzB,MAAA,6BAQgB;AAEhB,MAAM,cAAc,GAClB,UAAU,CAAC,cAAc,IACxB;IACC,aAAA;QACE,yEAAyE;QACzE,mBAAmB;QACnB,MAAM,IAAI,KAAK,CAAC,qDAAqD,CAAC,CAAA;IACxE,CAAC;CACmC,CAAA;AAExC,SAAgB,mBAAmB,CAAC,CAAU;IAC5C,OAAO,QAAA,iBAAiB,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAA;AAC/C,CAAC;AAED,SAAgB,yBAAyB,CACvC,MAAuC;IAEvC,IAAI,MAAM,CAAC,IAAI,KAAK,WAAW,EAAE,CAAC;QAChC,OAAO,MAAM,CAAA;IACf,CAAC;IACD,OAAO,KAAK,CAAA;AACd,CAAC;AAED,SAAgB,sBAAsB,CACpC,IAAY,EACZ,MAAuC,EACvC,UAAe,EACf,MAAoB;IAEpB,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,sBAAsB,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC,EAAE,UAAU,CAAC,CAAA;IAC7E,OAAO,GAAG,CAAC,QAAQ,EAAE,CAAA;AACvB,CAAC;AAED,SAAgB,sBAAsB,CACpC,IAAY,EACZ,MAAuC,EACvC,MAAoB;IAEpB,MAAM,QAAQ,GAAG,CAAA,MAAA,EAAS,kBAAkB,CAAC,IAAI,CAAC,EAAE,CAAA;IACpD,IAAI,CAAC,MAAM,EAAE,OAAO,QAAQ,CAAA;IAE5B,MAAM,YAAY,GAAuB,EAAE,CAAA;IAE3C,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAE,CAAC;QAClD,MAAM,WAAW,GAAG,MAAM,CAAC,UAAU,EAAE,UAAU,EAAE,CAAC,GAAG,CAAC,CAAA;QACxD,IAAI,CAAC,WAAW,EAAE,CAAC;YACjB,MAAM,IAAI,KAAK,CAAC,CAAA,yBAAA,EAA4B,GAAG,EAAE,CAAC,CAAA;QACpD,CAAC;QACD,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;YACxB,IAAI,WAAW,CAAC,IAAI,KAAK,OAAO,EAAE,CAAC;gBACjC,MAAM,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;oBAAC,KAAK;iBAAC,CAAA;gBACrD,KAAK,MAAM,GAAG,IAAI,MAAM,CAAE,CAAC;oBACzB,YAAY,CAAC,IAAI,CAAC;wBAChB,GAAG;wBACH,gBAAgB,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,EAAE,GAAG,CAAC;qBAC9C,CAAC,CAAA;gBACJ,CAAC;YACH,CAAC,MAAM,CAAC;gBACN,YAAY,CAAC,IAAI,CAAC;oBAAC,GAAG;oBAAE,gBAAgB,CAAC,WAAW,CAAC,IAAI,EAAE,KAAK,CAAC;iBAAC,CAAC,CAAA;YACrE,CAAC;QACH,CAAC;IACH,CAAC;IAED,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,OAAO,QAAQ,CAAA;IAEzC,OAAO,GAAG,QAAQ,CAAA,CAAA,EAAI,IAAI,eAAe,CAAC,YAAY,CAAC,CAAC,QAAQ,EAAE,EAAE,CAAA;AACtE,CAAC;AAED,SAAgB,gBAAgB,CAC9B,IAOa,EACb,KAAU;IAEV,IAAI,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,SAAS,EAAE,CAAC;QAC5C,OAAO,MAAM,CAAC,KAAK,CAAC,CAAA;IACtB,CAAC;IACD,IAAI,IAAI,KAAK,OAAO,EAAE,CAAC;QACrB,OAAO,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAA;IAC9B,CAAC,MAAM,IAAI,IAAI,KAAK,SAAS,EAAE,CAAC;QAC9B,OAAO,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAA;IAClC,CAAC,MAAM,IAAI,IAAI,KAAK,SAAS,EAAE,CAAC;QAC9B,OAAO,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAA;IACjC,CAAC,MAAM,IAAI,IAAI,KAAK,UAAU,EAAE,CAAC;QAC/B,IAAI,KAAK,YAAY,IAAI,EAAE,CAAC;YAC1B,OAAO,KAAK,CAAC,WAAW,EAAE,CAAA;QAC5B,CAAC;QACD,OAAO,MAAM,CAAC,KAAK,CAAC,CAAA;IACtB,CAAC;IACD,MAAM,IAAI,KAAK,CAAC,CAAA,8BAAA,EAAiC,IAAI,EAAE,CAAC,CAAA;AAC1D,CAAC;AAED,SAAgB,0BAA0B,CACxC,MAAuC,EACvC,IAAc,EACd,IAAkB;IAElB,6EAA6E;IAC7E,0EAA0E;IAC1E,8EAA8E;IAE9E,oFAAoF;IACpF,gBAAgB;IAChB,MAAM,OAAO,GAAG,IAAI,OAAO,EAAE,CAAA;IAE7B,IAAI,IAAI,EAAE,OAAO,EAAE,CAAC;QAClB,IAAK,MAAM,IAAI,IAAI,IAAI,CAAC,OAAO,CAAE,CAAC;YAChC,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC;gBACtB,MAAM,IAAI,SAAS,CAAC,CAAA,kBAAA,EAAqB,IAAI,EAAE,CAAC,CAAA;YAClD,CAAC;YAED,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;YAChC,IAAI,KAAK,IAAI,IAAI,EAAE,CAAC;gBAClB,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,CAAA;YAC1B,CAAC;QACH,CAAC;IACH,CAAC;IAED,IAAI,MAAM,CAAC,IAAI,KAAK,WAAW,EAAE,CAAC;QAChC,IAAI,IAAI,EAAE,QAAQ,EAAE,CAAC;YACnB,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA;QAC5C,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE,CAAC;YACvE,0EAA0E;YAC1E,IACE,IAAI,YAAY,WAAW,IAC3B,IAAI,YAAY,cAAc,IAC9B,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,EACxB,CAAC;gBACD,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,0BAA0B,CAAC,CAAA;YACzD,CAAC,MAAM,IAAI,IAAI,YAAY,QAAQ,EAAE,CAAC;gBACpC,oEAAoE;gBACpE,qEAAqE;gBACrE,oCAAoC;gBACpC,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,qBAAqB,CAAC,CAAA;YACpD,CAAC,MAAM,IAAI,IAAI,YAAY,eAAe,EAAE,CAAC;gBAC3C,OAAO,CAAC,GAAG,CACT,cAAc,EACd,iDAAiD,CAClD,CAAA;YACH,CAAC,MAAM,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC;gBAC5B,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAC,IAAI,IAAI,0BAA0B,CAAC,CAAA;YACtE,CAAC,MAAM,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE,CAAC;gBACpC,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,0BAA0B,CAAC,CAAA;YACzD,CAAC,MAEI,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC;gBAC1B,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,0BAA0B,CAAC,CAAA;YACzD,CAAC,MAAM,IACL,OAAO,IAAI,KAAK,SAAS,IACzB,OAAO,IAAI,KAAK,QAAQ,IACxB,OAAO,IAAI,KAAK,QAAQ,IACxB,OAAO,IAAI,KAAK,QAAQ,CAAC,gBAAgB;cACzC,CAAC;gBACD,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,kBAAkB,CAAC,CAAA;YACjD,CAAC,MAAM,CAAC;gBACN,2BAA2B;gBAC3B,MAAM,IAAI,QAAA,SAAS,CACjB,QAAA,YAAY,CAAC,cAAc,EAC3B,CAAA,uBAAA,EAA0B,OAAO,IAAI,EAAE,CACxC,CAAA;YACH,CAAC;QACH,CAAC;IACH,CAAC;IACD,OAAO,OAAO,CAAA;AAChB,CAAC;AAED,SAAgB,cAAc,CAC5B,WAAoC,EACpC,cAAwE;IAExE,IAAI,CAAC,cAAc,EAAE,OAAO,WAAW,CAAA;IAEvC,IAAI,OAAO,GAAwB,SAAS,CAAA;IAE5C,KAAK,MAAM,CAAC,IAAI,EAAE,UAAU,CAAC,IAAI,cAAc,CAAE,CAAC;QAChD,8DAA8D;QAC9D,mBAAmB;QACnB,IAAI,UAAU,KAAK,SAAS,EAAE,SAAQ;QAEtC,4CAA4C;QAC5C,OAAO,IAAA,CAAP,OAAO,GAAK,IAAI,OAAO,CAAC,WAAW,CAAC,EAAA;QAEpC,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,SAAQ;QAE/B,MAAM,KAAK,GAAG,OAAO,UAAU,KAAK,UAAU,CAAC,CAAC,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC,UAAU,CAAA;QAE1E,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,CAAA;aAClD,IAAI,KAAK,KAAK,IAAI,EAAE,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;aACxC,MAAM,IAAI,SAAS,CAAC,CAAA,SAAA,EAAY,IAAI,CAAA,gBAAA,EAAmB,OAAO,KAAK,EAAE,CAAC,CAAA;IAC7E,CAAC;IAED,OAAO,OAAO,IAAI,WAAW,CAAA;AAC/B,CAAC;AAED,SAAS,UAAU,CAAC,KAAc;IAChC,IAAI,KAAK,IAAI,IAAI,EAAE,OAAO,KAAK,CAAA;IAC/B,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,OAAO,KAAK,CAAA;IAC3C,IAAI,OAAO,IAAI,KAAK,UAAU,IAAI,KAAK,YAAY,IAAI,EAAE,OAAO,IAAI,CAAA;IAEpE,yEAAyE;IACzE,qCAAqC;IACrC,4GAA4G;IAE5G,MAAM,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,CAAA;IACrC,IAAI,GAAG,KAAK,MAAM,IAAI,GAAG,KAAK,MAAM,EAAE,CAAC;QACrC,OAAO,QAAQ,IAAI,KAAK,IAAI,OAAO,KAAK,CAAC,MAAM,KAAK,UAAU,CAAA;IAChE,CAAC;IAED,OAAO,KAAK,CAAA;AACd,CAAC;AAED,SAAgB,UAAU,CAAC,KAAc;IACvC,OAAQ,OAAO,KAAK,EAAE,CAAC;QACrB,KAAK,QAAQ;YACX,OAAO,IAAI,CAAA;QACb,KAAK,QAAQ;YACX,OAAO,AACL,KAAK,YAAY,WAAW,IAC5B,KAAK,YAAY,QAAQ,IACzB,KAAK,YAAY,eAAe,IAChC,KAAK,YAAY,cAAc,IAC/B,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,IACzB,UAAU,CAAC,KAAK,CAAC,CAClB,CAAA;QACH;YACE,OAAO,KAAK,CAAA;IAChB,CAAC;AACH,CAAC;AAED,SAAgB,UAAU,CACxB,KAAc;IAEd,OAAO,AACL,KAAK,IAAI,IAAI,IACb,OAAO,KAAK,KAAK,QAAQ,IACzB,CAAC,MAAM,CAAC,QAAQ,IAAI,KAAK,IAAI,MAAM,CAAC,aAAa,IAAI,KAAK,CAAC,CAC5D,CAAA;AACH,CAAC;AAED,SAAgB,oBAAoB,CAClC,OAAgB,EAChB,IAAc;IAEd,+DAA+D;IAC/D,MAAM,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;IAC/C,IAAI,CAAC,WAAW,EAAE,CAAC;QACjB,OAAO,SAAS,CAAA;IAClB,CAAC;IAED,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE,CAAC;QAChC,0EAA0E;QAC1E,2EAA2E;QAC3E,oEAAoE;QACpE,MAAM,IAAI,QAAA,SAAS,CACjB,QAAA,YAAY,CAAC,cAAc,EAC3B,CAAA,gDAAA,CAAkD,CACnD,CAAA;IACH,CAAC;IAED,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC;QACrB,IAAI,IAAI,YAAY,QAAQ,IAAI,WAAW,KAAK,qBAAqB,EAAE,CAAC;YACtE,yEAAyE;YACzE,wEAAwE;YACxE,wEAAwE;YACxE,qEAAqE;YACrE,OAAO,CAAC,MAAM,CAAC,cAAc,CAAC,CAAA;QAChC,CAAC;QAED,oCAAoC;QACpC,OAAO,IAAI,CAAA;IACb,CAAC;IAED,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC;QACrB,4EAA4E;QAC5E,+DAA+D;QAC/D,OAAO,wBAAwB,CAAC,IAAI,CAAC,CAAA;IACvC,CAAC;IAED,IAAI,WAAW,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC;QACpC,OAAO,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAA;IAC/C,CAAC;IACD,IAAI,WAAW,CAAC,UAAU,CAAC,kBAAkB,CAAC,EAAE,CAAC;QAC/C,MAAM,IAAI,GAAG,CAAA,GAAA,UAAA,YAAY,EAAC,IAAI,CAAC,CAAA;QAC/B,yEAAyE;QACzE,qEAAqE;QACrE,IAAI,IAAI,KAAK,SAAS,EAAE,CAAC;YACvB,MAAM,IAAI,QAAA,SAAS,CACjB,QAAA,YAAY,CAAC,cAAc,EAC3B,CAAA,qCAAA,CAAuC,CACxC,CAAA;QACH,CAAC;QACD,OAAO,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;IACvC,CAAC;IAED,6EAA6E;IAC7E,6EAA6E;IAC7E,+BAA+B;IAE/B,MAAM,IAAI,GACR,CAAC,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,GAC7B,OAAO,IAAI,GACX,IAAI,CAAC,WAAW,KAAK,MAAM,IACzB,OAAO,IAAI,CAAC,WAAW,KAAK,UAAU,IACtC,OAAO,IAAI,CAAC,WAAW,EAAE,IAAI,KAAK,QAAQ,GAC1C,IAAI,CAAC,WAAW,CAAC,IAAI,GACrB,QAAQ,CAAA;IAEhB,MAAM,IAAI,QAAA,SAAS,CACjB,QAAA,YAAY,CAAC,cAAc,EAC3B,CAAA,iBAAA,EAAoB,IAAI,CAAA,IAAA,EAAO,WAAW,CAAA,KAAA,CAAO,CAClD,CAAA;AACH,CAAC;AAED;;GAEG,CACH,SAAS,wBAAwB,CAC/B,QAAoD;IAEpD,qDAAqD;IACrD,IAAI,MAAM,IAAI,cAAc,IAAI,OAAO,cAAc,CAAC,IAAI,KAAK,UAAU,EAAE,CAAC;QAC1E,OAAO,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;IACtC,CAAC;IAED,2EAA2E;IAC3E,+CAA+C;IAC/C,yDAAyD;IAEzD,MAAM,IAAI,SAAS,CACjB,8DAA8D,GAC5D,iEAAiE,GACjE,+EAA+E,CAClF,CAAA;AACH,CAAC;AAED,SAAgB,qBAAqB,CACnC,QAAuB,EACvB,IAA6B;IAE7B,IAAI,CAAC;QACH,IAAI,QAAQ,EAAE,CAAC;YACb,IAAI,QAAQ,CAAC,QAAQ,CAAC,kBAAkB,CAAC,EAAE,CAAC;gBAC1C,MAAM,GAAG,GAAG,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;gBAC1C,OAAO,CAAA,GAAA,UAAA,eAAe,EAAC,GAAG,CAAC,CAAA;YAC7B,CAAC;YACD,IAAI,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC;gBACjC,OAAO,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;YACvC,CAAC;QACH,CAAC;QACD,IAAI,IAAI,YAAY,WAAW,EAAE,CAAC;YAChC,OAAO,IAAI,UAAU,CAAC,IAAI,CAAC,CAAA;QAC7B,CAAC;QACD,OAAO,IAAI,CAAA;IACb,CAAC,CAAC,OAAO,KAAK,EAAE,CAAC;QACf,MAAM,IAAI,QAAA,SAAS,CACjB,QAAA,YAAY,CAAC,eAAe,EAC5B,SAAS,EACT,CAAA,+BAAA,EAAkC,MAAM,CAAC,KAAK,CAAC,EAAE,EACjD,SAAS,EACT;YAAE,KAAK;QAAA,CAAE,CACV,CAAA;IACH,CAAC;AACH,CAAC","ignoreList":[0]}},
    {"offset": {"line": 8104, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8109, "column": 0}, "map": {"version":3,"file":"fetch-handler.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/xrpc/src/fetch-handler.ts"],"sourcesContent":["import { Gettable } from './types'\nimport { combineHeaders } from './util'\n\nexport type FetchHandler = (\n  this: void,\n  /**\n   * The URL (pathname + query parameters) to make the request to, without the\n   * origin. The origin (protocol, hostname, and port) must be added by this\n   * {@link FetchHandler}, typically based on authentication or other factors.\n   */\n  url: string,\n  init: RequestInit,\n) => Promise<Response>\n\nexport type FetchHandlerOptions = BuildFetchHandlerOptions | string | URL\n\nexport type BuildFetchHandlerOptions = {\n  /**\n   * The service URL to make requests to. This can be a string, URL, or a\n   * function that returns a string or URL. This is useful for dynamic URLs,\n   * such as a service URL that changes based on authentication.\n   */\n  service: Gettable<string | URL>\n\n  /**\n   * Headers to be added to every request. If a function is provided, it will be\n   * called on each request to get the headers. This is useful for dynamic\n   * headers, such as authentication tokens that may expire.\n   */\n  headers?: {\n    [_ in string]?: Gettable<null | string>\n  }\n\n  /**\n   * Bring your own fetch implementation. Typically useful for testing, logging,\n   * mocking, or adding retries, session management, signatures, proof of\n   * possession (DPoP), etc. Defaults to the global `fetch` function.\n   */\n  fetch?: typeof globalThis.fetch\n}\n\nexport interface FetchHandlerObject {\n  fetchHandler: (\n    this: FetchHandlerObject,\n    /**\n     * The URL (pathname + query parameters) to make the request to, without the\n     * origin. The origin (protocol, hostname, and port) must be added by this\n     * {@link FetchHandler}, typically based on authentication or other factors.\n     */\n    url: string,\n    init: RequestInit,\n  ) => Promise<Response>\n}\n\nexport function buildFetchHandler(\n  options: FetchHandler | FetchHandlerObject | FetchHandlerOptions,\n): FetchHandler {\n  // Already a fetch handler (allowed for convenience)\n  if (typeof options === 'function') return options\n  if (typeof options === 'object' && 'fetchHandler' in options) {\n    return options.fetchHandler.bind(options)\n  }\n\n  const {\n    service,\n    headers: defaultHeaders = undefined,\n    fetch = globalThis.fetch,\n  } = typeof options === 'string' || options instanceof URL\n    ? { service: options }\n    : options\n\n  if (typeof fetch !== 'function') {\n    throw new TypeError(\n      'XrpcDispatcher requires fetch() to be available in your environment.',\n    )\n  }\n\n  const defaultHeadersEntries =\n    defaultHeaders != null ? Object.entries(defaultHeaders) : undefined\n\n  return async function (url, init) {\n    const base = typeof service === 'function' ? service() : service\n    const fullUrl = new URL(url, base)\n\n    const headers = combineHeaders(init.headers, defaultHeadersEntries)\n\n    return fetch(fullUrl, { ...init, headers })\n  }\n}\n"],"names":[],"mappings":";;;;AAsDA,QAAA,iBAAA,GAAA,kBAkCC;AAvFD,MAAA,2BAAuC;AAqDvC,SAAgB,iBAAiB,CAC/B,OAAgE;IAEhE,oDAAoD;IACpD,IAAI,OAAO,OAAO,KAAK,UAAU,EAAE,OAAO,OAAO,CAAA;IACjD,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,cAAc,IAAI,OAAO,EAAE,CAAC;QAC7D,OAAO,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;IAC3C,CAAC;IAED,MAAM,EACJ,OAAO,EACP,OAAO,EAAE,cAAc,GAAG,SAAS,EACnC,KAAK,GAAG,UAAU,CAAC,KAAK,EACzB,GAAG,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,YAAY,GAAG,GACrD;QAAE,OAAO,EAAE,OAAO;IAAA,CAAE,GACpB,OAAO,CAAA;IAEX,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE,CAAC;QAChC,MAAM,IAAI,SAAS,CACjB,sEAAsE,CACvE,CAAA;IACH,CAAC;IAED,MAAM,qBAAqB,GACzB,cAAc,IAAI,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,SAAS,CAAA;IAErE,OAAO,KAAK,UAAW,GAAG,EAAE,IAAI;QAC9B,MAAM,IAAI,GAAG,OAAO,OAAO,KAAK,UAAU,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,OAAO,CAAA;QAChE,MAAM,OAAO,GAAG,IAAI,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAA;QAElC,MAAM,OAAO,GAAG,CAAA,GAAA,OAAA,cAAc,EAAC,IAAI,CAAC,OAAO,EAAE,qBAAqB,CAAC,CAAA;QAEnE,OAAO,KAAK,CAAC,OAAO,EAAE;YAAE,GAAG,IAAI;YAAE,OAAO;QAAA,CAAE,CAAC,CAAA;IAC7C,CAAC,CAAA;AACH,CAAC","ignoreList":[0]}},
    {"offset": {"line": 8138, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8143, "column": 0}, "map": {"version":3,"file":"xrpc-client.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/xrpc/src/xrpc-client.ts"],"sourcesContent":["import { LexiconDoc, Lexicons, ValidationError } from '@atproto/lexicon'\nimport {\n  FetchHandler,\n  FetchHandlerObject,\n  FetchHandlerOptions,\n  buildFetchHandler,\n} from './fetch-handler'\nimport {\n  CallOptions,\n  Gettable,\n  QueryParams,\n  ResponseType,\n  XRPCError,\n  XRPCInvalidResponseError,\n  XRPCResponse,\n  httpResponseCodeToEnum,\n} from './types'\nimport {\n  combineHeaders,\n  constructMethodCallHeaders,\n  constructMethodCallUrl,\n  encodeMethodCallBody,\n  getMethodSchemaHTTPMethod,\n  httpResponseBodyParse,\n  isErrorResponseBody,\n} from './util'\n\nexport class XrpcClient {\n  readonly fetchHandler: FetchHandler\n  readonly headers = new Map<string, Gettable<null | string>>()\n  readonly lex: Lexicons\n\n  constructor(\n    fetchHandlerOpts: FetchHandler | FetchHandlerObject | FetchHandlerOptions,\n    // \"Lexicons\" is redundant here (because that class implements\n    // \"Iterable<LexiconDoc>\") but we keep it for explicitness:\n    lex: Lexicons | Iterable<LexiconDoc>,\n  ) {\n    this.fetchHandler = buildFetchHandler(fetchHandlerOpts)\n\n    this.lex = lex instanceof Lexicons ? lex : new Lexicons(lex)\n  }\n\n  setHeader(key: string, value: Gettable<null | string>): void {\n    this.headers.set(key.toLowerCase(), value)\n  }\n\n  unsetHeader(key: string): void {\n    this.headers.delete(key.toLowerCase())\n  }\n\n  clearHeaders(): void {\n    this.headers.clear()\n  }\n\n  async call(\n    methodNsid: string,\n    params?: QueryParams,\n    data?: unknown,\n    opts?: CallOptions,\n  ): Promise<XRPCResponse> {\n    const def = this.lex.getDefOrThrow(methodNsid)\n    if (!def || (def.type !== 'query' && def.type !== 'procedure')) {\n      throw new TypeError(\n        `Invalid lexicon: ${methodNsid}. Must be a query or procedure.`,\n      )\n    }\n\n    // @TODO: should we validate the params and data here?\n    // this.lex.assertValidXrpcParams(methodNsid, params)\n    // if (data !== undefined) {\n    //   this.lex.assertValidXrpcInput(methodNsid, data)\n    // }\n\n    const reqUrl = constructMethodCallUrl(methodNsid, def, params)\n    const reqMethod = getMethodSchemaHTTPMethod(def)\n    const reqHeaders = constructMethodCallHeaders(def, data, opts)\n    const reqBody = encodeMethodCallBody(reqHeaders, data)\n\n    // The duplex field is required for streaming bodies, but not yet reflected\n    // anywhere in docs or types. See whatwg/fetch#1438, nodejs/node#46221.\n    const init: RequestInit & { duplex: 'half' } = {\n      method: reqMethod,\n      headers: combineHeaders(reqHeaders, this.headers),\n      body: reqBody,\n      duplex: 'half',\n      signal: opts?.signal,\n    }\n\n    try {\n      const response = await this.fetchHandler.call(undefined, reqUrl, init)\n\n      const resStatus = response.status\n      const resHeaders = Object.fromEntries(response.headers.entries())\n      const resBodyBytes = await response.arrayBuffer()\n      const resBody = httpResponseBodyParse(\n        response.headers.get('content-type'),\n        resBodyBytes,\n      )\n\n      const resCode = httpResponseCodeToEnum(resStatus)\n      if (resCode !== ResponseType.Success) {\n        const { error = undefined, message = undefined } =\n          resBody && isErrorResponseBody(resBody) ? resBody : {}\n        throw new XRPCError(resCode, error, message, resHeaders)\n      }\n\n      try {\n        this.lex.assertValidXrpcOutput(methodNsid, resBody)\n      } catch (e: unknown) {\n        if (e instanceof ValidationError) {\n          throw new XRPCInvalidResponseError(methodNsid, e, resBody)\n        }\n\n        throw e\n      }\n\n      return new XRPCResponse(resBody, resHeaders)\n    } catch (err) {\n      throw XRPCError.from(err)\n    }\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 8235, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8240, "column": 0}, "map": {"version":3,"file":"client.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/xrpc/src/client.ts"],"sourcesContent":["import { LexiconDoc, Lexicons } from '@atproto/lexicon'\nimport { CallOptions, QueryParams } from './types'\nimport { XrpcClient } from './xrpc-client'\nimport { combineHeaders } from './util'\n\n/** @deprecated Use {@link XrpcClient} instead */\nexport class Client {\n  /** @deprecated */\n  get fetch(): never {\n    throw new Error(\n      'Client.fetch is no longer supported. Use an XrpcClient instead.',\n    )\n  }\n\n  /** @deprecated */\n  set fetch(_: never) {\n    throw new Error(\n      'Client.fetch is no longer supported. Use an XrpcClient instead.',\n    )\n  }\n\n  lex = new Lexicons()\n\n  // method calls\n  //\n\n  async call(\n    serviceUri: string | URL,\n    methodNsid: string,\n    params?: QueryParams,\n    data?: BodyInit | null,\n    opts?: CallOptions,\n  ) {\n    return this.service(serviceUri).call(methodNsid, params, data, opts)\n  }\n\n  service(serviceUri: string | URL) {\n    return new ServiceClient(this, serviceUri)\n  }\n\n  // schemas\n  // =\n\n  addLexicon(doc: LexiconDoc) {\n    this.lex.add(doc)\n  }\n\n  addLexicons(docs: LexiconDoc[]) {\n    for (const doc of docs) {\n      this.addLexicon(doc)\n    }\n  }\n\n  removeLexicon(uri: string) {\n    this.lex.remove(uri)\n  }\n}\n\n/** @deprecated Use {@link XrpcClient} instead */\nexport class ServiceClient extends XrpcClient {\n  uri: URL\n\n  constructor(\n    public baseClient: Client,\n    serviceUri: string | URL,\n  ) {\n    super(async (input, init) => {\n      const headers = combineHeaders(init.headers, Object.entries(this.headers))\n      return fetch(new URL(input, this.uri), { ...init, headers })\n    }, baseClient.lex)\n    this.uri = typeof serviceUri === 'string' ? new URL(serviceUri) : serviceUri\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,wCAAuD;AAEvD,MAAA,yCAA0C;AAC1C,MAAA,2BAAuC;AAEvC,+CAAA,EAAiD,CACjD,MAAa,MAAM;IAAnB,aAAA;QAeE,OAAA,cAAA,CAAA,IAAA,EAAA,OAAA;;;;mBAAM,IAAI,UAAA,QAAQ,EAAE;WAAA;IAmCtB,CAAC;IAjDC,gBAAA,EAAkB,CAClB,IAAI,KAAK,GAAA;QACP,MAAM,IAAI,KAAK,CACb,iEAAiE,CAClE,CAAA;IACH,CAAC;IAED,gBAAA,EAAkB,CAClB,IAAI,KAAK,CAAC,CAAQ,EAAA;QAChB,MAAM,IAAI,KAAK,CACb,iEAAiE,CAClE,CAAA;IACH,CAAC;IAID,eAAe;IACf,EAAE;IAEF,KAAK,CAAC,IAAI,CACR,UAAwB,EACxB,UAAkB,EAClB,MAAoB,EACpB,IAAsB,EACtB,IAAkB,EAAA;QAElB,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,CAAA;IACtE,CAAC;IAED,OAAO,CAAC,UAAwB,EAAA;QAC9B,OAAO,IAAI,aAAa,CAAC,IAAI,EAAE,UAAU,CAAC,CAAA;IAC5C,CAAC;IAED,UAAU;IACV,IAAI;IAEJ,UAAU,CAAC,GAAe,EAAA;QACxB,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;IACnB,CAAC;IAED,WAAW,CAAC,IAAkB,EAAA;QAC5B,KAAK,MAAM,GAAG,IAAI,IAAI,CAAE,CAAC;YACvB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAA;QACtB,CAAC;IACH,CAAC;IAED,aAAa,CAAC,GAAW,EAAA;QACvB,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;IACtB,CAAC;CACF;AAlDD,QAAA,MAAA,GAAA,OAkDC;AAED,+CAAA,EAAiD,CACjD,MAAa,aAAc,SAAQ,cAAA,UAAU;IAG3C,YACS,UAAkB,EACzB,UAAwB,CAAA;QAExB,KAAK,CAAC,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE;YAC1B,MAAM,OAAO,GAAG,CAAA,GAAA,OAAA,cAAc,EAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAA;YAC1E,OAAO,KAAK,CAAC,IAAI,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE;gBAAE,GAAG,IAAI;gBAAE,OAAO;YAAA,CAAE,CAAC,CAAA;QAC9D,CAAC,EAAE,UAAU,CAAC,GAAG,CAAC,CAAA;QANlB,OAAA,cAAA,CAAA,IAAA,EAAA,cAAA;;;;mBAAO,UAAU;WAAQ;QAH3B,OAAA,cAAA,CAAA,IAAA,EAAA,OAAA;;;;;WAAQ;QAUN,IAAI,CAAC,GAAG,GAAG,OAAO,UAAU,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,UAAU,CAAA;IAC9E,CAAC;CACF;AAbD,QAAA,aAAA,GAAA,cAaC","ignoreList":[0]}},
    {"offset": {"line": 8311, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8316, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/xrpc/src/index.ts"],"sourcesContent":["export * from './client'\nexport * from './fetch-handler'\nexport * from './types'\nexport * from './util'\nexport * from './xrpc-client'\n\nimport { Client } from './client'\n/** @deprecated create a local {@link XrpcClient} instance instead */\nconst defaultInst = new Client()\nexport default defaultInst\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,qHAAA,SAAwB;AACxB,4HAAA,SAA+B;AAC/B,oHAAA,SAAuB;AACvB,mHAAA,SAAsB;AACtB,0HAAA,SAA6B;AAE7B,MAAA,+BAAiC;AACjC,mEAAA,EAAqE,CACrE,MAAM,WAAW,GAAG,IAAI,SAAA,MAAM,EAAE,CAAA;AAChC,QAAA,OAAA,GAAe,WAAW,CAAA","ignoreList":[0]}},
    {"offset": {"line": 8347, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8357, "column": 0}, "map": {"version":3,"file":"AwaitLock.js","sources":["file:///Users/mg/event-horizon/node_modules/await-lock/src/AwaitLock.ts"],"sourcesContent":["/**\n * A mutex lock for coordination across async functions\n */\nexport default class AwaitLock {\n  #acquired: boolean = false;\n  #waitingResolvers: Set<() => void> = new Set();\n\n  /**\n   * Whether the lock is currently acquired or not. Accessing this property does not affect the\n   * status of the lock.\n   */\n  get acquired(): boolean {\n    return this.#acquired;\n  }\n\n  /**\n   * Acquires the lock, waiting if necessary for it to become free if it is already locked. The\n   * returned promise is fulfilled once the lock is acquired.\n   *\n   * A timeout (in milliseconds) may be optionally provided. If the lock cannot be acquired before\n   * the timeout elapses, the returned promise is rejected with an error. The behavior of invalid\n   * timeout values depends on how `setTimeout` handles those values.\n   *\n   * After acquiring the lock, you **must** call `release` when you are done with it.\n   */\n  acquireAsync({ timeout }: { timeout?: number } = {}): Promise<void> {\n    if (!this.#acquired) {\n      this.#acquired = true;\n      return Promise.resolve();\n    }\n\n    if (timeout == null) {\n      return new Promise((resolve) => {\n        this.#waitingResolvers.add(resolve);\n      });\n    }\n\n    let resolver: () => void;\n    let timer: ReturnType<typeof setTimeout>;\n\n    return Promise.race<void>([\n      new Promise((resolve) => {\n        resolver = () => {\n          clearTimeout(timer);\n          resolve();\n        };\n        this.#waitingResolvers.add(resolver);\n      }),\n      new Promise<void>((_, reject) => {\n        timer = setTimeout(() => {\n          this.#waitingResolvers.delete(resolver);\n          reject(new Error(`Timed out waiting for lock`));\n        }, timeout);\n      }),\n    ]);\n  }\n\n  /**\n   * Acquires the lock if it is free and otherwise returns immediately without waiting. Returns\n   * `true` if the lock was free and is now acquired, and `false` otherwise.\n   *\n   * This method differs from calling `acquireAsync` with a zero-millisecond timeout in that it runs\n   * synchronously without waiting for the JavaScript task queue.\n   */\n  tryAcquire(): boolean {\n    if (!this.#acquired) {\n      this.#acquired = true;\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Releases the lock and gives it to the next waiting acquirer, if there is one. Each acquirer\n   * must release the lock exactly once.\n   */\n  release(): void {\n    if (!this.#acquired) {\n      throw new Error(`Cannot release an unacquired lock`);\n    }\n\n    if (this.#waitingResolvers.size > 0) {\n      // Sets preserve insertion order like a queue\n      const [resolve] = this.#waitingResolvers;\n      this.#waitingResolvers.delete(resolve);\n      resolve();\n    } else {\n      this.#acquired = false;\n    }\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;GAEG,CACH,MAAqB,SAAS;IAA9B,aAAA;QACE,oBAAA,GAAA,CAAA,IAAA,EAAqB,KAAK,EAAC;QAC3B,4BAAA,GAAA,CAAA,IAAA,EAAqC,IAAI,GAAG,EAAE,EAAC;IAsFjD,CAAC;IApFC;;;OAGG,CACH,IAAI,QAAQ,GAAA;QACV,OAAO,uBAAA,IAAI,EAAA,qBAAA,IAAU,CAAC;IACxB,CAAC;IAED;;;;;;;;;OASG,CACH,YAAY,CAAC,EAAE,OAAO,EAAA,GAA2B,CAAA,CAAE,EAAA;QACjD,IAAI,CAAC,uBAAA,IAAI,EAAA,qBAAA,IAAU,EAAE;YACnB,uBAAA,IAAI,EAAA,qBAAa,IAAI,EAAA,IAAA,CAAC;YACtB,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;SAC1B;QAED,IAAI,OAAO,IAAI,IAAI,EAAE;YACnB,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;gBAC7B,uBAAA,IAAI,EAAA,6BAAA,IAAkB,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YACtC,CAAC,CAAC,CAAC;SACJ;QAED,IAAI,QAAoB,CAAC;QACzB,IAAI,KAAoC,CAAC;QAEzC,OAAO,OAAO,CAAC,IAAI,CAAO;YACxB,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;gBACtB,QAAQ,GAAG,GAAG,EAAE;oBACd,YAAY,CAAC,KAAK,CAAC,CAAC;oBACpB,OAAO,EAAE,CAAC;gBACZ,CAAC,CAAC;gBACF,uBAAA,IAAI,EAAA,6BAAA,IAAkB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YACvC,CAAC,CAAC;YACF,IAAI,OAAO,CAAO,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE;gBAC9B,KAAK,GAAG,UAAU,CAAC,GAAG,EAAE;oBACtB,uBAAA,IAAI,EAAA,6BAAA,IAAkB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;oBACxC,MAAM,CAAC,IAAI,KAAK,CAAC,CAAA,0BAAA,CAA4B,CAAC,CAAC,CAAC;gBAClD,CAAC,EAAE,OAAO,CAAC,CAAC;YACd,CAAC,CAAC;SACH,CAAC,CAAC;IACL,CAAC;IAED;;;;;;OAMG,CACH,UAAU,GAAA;QACR,IAAI,CAAC,uBAAA,IAAI,EAAA,qBAAA,IAAU,EAAE;YACnB,uBAAA,IAAI,EAAA,qBAAa,IAAI,EAAA,IAAA,CAAC;YACtB,OAAO,IAAI,CAAC;SACb;QAED,OAAO,KAAK,CAAC;IACf,CAAC;IAED;;;OAGG,CACH,OAAO,GAAA;QACL,IAAI,CAAC,uBAAA,IAAI,EAAA,qBAAA,IAAU,EAAE;YACnB,MAAM,IAAI,KAAK,CAAC,CAAA,iCAAA,CAAmC,CAAC,CAAC;SACtD;QAED,IAAI,uBAAA,IAAI,EAAA,6BAAA,IAAkB,CAAC,IAAI,GAAG,CAAC,EAAE;YACnC,6CAA6C;YAC7C,MAAM,CAAC,OAAO,CAAC,GAAG,uBAAA,IAAI,EAAA,6BAAA,IAAkB,CAAC;YACzC,uBAAA,IAAI,EAAA,6BAAA,IAAkB,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACvC,OAAO,EAAE,CAAC;SACX,MAAM;YACL,uBAAA,IAAI,EAAA,qBAAa,KAAK,EAAA,IAAA,CAAC;SACxB;IACH,CAAC;CACF;AAxFD,QAAA,OAAA,GAAA,UAwFC","ignoreList":[0]}},
    {"offset": {"line": 8455, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8460, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/disposable-polyfill/index.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/disposable-polyfill/index.ts"],"names":[],"mappings":";AAAA,yEAAyE;AACzE,6EAA6E;AAC7E,8EAA8E;AAC9E,+EAA+E;AAC/E,qBAAqB;AAErB,mBAAmB;AACnB,MAAM,CAAC,OAAO,IAAA,CAAd,MAAM,CAAC,OAAO,GAAK,MAAM,CAAC,WAAW,CAAC,EAAA;AACtC,mBAAmB;AACnB,MAAM,CAAC,YAAY,IAAA,CAAnB,MAAM,CAAC,YAAY,GAAK,MAAM,CAAC,gBAAgB,CAAC,EAAA","ignoreList":[0]}},
    {"offset": {"line": 8470, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8475, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/indexed-db/util.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/indexed-db/util.ts"],"names":[],"mappings":";;;;AAAA,QAAA,aAAA,GAAA,cAmBC;AAED,QAAA,SAAA,GAAA,UAIC;AAzBD,SAAgB,aAAa,CAC3B,OAAsB,EACtB,SAA8B,EAC9B,OAA+B;IAE/B,MAAM,OAAO,GAAG,GAAG,EAAE;QACnB,OAAO,CAAC,mBAAmB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAA;QAC/C,OAAO,CAAC,mBAAmB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAA;IAC7C,CAAC,CAAA;IACD,MAAM,OAAO,GAAG,GAAG,EAAE;QACnB,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;QACzB,OAAO,EAAE,CAAA;IACX,CAAC,CAAA;IACD,MAAM,KAAK,GAAG,GAAG,EAAE;QACjB,OAAO,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAA;QACpD,OAAO,EAAE,CAAA;IACX,CAAC,CAAA;IACD,OAAO,CAAC,gBAAgB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAA;IAC5C,OAAO,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAA;AAC1C,CAAC;AAED,SAAgB,SAAS,CAAI,OAAsB;IACjD,OAAO,IAAI,OAAO,CAAI,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;QACxC,aAAa,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAAA;IACzC,CAAC,CAAC,CAAA;AACJ,CAAC","ignoreList":[0]}},
    {"offset": {"line": 8502, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8507, "column": 0}, "map": {"version":3,"file":"db-index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/indexed-db/db-index.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/indexed-db/db-index.ts"],"names":[],"mappings":";;;;;AACA,MAAA,iCAAqC;AAErC,MAAa,OAAO;IAClB,YAAoB,QAAkB,CAAA;QAA1B,OAAA,cAAA,CAAA,IAAA,EAAA,YAAA;;;;mBAAQ,QAAQ;WAAU;IAAG,CAAC;IAE1C,KAAK,CAAC,KAAiC,EAAA;QACrC,OAAO,CAAA,GAAA,UAAA,SAAS,EAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAA;IAC9C,CAAC;IAED,GAAG,CAAC,KAAgC,EAAA;QAClC,OAAO,CAAA,GAAA,UAAA,SAAS,EAAS,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAA;IACpD,CAAC;IAED,MAAM,CAAC,KAAgC,EAAA;QACrC,OAAO,CAAA,GAAA,UAAA,SAAS,EAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAA;IAC/C,CAAC;IAED,MAAM,CAAC,KAAwC,EAAE,KAAc,EAAA;QAC7D,OAAO,CAAA,GAAA,UAAA,SAAS,EAAW,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAA;IAChE,CAAC;IAED,UAAU,CAAC,KAAwC,EAAE,KAAc,EAAA;QACjE,OAAO,CAAA,GAAA,UAAA,SAAS,EAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAA;IAC1D,CAAC;IAED,SAAS,CAAC,KAAwC,EAAA;QAChD,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACrC,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;YAC9C,MAAM,CAAC,SAAS,GAAG,SAAU,KAAK;gBAChC,MAAM,MAAM,GAAI,KAAa,CAAC,MAAM,CAAC,MAA4B,CAAA;gBACjE,IAAI,MAAM,EAAE,CAAC;oBACX,MAAM,CAAC,MAAM,EAAE,CAAA;oBACf,MAAM,CAAC,QAAQ,EAAE,CAAA;gBACnB,CAAC,MAAM,CAAC;oBACN,OAAO,EAAE,CAAA;gBACX,CAAC;YACH,CAAC,CAAA;YACD,MAAM,CAAC,OAAO,GAAG,SAAU,KAAK;gBAC9B,MAAM,CAAE,KAAK,CAAC,MAAc,EAAE,KAAK,IAAI,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC,CAAA;YACvE,CAAC,CAAA;QACH,CAAC,CAAC,CAAA;IACJ,CAAC;CACF;AAxCD,QAAA,OAAA,GAAA,QAwCC","ignoreList":[0]}},
    {"offset": {"line": 8556, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8561, "column": 0}, "map": {"version":3,"file":"db-object-store.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/indexed-db/db-object-store.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/indexed-db/db-object-store.ts"],"names":[],"mappings":";;;;;AAAA,MAAA,yCAAuC;AAEvC,MAAA,iCAAqC;AAErC,MAAa,aAAa;IACxB,YAAoB,WAA2B,CAAA;QAAnC,OAAA,cAAA,CAAA,IAAA,EAAA,eAAA;;;;mBAAQ,WAAW;WAAgB;IAAG,CAAC;IAEnD,IAAI,IAAI,GAAA;QACN,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAA;IAC9B,CAAC;IAED,KAAK,CAAC,IAAY,EAAA;QAChB,OAAO,IAAI,cAAA,OAAO,CAAS,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAA;IAC1D,CAAC;IAED,GAAG,CAAC,GAA8B,EAAA;QAChC,OAAO,CAAA,GAAA,UAAA,SAAS,EAAS,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAA;IACrD,CAAC;IAED,MAAM,CAAC,KAAgC,EAAA;QACrC,OAAO,CAAA,GAAA,UAAA,SAAS,EAA0B,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAA;IAC3E,CAAC;IAED,MAAM,CAAC,KAAwC,EAAE,KAAc,EAAA;QAC7D,OAAO,CAAA,GAAA,UAAA,SAAS,EAAW,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAA;IACnE,CAAC;IAED,UAAU,CAAC,KAAwC,EAAE,KAAc,EAAA;QACjE,OAAO,CAAA,GAAA,UAAA,SAAS,EAAgB,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAA;IAC5E,CAAC;IAED,GAAG,CAAC,KAAa,EAAE,GAAiB,EAAA;QAClC,OAAO,CAAA,GAAA,UAAA,SAAS,EAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,CAAA;IACpD,CAAC;IAED,GAAG,CAAC,KAAa,EAAE,GAAiB,EAAA;QAClC,OAAO,CAAA,GAAA,UAAA,SAAS,EAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,CAAA;IACpD,CAAC;IAED,MAAM,CAAC,GAA8B,EAAA;QACnC,OAAO,CAAA,GAAA,UAAA,SAAS,EAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAA;IAChD,CAAC;IAED,KAAK,GAAA;QACH,OAAO,CAAA,GAAA,UAAA,SAAS,EAAC,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,CAAA;IAC5C,CAAC;CACF;AA1CD,QAAA,aAAA,GAAA,cA0CC","ignoreList":[0]}},
    {"offset": {"line": 8609, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8614, "column": 0}, "map": {"version":3,"file":"db-transaction.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/indexed-db/db-transaction.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/indexed-db/db-transaction.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA,MAAA,uDAAoD;AAGpD,MAAa,aAAa;IAKxB,YAAY,EAAkB,CAAA;QAF9B,kBAAA,GAAA,CAAA,IAAA,EAAA,KAAA,GAA0B;QAGxB,uBAAA,IAAI,EAAA,mBAAO,EAAE,EAAA,IAAA,CAAA;QAEb,MAAM,OAAO,GAAG,GAAG,EAAE;YACnB,OAAO,EAAE,CAAA;QACX,CAAC,CAAA;QACD,MAAM,UAAU,GAAG,GAAG,EAAE;YACtB,OAAO,EAAE,CAAA;QACX,CAAC,CAAA;QACD,MAAM,OAAO,GAAG,GAAG,EAAE;YACnB,uBAAA,IAAI,EAAA,mBAAO,IAAI,EAAA,IAAA,CAAA;YACf,EAAE,CAAC,mBAAmB,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;YACxC,EAAE,CAAC,mBAAmB,CAAC,UAAU,EAAE,UAAU,CAAC,CAAA;QAChD,CAAC,CAAA;QACD,EAAE,CAAC,gBAAgB,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;QACrC,EAAE,CAAC,gBAAgB,CAAC,UAAU,EAAE,UAAU,CAAC,CAAA;IAC7C,CAAC;IAED,IAAc,EAAE,GAAA;QACd,IAAI,CAAC,uBAAA,IAAI,EAAA,mBAAA,IAAI,EAAE,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAA;QAC3D,OAAO,uBAAA,IAAI,EAAA,mBAAA,IAAI,CAAA;IACjB,CAAC;IAED,KAAK,CAAC,KAAK,GAAA;QACT,MAAM,EAAE,EAAE,EAAE,GAAG,IAAI,CAAA;QACnB,uBAAA,IAAI,EAAA,mBAAO,IAAI,EAAA,IAAA,CAAA;QACf,EAAE,CAAC,KAAK,EAAE,CAAA;IACZ,CAAC;IAED,KAAK,CAAC,MAAM,GAAA;QACV,MAAM,EAAE,EAAE,EAAE,GAAG,IAAI,CAAA;QACnB,uBAAA,IAAI,EAAA,mBAAO,IAAI,EAAA,IAAA,CAAA;QACf,EAAE,CAAC,MAAM,EAAE,EAAE,CAAA;IACf,CAAC;IAED,WAAW,CAAkC,IAAO,EAAA;QAClD,MAAM,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,CAAA;QACvC,OAAO,IAAI,qBAAA,aAAa,CAAY,KAAK,CAAC,CAAA;IAC5C,CAAC;IAED,CAAA,CAAA,oBAAA,IAAA,WAAC,MAAM,CAAC,OAAO,EAAC,GAAA;QACd,IAAI,uBAAA,IAAI,EAAA,mBAAA,IAAI,EAAE,IAAI,CAAC,MAAM,EAAE,CAAA;IAC7B,CAAC;CACF;AAhDD,QAAA,aAAA,GAAA,cAgDC","ignoreList":[0]}},
    {"offset": {"line": 8673, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8678, "column": 0}, "map": {"version":3,"file":"db.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/indexed-db/db.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/indexed-db/db.ts"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 8789, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8794, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/indexed-db/index.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/indexed-db/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAEA,4IAAA,SAAuB;AACvB,kJAAA,SAA6B;AAC7B,yJAAA,SAAoC;AACpC,wJAAA,SAAmC","ignoreList":[0]}},
    {"offset": {"line": 8822, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 8827, "column": 0}, "map": {"version":3,"file":"browser-oauth-database.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/browser-oauth-database.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/browser-oauth-database.ts"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 9007, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9012, "column": 0}, "map": {"version":3,"file":"browser-runtime-implementation.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/browser-runtime-implementation.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/browser-runtime-implementation.ts"],"names":[],"mappings":";;;;;AAAA,MAAA,oDAAqD;AAQrD;;GAEG,CACH,MAAM,iBAAiB,GAA4B,SAAS,CAAC,KAAK,EAAE,OAAO,GACvE,CAAI,IAAY,EAAE,EAA4B,EAAc,CAC1D,CAD4D,QACnD,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE;QAAE,IAAI,EAAE,WAAW;IAAA,CAAE,EAAE,KAAK,IAAI,CAAG,CAAD,CAAG,EAAE,CAAC,GACxE,SAAS,CAAA;AAEb,MAAa,4BAA4B;IAGvC,aAAA;QAFA,OAAA,cAAA,CAAA,IAAA,EAAA,eAAA;;;;mBAAc,iBAAiB;WAAA;QAG7B,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC;YAClD,MAAM,IAAI,KAAK,CACb,iHAAiH,CAClH,CAAA;QACH,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YACtB,wEAAwE;YACxE,yEAAyE;YACzE,qBAAqB;YACrB,OAAO,CAAC,IAAI,CACV,2EAA2E,CAC5E,CAAA;QACH,CAAC;IACH,CAAC;IAED,KAAK,CAAC,SAAS,CAAC,IAAc,EAAA;QAC5B,OAAO,gBAAA,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;IACpC,CAAC;IAED,eAAe,CAAC,UAAkB,EAAA;QAChC,OAAO,MAAM,CAAC,eAAe,CAAC,IAAI,UAAU,CAAC,UAAU,CAAC,CAAC,CAAA;IAC3D,CAAC;IAED,KAAK,CAAC,MAAM,CACV,IAAgB,EAChB,EAAE,IAAI,EAAmB,EAAA;QAEzB,OAAQ,IAAI,EAAE,CAAC;YACb,KAAK,QAAQ,CAAC;YACd,KAAK,QAAQ,CAAC;YACd,KAAK,QAAQ,CAAC;gBAAC,CAAC;oBACd,MAAM,GAAG,GAAG,MAAM,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA,IAAA,EAAO,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,CAAC,CAAA;oBACpE,OAAO,IAAI,UAAU,CAAC,GAAG,CAAC,CAAA;gBAC5B,CAAC;YACD;gBACE,MAAM,IAAI,KAAK,CAAC,CAAA,8BAAA,EAAiC,IAAI,EAAE,CAAC,CAAA;QAC5D,CAAC;IACH,CAAC;CACF;AA3CD,QAAA,4BAAA,GAAA,6BA2CC","ignoreList":[0]}},
    {"offset": {"line": 9062, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9067, "column": 0}, "map": {"version":3,"file":"errors.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/errors.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/errors.ts"],"names":[],"mappings":";;;;;AAAA;;;GAGG,CACH,MAAa,iCAAkC,SAAQ,KAAK;IAE1D,aAAA;QACE,KAAK,CAAC,gDAAgD,CAAC,CAAA;QAFzD,OAAA,cAAA,CAAA,IAAA,EAAA,QAAA;;;;mBAAO,kCAAkC;WAAA;IAGzC,CAAC;CACF;AALD,QAAA,iCAAA,GAAA,kCAKC","ignoreList":[0]}},
    {"offset": {"line": 9087, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9092, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/util.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/util.ts"],"names":[],"mappings":";;;;AAeA,QAAA,qBAAA,GAAA,sBAiBC;AAhCD,MAAA,gDAAqD;AASrD;;;;;GAKG,CACH,SAAgB,qBAAqB,CACnC,QAIC,EACD,SAAS,GAAG,WAAW;IAEvB,IAAI,CAAC,CAAA,GAAA,cAAA,cAAc,EAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC;QACvC,MAAM,IAAI,SAAS,CAAC,CAAA,8BAAA,EAAiC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAA;IAC3E,CAAC;IAED,MAAM,WAAW,GAAG,CAAA,OAAA,EAAU,QAAQ,CAAC,QAAQ,KAAK,WAAW,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA,CAAA,EAAI,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,GAAG,QAAQ,CAAC,QAAQ,EAAE,CAAA;IAE7M,OAAO,CAAA,gBAAA,EACL,QAAQ,CAAC,QAAQ,KAAK,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,QAC5C,CAAA,cAAA,EAAiB,kBAAkB,CAAC,WAAW,CAAC,EAAE,CAAA;AACpD,CAAC","ignoreList":[0]}},
    {"offset": {"line": 9110, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9115, "column": 0}, "map": {"version":3,"file":"browser-oauth-client.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/browser-oauth-client.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/browser-oauth-client.ts"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 9445, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9450, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client-browser/src/index.ts"],"sourcesContent":["unable to read source [project]/node_modules/@atproto/oauth-client-browser/src/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAEA,6HAAA,SAAsC;AACtC,4HAAA,SAAqC;AAErC,mJAAA,SAAyC;AACzC,qIAAA,SAA2B;AAC3B,IAAA,iCAAiD;AAAxC,OAAA,cAAA,CAAA,SAAA,yBAAA;IAAA,YAAA;IAAA,KAAA;QAAA,OAAA,UAAA,qBAAqB;IAAA;AAAA,GAAA","ignoreList":[0]}},
    {"offset": {"line": 9486, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9491, "column": 0}, "map": {"version":3,"file":"errors.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/errors.ts"],"sourcesContent":["export type ErrorOptions = { cause?: unknown }\n\nexport const ERR_JWKS_NO_MATCHING_KEY = 'ERR_JWKS_NO_MATCHING_KEY'\nexport const ERR_JWK_INVALID = 'ERR_JWK_INVALID'\nexport const ERR_JWK_NOT_FOUND = 'ERR_JWK_NOT_FOUND'\nexport const ERR_JWT_INVALID = 'ERR_JWT_INVALID'\nexport const ERR_JWT_CREATE = 'ERR_JWT_CREATE'\nexport const ERR_JWT_VERIFY = 'ERR_JWT_VERIFY'\n\nexport class JwkError extends TypeError {\n  constructor(\n    message = 'JWK error',\n    public readonly code = ERR_JWK_INVALID,\n    options?: ErrorOptions,\n  ) {\n    super(message, options)\n  }\n}\n\nexport class JwtCreateError extends Error {\n  constructor(\n    message = 'Unable to create JWT',\n    public readonly code = ERR_JWT_CREATE,\n    options?: ErrorOptions,\n  ) {\n    super(message, options)\n  }\n\n  static from(cause: unknown, code?: string, message?: string): JwtCreateError {\n    if (cause instanceof JwtCreateError) return cause\n    if (cause instanceof JwkError) {\n      return new JwtCreateError(message, cause.code, { cause })\n    }\n\n    return new JwtCreateError(message, code, { cause })\n  }\n}\n\nexport class JwtVerifyError extends Error {\n  constructor(\n    message = 'Invalid JWT',\n    public readonly code = ERR_JWT_VERIFY,\n    options?: ErrorOptions,\n  ) {\n    super(message, options)\n  }\n\n  static from(cause: unknown, code?: string, message?: string): JwtVerifyError {\n    if (cause instanceof JwtVerifyError) return cause\n    if (cause instanceof JwkError) {\n      return new JwtVerifyError(message, cause.code, { cause })\n    }\n\n    return new JwtVerifyError(message, code, { cause })\n  }\n}\n"],"names":[],"mappings":";;;;;AAEa,QAAA,wBAAwB,GAAG,0BAA0B,CAAA;AACrD,QAAA,eAAe,GAAG,iBAAiB,CAAA;AACnC,QAAA,iBAAiB,GAAG,mBAAmB,CAAA;AACvC,QAAA,eAAe,GAAG,iBAAiB,CAAA;AACnC,QAAA,cAAc,GAAG,gBAAgB,CAAA;AACjC,QAAA,cAAc,GAAG,gBAAgB,CAAA;AAE9C,MAAa,QAAS,SAAQ,SAAS;IACrC,YACE,OAAO,GAAG,WAAW,EACL,OAAO,QAAA,eAAe,EACtC,OAAsB,CAAA;QAEtB,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;QAHvB,OAAA,cAAA,CAAA,IAAA,EAAA,QAAA;;;;mBAAgB,IAAI;WAAkB;IAIxC,CAAC;CACF;AARD,QAAA,QAAA,GAAA,SAQC;AAED,MAAa,cAAe,SAAQ,KAAK;IACvC,YACE,OAAO,GAAG,sBAAsB,EAChB,OAAO,QAAA,cAAc,EACrC,OAAsB,CAAA;QAEtB,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;QAHvB,OAAA,cAAA,CAAA,IAAA,EAAA,QAAA;;;;mBAAgB,IAAI;WAAiB;IAIvC,CAAC;IAED,MAAM,CAAC,IAAI,CAAC,KAAc,EAAE,IAAa,EAAE,OAAgB,EAAA;QACzD,IAAI,KAAK,YAAY,cAAc,EAAE,OAAO,KAAK,CAAA;QACjD,IAAI,KAAK,YAAY,QAAQ,EAAE,CAAC;YAC9B,OAAO,IAAI,cAAc,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,EAAE;gBAAE,KAAK;YAAA,CAAE,CAAC,CAAA;QAC3D,CAAC;QAED,OAAO,IAAI,cAAc,CAAC,OAAO,EAAE,IAAI,EAAE;YAAE,KAAK;QAAA,CAAE,CAAC,CAAA;IACrD,CAAC;CACF;AAjBD,QAAA,cAAA,GAAA,eAiBC;AAED,MAAa,cAAe,SAAQ,KAAK;IACvC,YACE,OAAO,GAAG,aAAa,EACP,OAAO,QAAA,cAAc,EACrC,OAAsB,CAAA;QAEtB,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;QAHvB,OAAA,cAAA,CAAA,IAAA,EAAA,QAAA;;;;mBAAgB,IAAI;WAAiB;IAIvC,CAAC;IAED,MAAM,CAAC,IAAI,CAAC,KAAc,EAAE,IAAa,EAAE,OAAgB,EAAA;QACzD,IAAI,KAAK,YAAY,cAAc,EAAE,OAAO,KAAK,CAAA;QACjD,IAAI,KAAK,YAAY,QAAQ,EAAE,CAAC;YAC9B,OAAO,IAAI,cAAc,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,EAAE;gBAAE,KAAK;YAAA,CAAE,CAAC,CAAA;QAC3D,CAAC;QAED,OAAO,IAAI,cAAc,CAAC,OAAO,EAAE,IAAI,EAAE;YAAE,KAAK;QAAA,CAAE,CAAC,CAAA;IACrD,CAAC;CACF;AAjBD,QAAA,cAAA,GAAA,eAiBC","ignoreList":[0]}},
    {"offset": {"line": 9560, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9565, "column": 0}, "map": {"version":3,"file":"alg.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/alg.ts"],"sourcesContent":["import { JwkError } from './errors.js'\nimport { Jwk } from './jwk.js'\n\n// Copy variable to prevent bundlers from automatically polyfilling \"process\" (e.g. parcel)\nconst { process } = globalThis\nconst IS_NODE_RUNTIME =\n  typeof process !== 'undefined' && typeof process?.versions?.node === 'string'\n\nexport function* jwkAlgorithms(jwk: Jwk): Generator<string> {\n  // Ed25519, Ed448, and secp256k1 always have \"alg\"\n  // OKP always has \"use\"\n  if (jwk.alg) {\n    yield jwk.alg\n    return\n  }\n\n  switch (jwk.kty) {\n    case 'EC': {\n      if (jwk.use === 'enc' || jwk.use === undefined) {\n        yield 'ECDH-ES'\n        yield 'ECDH-ES+A128KW'\n        yield 'ECDH-ES+A192KW'\n        yield 'ECDH-ES+A256KW'\n      }\n\n      if (jwk.use === 'sig' || jwk.use === undefined) {\n        const crv = 'crv' in jwk ? jwk.crv : undefined\n        switch (crv) {\n          case 'P-256':\n          case 'P-384':\n            yield `ES${crv.slice(-3)}`\n            break\n          case 'P-521':\n            yield 'ES512'\n            break\n          case 'secp256k1':\n            if (IS_NODE_RUNTIME) yield 'ES256K'\n            break\n          default:\n            throw new JwkError(`Unsupported crv \"${crv}\"`)\n        }\n      }\n\n      return\n    }\n\n    case 'OKP': {\n      if (!jwk.use) throw new JwkError('Missing \"use\" Parameter value')\n      yield 'ECDH-ES'\n      yield 'ECDH-ES+A128KW'\n      yield 'ECDH-ES+A192KW'\n      yield 'ECDH-ES+A256KW'\n      return\n    }\n\n    case 'RSA': {\n      if (jwk.use === 'enc' || jwk.use === undefined) {\n        yield 'RSA-OAEP'\n        yield 'RSA-OAEP-256'\n        yield 'RSA-OAEP-384'\n        yield 'RSA-OAEP-512'\n        if (IS_NODE_RUNTIME) yield 'RSA1_5'\n      }\n\n      if (jwk.use === 'sig' || jwk.use === undefined) {\n        yield 'PS256'\n        yield 'PS384'\n        yield 'PS512'\n        yield 'RS256'\n        yield 'RS384'\n        yield 'RS512'\n      }\n\n      return\n    }\n\n    case 'oct': {\n      if (jwk.use === 'enc' || jwk.use === undefined) {\n        yield 'A128GCMKW'\n        yield 'A192GCMKW'\n        yield 'A256GCMKW'\n        yield 'A128KW'\n        yield 'A192KW'\n        yield 'A256KW'\n      }\n\n      if (jwk.use === 'sig' || jwk.use === undefined) {\n        yield 'HS256'\n        yield 'HS384'\n        yield 'HS512'\n      }\n\n      return\n    }\n\n    default:\n      throw new JwkError(`Unsupported kty \"${jwk.kty}\"`)\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 9658, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9663, "column": 0}, "map": {"version":3,"file":"jwk.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/jwk.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const keyUsageSchema = z.enum([\n  'sign',\n  'verify',\n  'encrypt',\n  'decrypt',\n  'wrapKey',\n  'unwrapKey',\n  'deriveKey',\n  'deriveBits',\n])\n\nexport type KeyUsage = z.infer<typeof keyUsageSchema>\n\n/**\n * The \"use\" and \"key_ops\" JWK members SHOULD NOT be used together;\n * however, if both are used, the information they convey MUST be\n * consistent.  Applications should specify which of these members they\n * use, if either is to be used by the application.\n *\n * @todo Actually check that \"use\" and \"key_ops\" are consistent when both are present.\n * @see {@link https://datatracker.ietf.org/doc/html/rfc7517#section-4.3}\n */\nexport const jwkBaseSchema = z.object({\n  kty: z.string().min(1),\n  alg: z.string().min(1).optional(),\n  kid: z.string().min(1).optional(),\n  ext: z.boolean().optional(),\n  use: z.enum(['sig', 'enc']).optional(),\n  key_ops: z.array(keyUsageSchema).optional(),\n\n  x5c: z.array(z.string()).optional(), // X.509 Certificate Chain\n  x5t: z.string().min(1).optional(), // X.509 Certificate SHA-1 Thumbprint\n  'x5t#S256': z.string().min(1).optional(), // X.509 Certificate SHA-256 Thumbprint\n  x5u: z.string().url().optional(), // X.509 URL\n})\n\n/**\n * @todo: properly implement this\n */\nexport const jwkRsaKeySchema = jwkBaseSchema.extend({\n  kty: z.literal('RSA'),\n  alg: z\n    .enum(['RS256', 'RS384', 'RS512', 'PS256', 'PS384', 'PS512'])\n    .optional(),\n\n  n: z.string().min(1), // Modulus\n  e: z.string().min(1), // Exponent\n\n  d: z.string().min(1).optional(), // Private Exponent\n  p: z.string().min(1).optional(), // First Prime Factor\n  q: z.string().min(1).optional(), // Second Prime Factor\n  dp: z.string().min(1).optional(), // First Factor CRT Exponent\n  dq: z.string().min(1).optional(), // Second Factor CRT Exponent\n  qi: z.string().min(1).optional(), // First CRT Coefficient\n  oth: z\n    .array(\n      z.object({\n        r: z.string().optional(),\n        d: z.string().optional(),\n        t: z.string().optional(),\n      }),\n    )\n    .nonempty()\n\n    .optional(), // Other Primes Info\n})\n\nexport const jwkEcKeySchema = jwkBaseSchema.extend({\n  kty: z.literal('EC'),\n  alg: z.enum(['ES256', 'ES384', 'ES512']).optional(),\n  crv: z.enum(['P-256', 'P-384', 'P-521']),\n\n  x: z.string().min(1),\n  y: z.string().min(1),\n\n  d: z.string().min(1).optional(), // ECC Private Key\n})\n\nexport const jwkEcSecp256k1KeySchema = jwkBaseSchema.extend({\n  kty: z.literal('EC'),\n  alg: z.enum(['ES256K']).optional(),\n  crv: z.enum(['secp256k1']),\n\n  x: z.string().min(1),\n  y: z.string().min(1),\n\n  d: z.string().min(1).optional(), // ECC Private Key\n})\n\nexport const jwkOkpKeySchema = jwkBaseSchema.extend({\n  kty: z.literal('OKP'),\n  alg: z.enum(['EdDSA']).optional(),\n  crv: z.enum(['Ed25519', 'Ed448']),\n\n  x: z.string().min(1),\n  d: z.string().min(1).optional(), // ECC Private Key\n})\n\nexport const jwkSymKeySchema = jwkBaseSchema.extend({\n  kty: z.literal('oct'), // Octet Sequence (used to represent symmetric keys)\n  alg: z.enum(['HS256', 'HS384', 'HS512']).optional(),\n\n  k: z.string(), // Key Value (base64url encoded)\n})\n\nexport const jwkUnknownKeySchema = jwkBaseSchema.extend({\n  kty: z\n    .string()\n    .refine((v) => v !== 'RSA' && v !== 'EC' && v !== 'OKP' && v !== 'oct'),\n})\n\nexport const jwkSchema = z.union([\n  jwkUnknownKeySchema,\n  jwkRsaKeySchema,\n  jwkEcKeySchema,\n  jwkEcSecp256k1KeySchema,\n  jwkOkpKeySchema,\n  jwkSymKeySchema,\n])\n\nexport type Jwk = z.infer<typeof jwkSchema>\n\nexport const jwkValidator = jwkSchema\n  .refine((k) => k.use != null || k.key_ops != null, 'use or key_ops required')\n  .refine(\n    (k) =>\n      !k.use ||\n      !k.key_ops ||\n      k.key_ops.every((o) =>\n        k.use === 'sig'\n          ? o === 'sign' || o === 'verify'\n          : o === 'encrypt' || o === 'decrypt',\n      ),\n    'use and key_ops must be consistent',\n  )\n\nexport const jwkPubSchema = jwkValidator\n  .refine((k) => k.kid != null, 'kid is required')\n  .refine((k) => !('k' in k) && !('d' in k), 'private key not allowed')\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 9790, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9795, "column": 0}, "map": {"version":3,"file":"jwks.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/jwks.ts"],"sourcesContent":["import { z } from 'zod'\n\nimport { jwkPubSchema, jwkSchema } from './jwk.js'\n\nexport const jwksSchema = z.object({\n  keys: z.array(jwkSchema),\n})\n\nexport type Jwks = z.infer<typeof jwksSchema>\n\nexport const jwksPubSchema = z.object({\n  keys: z.array(jwkPubSchema),\n})\n\nexport type JwksPub = z.infer<typeof jwksPubSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEvB,MAAA,+BAAkD;AAErC,QAAA,UAAU,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACjC,IAAI,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,SAAA,SAAS,CAAC;CACzB,CAAC,CAAA;AAIW,QAAA,aAAa,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACpC,IAAI,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,SAAA,YAAY,CAAC;CAC5B,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 9808, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9813, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/util.ts"],"sourcesContent":["import { base64url } from 'multiformats/bases/base64'\nimport { RefinementCtx, ZodIssueCode } from 'zod'\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport type Simplify<T> = { [K in keyof T]: T[K] } & {}\nexport type Override<T, V> = Simplify<V & Omit<T, keyof V>>\n\nexport type RequiredKey<T, K extends keyof T = never> = Simplify<\n  T & {\n    [L in K]-?: unknown extends T[L]\n      ? NonNullable<unknown> | null\n      : Exclude<T[L], undefined>\n  }\n>\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport type DeepReadonly<T> = T extends Function\n  ? T\n  : T extends object\n    ? { readonly [K in keyof T]: DeepReadonly<T[K]> }\n    : T extends readonly (infer U)[]\n      ? readonly DeepReadonly<U>[]\n      : T\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport type UnReadonly<T> = T extends Function\n  ? T\n  : T extends object\n    ? { -readonly [K in keyof T]: UnReadonly<T[K]> }\n    : T extends readonly (infer U)[]\n      ? UnReadonly<U>[]\n      : T\n\nexport const isDefined = <T>(i: T | undefined): i is T => i !== undefined\n\nexport const preferredOrderCmp =\n  <T>(order: readonly T[]) =>\n  (a: T, b: T) => {\n    const aIdx = order.indexOf(a)\n    const bIdx = order.indexOf(b)\n    if (aIdx === bIdx) return 0\n    if (aIdx === -1) return 1\n    if (bIdx === -1) return -1\n    return aIdx - bIdx\n  }\n\nexport function matchesAny<T extends string | number | symbol | boolean>(\n  value: null | undefined | T | readonly T[],\n): (v: unknown) => v is T {\n  return value == null\n    ? (v): v is T => true\n    : Array.isArray(value)\n      ? (v): v is T => value.includes(v)\n      : (v): v is T => v === value\n}\n\n/**\n * Decorator to cache the result of a getter on a class instance.\n */\nexport const cachedGetter = <T extends object, V>(\n  target: (this: T) => V,\n  _context: ClassGetterDecoratorContext<T, V>,\n) => {\n  return function (this: T) {\n    const value = target.call(this)\n    Object.defineProperty(this, target.name, {\n      get: () => value,\n      enumerable: true,\n      configurable: true,\n    })\n    return value\n  }\n}\n\nconst decoder = new TextDecoder()\nexport function parseB64uJson(input: string): unknown {\n  const inputBytes = base64url.baseDecode(input)\n  const json = decoder.decode(inputBytes)\n  return JSON.parse(json)\n}\n\n/**\n * @example\n * ```ts\n * // jwtSchema will only allow base64url chars & \".\" (dot)\n * const jwtSchema = z.string().superRefine(jwtCharsRefinement)\n * ```\n */\nexport const jwtCharsRefinement = (data: string, ctx: RefinementCtx): void => {\n  // Note: this is a hot path, let's avoid using a RegExp\n  let char\n\n  for (let i = 0; i < data.length; i++) {\n    char = data.charCodeAt(i)\n\n    if (\n      // Base64 URL encoding (most frequent)\n      (65 <= char && char <= 90) || // A-Z\n      (97 <= char && char <= 122) || // a-z\n      (48 <= char && char <= 57) || // 0-9\n      char === 45 || // -\n      char === 95 || // _\n      // Boundary (least frequent, check last)\n      char === 46 // .\n    ) {\n      // continue\n    } else {\n      // Invalid char might be a surrogate pair\n      const invalidChar = String.fromCodePoint(data.codePointAt(i)!)\n      return ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message: `Invalid character \"${invalidChar}\" in JWT at position ${i}`,\n      })\n    }\n  }\n}\n\n/**\n * @example\n * ```ts\n * type SegmentedString3 = SegmentedString<3> // `${string}.${string}.${string}`\n * type SegmentedString4 = SegmentedString<4> // `${string}.${string}.${string}.${string}`\n * ```\n *\n * @note\n * This utility only provides one way type safety (A SegmentedString<4> can be\n * assigned to SegmentedString<3> but not vice versa). The purpose of this\n * utility is to improve DX by avoiding as many potential errors as build time.\n * DO NOT rely on this to enforce security or data integrity.\n */\ntype SegmentedString<\n  C extends number,\n  Acc extends string[] = [string],\n> = Acc['length'] extends C\n  ? `${Acc[0]}`\n  : `${Acc[0]}.${SegmentedString<C, [string, ...Acc]>}`\n\n/**\n * @example\n * ```ts\n * const jwtSchema = z.string().superRefine(segmentedStringRefinementFactory(3))\n * type Jwt = z.infer<typeof jwtSchema> // `${string}.${string}.${string}`\n * ```\n */\nexport const segmentedStringRefinementFactory = <C extends number>(\n  count: C,\n  minPartLength = 2,\n) => {\n  if (!Number.isFinite(count) || count < 1 || (count | 0) !== count) {\n    throw new TypeError(`Count must be a natural number (got ${count})`)\n  }\n\n  const minTotalLength = count * minPartLength + (count - 1)\n  const errorPrefix = `Invalid JWT format`\n\n  return (data: string, ctx: RefinementCtx): data is SegmentedString<C> => {\n    if (data.length < minTotalLength) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message: `${errorPrefix}: too short`,\n      })\n      return false\n    }\n    let currentStart = 0\n    for (let i = 0; i < count - 1; i++) {\n      const nextDot = data.indexOf('.', currentStart)\n      if (nextDot === -1) {\n        ctx.addIssue({\n          code: ZodIssueCode.custom,\n          message: `${errorPrefix}: expected ${count} segments, got ${i + 1}`,\n        })\n        return false\n      }\n      if (nextDot - currentStart < minPartLength) {\n        ctx.addIssue({\n          code: ZodIssueCode.custom,\n          message: `${errorPrefix}: segment ${i + 1} is too short`,\n        })\n        return false\n      }\n      currentStart = nextDot + 1\n    }\n    if (data.indexOf('.', currentStart) !== -1) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message: `${errorPrefix}: too many segments`,\n      })\n      return false\n    }\n    if (data.length - currentStart < minPartLength) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message: `${errorPrefix}: last segment is too short`,\n      })\n      return false\n    }\n    return true\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 9943, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 9948, "column": 0}, "map": {"version":3,"file":"jwt.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/jwt.ts"],"sourcesContent":["import { z } from 'zod'\n\nimport { jwkPubSchema } from './jwk.js'\nimport { jwtCharsRefinement, segmentedStringRefinementFactory } from './util.js'\n\nexport const signedJwtSchema = z\n  .string()\n  .superRefine(jwtCharsRefinement)\n  .superRefine(segmentedStringRefinementFactory(3))\n\nexport type SignedJwt = z.infer<typeof signedJwtSchema>\nexport const isSignedJwt = (data: unknown): data is SignedJwt =>\n  signedJwtSchema.safeParse(data).success\n\nexport const unsignedJwtSchema = z\n  .string()\n  .superRefine(jwtCharsRefinement)\n  .superRefine(segmentedStringRefinementFactory(2))\n\nexport type UnsignedJwt = z.infer<typeof unsignedJwtSchema>\nexport const isUnsignedJwt = (data: unknown): data is UnsignedJwt =>\n  unsignedJwtSchema.safeParse(data).success\n\n/**\n * @see {@link https://www.rfc-editor.org/rfc/rfc7515.html#section-4}\n */\nexport const jwtHeaderSchema = z\n  .object({\n    /** \"alg\" (Algorithm) Header Parameter */\n    alg: z.string(),\n    /** \"jku\" (JWK Set URL) Header Parameter */\n    jku: z.string().url().optional(),\n    /** \"jwk\" (JSON Web Key) Header Parameter */\n    jwk: z\n      .object({\n        kty: z.string(),\n        crv: z.string().optional(),\n        x: z.string().optional(),\n        y: z.string().optional(),\n        e: z.string().optional(),\n        n: z.string().optional(),\n      })\n      .optional(),\n    /** \"kid\" (Key ID) Header Parameter */\n    kid: z.string().optional(),\n    /** \"x5u\" (X.509 URL) Header Parameter */\n    x5u: z.string().optional(),\n    /** \"x5c\" (X.509 Certificate Chain) Header Parameter */\n    x5c: z.array(z.string()).optional(),\n    /** \"x5t\" (X.509 Certificate SHA-1 Thumbprint) Header Parameter */\n    x5t: z.string().optional(),\n    /** \"x5t#S256\" (X.509 Certificate SHA-256 Thumbprint) Header Parameter */\n    'x5t#S256': z.string().optional(),\n    /** \"typ\" (Type) Header Parameter */\n    typ: z.string().optional(),\n    /** \"cty\" (Content Type) Header Parameter */\n    cty: z.string().optional(),\n    /** \"crit\" (Critical) Header Parameter */\n    crit: z.array(z.string()).optional(),\n  })\n  .passthrough()\n\nexport type JwtHeader = z.infer<typeof jwtHeaderSchema>\n\n// https://www.iana.org/assignments/jwt/jwt.xhtml\nexport const jwtPayloadSchema = z\n  .object({\n    iss: z.string().optional(),\n    aud: z.union([z.string(), z.array(z.string()).nonempty()]).optional(),\n    sub: z.string().optional(),\n    exp: z.number().int().optional(),\n    nbf: z.number().int().optional(),\n    iat: z.number().int().optional(),\n    jti: z.string().optional(),\n    htm: z.string().optional(),\n    htu: z.string().optional(),\n    ath: z.string().optional(),\n    acr: z.string().optional(),\n    azp: z.string().optional(),\n    amr: z.array(z.string()).optional(),\n    // https://datatracker.ietf.org/doc/html/rfc7800\n    cnf: z\n      .object({\n        kid: z.string().optional(), // Key ID\n        jwk: jwkPubSchema.optional(), // JWK\n        jwe: z.string().optional(), // Encrypted key\n        jku: z.string().url().optional(), // JWK Set URI (\"kid\" should also be provided)\n\n        // https://datatracker.ietf.org/doc/html/rfc9449#section-6.1\n        jkt: z.string().optional(),\n\n        // https://datatracker.ietf.org/doc/html/rfc8705\n        'x5t#S256': z.string().optional(), // X.509 Certificate SHA-256 Thumbprint\n\n        // https://datatracker.ietf.org/doc/html/rfc9203\n        osc: z.string().optional(), // OSCORE_Input_Material carrying the parameters for using OSCORE per-message security with implicit key confirmation\n      })\n      .optional(),\n\n    client_id: z.string().optional(),\n\n    scope: z.string().optional(),\n    nonce: z.string().optional(),\n\n    at_hash: z.string().optional(),\n    c_hash: z.string().optional(),\n    s_hash: z.string().optional(),\n    auth_time: z.number().int().optional(),\n\n    // https://openid.net/specs/openid-connect-core-1_0.html#StandardClaims\n\n    // OpenID: \"profile\" scope\n    name: z.string().optional(),\n    family_name: z.string().optional(),\n    given_name: z.string().optional(),\n    middle_name: z.string().optional(),\n    nickname: z.string().optional(),\n    preferred_username: z.string().optional(),\n    gender: z.string().optional(), // OpenID only defines \"male\" and \"female\" without forbidding other values\n    picture: z.string().url().optional(),\n    profile: z.string().url().optional(),\n    website: z.string().url().optional(),\n    birthdate: z\n      .string()\n      .regex(/\\d{4}-\\d{2}-\\d{2}/) // YYYY-MM-DD\n      .optional(),\n    zoneinfo: z\n      .string()\n      .regex(/^[A-Za-z0-9_/]+$/)\n      .optional(),\n    locale: z\n      .string()\n      .regex(/^[a-z]{2}(-[A-Z]{2})?$/)\n      .optional(),\n    updated_at: z.number().int().optional(),\n\n    // OpenID: \"email\" scope\n    email: z.string().optional(),\n    email_verified: z.boolean().optional(),\n\n    // OpenID: \"phone\" scope\n    phone_number: z.string().optional(),\n    phone_number_verified: z.boolean().optional(),\n\n    // OpenID: \"address\" scope\n    // https://openid.net/specs/openid-connect-core-1_0.html#AddressClaim\n    address: z\n      .object({\n        formatted: z.string().optional(),\n        street_address: z.string().optional(),\n        locality: z.string().optional(),\n        region: z.string().optional(),\n        postal_code: z.string().optional(),\n        country: z.string().optional(),\n      })\n      .optional(),\n\n    // https://datatracker.ietf.org/doc/html/rfc9396#section-14.2\n    authorization_details: z\n      .array(\n        z\n          .object({\n            type: z.string(),\n            // https://datatracker.ietf.org/doc/html/rfc9396#section-2.2\n            locations: z.array(z.string()).optional(),\n            actions: z.array(z.string()).optional(),\n            datatypes: z.array(z.string()).optional(),\n            identifier: z.string().optional(),\n            privileges: z.array(z.string()).optional(),\n          })\n          .passthrough(),\n      )\n      .optional(),\n  })\n  .passthrough()\n\nexport type JwtPayload = z.infer<typeof jwtPayloadSchema>\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 10066, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10071, "column": 0}, "map": {"version":3,"file":"jwt-decode.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/jwt-decode.ts"],"sourcesContent":["import { ERR_JWT_INVALID, JwtVerifyError } from './errors.js'\nimport {\n  JwtHeader,\n  JwtPayload,\n  jwtHeaderSchema,\n  jwtPayloadSchema,\n} from './jwt.js'\nimport { parseB64uJson } from './util.js'\n\nexport function unsafeDecodeJwt(jwt: string): {\n  header: JwtHeader\n  payload: JwtPayload\n} {\n  const { 0: headerEnc, 1: payloadEnc, length } = jwt.split('.')\n  if (length > 3 || length < 2) {\n    throw new JwtVerifyError(undefined, ERR_JWT_INVALID)\n  }\n\n  const header = jwtHeaderSchema.parse(parseB64uJson(headerEnc!))\n  if (length === 2 && header?.alg !== 'none') {\n    throw new JwtVerifyError(undefined, ERR_JWT_INVALID)\n  }\n\n  const payload = jwtPayloadSchema.parse(parseB64uJson(payloadEnc!))\n\n  return { header, payload }\n}\n"],"names":[],"mappings":";;;;AASA,QAAA,eAAA,GAAA,gBAiBC;AA1BD,MAAA,qCAA6D;AAC7D,MAAA,+BAKiB;AACjB,MAAA,iCAAyC;AAEzC,SAAgB,eAAe,CAAC,GAAW;IAIzC,MAAM,EAAE,CAAC,EAAE,SAAS,EAAE,CAAC,EAAE,UAAU,EAAE,MAAM,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;IAC9D,IAAI,MAAM,GAAG,CAAC,IAAI,MAAM,GAAG,CAAC,EAAE,CAAC;QAC7B,MAAM,IAAI,YAAA,cAAc,CAAC,SAAS,EAAE,YAAA,eAAe,CAAC,CAAA;IACtD,CAAC;IAED,MAAM,MAAM,GAAG,SAAA,eAAe,CAAC,KAAK,CAAC,CAAA,GAAA,UAAA,aAAa,EAAC,SAAU,CAAC,CAAC,CAAA;IAC/D,IAAI,MAAM,KAAK,CAAC,IAAI,MAAM,EAAE,GAAG,KAAK,MAAM,EAAE,CAAC;QAC3C,MAAM,IAAI,YAAA,cAAc,CAAC,SAAS,EAAE,YAAA,eAAe,CAAC,CAAA;IACtD,CAAC;IAED,MAAM,OAAO,GAAG,SAAA,gBAAgB,CAAC,KAAK,CAAC,CAAA,GAAA,UAAA,aAAa,EAAC,UAAW,CAAC,CAAC,CAAA;IAElE,OAAO;QAAE,MAAM;QAAE,OAAO;IAAA,CAAE,CAAA;AAC5B,CAAC","ignoreList":[0]}},
    {"offset": {"line": 10094, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10099, "column": 0}, "map": {"version":3,"file":"jwt-verify.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/jwt-verify.ts"],"sourcesContent":["import { JwtHeader, JwtPayload } from './jwt.js'\nimport { RequiredKey } from './util.js'\n\nexport type VerifyOptions<C extends string = never> = {\n  audience?: string | readonly string[]\n  /** in seconds */\n  clockTolerance?: number\n  issuer?: string | readonly string[]\n  /** in seconds */\n  maxTokenAge?: number\n  subject?: string\n  typ?: string\n  currentDate?: Date\n  requiredClaims?: readonly C[]\n}\n\nexport type VerifyResult<C extends string = never> = {\n  payload: RequiredKey<JwtPayload, C>\n  protectedHeader: JwtHeader\n}\n"],"names":[],"mappings":"","ignoreList":[0]}},
    {"offset": {"line": 10103, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10108, "column": 0}, "map": {"version":3,"file":"key.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/key.ts"],"sourcesContent":["import { jwkAlgorithms } from './alg.js'\nimport { JwkError } from './errors.js'\nimport { Jwk, jwkSchema } from './jwk.js'\nimport { VerifyOptions, VerifyResult } from './jwt-verify.js'\nimport { JwtHeader, JwtPayload, SignedJwt } from './jwt.js'\nimport { cachedGetter } from './util.js'\n\nconst jwkSchemaReadonly = jwkSchema.readonly()\n\nexport abstract class Key<J extends Jwk = Jwk> {\n  constructor(protected readonly jwk: Readonly<J>) {\n    // A key should always be used either for signing or encryption.\n    if (!jwk.use) throw new JwkError('Missing \"use\" Parameter value')\n  }\n\n  get isPrivate(): boolean {\n    const { jwk } = this\n    if ('d' in jwk && jwk.d !== undefined) return true\n    if ('k' in jwk && jwk.k !== undefined) return true\n    return false\n  }\n\n  get isSymetric(): boolean {\n    const { jwk } = this\n    if ('k' in jwk && jwk.k !== undefined) return true\n    return false\n  }\n\n  get privateJwk(): Readonly<J> | undefined {\n    return this.isPrivate ? this.jwk : undefined\n  }\n\n  @cachedGetter\n  get publicJwk():\n    | Readonly<Exclude<J, { kty: 'oct' }> & { d?: never }>\n    | undefined {\n    if (this.isSymetric) return undefined\n\n    return jwkSchemaReadonly.parse({\n      ...this.jwk,\n      d: undefined,\n      k: undefined,\n    }) as Exclude<J, { kty: 'oct' }> & { d?: never }\n  }\n\n  @cachedGetter\n  get bareJwk(): Readonly<Jwk> | undefined {\n    if (this.isSymetric) return undefined\n    const { kty, crv, e, n, x, y } = this.jwk as any\n    return jwkSchemaReadonly.parse({ crv, e, kty, n, x, y })\n  }\n\n  get use() {\n    return this.jwk.use!\n  }\n\n  /**\n   * The (forced) algorithm to use. If not provided, the key will be usable with\n   * any of the algorithms in {@link algorithms}.\n   *\n   * @see {@link https://datatracker.ietf.org/doc/html/rfc7518#section-3.1 | \"alg\" (Algorithm) Header Parameter Values for JWS}\n   */\n  get alg() {\n    return this.jwk.alg\n  }\n\n  get kid() {\n    return this.jwk.kid\n  }\n\n  get crv() {\n    return (this.jwk as { crv: undefined } | Extract<J, { crv: unknown }>).crv\n  }\n\n  /**\n   * All the algorithms that this key can be used with. If `alg` is provided,\n   * this set will only contain that algorithm.\n   */\n  @cachedGetter\n  get algorithms(): readonly string[] {\n    return Object.freeze(Array.from(jwkAlgorithms(this.jwk)))\n  }\n\n  /**\n   * Create a signed JWT\n   */\n  abstract createJwt(header: JwtHeader, payload: JwtPayload): Promise<SignedJwt>\n\n  /**\n   * Verify the signature, headers and payload of a JWT\n   *\n   * @throws {JwtVerifyError} if the JWT is invalid\n   */\n  abstract verifyJwt<C extends string = never>(\n    token: SignedJwt,\n    options?: VerifyOptions<C>,\n  ): Promise<VerifyResult<C>>\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 10287, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10292, "column": 0}, "map": {"version":3,"file":"keyset.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/keyset.ts"],"sourcesContent":["import {\n  ERR_JWKS_NO_MATCHING_KEY,\n  ERR_JWK_NOT_FOUND,\n  ERR_JWT_INVALID,\n  JwkError,\n  JwtCreateError,\n  JwtVerifyError,\n} from './errors.js'\nimport { Jwk } from './jwk.js'\nimport { Jwks, JwksPub } from './jwks.js'\nimport { unsafeDecodeJwt } from './jwt-decode.js'\nimport { VerifyOptions, VerifyResult } from './jwt-verify.js'\nimport { JwtHeader, JwtPayload, SignedJwt } from './jwt.js'\nimport { Key } from './key.js'\nimport {\n  DeepReadonly,\n  Override,\n  UnReadonly,\n  cachedGetter,\n  isDefined,\n  matchesAny,\n  preferredOrderCmp,\n} from './util.js'\n\nexport type JwtSignHeader = Override<JwtHeader, Pick<KeySearch, 'alg' | 'kid'>>\n\nexport type JwtPayloadGetter<P = JwtPayload> = (\n  header: JwtHeader,\n  key: Key,\n) => P | PromiseLike<P>\n\nexport type KeySearch = {\n  use?: 'sig' | 'enc'\n  kid?: string | string[]\n  alg?: string | string[]\n}\n\nconst extractPrivateJwk = (key: Key): Jwk | undefined => key.privateJwk\nconst extractPublicJwk = (key: Key): Jwk | undefined => key.publicJwk\n\nexport class Keyset<K extends Key = Key> implements Iterable<K> {\n  private readonly keys: readonly K[]\n\n  constructor(\n    iterable: Iterable<K | null | undefined | false>,\n    /**\n     * The preferred algorithms to use when signing a JWT using this keyset.\n     *\n     * @see {@link https://datatracker.ietf.org/doc/html/rfc7518#section-3.1}\n     */\n    public readonly preferredSigningAlgorithms: readonly string[] = iterable instanceof\n    Keyset\n      ? [...iterable.preferredSigningAlgorithms]\n      : [\n          // Prefer elliptic curve algorithms\n          'EdDSA',\n          'ES256K',\n          'ES256',\n          // https://datatracker.ietf.org/doc/html/rfc7518#section-3.5\n          'PS256',\n          'PS384',\n          'PS512',\n          'HS256',\n          'HS384',\n          'HS512',\n        ],\n  ) {\n    const keys: K[] = []\n\n    const kids = new Set<string>()\n    for (const key of iterable) {\n      if (!key) continue\n\n      keys.push(key)\n\n      if (key.kid) {\n        if (kids.has(key.kid)) throw new JwkError(`Duplicate key: ${key.kid}`)\n        else kids.add(key.kid)\n      }\n    }\n\n    this.keys = Object.freeze(keys)\n  }\n\n  get size(): number {\n    return this.keys.length\n  }\n\n  @cachedGetter\n  get signAlgorithms(): readonly string[] {\n    const algorithms = new Set<string>()\n    for (const key of this) {\n      if (key.use !== 'sig') continue\n      for (const alg of key.algorithms) {\n        algorithms.add(alg)\n      }\n    }\n    return Object.freeze(\n      [...algorithms].sort(preferredOrderCmp(this.preferredSigningAlgorithms)),\n    )\n  }\n\n  @cachedGetter\n  get publicJwks(): DeepReadonly<JwksPub> {\n    return {\n      keys: Array.from(this, extractPublicJwk).filter(isDefined),\n    }\n  }\n\n  @cachedGetter\n  get privateJwks(): DeepReadonly<Jwks> {\n    return {\n      keys: Array.from(this, extractPrivateJwk).filter(isDefined),\n    }\n  }\n\n  has(kid: string): boolean {\n    return this.keys.some((key) => key.kid === kid)\n  }\n\n  get(search: KeySearch): K {\n    for (const key of this.list(search)) {\n      return key\n    }\n\n    throw new JwkError(\n      `Key not found ${search.kid || search.alg || '<unknown>'}`,\n      ERR_JWK_NOT_FOUND,\n    )\n  }\n\n  *list(search: KeySearch): Generator<K> {\n    // Optimization: Empty string or empty array will not match any key\n    if (search.kid?.length === 0) return\n    if (search.alg?.length === 0) return\n\n    for (const key of this) {\n      if (search.use && key.use !== search.use) continue\n\n      if (Array.isArray(search.kid)) {\n        if (!key.kid || !search.kid.includes(key.kid)) continue\n      } else if (search.kid) {\n        if (key.kid !== search.kid) continue\n      }\n\n      if (Array.isArray(search.alg)) {\n        if (!search.alg.some((a) => key.algorithms.includes(a))) continue\n      } else if (typeof search.alg === 'string') {\n        if (!key.algorithms.includes(search.alg)) continue\n      }\n\n      yield key\n    }\n  }\n\n  findKey({ kid, alg, use }: KeySearch): [key: Key, alg: string] {\n    const matchingKeys: Key[] = []\n\n    for (const key of this.list({ kid, alg, use })) {\n      // Not a signing key\n      if (!key.isPrivate) continue\n\n      // Skip negotiation if a specific \"alg\" was provided\n      if (typeof alg === 'string') return [key, alg]\n\n      matchingKeys.push(key)\n    }\n\n    const isAllowedAlg = matchesAny(alg)\n    const candidates = matchingKeys.map(\n      (key) => [key, key.algorithms.filter(isAllowedAlg)] as const,\n    )\n\n    // Return the first candidates that matches the preferred algorithms\n    for (const prefAlg of this.preferredSigningAlgorithms) {\n      for (const [matchingKey, matchingAlgs] of candidates) {\n        if (matchingAlgs.includes(prefAlg)) return [matchingKey, prefAlg]\n      }\n    }\n\n    // Return any candidate\n    for (const [matchingKey, matchingAlgs] of candidates) {\n      for (const alg of matchingAlgs) {\n        return [matchingKey, alg]\n      }\n    }\n\n    throw new JwkError(\n      `No singing key found for ${kid || alg || use || '<unknown>'}`,\n      ERR_JWK_NOT_FOUND,\n    )\n  }\n\n  [Symbol.iterator](): IterableIterator<K> {\n    return this.keys.values()\n  }\n\n  async createJwt(\n    { alg: sAlg, kid: sKid, ...header }: JwtSignHeader,\n    payload: JwtPayload | JwtPayloadGetter,\n  ): Promise<SignedJwt> {\n    try {\n      const [key, alg] = this.findKey({ alg: sAlg, kid: sKid, use: 'sig' })\n      const protectedHeader = { ...header, alg, kid: key.kid }\n\n      if (typeof payload === 'function') {\n        payload = await payload(protectedHeader, key)\n      }\n\n      return await key.createJwt(protectedHeader, payload)\n    } catch (err) {\n      throw JwtCreateError.from(err)\n    }\n  }\n\n  async verifyJwt<C extends string = never>(\n    token: SignedJwt,\n    options?: VerifyOptions<C>,\n  ): Promise<VerifyResult<C> & { key: K }> {\n    const { header } = unsafeDecodeJwt(token)\n    const { kid, alg } = header\n\n    const errors: unknown[] = []\n\n    for (const key of this.list({ kid, alg })) {\n      try {\n        const result = await key.verifyJwt<C>(token, options)\n        return { ...result, key }\n      } catch (err) {\n        errors.push(err)\n      }\n    }\n\n    switch (errors.length) {\n      case 0:\n        throw new JwtVerifyError('No key matched', ERR_JWKS_NO_MATCHING_KEY)\n      case 1:\n        throw JwtVerifyError.from(errors[0], ERR_JWT_INVALID)\n      default:\n        throw JwtVerifyError.from(errors, ERR_JWT_INVALID)\n    }\n  }\n\n  toJSON(): JwksPub {\n    // Make a copy to prevent mutation of the original keyset\n    return structuredClone(this.publicJwks) as UnReadonly<JwksPub>\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 10592, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10597, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk/src/index.ts"],"sourcesContent":["// Since we expose zod schemas, let's expose ZodError (under a generic name) so\n// that dependents can catch schema parsing errors without requiring an explicit\n// dependency on zod, or risking a conflict in case of mismatching zob versions.\nexport { ZodError as ValidationError } from 'zod'\n\nexport * from './alg.js'\nexport * from './errors.js'\nexport * from './jwk.js'\nexport * from './jwks.js'\nexport * from './jwt-decode.js'\nexport * from './jwt-verify.js'\nexport * from './jwt.js'\nexport * from './key.js'\nexport * from './keyset.js'\nexport * from './util.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,+EAA+E;AAC/E,gFAAgF;AAChF,gFAAgF;AAChF,IAAA,uBAAiD;AAAxC,OAAA,cAAA,CAAA,SAAA,mBAAA;IAAA,YAAA;IAAA,KAAA;QAAA,OAAA,MAAA,QAAQ;IAAA;AAAA,GAAmB;AAEpC,iHAAA,SAAwB;AACxB,oHAAA,SAA2B;AAC3B,iHAAA,SAAwB;AACxB,kHAAA,SAAyB;AACzB,wHAAA,SAA+B;AAC/B,wHAAA,SAA+B;AAC/B,iHAAA,SAAwB;AACxB,iHAAA,SAAwB;AACxB,oHAAA,SAA2B;AAC3B,kHAAA,SAAyB","ignoreList":[0]}},
    {"offset": {"line": 10641, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10646, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk-jose/src/util.ts"],"sourcesContent":["export function either<T extends string | number | boolean>(\n  a?: T,\n  b?: T,\n): T | undefined {\n  if (a != null && b != null && a !== b) {\n    throw new TypeError(`Expected \"${b}\", got \"${a}\"`)\n  }\n  return a ?? b ?? undefined\n}\n"],"names":[],"mappings":";;;;AAAA,QAAA,MAAA,GAAA,OAQC;AARD,SAAgB,MAAM,CACpB,CAAK,EACL,CAAK;IAEL,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC;QACtC,MAAM,IAAI,SAAS,CAAC,CAAA,UAAA,EAAa,CAAC,CAAA,QAAA,EAAW,CAAC,CAAA,CAAA,CAAG,CAAC,CAAA;IACpD,CAAC;IACD,OAAO,CAAC,IAAI,CAAC,IAAI,SAAS,CAAA;AAC5B,CAAC","ignoreList":[0]}},
    {"offset": {"line": 10657, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10662, "column": 0}, "map": {"version":3,"file":"jose-key.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk-jose/src/jose-key.ts"],"sourcesContent":["import {\n  Jwk,\n  JwkError,\n  JwtCreateError,\n  JwtHeader,\n  JwtPayload,\n  JwtVerifyError,\n  Key,\n  RequiredKey,\n  SignedJwt,\n  VerifyOptions,\n  VerifyResult,\n  jwkValidator,\n  jwtHeaderSchema,\n  jwtPayloadSchema,\n} from '@atproto/jwk'\nimport {\n  SignJWT,\n  errors,\n  exportJWK,\n  generateKeyPair,\n  importJWK,\n  importPKCS8,\n  jwtVerify,\n  type GenerateKeyPairOptions,\n  type GenerateKeyPairResult,\n  type JWK,\n  type JWTVerifyOptions,\n  type KeyLike,\n} from 'jose'\n\nimport { either } from './util'\n\nconst { JOSEError } = errors\n\nexport type Importable = string | KeyLike | Jwk\n\nexport type { GenerateKeyPairOptions, GenerateKeyPairResult }\n\nexport class JoseKey<J extends Jwk = Jwk> extends Key<J> {\n  /**\n   * Some runtimes (e.g. Bun) require an `alg` second argument to be set when\n   * invoking `importJWK`. In order to be compatible with these runtimes, we\n   * provide the following method to ensure the `alg` is always set. We also\n   * take the opportunity to ensure that the `alg` is compatible with this key.\n   */\n  protected async getKeyObj(alg: string) {\n    if (!this.algorithms.includes(alg)) {\n      throw new JwkError(`Key cannot be used with algorithm \"${alg}\"`)\n    }\n    try {\n      return await importJWK(this.jwk as JWK, alg)\n    } catch (cause) {\n      throw new JwkError('Failed to import JWK', undefined, { cause })\n    }\n  }\n\n  async createJwt(header: JwtHeader, payload: JwtPayload): Promise<SignedJwt> {\n    try {\n      const { kid } = header\n      if (kid && kid !== this.kid) {\n        throw new JwtCreateError(\n          `Invalid \"kid\" (${kid}) used to sign with key \"${this.kid}\"`,\n        )\n      }\n\n      const { alg } = header\n      if (!alg) {\n        throw new JwtCreateError('Missing \"alg\" in JWT header')\n      }\n\n      const keyObj = await this.getKeyObj(alg)\n      const jwtBuilder = new SignJWT(payload).setProtectedHeader({\n        ...header,\n        alg,\n        kid: this.kid,\n      })\n\n      const signedJwt = await jwtBuilder.sign(keyObj)\n\n      return signedJwt as SignedJwt\n    } catch (cause) {\n      if (cause instanceof JOSEError) {\n        throw new JwtCreateError(cause.message, cause.code, { cause })\n      } else {\n        throw JwtCreateError.from(cause)\n      }\n    }\n  }\n\n  async verifyJwt<C extends string = never>(\n    token: SignedJwt,\n    options?: VerifyOptions<C>,\n  ): Promise<VerifyResult<C>> {\n    try {\n      const result = await jwtVerify(\n        token,\n        async ({ alg }) => this.getKeyObj(alg),\n        { ...options, algorithms: this.algorithms } as JWTVerifyOptions,\n      )\n\n      // @NOTE if all tokens are signed exclusively through createJwt(), then\n      // there should be no need to parse the payload and headers here. But\n      // since the JWT could have been signed with the same key from somewhere\n      // else, let's parse it to ensure the integrity (and type safety) of the\n      // data.\n      const headerParsed = jwtHeaderSchema.safeParse(result.protectedHeader)\n      if (!headerParsed.success) {\n        throw new JwtVerifyError('Invalid JWT header', undefined, {\n          cause: headerParsed.error,\n        })\n      }\n\n      const payloadParsed = jwtPayloadSchema.safeParse(result.payload)\n      if (!payloadParsed.success) {\n        throw new JwtVerifyError('Invalid JWT payload', undefined, {\n          cause: payloadParsed.error,\n        })\n      }\n\n      return {\n        protectedHeader: headerParsed.data,\n        // \"requiredClaims\" enforced by jwtVerify()\n        payload: payloadParsed.data as RequiredKey<JwtPayload, C>,\n      }\n    } catch (cause) {\n      if (cause instanceof JOSEError) {\n        throw new JwtVerifyError(cause.message, cause.code, { cause })\n      } else {\n        throw JwtVerifyError.from(cause)\n      }\n    }\n  }\n\n  static async generateKeyPair(\n    allowedAlgos: readonly string[] = ['ES256'],\n    options?: GenerateKeyPairOptions,\n  ) {\n    if (!allowedAlgos.length) {\n      throw new JwkError('No algorithms provided for key generation')\n    }\n\n    const errors: unknown[] = []\n    for (const alg of allowedAlgos) {\n      try {\n        return await generateKeyPair(alg, options)\n      } catch (err) {\n        errors.push(err)\n      }\n    }\n\n    throw new JwkError('Failed to generate key pair', undefined, {\n      cause: new AggregateError(errors, 'None of the algorithms worked'),\n    })\n  }\n\n  static async generate(\n    allowedAlgos: string[] = ['ES256'],\n    kid?: string,\n    options?: Omit<GenerateKeyPairOptions, 'extractable'>,\n  ) {\n    const kp = await this.generateKeyPair(allowedAlgos, {\n      ...options,\n      extractable: true,\n    })\n    return this.fromImportable(kp.privateKey, kid)\n  }\n\n  static async fromImportable(\n    input: Importable,\n    kid?: string,\n  ): Promise<JoseKey> {\n    if (typeof input === 'string') {\n      // PKCS8\n      if (input.startsWith('-----')) {\n        // The \"alg\" is only needed in WebCrypto (NodeJS will be fine)\n        return this.fromPKCS8(input, '', kid)\n      }\n\n      // Jwk (string)\n      if (input.startsWith('{')) {\n        return this.fromJWK(input, kid)\n      }\n\n      throw new JwkError('Invalid input')\n    }\n\n    if (typeof input === 'object') {\n      // Jwk\n      if ('kty' in input || 'alg' in input) {\n        return this.fromJWK(input, kid)\n      }\n\n      // KeyLike\n      return this.fromKeyLike(input, kid)\n    }\n\n    throw new JwkError('Invalid input')\n  }\n\n  /**\n   * @see {@link exportJWK}\n   */\n  static async fromKeyLike(\n    keyLike: KeyLike | Uint8Array,\n    kid?: string,\n    alg?: string,\n  ): Promise<JoseKey> {\n    const jwk = await exportJWK(keyLike)\n    if (alg) {\n      if (!jwk.alg) jwk.alg = alg\n      else if (jwk.alg !== alg) throw new JwkError('Invalid \"alg\" in JWK')\n    }\n    return this.fromJWK(jwk, kid)\n  }\n\n  /**\n   * @see {@link importPKCS8}\n   */\n  static async fromPKCS8(\n    pem: string,\n    alg: string,\n    kid?: string,\n  ): Promise<JoseKey> {\n    const keyLike = await importPKCS8(pem, alg, { extractable: true })\n    return this.fromKeyLike(keyLike, kid)\n  }\n\n  static async fromJWK(\n    input: string | Record<string, unknown>,\n    inputKid?: string,\n  ): Promise<JoseKey> {\n    const jwk = typeof input === 'string' ? JSON.parse(input) : input\n    if (!jwk || typeof jwk !== 'object') throw new JwkError('Invalid JWK')\n\n    const kid = either(jwk.kid, inputKid)\n    const use = jwk.use || 'sig'\n\n    return new JoseKey(jwkValidator.parse({ ...jwk, kid, use }))\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,gCAeqB;AACrB,MAAA,yBAaa;AAEb,MAAA,2BAA+B;AAE/B,MAAM,EAAE,SAAS,EAAE,GAAG,OAAA,MAAM,CAAA;AAM5B,MAAa,OAA6B,SAAQ,MAAA,GAAM;IACtD;;;;;OAKG,CACO,KAAK,CAAC,SAAS,CAAC,GAAW,EAAA;QACnC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;YACnC,MAAM,IAAI,MAAA,QAAQ,CAAC,CAAA,mCAAA,EAAsC,GAAG,CAAA,CAAA,CAAG,CAAC,CAAA;QAClE,CAAC;QACD,IAAI,CAAC;YACH,OAAO,MAAM,CAAA,GAAA,OAAA,SAAS,EAAC,IAAI,CAAC,GAAU,EAAE,GAAG,CAAC,CAAA;QAC9C,CAAC,CAAC,OAAO,KAAK,EAAE,CAAC;YACf,MAAM,IAAI,MAAA,QAAQ,CAAC,sBAAsB,EAAE,SAAS,EAAE;gBAAE,KAAK;YAAA,CAAE,CAAC,CAAA;QAClE,CAAC;IACH,CAAC;IAED,KAAK,CAAC,SAAS,CAAC,MAAiB,EAAE,OAAmB,EAAA;QACpD,IAAI,CAAC;YACH,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,CAAA;YACtB,IAAI,GAAG,IAAI,GAAG,KAAK,IAAI,CAAC,GAAG,EAAE,CAAC;gBAC5B,MAAM,IAAI,MAAA,cAAc,CACtB,CAAA,eAAA,EAAkB,GAAG,CAAA,yBAAA,EAA4B,IAAI,CAAC,GAAG,CAAA,CAAA,CAAG,CAC7D,CAAA;YACH,CAAC;YAED,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,CAAA;YACtB,IAAI,CAAC,GAAG,EAAE,CAAC;gBACT,MAAM,IAAI,MAAA,cAAc,CAAC,6BAA6B,CAAC,CAAA;YACzD,CAAC;YAED,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAA;YACxC,MAAM,UAAU,GAAG,IAAI,OAAA,OAAO,CAAC,OAAO,CAAC,CAAC,kBAAkB,CAAC;gBACzD,GAAG,MAAM;gBACT,GAAG;gBACH,GAAG,EAAE,IAAI,CAAC,GAAG;aACd,CAAC,CAAA;YAEF,MAAM,SAAS,GAAG,MAAM,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;YAE/C,OAAO,SAAsB,CAAA;QAC/B,CAAC,CAAC,OAAO,KAAK,EAAE,CAAC;YACf,IAAI,KAAK,YAAY,SAAS,EAAE,CAAC;gBAC/B,MAAM,IAAI,MAAA,cAAc,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,EAAE;oBAAE,KAAK;gBAAA,CAAE,CAAC,CAAA;YAChE,CAAC,MAAM,CAAC;gBACN,MAAM,MAAA,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;YAClC,CAAC;QACH,CAAC;IACH,CAAC;IAED,KAAK,CAAC,SAAS,CACb,KAAgB,EAChB,OAA0B,EAAA;QAE1B,IAAI,CAAC;YACH,MAAM,MAAM,GAAG,MAAM,CAAA,GAAA,OAAA,SAAS,EAC5B,KAAK,EACL,KAAK,EAAE,EAAE,GAAG,EAAE,EAAE,CAAG,CAAD,GAAK,CAAC,SAAS,CAAC,GAAG,CAAC,EACtC;gBAAE,GAAG,OAAO;gBAAE,UAAU,EAAE,IAAI,CAAC,UAAU;YAAA,CAAsB,CAChE,CAAA;YAED,uEAAuE;YACvE,qEAAqE;YACrE,wEAAwE;YACxE,wEAAwE;YACxE,QAAQ;YACR,MAAM,YAAY,GAAG,MAAA,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,CAAA;YACtE,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC;gBAC1B,MAAM,IAAI,MAAA,cAAc,CAAC,oBAAoB,EAAE,SAAS,EAAE;oBACxD,KAAK,EAAE,YAAY,CAAC,KAAK;iBAC1B,CAAC,CAAA;YACJ,CAAC;YAED,MAAM,aAAa,GAAG,MAAA,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAA;YAChE,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC;gBAC3B,MAAM,IAAI,MAAA,cAAc,CAAC,qBAAqB,EAAE,SAAS,EAAE;oBACzD,KAAK,EAAE,aAAa,CAAC,KAAK;iBAC3B,CAAC,CAAA;YACJ,CAAC;YAED,OAAO;gBACL,eAAe,EAAE,YAAY,CAAC,IAAI;gBAClC,2CAA2C;gBAC3C,OAAO,EAAE,aAAa,CAAC,IAAkC;aAC1D,CAAA;QACH,CAAC,CAAC,OAAO,KAAK,EAAE,CAAC;YACf,IAAI,KAAK,YAAY,SAAS,EAAE,CAAC;gBAC/B,MAAM,IAAI,MAAA,cAAc,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,EAAE;oBAAE,KAAK;gBAAA,CAAE,CAAC,CAAA;YAChE,CAAC,MAAM,CAAC;gBACN,MAAM,MAAA,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;YAClC,CAAC;QACH,CAAC;IACH,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,eAAe,CAC1B,eAAkC;QAAC,OAAO;KAAC,EAC3C,OAAgC,EAAA;QAEhC,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC;YACzB,MAAM,IAAI,MAAA,QAAQ,CAAC,2CAA2C,CAAC,CAAA;QACjE,CAAC;QAED,MAAM,MAAM,GAAc,EAAE,CAAA;QAC5B,KAAK,MAAM,GAAG,IAAI,YAAY,CAAE,CAAC;YAC/B,IAAI,CAAC;gBACH,OAAO,MAAM,CAAA,GAAA,OAAA,eAAe,EAAC,GAAG,EAAE,OAAO,CAAC,CAAA;YAC5C,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;gBACb,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;YAClB,CAAC;QACH,CAAC;QAED,MAAM,IAAI,MAAA,QAAQ,CAAC,6BAA6B,EAAE,SAAS,EAAE;YAC3D,KAAK,EAAE,IAAI,cAAc,CAAC,MAAM,EAAE,+BAA+B,CAAC;SACnE,CAAC,CAAA;IACJ,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,QAAQ,CACnB,eAAyB;QAAC,OAAO;KAAC,EAClC,GAAY,EACZ,OAAqD,EAAA;QAErD,MAAM,EAAE,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE;YAClD,GAAG,OAAO;YACV,WAAW,EAAE,IAAI;SAClB,CAAC,CAAA;QACF,OAAO,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,UAAU,EAAE,GAAG,CAAC,CAAA;IAChD,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,cAAc,CACzB,KAAiB,EACjB,GAAY,EAAA;QAEZ,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;YAC9B,QAAQ;YACR,IAAI,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC;gBAC9B,8DAA8D;gBAC9D,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,EAAE,EAAE,GAAG,CAAC,CAAA;YACvC,CAAC;YAED,eAAe;YACf,IAAI,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC1B,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAA;YACjC,CAAC;YAED,MAAM,IAAI,MAAA,QAAQ,CAAC,eAAe,CAAC,CAAA;QACrC,CAAC;QAED,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;YAC9B,MAAM;YACN,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,EAAE,CAAC;gBACrC,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAA;YACjC,CAAC;YAED,UAAU;YACV,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,GAAG,CAAC,CAAA;QACrC,CAAC;QAED,MAAM,IAAI,MAAA,QAAQ,CAAC,eAAe,CAAC,CAAA;IACrC,CAAC;IAED;;OAEG,CACH,MAAM,CAAC,KAAK,CAAC,WAAW,CACtB,OAA6B,EAC7B,GAAY,EACZ,GAAY,EAAA;QAEZ,MAAM,GAAG,GAAG,MAAM,CAAA,GAAA,OAAA,SAAS,EAAC,OAAO,CAAC,CAAA;QACpC,IAAI,GAAG,EAAE,CAAC;YACR,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,GAAG,GAAG,CAAA;iBACtB,IAAI,GAAG,CAAC,GAAG,KAAK,GAAG,EAAE,MAAM,IAAI,MAAA,QAAQ,CAAC,sBAAsB,CAAC,CAAA;QACtE,CAAC;QACD,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAA;IAC/B,CAAC;IAED;;OAEG,CACH,MAAM,CAAC,KAAK,CAAC,SAAS,CACpB,GAAW,EACX,GAAW,EACX,GAAY,EAAA;QAEZ,MAAM,OAAO,GAAG,MAAM,CAAA,GAAA,OAAA,WAAW,EAAC,GAAG,EAAE,GAAG,EAAE;YAAE,WAAW,EAAE,IAAI;QAAA,CAAE,CAAC,CAAA;QAClE,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,GAAG,CAAC,CAAA;IACvC,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,OAAO,CAClB,KAAuC,EACvC,QAAiB,EAAA;QAEjB,MAAM,GAAG,GAAG,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAA;QACjE,IAAI,CAAC,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE,MAAM,IAAI,MAAA,QAAQ,CAAC,aAAa,CAAC,CAAA;QAEtE,MAAM,GAAG,GAAG,CAAA,GAAA,OAAA,MAAM,EAAC,GAAG,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAA;QACrC,MAAM,GAAG,GAAG,GAAG,CAAC,GAAG,IAAI,KAAK,CAAA;QAE5B,OAAO,IAAI,OAAO,CAAC,MAAA,YAAY,CAAC,KAAK,CAAC;YAAE,GAAG,GAAG;YAAE,GAAG;YAAE,GAAG;QAAA,CAAE,CAAC,CAAC,CAAA;IAC9D,CAAC;CACF;AAzMD,QAAA,OAAA,GAAA,QAyMC","ignoreList":[0]}},
    {"offset": {"line": 10836, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10841, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk-jose/src/index.ts"],"sourcesContent":["export * from './jose-key.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,2HAAA,SAA6B","ignoreList":[0]}},
    {"offset": {"line": 10865, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10870, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk-webcrypto/src/util.ts"],"sourcesContent":["export type JWSAlgorithm =\n  // HMAC\n  | 'HS256'\n  | 'HS384'\n  | 'HS512'\n  // RSA\n  | 'PS256'\n  | 'PS384'\n  | 'PS512'\n  | 'RS256'\n  | 'RS384'\n  | 'RS512'\n  // EC\n  | 'ES256'\n  | 'ES256K'\n  | 'ES384'\n  | 'ES512'\n  // OKP\n  | 'EdDSA'\n\nexport type SubtleAlgorithm = RsaHashedKeyGenParams | EcKeyGenParams\n\nexport function toSubtleAlgorithm(\n  alg: string,\n  crv?: string,\n  options?: { modulusLength?: number },\n): SubtleAlgorithm {\n  switch (alg) {\n    case 'PS256':\n    case 'PS384':\n    case 'PS512':\n      return {\n        name: 'RSA-PSS',\n        hash: `SHA-${alg.slice(-3) as '256' | '384' | '512'}`,\n        modulusLength: options?.modulusLength ?? 2048,\n        publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n      }\n    case 'RS256':\n    case 'RS384':\n    case 'RS512':\n      return {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: `SHA-${alg.slice(-3) as '256' | '384' | '512'}`,\n        modulusLength: options?.modulusLength ?? 2048,\n        publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n      }\n    case 'ES256':\n    case 'ES384':\n      return {\n        name: 'ECDSA',\n        namedCurve: `P-${alg.slice(-3) as '256' | '384'}`,\n      }\n    case 'ES512':\n      return {\n        name: 'ECDSA',\n        namedCurve: 'P-521',\n      }\n    default:\n      // https://github.com/w3c/webcrypto/issues/82#issuecomment-849856773\n\n      throw new TypeError(`Unsupported alg \"${alg}\"`)\n  }\n}\n\nexport function fromSubtleAlgorithm(algorithm: KeyAlgorithm): JWSAlgorithm {\n  switch (algorithm.name) {\n    case 'RSA-PSS':\n    case 'RSASSA-PKCS1-v1_5': {\n      const hash = (<RsaHashedKeyAlgorithm>algorithm).hash.name\n      switch (hash) {\n        case 'SHA-256':\n        case 'SHA-384':\n        case 'SHA-512': {\n          const prefix = algorithm.name === 'RSA-PSS' ? 'PS' : 'RS'\n          return `${prefix}${hash.slice(-3) as '256' | '384' | '512'}`\n        }\n        default:\n          throw new TypeError('unsupported RsaHashedKeyAlgorithm hash')\n      }\n    }\n    case 'ECDSA': {\n      const namedCurve = (<EcKeyAlgorithm>algorithm).namedCurve\n      switch (namedCurve) {\n        case 'P-256':\n        case 'P-384':\n        case 'P-512':\n          return `ES${namedCurve.slice(-3) as '256' | '384' | '512'}`\n        case 'P-521':\n          return 'ES512'\n        default:\n          throw new TypeError('unsupported EcKeyAlgorithm namedCurve')\n      }\n    }\n    case 'Ed448':\n    case 'Ed25519':\n      return 'EdDSA'\n    default:\n      // https://github.com/w3c/webcrypto/issues/82#issuecomment-849856773\n\n      throw new TypeError(`Unexpected algorithm \"${algorithm.name}\"`)\n  }\n}\n\nexport function isCryptoKeyPair(\n  v: unknown,\n  extractable?: boolean,\n): v is CryptoKeyPair {\n  return (\n    typeof v === 'object' &&\n    v !== null &&\n    'privateKey' in v &&\n    v.privateKey instanceof CryptoKey &&\n    v.privateKey.type === 'private' &&\n    (extractable == null || v.privateKey.extractable === extractable) &&\n    v.privateKey.usages.includes('sign') &&\n    'publicKey' in v &&\n    v.publicKey instanceof CryptoKey &&\n    v.publicKey.type === 'public' &&\n    v.publicKey.extractable === true &&\n    v.publicKey.usages.includes('verify')\n  )\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 10964, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 10969, "column": 0}, "map": {"version":3,"file":"webcrypto-key.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk-webcrypto/src/webcrypto-key.ts"],"sourcesContent":["import { JwkError, jwkSchema } from '@atproto/jwk'\nimport { GenerateKeyPairOptions, JoseKey } from '@atproto/jwk-jose'\nimport z from 'zod'\n\nimport { fromSubtleAlgorithm, isCryptoKeyPair } from './util.js'\n\n// Webcrypto keys are bound to a single algorithm\nexport const jwkWithAlgSchema = z.intersection(\n  jwkSchema,\n  z.object({ alg: z.string() }),\n)\n\nexport type JwkWithAlg = z.infer<typeof jwkWithAlgSchema>\n\nexport class WebcryptoKey<\n  J extends JwkWithAlg = JwkWithAlg,\n> extends JoseKey<J> {\n  // We need to override the static method generate from JoseKey because\n  // the browser needs both the private and public keys\n  static override async generate(\n    allowedAlgos: string[] = ['ES256'],\n    kid: string = crypto.randomUUID(),\n    options?: GenerateKeyPairOptions,\n  ) {\n    const keyPair = await this.generateKeyPair(allowedAlgos, options)\n\n    // Type safety only: in the browser, 'jose' always generates a CryptoKeyPair\n    if (!isCryptoKeyPair(keyPair)) {\n      throw new TypeError('Invalid CryptoKeyPair')\n    }\n\n    return this.fromKeypair(keyPair, kid)\n  }\n\n  static async fromKeypair(cryptoKeyPair: CryptoKeyPair, kid?: string) {\n    // https://datatracker.ietf.org/doc/html/rfc7517\n    // > The \"use\" and \"key_ops\" JWK members SHOULD NOT be used together; [...]\n    // > Applications should specify which of these members they use.\n\n    const {\n      key_ops,\n      use,\n      alg = fromSubtleAlgorithm(cryptoKeyPair.privateKey.algorithm),\n      ...jwk\n    } = await crypto.subtle.exportKey(\n      'jwk',\n      cryptoKeyPair.privateKey.extractable\n        ? cryptoKeyPair.privateKey\n        : cryptoKeyPair.publicKey,\n    )\n\n    if (use && use !== 'sig') {\n      throw new TypeError(`Unsupported JWK use \"${use}\"`)\n    }\n\n    if (key_ops && !key_ops.some((o) => o === 'sign' || o === 'verify')) {\n      // Make sure that \"key_ops\", if present, is compatible with \"use\"\n      throw new TypeError(`Invalid key_ops \"${key_ops}\" for \"sig\" use`)\n    }\n\n    return new WebcryptoKey(\n      jwkWithAlgSchema.parse({ ...jwk, kid, alg, use: 'sig' }),\n      cryptoKeyPair,\n    )\n  }\n\n  constructor(\n    jwk: Readonly<J>,\n    readonly cryptoKeyPair: CryptoKeyPair,\n  ) {\n    super(jwk)\n  }\n\n  get isPrivate() {\n    return true\n  }\n\n  get privateJwk(): Readonly<J> | undefined {\n    if (super.isPrivate) return this.jwk\n    throw new Error('Private Webcrypto Key not exportable')\n  }\n\n  protected override async getKeyObj(alg: string) {\n    if (this.jwk.alg !== alg) {\n      throw new JwkError(`Key cannot be used with algorithm \"${alg}\"`)\n    }\n    return this.cryptoKeyPair.privateKey\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 11043, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11048, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/jwk-webcrypto/src/index.ts"],"sourcesContent":["export * from './webcrypto-key.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,qIAAA,SAAkC","ignoreList":[0]}},
    {"offset": {"line": 11072, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11077, "column": 0}, "map": {"version":3,"file":"did-error.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/did/src/did-error.ts"],"sourcesContent":["export class DidError extends Error {\n  constructor(\n    public readonly did: string,\n    message: string,\n    public readonly code: string,\n    public readonly status = 400,\n    cause?: unknown,\n  ) {\n    super(message, { cause })\n  }\n\n  /**\n   * For compatibility with error handlers in common HTTP frameworks.\n   */\n  get statusCode() {\n    return this.status\n  }\n\n  override toString() {\n    return `${this.constructor.name} ${this.code} (${this.did}): ${this.message}`\n  }\n\n  static from(cause: unknown, did: string): DidError {\n    if (cause instanceof DidError) {\n      return cause\n    }\n\n    const message =\n      cause instanceof Error\n        ? cause.message\n        : typeof cause === 'string'\n          ? cause\n          : 'An unknown error occurred'\n\n    const status =\n      (typeof cause?.['statusCode'] === 'number'\n        ? cause['statusCode']\n        : undefined) ??\n      (typeof cause?.['status'] === 'number' ? cause['status'] : undefined)\n\n    return new DidError(did, message, 'did-unknown-error', status, cause)\n  }\n}\n\nexport class InvalidDidError extends DidError {\n  constructor(did: string, message: string, cause?: unknown) {\n    super(did, message, 'did-invalid', 400, cause)\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAa,QAAS,SAAQ,KAAK;IACjC,YACkB,GAAW,EAC3B,OAAe,EACC,IAAY,EACZ,SAAS,GAAG,EAC5B,KAAe,CAAA;QAEf,KAAK,CAAC,OAAO,EAAE;YAAE,KAAK;QAAA,CAAE,CAAC,CAAA;QANzB,OAAA,cAAA,CAAA,IAAA,EAAA,OAAA;;;;mBAAgB,GAAG;WAAQ;QAE3B,OAAA,cAAA,CAAA,IAAA,EAAA,QAAA;;;;mBAAgB,IAAI;WAAQ;QAC5B,OAAA,cAAA,CAAA,IAAA,EAAA,UAAA;;;;mBAAgB,MAAM;WAAM;IAI9B,CAAC;IAED;;OAEG,CACH,IAAI,UAAU,GAAA;QACZ,OAAO,IAAI,CAAC,MAAM,CAAA;IACpB,CAAC;IAEQ,QAAQ,GAAA;QACf,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAA,CAAA,EAAI,IAAI,CAAC,IAAI,CAAA,EAAA,EAAK,IAAI,CAAC,GAAG,CAAA,GAAA,EAAM,IAAI,CAAC,OAAO,EAAE,CAAA;IAC/E,CAAC;IAED,MAAM,CAAC,IAAI,CAAC,KAAc,EAAE,GAAW,EAAA;QACrC,IAAI,KAAK,YAAY,QAAQ,EAAE,CAAC;YAC9B,OAAO,KAAK,CAAA;QACd,CAAC;QAED,MAAM,OAAO,GACX,KAAK,YAAY,KAAK,GAClB,KAAK,CAAC,OAAO,GACb,OAAO,KAAK,KAAK,QAAQ,GACvB,KAAK,GACL,2BAA2B,CAAA;QAEnC,MAAM,MAAM,GACV,CAAC,OAAO,KAAK,EAAE,CAAC,YAAY,CAAC,KAAK,QAAQ,GACtC,KAAK,CAAC,YAAY,CAAC,GACnB,SAAS,CAAC,IACd,CAAC,OAAO,KAAK,EAAE,CAAC,QAAQ,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAA;QAEvE,OAAO,IAAI,QAAQ,CAAC,GAAG,EAAE,OAAO,EAAE,mBAAmB,EAAE,MAAM,EAAE,KAAK,CAAC,CAAA;IACvE,CAAC;CACF;AA1CD,QAAA,QAAA,GAAA,SA0CC;AAED,MAAa,eAAgB,SAAQ,QAAQ;IAC3C,YAAY,GAAW,EAAE,OAAe,EAAE,KAAe,CAAA;QACvD,KAAK,CAAC,GAAG,EAAE,OAAO,EAAE,aAAa,EAAE,GAAG,EAAE,KAAK,CAAC,CAAA;IAChD,CAAC;CACF;AAJD,QAAA,eAAA,GAAA,gBAIC","ignoreList":[0]}},
    {"offset": {"line": 11130, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11135, "column": 0}, "map": {"version":3,"file":"plc.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/did/src/methods/plc.ts"],"sourcesContent":["import { InvalidDidError } from '../did-error.js'\nimport { Did } from '../did.js'\n\nconst DID_PLC_PREFIX = `did:plc:`\nconst DID_PLC_PREFIX_LENGTH = DID_PLC_PREFIX.length\nconst DID_PLC_LENGTH = 32\n\nexport { DID_PLC_PREFIX }\n\nexport function isDidPlc(input: unknown): input is Did<'plc'> {\n  // Optimization: equivalent to try/catch around \"assertDidPlc\"\n  if (typeof input !== 'string') return false\n  if (input.length !== DID_PLC_LENGTH) return false\n  if (!input.startsWith(DID_PLC_PREFIX)) return false\n  for (let i = DID_PLC_PREFIX_LENGTH; i < DID_PLC_LENGTH; i++) {\n    if (!isBase32Char(input.charCodeAt(i))) return false\n  }\n  return true\n}\n\nexport function asDidPlc(input: unknown): Did<'plc'> {\n  assertDidPlc(input)\n  return input\n}\n\nexport function assertDidPlc(input: unknown): asserts input is Did<'plc'> {\n  if (typeof input !== 'string') {\n    throw new InvalidDidError(typeof input, `DID must be a string`)\n  }\n\n  if (input.length !== DID_PLC_LENGTH) {\n    throw new InvalidDidError(\n      input,\n      `did:plc must be ${DID_PLC_LENGTH} characters long`,\n    )\n  }\n\n  if (!input.startsWith(DID_PLC_PREFIX)) {\n    throw new InvalidDidError(input, `Invalid did:plc prefix`)\n  }\n\n  // The following check is not necessary, as the check below is more strict:\n\n  // assertDidMsid(input, DID_PLC_PREFIX.length)\n\n  for (let i = DID_PLC_PREFIX_LENGTH; i < DID_PLC_LENGTH; i++) {\n    if (!isBase32Char(input.charCodeAt(i))) {\n      throw new InvalidDidError(input, `Invalid character at position ${i}`)\n    }\n  }\n}\n\nconst isBase32Char = (c: number): boolean =>\n  (c >= 0x61 && c <= 0x7a) || (c >= 0x32 && c <= 0x37) // [a-z2-7]\n"],"names":[],"mappings":";;;;;AASA,QAAA,QAAA,GAAA,SASC;AAED,QAAA,QAAA,GAAA,SAGC;AAED,QAAA,YAAA,GAAA,aAyBC;AAlDD,MAAA,4CAAiD;AAGjD,MAAM,cAAc,GAAG,CAAA,QAAA,CAAU,CAAA;AAIxB,QAAA,cAAA,GAAA,eAAc;AAHvB,MAAM,qBAAqB,GAAG,cAAc,CAAC,MAAM,CAAA;AACnD,MAAM,cAAc,GAAG,EAAE,CAAA;AAIzB,SAAgB,QAAQ,CAAC,KAAc;IACrC,8DAA8D;IAC9D,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,OAAO,KAAK,CAAA;IAC3C,IAAI,KAAK,CAAC,MAAM,KAAK,cAAc,EAAE,OAAO,KAAK,CAAA;IACjD,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,cAAc,CAAC,EAAE,OAAO,KAAK,CAAA;IACnD,IAAK,IAAI,CAAC,GAAG,qBAAqB,EAAE,CAAC,GAAG,cAAc,EAAE,CAAC,EAAE,CAAE,CAAC;QAC5D,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,KAAK,CAAA;IACtD,CAAC;IACD,OAAO,IAAI,CAAA;AACb,CAAC;AAED,SAAgB,QAAQ,CAAC,KAAc;IACrC,YAAY,CAAC,KAAK,CAAC,CAAA;IACnB,OAAO,KAAK,CAAA;AACd,CAAC;AAED,SAAgB,YAAY,CAAC,KAAc;IACzC,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;QAC9B,MAAM,IAAI,eAAA,eAAe,CAAC,OAAO,KAAK,EAAE,CAAA,oBAAA,CAAsB,CAAC,CAAA;IACjE,CAAC;IAED,IAAI,KAAK,CAAC,MAAM,KAAK,cAAc,EAAE,CAAC;QACpC,MAAM,IAAI,eAAA,eAAe,CACvB,KAAK,EACL,CAAA,gBAAA,EAAmB,cAAc,CAAA,gBAAA,CAAkB,CACpD,CAAA;IACH,CAAC;IAED,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,cAAc,CAAC,EAAE,CAAC;QACtC,MAAM,IAAI,eAAA,eAAe,CAAC,KAAK,EAAE,CAAA,sBAAA,CAAwB,CAAC,CAAA;IAC5D,CAAC;IAED,2EAA2E;IAE3E,8CAA8C;IAE9C,IAAK,IAAI,CAAC,GAAG,qBAAqB,EAAE,CAAC,GAAG,cAAc,EAAE,CAAC,EAAE,CAAE,CAAC;QAC5D,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;YACvC,MAAM,IAAI,eAAA,eAAe,CAAC,KAAK,EAAE,CAAA,8BAAA,EAAiC,CAAC,EAAE,CAAC,CAAA;QACxE,CAAC;IACH,CAAC;AACH,CAAC;AAED,MAAM,YAAY,GAAG,CAAC,CAAS,EAAW,CACxC,AAAC,CADyC,AACxC,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,GAAK,CAAD,AAAE,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,CAAA,AAAC,WAAW","ignoreList":[0]}},
    {"offset": {"line": 11182, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11187, "column": 0}, "map": {"version":3,"file":"did.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/did/src/did.ts"],"sourcesContent":["import { z } from 'zod'\nimport { DidError, InvalidDidError } from './did-error.js'\n\nconst DID_PREFIX = 'did:'\nconst DID_PREFIX_LENGTH = DID_PREFIX.length\nexport { DID_PREFIX }\n\n/**\n * Type representation of a Did, with method.\n *\n * ```bnf\n * did                = \"did:\" method-name \":\" method-specific-id\n * method-name        = 1*method-char\n * method-char        = %x61-7A / DIGIT\n * method-specific-id = *( *idchar \":\" ) 1*idchar\n * idchar             = ALPHA / DIGIT / \".\" / \"-\" / \"_\" / pct-encoded\n * pct-encoded        = \"%\" HEXDIG HEXDIG\n * ```\n *\n * @example\n * ```ts\n * type DidWeb = Did<'web'> // `did:web:${string}`\n * type DidCustom = Did<'web' | 'plc'> // `did:${'web' | 'plc'}:${string}`\n * type DidNever = Did<' invalid 🥴 '> // never\n * type DidFoo = Did<'foo' | ' invalid 🥴 '> // `did:foo:${string}`\n * ```\n *\n * @see {@link https://www.w3.org/TR/did-core/#did-syntax}\n */\nexport type Did<M extends string = string> = `did:${AsDidMethod<M>}:${string}`\n\n/**\n * DID Method\n */\nexport type AsDidMethod<M> = string extends M\n  ? string // can't know...\n  : AsDidMethodInternal<M, ''>\n\ntype AlphanumericChar = DigitChar | LowerAlphaChar\ntype DigitChar = '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9'\ntype LowerAlphaChar =\n  | 'a'\n  | 'b'\n  | 'c'\n  | 'd'\n  | 'e'\n  | 'f'\n  | 'g'\n  | 'h'\n  | 'i'\n  | 'j'\n  | 'k'\n  | 'l'\n  | 'm'\n  | 'n'\n  | 'o'\n  | 'p'\n  | 'q'\n  | 'r'\n  | 's'\n  | 't'\n  | 'u'\n  | 'v'\n  | 'w'\n  | 'x'\n  | 'y'\n  | 'z'\n\ntype AsDidMethodInternal<\n  S,\n  Acc extends string,\n> = S extends `${infer H}${infer T}`\n  ? H extends AlphanumericChar\n    ? AsDidMethodInternal<T, `${Acc}${H}`>\n    : never\n  : Acc extends ''\n    ? never\n    : Acc\n\n/**\n * DID Method-name check function.\n *\n * Check if the input is a valid DID method name, at the position between\n * `start` (inclusive) and `end` (exclusive).\n */\nexport function assertDidMethod(\n  input: string,\n  start = 0,\n  end = input.length,\n): void {\n  if (\n    !Number.isFinite(end) ||\n    !Number.isFinite(start) ||\n    end < start ||\n    end > input.length\n  ) {\n    throw new TypeError('Invalid start or end position')\n  }\n  if (end === start) {\n    throw new InvalidDidError(input, `Empty method name`)\n  }\n\n  let c: number\n  for (let i = start; i < end; i++) {\n    c = input.charCodeAt(i)\n    if (\n      (c < 0x61 || c > 0x7a) && // a-z\n      (c < 0x30 || c > 0x39) // 0-9\n    ) {\n      throw new InvalidDidError(\n        input,\n        `Invalid character at position ${i} in DID method name`,\n      )\n    }\n  }\n}\n\n/**\n * This method assumes the input is a valid Did\n */\nexport function extractDidMethod<D extends Did>(did: D) {\n  const msidSep = did.indexOf(':', DID_PREFIX_LENGTH)\n  const method = did.slice(DID_PREFIX_LENGTH, msidSep)\n  return method as D extends Did<infer M> ? M : string\n}\n\n/**\n * DID Method-specific identifier check function.\n *\n * Check if the input is a valid DID method-specific identifier, at the position\n * between `start` (inclusive) and `end` (exclusive).\n */\nexport function assertDidMsid(\n  input: string,\n  start = 0,\n  end = input.length,\n): void {\n  if (\n    !Number.isFinite(end) ||\n    !Number.isFinite(start) ||\n    end < start ||\n    end > input.length\n  ) {\n    throw new TypeError('Invalid start or end position')\n  }\n  if (end === start) {\n    throw new InvalidDidError(input, `DID method-specific id must not be empty`)\n  }\n\n  let c: number\n  for (let i = start; i < end; i++) {\n    c = input.charCodeAt(i)\n\n    // Check for frequent chars first\n    if (\n      (c < 0x61 || c > 0x7a) && // a-z\n      (c < 0x41 || c > 0x5a) && // A-Z\n      (c < 0x30 || c > 0x39) && // 0-9\n      c !== 0x2e && // .\n      c !== 0x2d && // -\n      c !== 0x5f // _\n    ) {\n      // Less frequent chars are checked here\n\n      // \":\"\n      if (c === 0x3a) {\n        if (i === end - 1) {\n          throw new InvalidDidError(input, `DID cannot end with \":\"`)\n        }\n        continue\n      }\n\n      // pct-encoded\n      if (c === 0x25) {\n        c = input.charCodeAt(++i)\n        if ((c < 0x30 || c > 0x39) && (c < 0x41 || c > 0x46)) {\n          throw new InvalidDidError(\n            input,\n            `Invalid pct-encoded character at position ${i}`,\n          )\n        }\n\n        c = input.charCodeAt(++i)\n        if ((c < 0x30 || c > 0x39) && (c < 0x41 || c > 0x46)) {\n          throw new InvalidDidError(\n            input,\n            `Invalid pct-encoded character at position ${i}`,\n          )\n        }\n\n        // There must always be 2 HEXDIG after a \"%\"\n        if (i >= end) {\n          throw new InvalidDidError(\n            input,\n            `Incomplete pct-encoded character at position ${i - 2}`,\n          )\n        }\n\n        continue\n      }\n\n      throw new InvalidDidError(\n        input,\n        `Disallowed character in DID at position ${i}`,\n      )\n    }\n  }\n}\n\nexport function assertDid(input: unknown): asserts input is Did {\n  if (typeof input !== 'string') {\n    throw new InvalidDidError(typeof input, `DID must be a string`)\n  }\n\n  const { length } = input\n  if (length > 2048) {\n    throw new InvalidDidError(input, `DID is too long (2048 chars max)`)\n  }\n\n  if (!input.startsWith(DID_PREFIX)) {\n    throw new InvalidDidError(input, `DID requires \"${DID_PREFIX}\" prefix`)\n  }\n\n  const idSep = input.indexOf(':', DID_PREFIX_LENGTH)\n  if (idSep === -1) {\n    throw new InvalidDidError(input, `Missing colon after method name`)\n  }\n\n  assertDidMethod(input, DID_PREFIX_LENGTH, idSep)\n  assertDidMsid(input, idSep + 1, length)\n}\n\nexport function isDid(input: unknown): input is Did {\n  try {\n    assertDid(input)\n    return true\n  } catch (err) {\n    if (err instanceof DidError) {\n      return false\n    }\n\n    // Unexpected TypeError (should never happen)\n    throw err\n  }\n}\n\nexport function asDid(input: unknown): Did {\n  assertDid(input)\n  return input\n}\n\nexport const didSchema = z\n  .string()\n  .superRefine((value: string, ctx: z.RefinementCtx): value is Did => {\n    try {\n      assertDid(value)\n      return true\n    } catch (err) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: err instanceof Error ? err.message : 'Unexpected error',\n      })\n      return false\n    }\n  })\n"],"names":[],"mappings":";;;;;AAqFA,QAAA,eAAA,GAAA,gBA8BC;AAKD,QAAA,gBAAA,GAAA,iBAIC;AAQD,QAAA,aAAA,GAAA,cA2EC;AAED,QAAA,SAAA,GAAA,UAqBC;AAED,QAAA,KAAA,GAAA,MAYC;AAED,QAAA,KAAA,GAAA,MAGC;AAzPD,MAAA,uBAAuB;AACvB,MAAA,2CAA0D;AAE1D,MAAM,UAAU,GAAG,MAAM,CAAA;AAEhB,QAAA,UAAA,GAAA,WAAU;AADnB,MAAM,iBAAiB,GAAG,UAAU,CAAC,MAAM,CAAA;AA2E3C;;;;;GAKG,CACH,SAAgB,eAAe,CAC7B,KAAa,EACb,KAAK,GAAG,CAAC,EACT,GAAG,GAAG,KAAK,CAAC,MAAM;IAElB,IACE,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IACrB,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,IACvB,GAAG,GAAG,KAAK,IACX,GAAG,GAAG,KAAK,CAAC,MAAM,EAClB,CAAC;QACD,MAAM,IAAI,SAAS,CAAC,+BAA+B,CAAC,CAAA;IACtD,CAAC;IACD,IAAI,GAAG,KAAK,KAAK,EAAE,CAAC;QAClB,MAAM,IAAI,eAAA,eAAe,CAAC,KAAK,EAAE,CAAA,iBAAA,CAAmB,CAAC,CAAA;IACvD,CAAC;IAED,IAAI,CAAS,CAAA;IACb,IAAK,IAAI,CAAC,GAAG,KAAK,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,CAAE,CAAC;QACjC,CAAC,GAAG,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAA;QACvB,IACE,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,MAAM;QAChC,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,MAAM;UAC7B,CAAC;YACD,MAAM,IAAI,eAAA,eAAe,CACvB,KAAK,EACL,CAAA,8BAAA,EAAiC,CAAC,CAAA,mBAAA,CAAqB,CACxD,CAAA;QACH,CAAC;IACH,CAAC;AACH,CAAC;AAED;;GAEG,CACH,SAAgB,gBAAgB,CAAgB,GAAM;IACpD,MAAM,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,iBAAiB,CAAC,CAAA;IACnD,MAAM,MAAM,GAAG,GAAG,CAAC,KAAK,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAA;IACpD,OAAO,MAA6C,CAAA;AACtD,CAAC;AAED;;;;;GAKG,CACH,SAAgB,aAAa,CAC3B,KAAa,EACb,KAAK,GAAG,CAAC,EACT,GAAG,GAAG,KAAK,CAAC,MAAM;IAElB,IACE,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IACrB,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,IACvB,GAAG,GAAG,KAAK,IACX,GAAG,GAAG,KAAK,CAAC,MAAM,EAClB,CAAC;QACD,MAAM,IAAI,SAAS,CAAC,+BAA+B,CAAC,CAAA;IACtD,CAAC;IACD,IAAI,GAAG,KAAK,KAAK,EAAE,CAAC;QAClB,MAAM,IAAI,eAAA,eAAe,CAAC,KAAK,EAAE,CAAA,wCAAA,CAA0C,CAAC,CAAA;IAC9E,CAAC;IAED,IAAI,CAAS,CAAA;IACb,IAAK,IAAI,CAAC,GAAG,KAAK,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,CAAE,CAAC;QACjC,CAAC,GAAG,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAA;QAEvB,iCAAiC;QACjC,IACE,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,MAAM;QAChC,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,MAAM;QAChC,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,MAAM;QAChC,CAAC,KAAK,IAAI,IAAI,IAAI;QAClB,CAAC,KAAK,IAAI,IAAI,IAAI;QAClB,CAAC,KAAK,IAAI,CAAC,IAAI;UACf,CAAC;YACD,uCAAuC;YAEvC,MAAM;YACN,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;gBACf,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,EAAE,CAAC;oBAClB,MAAM,IAAI,eAAA,eAAe,CAAC,KAAK,EAAE,CAAA,uBAAA,CAAyB,CAAC,CAAA;gBAC7D,CAAC;gBACD,SAAQ;YACV,CAAC;YAED,cAAc;YACd,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;gBACf,CAAC,GAAG,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAA;gBACzB,IAAI,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC;oBACrD,MAAM,IAAI,eAAA,eAAe,CACvB,KAAK,EACL,CAAA,0CAAA,EAA6C,CAAC,EAAE,CACjD,CAAA;gBACH,CAAC;gBAED,CAAC,GAAG,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAA;gBACzB,IAAI,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC;oBACrD,MAAM,IAAI,eAAA,eAAe,CACvB,KAAK,EACL,CAAA,0CAAA,EAA6C,CAAC,EAAE,CACjD,CAAA;gBACH,CAAC;gBAED,4CAA4C;gBAC5C,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;oBACb,MAAM,IAAI,eAAA,eAAe,CACvB,KAAK,EACL,CAAA,6CAAA,EAAgD,CAAC,GAAG,CAAC,EAAE,CACxD,CAAA;gBACH,CAAC;gBAED,SAAQ;YACV,CAAC;YAED,MAAM,IAAI,eAAA,eAAe,CACvB,KAAK,EACL,CAAA,wCAAA,EAA2C,CAAC,EAAE,CAC/C,CAAA;QACH,CAAC;IACH,CAAC;AACH,CAAC;AAED,SAAgB,SAAS,CAAC,KAAc;IACtC,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;QAC9B,MAAM,IAAI,eAAA,eAAe,CAAC,OAAO,KAAK,EAAE,CAAA,oBAAA,CAAsB,CAAC,CAAA;IACjE,CAAC;IAED,MAAM,EAAE,MAAM,EAAE,GAAG,KAAK,CAAA;IACxB,IAAI,MAAM,GAAG,IAAI,EAAE,CAAC;QAClB,MAAM,IAAI,eAAA,eAAe,CAAC,KAAK,EAAE,CAAA,gCAAA,CAAkC,CAAC,CAAA;IACtE,CAAC;IAED,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,UAAU,CAAC,EAAE,CAAC;QAClC,MAAM,IAAI,eAAA,eAAe,CAAC,KAAK,EAAE,CAAA,cAAA,EAAiB,UAAU,CAAA,QAAA,CAAU,CAAC,CAAA;IACzE,CAAC;IAED,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,iBAAiB,CAAC,CAAA;IACnD,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE,CAAC;QACjB,MAAM,IAAI,eAAA,eAAe,CAAC,KAAK,EAAE,CAAA,+BAAA,CAAiC,CAAC,CAAA;IACrE,CAAC;IAED,eAAe,CAAC,KAAK,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAA;IAChD,aAAa,CAAC,KAAK,EAAE,KAAK,GAAG,CAAC,EAAE,MAAM,CAAC,CAAA;AACzC,CAAC;AAED,SAAgB,KAAK,CAAC,KAAc;IAClC,IAAI,CAAC;QACH,SAAS,CAAC,KAAK,CAAC,CAAA;QAChB,OAAO,IAAI,CAAA;IACb,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;QACb,IAAI,GAAG,YAAY,eAAA,QAAQ,EAAE,CAAC;YAC5B,OAAO,KAAK,CAAA;QACd,CAAC;QAED,6CAA6C;QAC7C,MAAM,GAAG,CAAA;IACX,CAAC;AACH,CAAC;AAED,SAAgB,KAAK,CAAC,KAAc;IAClC,SAAS,CAAC,KAAK,CAAC,CAAA;IAChB,OAAO,KAAK,CAAA;AACd,CAAC;AAEY,QAAA,SAAS,GAAG,MAAA,CAAC,CACvB,MAAM,EAAE,CACR,WAAW,CAAC,CAAC,KAAa,EAAE,GAAoB,EAAgB,EAAE;IACjE,IAAI,CAAC;QACH,SAAS,CAAC,KAAK,CAAC,CAAA;QAChB,OAAO,IAAI,CAAA;IACb,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;QACb,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,GAAG,YAAY,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,kBAAkB;SACjE,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;AACH,CAAC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 11329, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11334, "column": 0}, "map": {"version":3,"file":"web.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/did/src/methods/web.ts"],"sourcesContent":["import { InvalidDidError } from '../did-error.js'\nimport { Did, assertDidMsid } from '../did.js'\n\nexport const DID_WEB_PREFIX = `did:web:` satisfies Did<'web'>\n\n/**\n * This function checks if the input is a valid Web DID, as per DID spec.\n */\nexport function isDidWeb(input: unknown): input is Did<'web'> {\n  // Optimization: make cheap checks first\n  if (typeof input !== 'string') return false\n\n  try {\n    assertDidWeb(input)\n    return true\n  } catch {\n    return false\n  }\n}\n\nexport function asDidWeb(input: unknown): Did<'web'> {\n  assertDidWeb(input)\n  return input\n}\n\nexport function assertDidWeb(input: unknown): asserts input is Did<'web'> {\n  if (typeof input !== 'string') {\n    throw new InvalidDidError(typeof input, `DID must be a string`)\n  }\n\n  void didWebToUrl(input)\n}\n\nexport function didWebToUrl(did: string): URL {\n  if (!did.startsWith(DID_WEB_PREFIX)) {\n    throw new InvalidDidError(did, `did:web must start with ${DID_WEB_PREFIX}`)\n  }\n\n  if (did.charAt(DID_WEB_PREFIX.length) === ':') {\n    throw new InvalidDidError(did, 'did:web MSID must not start with a colon')\n  }\n\n  // Make sure every char is valid (per DID spec)\n  assertDidMsid(did, DID_WEB_PREFIX.length)\n\n  try {\n    const msid = did.slice(DID_WEB_PREFIX.length)\n    const parts = msid.split(':').map(decodeURIComponent)\n    const url = new URL(`https://${parts.join('/')}`)\n    if (url.hostname === 'localhost') {\n      url.protocol = 'http:'\n    }\n    return url\n  } catch (cause) {\n    throw new InvalidDidError(did, 'Invalid Web DID', cause)\n  }\n}\n\nexport function urlToDidWeb(url: URL): Did<'web'> {\n  const path =\n    url.pathname === '/'\n      ? ''\n      : url.pathname.slice(1).split('/').map(encodeURIComponent).join(':')\n\n  return `did:web:${encodeURIComponent(url.host)}${path ? `:${path}` : ''}`\n}\n"],"names":[],"mappings":";;;;;AAQA,QAAA,QAAA,GAAA,SAUC;AAED,QAAA,QAAA,GAAA,SAGC;AAED,QAAA,YAAA,GAAA,aAMC;AAED,QAAA,WAAA,GAAA,YAuBC;AAED,QAAA,WAAA,GAAA,YAOC;AAjED,MAAA,4CAAiD;AACjD,MAAA,gCAA8C;AAEjC,QAAA,cAAc,GAAG,CAAA,QAAA,CAA+B,CAAA;AAE7D;;GAEG,CACH,SAAgB,QAAQ,CAAC,KAAc;IACrC,wCAAwC;IACxC,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,OAAO,KAAK,CAAA;IAE3C,IAAI,CAAC;QACH,YAAY,CAAC,KAAK,CAAC,CAAA;QACnB,OAAO,IAAI,CAAA;IACb,CAAC,CAAC,OAAM,CAAC;QACP,OAAO,KAAK,CAAA;IACd,CAAC;AACH,CAAC;AAED,SAAgB,QAAQ,CAAC,KAAc;IACrC,YAAY,CAAC,KAAK,CAAC,CAAA;IACnB,OAAO,KAAK,CAAA;AACd,CAAC;AAED,SAAgB,YAAY,CAAC,KAAc;IACzC,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;QAC9B,MAAM,IAAI,eAAA,eAAe,CAAC,OAAO,KAAK,EAAE,CAAA,oBAAA,CAAsB,CAAC,CAAA;IACjE,CAAC;IAED,KAAK,WAAW,CAAC,KAAK,CAAC,CAAA;AACzB,CAAC;AAED,SAAgB,WAAW,CAAC,GAAW;IACrC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,QAAA,cAAc,CAAC,EAAE,CAAC;QACpC,MAAM,IAAI,eAAA,eAAe,CAAC,GAAG,EAAE,CAAA,wBAAA,EAA2B,QAAA,cAAc,EAAE,CAAC,CAAA;IAC7E,CAAC;IAED,IAAI,GAAG,CAAC,MAAM,CAAC,QAAA,cAAc,CAAC,MAAM,CAAC,KAAK,GAAG,EAAE,CAAC;QAC9C,MAAM,IAAI,eAAA,eAAe,CAAC,GAAG,EAAE,0CAA0C,CAAC,CAAA;IAC5E,CAAC;IAED,+CAA+C;IAC/C,CAAA,GAAA,SAAA,aAAa,EAAC,GAAG,EAAE,QAAA,cAAc,CAAC,MAAM,CAAC,CAAA;IAEzC,IAAI,CAAC;QACH,MAAM,IAAI,GAAG,GAAG,CAAC,KAAK,CAAC,QAAA,cAAc,CAAC,MAAM,CAAC,CAAA;QAC7C,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAA;QACrD,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,CAAA,QAAA,EAAW,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,CAAA;QACjD,IAAI,GAAG,CAAC,QAAQ,KAAK,WAAW,EAAE,CAAC;YACjC,GAAG,CAAC,QAAQ,GAAG,OAAO,CAAA;QACxB,CAAC;QACD,OAAO,GAAG,CAAA;IACZ,CAAC,CAAC,OAAO,KAAK,EAAE,CAAC;QACf,MAAM,IAAI,eAAA,eAAe,CAAC,GAAG,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAA;IAC1D,CAAC;AACH,CAAC;AAED,SAAgB,WAAW,CAAC,GAAQ;IAClC,MAAM,IAAI,GACR,GAAG,CAAC,QAAQ,KAAK,GAAG,GAChB,EAAE,GACF,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;IAExE,OAAO,CAAA,QAAA,EAAW,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA,CAAA,EAAI,IAAI,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAA;AAC3E,CAAC","ignoreList":[0]}},
    {"offset": {"line": 11394, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11399, "column": 0}, "map": {"version":3,"file":"methods.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/did/src/methods.ts"],"sourcesContent":["export * from './methods/plc.js'\nexport * from './methods/web.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,yHAAA,SAAgC;AAChC,yHAAA,SAAgC","ignoreList":[0]}},
    {"offset": {"line": 11424, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11429, "column": 0}, "map": {"version":3,"file":"atproto.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/did/src/atproto.ts"],"sourcesContent":["import { z } from 'zod'\n\nimport { InvalidDidError } from './did-error.js'\nimport { Did } from './did.js'\nimport {\n  assertDidPlc,\n  assertDidWeb,\n  DID_PLC_PREFIX,\n  DID_WEB_PREFIX,\n  isDidPlc,\n} from './methods.js'\n\n// This file contains atproto-specific DID validation utilities.\n\nexport type AtprotoIdentityDidMethods = 'plc' | 'web'\nexport type AtprotoDid = Did<AtprotoIdentityDidMethods>\n\nexport const atprotoDidSchema = z\n  .string()\n  .refine(isAtprotoDid, `Atproto only allows \"plc\" and \"web\" DID methods`)\n\nexport function isAtprotoDid(input: unknown): input is AtprotoDid {\n  // Optimized equivalent of:\n  // return isDidPlc(input) || isAtprotoDidWeb(input)\n\n  if (typeof input !== 'string') {\n    return false\n  } else if (input.startsWith(DID_PLC_PREFIX)) {\n    return isDidPlc(input)\n  } else if (input.startsWith(DID_WEB_PREFIX)) {\n    return isAtprotoDidWeb(input)\n  } else {\n    return false\n  }\n}\n\nexport function asAtprotoDid(input: unknown): AtprotoDid {\n  assertAtprotoDid(input)\n  return input\n}\n\nexport function assertAtprotoDid(input: unknown): asserts input is AtprotoDid {\n  if (typeof input !== 'string') {\n    throw new InvalidDidError(typeof input, `DID must be a string`)\n  } else if (input.startsWith(DID_PLC_PREFIX)) {\n    assertDidPlc(input)\n  } else if (input.startsWith(DID_WEB_PREFIX)) {\n    assertAtprotoDidWeb(input)\n  } else {\n    throw new InvalidDidError(\n      input,\n      `Atproto only allows \"plc\" and \"web\" DID methods`,\n    )\n  }\n}\n\nexport function assertAtprotoDidWeb(\n  input: unknown,\n): asserts input is Did<'web'> {\n  assertDidWeb(input)\n\n  if (input.includes(':', DID_WEB_PREFIX.length)) {\n    throw new InvalidDidError(\n      input,\n      `Atproto does not allow path components in Web DIDs`,\n    )\n  }\n\n  if (\n    input.includes('%3A', DID_WEB_PREFIX.length) &&\n    !input.startsWith('did:web:localhost%3A')\n  ) {\n    throw new InvalidDidError(\n      input,\n      `Atproto does not allow port numbers in Web DIDs, except for localhost`,\n    )\n  }\n}\n\n/**\n * @see {@link https://atproto.com/specs/did#blessed-did-methods}\n */\nexport function isAtprotoDidWeb(input: unknown): input is Did<'web'> {\n  try {\n    assertAtprotoDidWeb(input)\n    return true\n  } catch {\n    return false\n  }\n}\n"],"names":[],"mappings":";;;;;AAqBA,QAAA,YAAA,GAAA,aAaC;AAED,QAAA,YAAA,GAAA,aAGC;AAED,QAAA,gBAAA,GAAA,iBAaC;AAED,QAAA,mBAAA,GAAA,oBAqBC;AAKD,QAAA,eAAA,GAAA,gBAOC;AAzFD,MAAA,uBAAuB;AAEvB,MAAA,2CAAgD;AAEhD,MAAA,uCAMqB;AAOR,QAAA,gBAAgB,GAAG,MAAA,CAAC,CAC9B,MAAM,EAAE,CACR,MAAM,CAAC,YAAY,EAAE,CAAA,+CAAA,CAAiD,CAAC,CAAA;AAE1E,SAAgB,YAAY,CAAC,KAAc;IACzC,2BAA2B;IAC3B,mDAAmD;IAEnD,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;QAC9B,OAAO,KAAK,CAAA;IACd,CAAC,MAAM,IAAI,KAAK,CAAC,UAAU,CAAC,aAAA,cAAc,CAAC,EAAE,CAAC;QAC5C,OAAO,CAAA,GAAA,aAAA,QAAQ,EAAC,KAAK,CAAC,CAAA;IACxB,CAAC,MAAM,IAAI,KAAK,CAAC,UAAU,CAAC,aAAA,cAAc,CAAC,EAAE,CAAC;QAC5C,OAAO,eAAe,CAAC,KAAK,CAAC,CAAA;IAC/B,CAAC,MAAM,CAAC;QACN,OAAO,KAAK,CAAA;IACd,CAAC;AACH,CAAC;AAED,SAAgB,YAAY,CAAC,KAAc;IACzC,gBAAgB,CAAC,KAAK,CAAC,CAAA;IACvB,OAAO,KAAK,CAAA;AACd,CAAC;AAED,SAAgB,gBAAgB,CAAC,KAAc;IAC7C,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;QAC9B,MAAM,IAAI,eAAA,eAAe,CAAC,OAAO,KAAK,EAAE,CAAA,oBAAA,CAAsB,CAAC,CAAA;IACjE,CAAC,MAAM,IAAI,KAAK,CAAC,UAAU,CAAC,aAAA,cAAc,CAAC,EAAE,CAAC;QAC5C,CAAA,GAAA,aAAA,YAAY,EAAC,KAAK,CAAC,CAAA;IACrB,CAAC,MAAM,IAAI,KAAK,CAAC,UAAU,CAAC,aAAA,cAAc,CAAC,EAAE,CAAC;QAC5C,mBAAmB,CAAC,KAAK,CAAC,CAAA;IAC5B,CAAC,MAAM,CAAC;QACN,MAAM,IAAI,eAAA,eAAe,CACvB,KAAK,EACL,CAAA,+CAAA,CAAiD,CAClD,CAAA;IACH,CAAC;AACH,CAAC;AAED,SAAgB,mBAAmB,CACjC,KAAc;IAEd,CAAA,GAAA,aAAA,YAAY,EAAC,KAAK,CAAC,CAAA;IAEnB,IAAI,KAAK,CAAC,QAAQ,CAAC,GAAG,EAAE,aAAA,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC;QAC/C,MAAM,IAAI,eAAA,eAAe,CACvB,KAAK,EACL,CAAA,kDAAA,CAAoD,CACrD,CAAA;IACH,CAAC;IAED,IACE,KAAK,CAAC,QAAQ,CAAC,KAAK,EAAE,aAAA,cAAc,CAAC,MAAM,CAAC,IAC5C,CAAC,KAAK,CAAC,UAAU,CAAC,sBAAsB,CAAC,EACzC,CAAC;QACD,MAAM,IAAI,eAAA,eAAe,CACvB,KAAK,EACL,CAAA,qEAAA,CAAuE,CACxE,CAAA;IACH,CAAC;AACH,CAAC;AAED;;GAEG,CACH,SAAgB,eAAe,CAAC,KAAc;IAC5C,IAAI,CAAC;QACH,mBAAmB,CAAC,KAAK,CAAC,CAAA;QAC1B,OAAO,IAAI,CAAA;IACb,CAAC,CAAC,OAAM,CAAC;QACP,OAAO,KAAK,CAAA;IACd,CAAC;AACH,CAAC","ignoreList":[0]}},
    {"offset": {"line": 11490, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11495, "column": 0}, "map": {"version":3,"file":"did-document.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/did/src/did-document.ts"],"sourcesContent":["import { z } from 'zod'\n\nimport { Did, didSchema } from './did.js'\n\n/**\n * RFC3968 compliant URI\n *\n * @see {@link https://www.rfc-editor.org/rfc/rfc3986}\n */\nconst rfc3968UriSchema = z.string().refine((data) => {\n  try {\n    new URL(data)\n    return true\n  } catch {\n    return false\n  }\n}, 'RFC3968 compliant URI')\n\nconst didControllerSchema = z.union([didSchema, z.array(didSchema)])\n\n/**\n * @note this schema might be too permissive\n */\nconst didRelativeUriSchema = z.union([\n  rfc3968UriSchema,\n  z.string().regex(/^#[^#]+$/),\n])\n\nconst didVerificationMethodSchema = z.object({\n  id: didRelativeUriSchema,\n  type: z.string().min(1),\n  controller: didControllerSchema,\n  publicKeyJwk: z.record(z.string(), z.unknown()).optional(),\n  publicKeyMultibase: z.string().optional(),\n})\n\n/**\n * The value of the id property MUST be a URI conforming to [RFC3986]. A\n * conforming producer MUST NOT produce multiple service entries with the same\n * id. A conforming consumer MUST produce an error if it detects multiple\n * service entries with the same id.\n *\n * @note Normally, only rfc3968UriSchema should be allowed here. However, the\n *   did:plc uses relative URI. For this reason, we also allow relative URIs\n *   here.\n */\nconst didServiceIdSchema = didRelativeUriSchema\n\n/**\n * The value of the type property MUST be a string or a set of strings. In order\n * to maximize interoperability, the service type and its associated properties\n * SHOULD be registered in the DID Specification Registries\n * [DID-SPEC-REGISTRIES].\n */\nconst didServiceTypeSchema = z.union([z.string(), z.array(z.string())])\n\n/**\n * The value of the serviceEndpoint property MUST be a string, a map, or a set\n * composed of one or more strings and/or maps. All string values MUST be valid\n * URIs conforming to [RFC3986] and normalized according to the Normalization\n * and Comparison rules in RFC3986 and to any normalization rules in its\n * applicable URI scheme specification.\n */\nconst didServiceEndpointSchema = z.union([\n  rfc3968UriSchema,\n  z.record(z.string(), rfc3968UriSchema),\n  z\n    .array(z.union([rfc3968UriSchema, z.record(z.string(), rfc3968UriSchema)]))\n    .nonempty(),\n])\n\n/**\n * Each service map MUST contain id, type, and serviceEndpoint properties.\n * @see {@link https://www.w3.org/TR/did-core/#services}\n */\nconst didServiceSchema = z.object({\n  id: didServiceIdSchema,\n  type: didServiceTypeSchema,\n  serviceEndpoint: didServiceEndpointSchema,\n})\n\nexport type DidService = z.infer<typeof didServiceSchema>\n\nconst didAuthenticationSchema = z.union([\n  //\n  didRelativeUriSchema,\n  didVerificationMethodSchema,\n])\n\n/**\n * @note This schema is incomplete\n * @see {@link https://www.w3.org/TR/did-core/#production-0}\n */\nexport const didDocumentSchema = z.object({\n  '@context': z.union([\n    z.literal('https://www.w3.org/ns/did/v1'),\n    z\n      .array(z.string().url())\n      .nonempty()\n      .refine((data) => data[0] === 'https://www.w3.org/ns/did/v1', {\n        message: 'First @context must be https://www.w3.org/ns/did/v1',\n      }),\n  ]),\n  id: didSchema,\n  controller: didControllerSchema.optional(),\n  alsoKnownAs: z.array(rfc3968UriSchema).optional(),\n  service: z.array(didServiceSchema).optional(),\n  authentication: z.array(didAuthenticationSchema).optional(),\n  verificationMethod: z\n    .array(z.union([didVerificationMethodSchema, didRelativeUriSchema]))\n    .optional(),\n})\n\nexport type DidDocument<Method extends string = string> = z.infer<\n  typeof didDocumentSchema\n> & { id: Did<Method> }\n\n// @TODO: add other refinements ?\nexport const didDocumentValidator = didDocumentSchema\n  // Ensure that every service id is unique\n  .superRefine(({ id: did, service }, ctx) => {\n    if (service) {\n      const visited = new Set()\n\n      for (let i = 0; i < service.length; i++) {\n        const current = service[i]\n\n        const serviceId = current.id.startsWith('#')\n          ? `${did}${current.id}`\n          : current.id\n\n        if (!visited.has(serviceId)) {\n          visited.add(serviceId)\n        } else {\n          ctx.addIssue({\n            code: z.ZodIssueCode.custom,\n            message: `Duplicate service id (${current.id}) found in the document`,\n            path: ['service', i, 'id'],\n          })\n        }\n      }\n    }\n  })\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 11621, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11626, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/did/src/index.ts"],"sourcesContent":["export * from './atproto.js'\nexport * from './did-document.js'\nexport * from './did-error.js'\nexport * from './did.js'\nexport * from './methods.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,qHAAA,SAA4B;AAC5B,0HAAA,SAAiC;AACjC,uHAAA,SAA8B;AAC9B,iHAAA,SAAwB;AACxB,qHAAA,SAA4B","ignoreList":[0]}},
    {"offset": {"line": 11654, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 11659, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/lru-cache/src/index.ts"],"sourcesContent":["/**\n * @module LRUCache\n */\n\n// module-private names and types\ntype Perf = { now: () => number }\nconst perf: Perf =\n  typeof performance === 'object' &&\n  performance &&\n  typeof performance.now === 'function'\n    ? performance\n    : Date\n\nconst warned = new Set<string>()\n\n// either a function or a class\ntype ForC = ((...a: any[]) => any) | { new (...a: any[]): any }\n\n/* c8 ignore start */\nconst PROCESS = (\n  typeof process === 'object' && !!process ? process : {}\n) as { [k: string]: any }\n/* c8 ignore start */\n\nconst emitWarning = (\n  msg: string,\n  type: string,\n  code: string,\n  fn: ForC\n) => {\n  typeof PROCESS.emitWarning === 'function'\n    ? PROCESS.emitWarning(msg, type, code, fn)\n    : console.error(`[${code}] ${type}: ${msg}`)\n}\n\nlet AC = globalThis.AbortController\nlet AS = globalThis.AbortSignal\n\n/* c8 ignore start */\nif (typeof AC === 'undefined') {\n  //@ts-ignore\n  AS = class AbortSignal {\n    onabort?: (...a: any[]) => any\n    _onabort: ((...a: any[]) => any)[] = []\n    reason?: any\n    aborted: boolean = false\n    addEventListener(_: string, fn: (...a: any[]) => any) {\n      this._onabort.push(fn)\n    }\n  }\n  //@ts-ignore\n  AC = class AbortController {\n    constructor() {\n      warnACPolyfill()\n    }\n    signal = new AS()\n    abort(reason: any) {\n      if (this.signal.aborted) return\n      //@ts-ignore\n      this.signal.reason = reason\n      //@ts-ignore\n      this.signal.aborted = true\n      //@ts-ignore\n      for (const fn of this.signal._onabort) {\n        fn(reason)\n      }\n      this.signal.onabort?.(reason)\n    }\n  }\n  let printACPolyfillWarning =\n    PROCESS.env?.LRU_CACHE_IGNORE_AC_WARNING !== '1'\n  const warnACPolyfill = () => {\n    if (!printACPolyfillWarning) return\n    printACPolyfillWarning = false\n    emitWarning(\n      'AbortController is not defined. If using lru-cache in ' +\n        'node 14, load an AbortController polyfill from the ' +\n        '`node-abort-controller` package. A minimal polyfill is ' +\n        'provided for use by LRUCache.fetch(), but it should not be ' +\n        'relied upon in other contexts (eg, passing it to other APIs that ' +\n        'use AbortController/AbortSignal might have undesirable effects). ' +\n        'You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.',\n      'NO_ABORT_CONTROLLER',\n      'ENOTSUP',\n      warnACPolyfill\n    )\n  }\n}\n/* c8 ignore stop */\n\nconst shouldWarn = (code: string) => !warned.has(code)\n\nconst TYPE = Symbol('type')\nexport type PosInt = number & { [TYPE]: 'Positive Integer' }\nexport type Index = number & { [TYPE]: 'LRUCache Index' }\n\nconst isPosInt = (n: any): n is PosInt =>\n  n && n === Math.floor(n) && n > 0 && isFinite(n)\n\nexport type UintArray = Uint8Array | Uint16Array | Uint32Array\nexport type NumberArray = UintArray | number[]\n\n/* c8 ignore start */\n// This is a little bit ridiculous, tbh.\n// The maximum array length is 2^32-1 or thereabouts on most JS impls.\n// And well before that point, you're caching the entire world, I mean,\n// that's ~32GB of just integers for the next/prev links, plus whatever\n// else to hold that many keys and values.  Just filling the memory with\n// zeroes at init time is brutal when you get that big.\n// But why not be complete?\n// Maybe in the future, these limits will have expanded.\nconst getUintArray = (max: number) =>\n  !isPosInt(max)\n    ? null\n    : max <= Math.pow(2, 8)\n    ? Uint8Array\n    : max <= Math.pow(2, 16)\n    ? Uint16Array\n    : max <= Math.pow(2, 32)\n    ? Uint32Array\n    : max <= Number.MAX_SAFE_INTEGER\n    ? ZeroArray\n    : null\n/* c8 ignore stop */\n\nclass ZeroArray extends Array<number> {\n  constructor(size: number) {\n    super(size)\n    this.fill(0)\n  }\n}\nexport type { ZeroArray }\nexport type { Stack }\n\nexport type StackLike = Stack | Index[]\nclass Stack {\n  heap: NumberArray\n  length: number\n  // private constructor\n  static #constructing: boolean = false\n  static create(max: number): StackLike {\n    const HeapCls = getUintArray(max)\n    if (!HeapCls) return []\n    Stack.#constructing = true\n    const s = new Stack(max, HeapCls)\n    Stack.#constructing = false\n    return s\n  }\n  constructor(\n    max: number,\n    HeapCls: { new (n: number): NumberArray }\n  ) {\n    /* c8 ignore start */\n    if (!Stack.#constructing) {\n      throw new TypeError('instantiate Stack using Stack.create(n)')\n    }\n    /* c8 ignore stop */\n    this.heap = new HeapCls(max)\n    this.length = 0\n  }\n  push(n: Index) {\n    this.heap[this.length++] = n\n  }\n  pop(): Index {\n    return this.heap[--this.length] as Index\n  }\n}\n\n/**\n * Promise representing an in-progress {@link LRUCache#fetch} call\n */\nexport type BackgroundFetch<V> = Promise<V | undefined> & {\n  __returned: BackgroundFetch<V> | undefined\n  __abortController: AbortController\n  __staleWhileFetching: V | undefined\n}\n\nexport type DisposeTask<K, V> = [\n  value: V,\n  key: K,\n  reason: LRUCache.DisposeReason\n]\n\nexport namespace LRUCache {\n  /**\n   * An integer greater than 0, reflecting the calculated size of items\n   */\n  export type Size = number\n\n  /**\n   * Integer greater than 0, representing some number of milliseconds, or the\n   * time at which a TTL started counting from.\n   */\n  export type Milliseconds = number\n\n  /**\n   * An integer greater than 0, reflecting a number of items\n   */\n  export type Count = number\n\n  /**\n   * The reason why an item was removed from the cache, passed\n   * to the {@link Disposer} methods.\n   *\n   * - `evict`: The item was evicted because it is the least recently used,\n   *   and the cache is full.\n   * - `set`: A new value was set, overwriting the old value being disposed.\n   * - `delete`: The item was explicitly deleted, either by calling\n   *   {@link LRUCache#delete}, {@link LRUCache#clear}, or\n   *   {@link LRUCache#set} with an undefined value.\n   * - `expire`: The item was removed due to exceeding its TTL.\n   * - `fetch`: A {@link OptionsBase#fetchMethod} operation returned\n   *   `undefined` or was aborted, causing the item to be deleted.\n   */\n  export type DisposeReason =\n    | 'evict'\n    | 'set'\n    | 'delete'\n    | 'expire'\n    | 'fetch'\n  /**\n   * A method called upon item removal, passed as the\n   * {@link OptionsBase.dispose} and/or\n   * {@link OptionsBase.disposeAfter} options.\n   */\n  export type Disposer<K, V> = (\n    value: V,\n    key: K,\n    reason: DisposeReason\n  ) => void\n\n  /**\n   * A function that returns the effective calculated size\n   * of an entry in the cache.\n   */\n  export type SizeCalculator<K, V> = (value: V, key: K) => Size\n\n  /**\n   * Options provided to the\n   * {@link OptionsBase.fetchMethod} function.\n   */\n  export interface FetcherOptions<K, V, FC = unknown> {\n    signal: AbortSignal\n    options: FetcherFetchOptions<K, V, FC>\n    /**\n     * Object provided in the {@link FetchOptions.context} option to\n     * {@link LRUCache#fetch}\n     */\n    context: FC\n  }\n\n  /**\n   * Occasionally, it may be useful to track the internal behavior of the\n   * cache, particularly for logging, debugging, or for behavior within the\n   * `fetchMethod`. To do this, you can pass a `status` object to the\n   * {@link LRUCache#fetch}, {@link LRUCache#get}, {@link LRUCache#set},\n   * {@link LRUCache#memo}, and {@link LRUCache#has} methods.\n   *\n   * The `status` option should be a plain JavaScript object. The following\n   * fields will be set on it appropriately, depending on the situation.\n   */\n  export interface Status<V> {\n    /**\n     * The status of a set() operation.\n     *\n     * - add: the item was not found in the cache, and was added\n     * - update: the item was in the cache, with the same value provided\n     * - replace: the item was in the cache, and replaced\n     * - miss: the item was not added to the cache for some reason\n     */\n    set?: 'add' | 'update' | 'replace' | 'miss'\n\n    /**\n     * the ttl stored for the item, or undefined if ttls are not used.\n     */\n    ttl?: Milliseconds\n\n    /**\n     * the start time for the item, or undefined if ttls are not used.\n     */\n    start?: Milliseconds\n\n    /**\n     * The timestamp used for TTL calculation\n     */\n    now?: Milliseconds\n\n    /**\n     * the remaining ttl for the item, or undefined if ttls are not used.\n     */\n    remainingTTL?: Milliseconds\n\n    /**\n     * The calculated size for the item, if sizes are used.\n     */\n    entrySize?: Size\n\n    /**\n     * The total calculated size of the cache, if sizes are used.\n     */\n    totalCalculatedSize?: Size\n\n    /**\n     * A flag indicating that the item was not stored, due to exceeding the\n     * {@link OptionsBase.maxEntrySize}\n     */\n    maxEntrySizeExceeded?: true\n\n    /**\n     * The old value, specified in the case of `set:'update'` or\n     * `set:'replace'`\n     */\n    oldValue?: V\n\n    /**\n     * The results of a {@link LRUCache#has} operation\n     *\n     * - hit: the item was found in the cache\n     * - stale: the item was found in the cache, but is stale\n     * - miss: the item was not found in the cache\n     */\n    has?: 'hit' | 'stale' | 'miss'\n\n    /**\n     * The status of a {@link LRUCache#fetch} operation.\n     * Note that this can change as the underlying fetch() moves through\n     * various states.\n     *\n     * - inflight: there is another fetch() for this key which is in process\n     * - get: there is no {@link OptionsBase.fetchMethod}, so\n     *   {@link LRUCache#get} was called.\n     * - miss: the item is not in cache, and will be fetched.\n     * - hit: the item is in the cache, and was resolved immediately.\n     * - stale: the item is in the cache, but stale.\n     * - refresh: the item is in the cache, and not stale, but\n     *   {@link FetchOptions.forceRefresh} was specified.\n     */\n    fetch?: 'get' | 'inflight' | 'miss' | 'hit' | 'stale' | 'refresh'\n\n    /**\n     * The {@link OptionsBase.fetchMethod} was called\n     */\n    fetchDispatched?: true\n\n    /**\n     * The cached value was updated after a successful call to\n     * {@link OptionsBase.fetchMethod}\n     */\n    fetchUpdated?: true\n\n    /**\n     * The reason for a fetch() rejection.  Either the error raised by the\n     * {@link OptionsBase.fetchMethod}, or the reason for an\n     * AbortSignal.\n     */\n    fetchError?: Error\n\n    /**\n     * The fetch received an abort signal\n     */\n    fetchAborted?: true\n\n    /**\n     * The abort signal received was ignored, and the fetch was allowed to\n     * continue.\n     */\n    fetchAbortIgnored?: true\n\n    /**\n     * The fetchMethod promise resolved successfully\n     */\n    fetchResolved?: true\n\n    /**\n     * The fetchMethod promise was rejected\n     */\n    fetchRejected?: true\n\n    /**\n     * The status of a {@link LRUCache#get} operation.\n     *\n     * - fetching: The item is currently being fetched.  If a previous value\n     *   is present and allowed, that will be returned.\n     * - stale: The item is in the cache, and is stale.\n     * - hit: the item is in the cache\n     * - miss: the item is not in the cache\n     */\n    get?: 'stale' | 'hit' | 'miss'\n\n    /**\n     * A fetch or get operation returned a stale value.\n     */\n    returnedStale?: true\n  }\n\n  /**\n   * options which override the options set in the LRUCache constructor\n   * when calling {@link LRUCache#fetch}.\n   *\n   * This is the union of {@link GetOptions} and {@link SetOptions}, plus\n   * {@link OptionsBase.noDeleteOnFetchRejection},\n   * {@link OptionsBase.allowStaleOnFetchRejection},\n   * {@link FetchOptions.forceRefresh}, and\n   * {@link FetcherOptions.context}\n   *\n   * Any of these may be modified in the {@link OptionsBase.fetchMethod}\n   * function, but the {@link GetOptions} fields will of course have no\n   * effect, as the {@link LRUCache#get} call already happened by the time\n   * the fetchMethod is called.\n   */\n  export interface FetcherFetchOptions<K, V, FC = unknown>\n    extends Pick<\n      OptionsBase<K, V, FC>,\n      | 'allowStale'\n      | 'updateAgeOnGet'\n      | 'noDeleteOnStaleGet'\n      | 'sizeCalculation'\n      | 'ttl'\n      | 'noDisposeOnSet'\n      | 'noUpdateTTL'\n      | 'noDeleteOnFetchRejection'\n      | 'allowStaleOnFetchRejection'\n      | 'ignoreFetchAbort'\n      | 'allowStaleOnFetchAbort'\n    > {\n    status?: Status<V>\n    size?: Size\n  }\n\n  /**\n   * Options that may be passed to the {@link LRUCache#fetch} method.\n   */\n  export interface FetchOptions<K, V, FC>\n    extends FetcherFetchOptions<K, V, FC> {\n    /**\n     * Set to true to force a re-load of the existing data, even if it\n     * is not yet stale.\n     */\n    forceRefresh?: boolean\n    /**\n     * Context provided to the {@link OptionsBase.fetchMethod} as\n     * the {@link FetcherOptions.context} param.\n     *\n     * If the FC type is specified as unknown (the default),\n     * undefined or void, then this is optional.  Otherwise, it will\n     * be required.\n     */\n    context?: FC\n    signal?: AbortSignal\n    status?: Status<V>\n  }\n  /**\n   * Options provided to {@link LRUCache#fetch} when the FC type is something\n   * other than `unknown`, `undefined`, or `void`\n   */\n  export interface FetchOptionsWithContext<K, V, FC>\n    extends FetchOptions<K, V, FC> {\n    context: FC\n  }\n  /**\n   * Options provided to {@link LRUCache#fetch} when the FC type is\n   * `undefined` or `void`\n   */\n  export interface FetchOptionsNoContext<K, V>\n    extends FetchOptions<K, V, undefined> {\n    context?: undefined\n  }\n\n  export interface MemoOptions<K, V, FC = unknown>\n    extends Pick<\n      OptionsBase<K, V, FC>,\n      | 'allowStale'\n      | 'updateAgeOnGet'\n      | 'noDeleteOnStaleGet'\n      | 'sizeCalculation'\n      | 'ttl'\n      | 'noDisposeOnSet'\n      | 'noUpdateTTL'\n      | 'noDeleteOnFetchRejection'\n      | 'allowStaleOnFetchRejection'\n      | 'ignoreFetchAbort'\n      | 'allowStaleOnFetchAbort'\n    > {\n    /**\n     * Set to true to force a re-load of the existing data, even if it\n     * is not yet stale.\n     */\n    forceRefresh?: boolean\n    /**\n     * Context provided to the {@link OptionsBase.memoMethod} as\n     * the {@link MemoizerOptions.context} param.\n     *\n     * If the FC type is specified as unknown (the default),\n     * undefined or void, then this is optional.  Otherwise, it will\n     * be required.\n     */\n    context?: FC\n    status?: Status<V>\n  }\n  /**\n   * Options provided to {@link LRUCache#memo} when the FC type is something\n   * other than `unknown`, `undefined`, or `void`\n   */\n  export interface MemoOptionsWithContext<K, V, FC>\n    extends MemoOptions<K, V, FC> {\n    context: FC\n  }\n  /**\n   * Options provided to {@link LRUCache#memo} when the FC type is\n   * `undefined` or `void`\n   */\n  export interface MemoOptionsNoContext<K, V>\n    extends MemoOptions<K, V, undefined> {\n    context?: undefined\n  }\n\n  /**\n   * Options provided to the\n   * {@link OptionsBase.memoMethod} function.\n   */\n  export interface MemoizerOptions<K, V, FC = unknown> {\n    options: MemoizerMemoOptions<K, V, FC>\n    /**\n     * Object provided in the {@link MemoOptions.context} option to\n     * {@link LRUCache#memo}\n     */\n    context: FC\n  }\n\n  /**\n   * options which override the options set in the LRUCache constructor\n   * when calling {@link LRUCache#memo}.\n   *\n   * This is the union of {@link GetOptions} and {@link SetOptions}, plus\n   * {@link MemoOptions.forceRefresh}, and\n   * {@link MemoerOptions.context}\n   *\n   * Any of these may be modified in the {@link OptionsBase.memoMethod}\n   * function, but the {@link GetOptions} fields will of course have no\n   * effect, as the {@link LRUCache#get} call already happened by the time\n   * the memoMethod is called.\n   */\n  export interface MemoizerMemoOptions<K, V, FC = unknown>\n    extends Pick<\n      OptionsBase<K, V, FC>,\n      | 'allowStale'\n      | 'updateAgeOnGet'\n      | 'noDeleteOnStaleGet'\n      | 'sizeCalculation'\n      | 'ttl'\n      | 'noDisposeOnSet'\n      | 'noUpdateTTL'\n    > {\n    status?: Status<V>\n    size?: Size\n    start?: Milliseconds\n  }\n\n  /**\n   * Options that may be passed to the {@link LRUCache#has} method.\n   */\n  export interface HasOptions<K, V, FC>\n    extends Pick<OptionsBase<K, V, FC>, 'updateAgeOnHas'> {\n    status?: Status<V>\n  }\n\n  /**\n   * Options that may be passed to the {@link LRUCache#get} method.\n   */\n  export interface GetOptions<K, V, FC>\n    extends Pick<\n      OptionsBase<K, V, FC>,\n      'allowStale' | 'updateAgeOnGet' | 'noDeleteOnStaleGet'\n    > {\n    status?: Status<V>\n  }\n\n  /**\n   * Options that may be passed to the {@link LRUCache#peek} method.\n   */\n  export interface PeekOptions<K, V, FC>\n    extends Pick<OptionsBase<K, V, FC>, 'allowStale'> {}\n\n  /**\n   * Options that may be passed to the {@link LRUCache#set} method.\n   */\n  export interface SetOptions<K, V, FC>\n    extends Pick<\n      OptionsBase<K, V, FC>,\n      'sizeCalculation' | 'ttl' | 'noDisposeOnSet' | 'noUpdateTTL'\n    > {\n    /**\n     * If size tracking is enabled, then setting an explicit size\n     * in the {@link LRUCache#set} call will prevent calling the\n     * {@link OptionsBase.sizeCalculation} function.\n     */\n    size?: Size\n    /**\n     * If TTL tracking is enabled, then setting an explicit start\n     * time in the {@link LRUCache#set} call will override the\n     * default time from `performance.now()` or `Date.now()`.\n     *\n     * Note that it must be a valid value for whichever time-tracking\n     * method is in use.\n     */\n    start?: Milliseconds\n    status?: Status<V>\n  }\n\n  /**\n   * The type signature for the {@link OptionsBase.fetchMethod} option.\n   */\n  export type Fetcher<K, V, FC = unknown> = (\n    key: K,\n    staleValue: V | undefined,\n    options: FetcherOptions<K, V, FC>\n  ) => Promise<V | undefined | void> | V | undefined | void\n\n  /**\n   * the type signature for the {@link OptionsBase.memoMethod} option.\n   */\n  export type Memoizer<K, V, FC = unknown> = (\n    key: K,\n    staleValue: V | undefined,\n    options: MemoizerOptions<K, V, FC>\n  ) => V\n\n  /**\n   * Options which may be passed to the {@link LRUCache} constructor.\n   *\n   * Most of these may be overridden in the various options that use\n   * them.\n   *\n   * Despite all being technically optional, the constructor requires that\n   * a cache is at minimum limited by one or more of {@link OptionsBase.max},\n   * {@link OptionsBase.ttl}, or {@link OptionsBase.maxSize}.\n   *\n   * If {@link OptionsBase.ttl} is used alone, then it is strongly advised\n   * (and in fact required by the type definitions here) that the cache\n   * also set {@link OptionsBase.ttlAutopurge}, to prevent potentially\n   * unbounded storage.\n   *\n   * All options are also available on the {@link LRUCache} instance, making\n   * it safe to pass an LRUCache instance as the options argumemnt to\n   * make another empty cache of the same type.\n   *\n   * Some options are marked as read-only, because changing them after\n   * instantiation is not safe. Changing any of the other options will of\n   * course only have an effect on subsequent method calls.\n   */\n  export interface OptionsBase<K, V, FC> {\n    /**\n     * The maximum number of items to store in the cache before evicting\n     * old entries. This is read-only on the {@link LRUCache} instance,\n     * and may not be overridden.\n     *\n     * If set, then storage space will be pre-allocated at construction\n     * time, and the cache will perform significantly faster.\n     *\n     * Note that significantly fewer items may be stored, if\n     * {@link OptionsBase.maxSize} and/or {@link OptionsBase.ttl} are also\n     * set.\n     *\n     * **It is strongly recommended to set a `max` to prevent unbounded growth\n     * of the cache.**\n     */\n    max?: Count\n\n    /**\n     * Max time in milliseconds for items to live in cache before they are\n     * considered stale.  Note that stale items are NOT preemptively removed by\n     * default, and MAY live in the cache, contributing to its LRU max, long\n     * after they have expired, unless {@link OptionsBase.ttlAutopurge} is\n     * set.\n     *\n     * If set to `0` (the default value), then that means \"do not track\n     * TTL\", not \"expire immediately\".\n     *\n     * Also, as this cache is optimized for LRU/MRU operations, some of\n     * the staleness/TTL checks will reduce performance, as they will incur\n     * overhead by deleting items.\n     *\n     * This is not primarily a TTL cache, and does not make strong TTL\n     * guarantees. There is no pre-emptive pruning of expired items, but you\n     * _may_ set a TTL on the cache, and it will treat expired items as missing\n     * when they are fetched, and delete them.\n     *\n     * Optional, but must be a non-negative integer in ms if specified.\n     *\n     * This may be overridden by passing an options object to `cache.set()`.\n     *\n     * At least one of `max`, `maxSize`, or `TTL` is required. This must be a\n     * positive integer if set.\n     *\n     * Even if ttl tracking is enabled, **it is strongly recommended to set a\n     * `max` to prevent unbounded growth of the cache.**\n     *\n     * If ttl tracking is enabled, and `max` and `maxSize` are not set,\n     * and `ttlAutopurge` is not set, then a warning will be emitted\n     * cautioning about the potential for unbounded memory consumption.\n     * (The TypeScript definitions will also discourage this.)\n     */\n    ttl?: Milliseconds\n\n    /**\n     * Minimum amount of time in ms in which to check for staleness.\n     * Defaults to 1, which means that the current time is checked\n     * at most once per millisecond.\n     *\n     * Set to 0 to check the current time every time staleness is tested.\n     * (This reduces performance, and is theoretically unnecessary.)\n     *\n     * Setting this to a higher value will improve performance somewhat\n     * while using ttl tracking, albeit at the expense of keeping stale\n     * items around a bit longer than their TTLs would indicate.\n     *\n     * @default 1\n     */\n    ttlResolution?: Milliseconds\n\n    /**\n     * Preemptively remove stale items from the cache.\n     *\n     * Note that this may *significantly* degrade performance, especially if\n     * the cache is storing a large number of items. It is almost always best\n     * to just leave the stale items in the cache, and let them fall out as new\n     * items are added.\n     *\n     * Note that this means that {@link OptionsBase.allowStale} is a bit\n     * pointless, as stale items will be deleted almost as soon as they\n     * expire.\n     *\n     * Use with caution!\n     */\n    ttlAutopurge?: boolean\n\n    /**\n     * When using time-expiring entries with `ttl`, setting this to `true` will\n     * make each item's age reset to 0 whenever it is retrieved from cache with\n     * {@link LRUCache#get}, causing it to not expire. (It can still fall out\n     * of cache based on recency of use, of course.)\n     *\n     * Has no effect if {@link OptionsBase.ttl} is not set.\n     *\n     * This may be overridden by passing an options object to `cache.get()`.\n     */\n    updateAgeOnGet?: boolean\n\n    /**\n     * When using time-expiring entries with `ttl`, setting this to `true` will\n     * make each item's age reset to 0 whenever its presence in the cache is\n     * checked with {@link LRUCache#has}, causing it to not expire. (It can\n     * still fall out of cache based on recency of use, of course.)\n     *\n     * Has no effect if {@link OptionsBase.ttl} is not set.\n     */\n    updateAgeOnHas?: boolean\n\n    /**\n     * Allow {@link LRUCache#get} and {@link LRUCache#fetch} calls to return\n     * stale data, if available.\n     *\n     * By default, if you set `ttl`, stale items will only be deleted from the\n     * cache when you `get(key)`. That is, it's not preemptively pruning items,\n     * unless {@link OptionsBase.ttlAutopurge} is set.\n     *\n     * If you set `allowStale:true`, it'll return the stale value *as well as*\n     * deleting it. If you don't set this, then it'll return `undefined` when\n     * you try to get a stale entry.\n     *\n     * Note that when a stale entry is fetched, _even if it is returned due to\n     * `allowStale` being set_, it is removed from the cache immediately. You\n     * can suppress this behavior by setting\n     * {@link OptionsBase.noDeleteOnStaleGet}, either in the constructor, or in\n     * the options provided to {@link LRUCache#get}.\n     *\n     * This may be overridden by passing an options object to `cache.get()`.\n     * The `cache.has()` method will always return `false` for stale items.\n     *\n     * Only relevant if a ttl is set.\n     */\n    allowStale?: boolean\n\n    /**\n     * Function that is called on items when they are dropped from the\n     * cache, as `dispose(value, key, reason)`.\n     *\n     * This can be handy if you want to close file descriptors or do\n     * other cleanup tasks when items are no longer stored in the cache.\n     *\n     * **NOTE**: It is called _before_ the item has been fully removed\n     * from the cache, so if you want to put it right back in, you need\n     * to wait until the next tick. If you try to add it back in during\n     * the `dispose()` function call, it will break things in subtle and\n     * weird ways.\n     *\n     * Unlike several other options, this may _not_ be overridden by\n     * passing an option to `set()`, for performance reasons.\n     *\n     * The `reason` will be one of the following strings, corresponding\n     * to the reason for the item's deletion:\n     *\n     * - `evict` Item was evicted to make space for a new addition\n     * - `set` Item was overwritten by a new value\n     * - `expire` Item expired its TTL\n     * - `fetch` Item was deleted due to a failed or aborted fetch, or a\n     *   fetchMethod returning `undefined.\n     * - `delete` Item was removed by explicit `cache.delete(key)`,\n     *   `cache.clear()`, or `cache.set(key, undefined)`.\n     */\n    dispose?: Disposer<K, V>\n\n    /**\n     * The same as {@link OptionsBase.dispose}, but called *after* the entry\n     * is completely removed and the cache is once again in a clean state.\n     *\n     * It is safe to add an item right back into the cache at this point.\n     * However, note that it is *very* easy to inadvertently create infinite\n     * recursion this way.\n     */\n    disposeAfter?: Disposer<K, V>\n\n    /**\n     * Set to true to suppress calling the\n     * {@link OptionsBase.dispose} function if the entry key is\n     * still accessible within the cache.\n     *\n     * This may be overridden by passing an options object to\n     * {@link LRUCache#set}.\n     *\n     * Only relevant if `dispose` or `disposeAfter` are set.\n     */\n    noDisposeOnSet?: boolean\n\n    /**\n     * Boolean flag to tell the cache to not update the TTL when setting a new\n     * value for an existing key (ie, when updating a value rather than\n     * inserting a new value).  Note that the TTL value is _always_ set (if\n     * provided) when adding a new entry into the cache.\n     *\n     * Has no effect if a {@link OptionsBase.ttl} is not set.\n     *\n     * May be passed as an option to {@link LRUCache#set}.\n     */\n    noUpdateTTL?: boolean\n\n    /**\n     * Set to a positive integer to track the sizes of items added to the\n     * cache, and automatically evict items in order to stay below this size.\n     * Note that this may result in fewer than `max` items being stored.\n     *\n     * Attempting to add an item to the cache whose calculated size is greater\n     * that this amount will be a no-op. The item will not be cached, and no\n     * other items will be evicted.\n     *\n     * Optional, must be a positive integer if provided.\n     *\n     * Sets `maxEntrySize` to the same value, unless a different value is\n     * provided for `maxEntrySize`.\n     *\n     * At least one of `max`, `maxSize`, or `TTL` is required. This must be a\n     * positive integer if set.\n     *\n     * Even if size tracking is enabled, **it is strongly recommended to set a\n     * `max` to prevent unbounded growth of the cache.**\n     *\n     * Note also that size tracking can negatively impact performance,\n     * though for most cases, only minimally.\n     */\n    maxSize?: Size\n\n    /**\n     * The maximum allowed size for any single item in the cache.\n     *\n     * If a larger item is passed to {@link LRUCache#set} or returned by a\n     * {@link OptionsBase.fetchMethod} or {@link OptionsBase.memoMethod}, then\n     * it will not be stored in the cache.\n     *\n     * Attempting to add an item whose calculated size is greater than\n     * this amount will not cache the item or evict any old items, but\n     * WILL delete an existing value if one is already present.\n     *\n     * Optional, must be a positive integer if provided. Defaults to\n     * the value of `maxSize` if provided.\n     */\n    maxEntrySize?: Size\n\n    /**\n     * A function that returns a number indicating the item's size.\n     *\n     * Requires {@link OptionsBase.maxSize} to be set.\n     *\n     * If not provided, and {@link OptionsBase.maxSize} or\n     * {@link OptionsBase.maxEntrySize} are set, then all\n     * {@link LRUCache#set} calls **must** provide an explicit\n     * {@link SetOptions.size} or sizeCalculation param.\n     */\n    sizeCalculation?: SizeCalculator<K, V>\n\n    /**\n     * Method that provides the implementation for {@link LRUCache#fetch}\n     *\n     * ```ts\n     * fetchMethod(key, staleValue, { signal, options, context })\n     * ```\n     *\n     * If `fetchMethod` is not provided, then `cache.fetch(key)` is equivalent\n     * to `Promise.resolve(cache.get(key))`.\n     *\n     * If at any time, `signal.aborted` is set to `true`, or if the\n     * `signal.onabort` method is called, or if it emits an `'abort'` event\n     * which you can listen to with `addEventListener`, then that means that\n     * the fetch should be abandoned. This may be passed along to async\n     * functions aware of AbortController/AbortSignal behavior.\n     *\n     * The `fetchMethod` should **only** return `undefined` or a Promise\n     * resolving to `undefined` if the AbortController signaled an `abort`\n     * event. In all other cases, it should return or resolve to a value\n     * suitable for adding to the cache.\n     *\n     * The `options` object is a union of the options that may be provided to\n     * `set()` and `get()`. If they are modified, then that will result in\n     * modifying the settings to `cache.set()` when the value is resolved, and\n     * in the case of\n     * {@link OptionsBase.noDeleteOnFetchRejection} and\n     * {@link OptionsBase.allowStaleOnFetchRejection}, the handling of\n     * `fetchMethod` failures.\n     *\n     * For example, a DNS cache may update the TTL based on the value returned\n     * from a remote DNS server by changing `options.ttl` in the `fetchMethod`.\n     */\n    fetchMethod?: Fetcher<K, V, FC>\n\n    /**\n     * Method that provides the implementation for {@link LRUCache#memo}\n     */\n    memoMethod?: Memoizer<K, V, FC>\n\n    /**\n     * Set to true to suppress the deletion of stale data when a\n     * {@link OptionsBase.fetchMethod} returns a rejected promise.\n     */\n    noDeleteOnFetchRejection?: boolean\n\n    /**\n     * Do not delete stale items when they are retrieved with\n     * {@link LRUCache#get}.\n     *\n     * Note that the `get` return value will still be `undefined`\n     * unless {@link OptionsBase.allowStale} is true.\n     *\n     * When using time-expiring entries with `ttl`, by default stale\n     * items will be removed from the cache when the key is accessed\n     * with `cache.get()`.\n     *\n     * Setting this option will cause stale items to remain in the cache, until\n     * they are explicitly deleted with `cache.delete(key)`, or retrieved with\n     * `noDeleteOnStaleGet` set to `false`.\n     *\n     * This may be overridden by passing an options object to `cache.get()`.\n     *\n     * Only relevant if a ttl is used.\n     */\n    noDeleteOnStaleGet?: boolean\n\n    /**\n     * Set to true to allow returning stale data when a\n     * {@link OptionsBase.fetchMethod} throws an error or returns a rejected\n     * promise.\n     *\n     * This differs from using {@link OptionsBase.allowStale} in that stale\n     * data will ONLY be returned in the case that the {@link LRUCache#fetch}\n     * fails, not any other times.\n     *\n     * If a `fetchMethod` fails, and there is no stale value available, the\n     * `fetch()` will resolve to `undefined`. Ie, all `fetchMethod` errors are\n     * suppressed.\n     *\n     * Implies `noDeleteOnFetchRejection`.\n     *\n     * This may be set in calls to `fetch()`, or defaulted on the constructor,\n     * or overridden by modifying the options object in the `fetchMethod`.\n     */\n    allowStaleOnFetchRejection?: boolean\n\n    /**\n     * Set to true to return a stale value from the cache when the\n     * `AbortSignal` passed to the {@link OptionsBase.fetchMethod} dispatches\n     * an `'abort'` event, whether user-triggered, or due to internal cache\n     * behavior.\n     *\n     * Unless {@link OptionsBase.ignoreFetchAbort} is also set, the underlying\n     * {@link OptionsBase.fetchMethod} will still be considered canceled, and\n     * any value it returns will be ignored and not cached.\n     *\n     * Caveat: since fetches are aborted when a new value is explicitly\n     * set in the cache, this can lead to fetch returning a stale value,\n     * since that was the fallback value _at the moment the `fetch()` was\n     * initiated_, even though the new updated value is now present in\n     * the cache.\n     *\n     * For example:\n     *\n     * ```ts\n     * const cache = new LRUCache<string, any>({\n     *   ttl: 100,\n     *   fetchMethod: async (url, oldValue, { signal }) =>  {\n     *     const res = await fetch(url, { signal })\n     *     return await res.json()\n     *   }\n     * })\n     * cache.set('https://example.com/', { some: 'data' })\n     * // 100ms go by...\n     * const result = cache.fetch('https://example.com/')\n     * cache.set('https://example.com/', { other: 'thing' })\n     * console.log(await result) // { some: 'data' }\n     * console.log(cache.get('https://example.com/')) // { other: 'thing' }\n     * ```\n     */\n    allowStaleOnFetchAbort?: boolean\n\n    /**\n     * Set to true to ignore the `abort` event emitted by the `AbortSignal`\n     * object passed to {@link OptionsBase.fetchMethod}, and still cache the\n     * resulting resolution value, as long as it is not `undefined`.\n     *\n     * When used on its own, this means aborted {@link LRUCache#fetch} calls\n     * are not immediately resolved or rejected when they are aborted, and\n     * instead take the full time to await.\n     *\n     * When used with {@link OptionsBase.allowStaleOnFetchAbort}, aborted\n     * {@link LRUCache#fetch} calls will resolve immediately to their stale\n     * cached value or `undefined`, and will continue to process and eventually\n     * update the cache when they resolve, as long as the resulting value is\n     * not `undefined`, thus supporting a \"return stale on timeout while\n     * refreshing\" mechanism by passing `AbortSignal.timeout(n)` as the signal.\n     *\n     * For example:\n     *\n     * ```ts\n     * const c = new LRUCache({\n     *   ttl: 100,\n     *   ignoreFetchAbort: true,\n     *   allowStaleOnFetchAbort: true,\n     *   fetchMethod: async (key, oldValue, { signal }) => {\n     *     // note: do NOT pass the signal to fetch()!\n     *     // let's say this fetch can take a long time.\n     *     const res = await fetch(`https://slow-backend-server/${key}`)\n     *     return await res.json()\n     *   },\n     * })\n     *\n     * // this will return the stale value after 100ms, while still\n     * // updating in the background for next time.\n     * const val = await c.fetch('key', { signal: AbortSignal.timeout(100) })\n     * ```\n     *\n     * **Note**: regardless of this setting, an `abort` event _is still\n     * emitted on the `AbortSignal` object_, so may result in invalid results\n     * when passed to other underlying APIs that use AbortSignals.\n     *\n     * This may be overridden in the {@link OptionsBase.fetchMethod} or the\n     * call to {@link LRUCache#fetch}.\n     */\n    ignoreFetchAbort?: boolean\n  }\n\n  export interface OptionsMaxLimit<K, V, FC>\n    extends OptionsBase<K, V, FC> {\n    max: Count\n  }\n  export interface OptionsTTLLimit<K, V, FC>\n    extends OptionsBase<K, V, FC> {\n    ttl: Milliseconds\n    ttlAutopurge: boolean\n  }\n  export interface OptionsSizeLimit<K, V, FC>\n    extends OptionsBase<K, V, FC> {\n    maxSize: Size\n  }\n\n  /**\n   * The valid safe options for the {@link LRUCache} constructor\n   */\n  export type Options<K, V, FC> =\n    | OptionsMaxLimit<K, V, FC>\n    | OptionsSizeLimit<K, V, FC>\n    | OptionsTTLLimit<K, V, FC>\n\n  /**\n   * Entry objects used by {@link LRUCache#load} and {@link LRUCache#dump},\n   * and returned by {@link LRUCache#info}.\n   */\n  export interface Entry<V> {\n    value: V\n    ttl?: Milliseconds\n    size?: Size\n    start?: Milliseconds\n  }\n}\n\n/**\n * Default export, the thing you're using this module to get.\n *\n * The `K` and `V` types define the key and value types, respectively. The\n * optional `FC` type defines the type of the `context` object passed to\n * `cache.fetch()` and `cache.memo()`.\n *\n * Keys and values **must not** be `null` or `undefined`.\n *\n * All properties from the options object (with the exception of `max`,\n * `maxSize`, `fetchMethod`, `memoMethod`, `dispose` and `disposeAfter`) are\n * added as normal public members. (The listed options are read-only getters.)\n *\n * Changing any of these will alter the defaults for subsequent method calls.\n */\nexport class LRUCache<K extends {}, V extends {}, FC = unknown>\n  implements Map<K, V>\n{\n  // options that cannot be changed without disaster\n  readonly #max: LRUCache.Count\n  readonly #maxSize: LRUCache.Size\n  readonly #dispose?: LRUCache.Disposer<K, V>\n  readonly #disposeAfter?: LRUCache.Disposer<K, V>\n  readonly #fetchMethod?: LRUCache.Fetcher<K, V, FC>\n  readonly #memoMethod?: LRUCache.Memoizer<K, V, FC>\n\n  /**\n   * {@link LRUCache.OptionsBase.ttl}\n   */\n  ttl: LRUCache.Milliseconds\n\n  /**\n   * {@link LRUCache.OptionsBase.ttlResolution}\n   */\n  ttlResolution: LRUCache.Milliseconds\n  /**\n   * {@link LRUCache.OptionsBase.ttlAutopurge}\n   */\n  ttlAutopurge: boolean\n  /**\n   * {@link LRUCache.OptionsBase.updateAgeOnGet}\n   */\n  updateAgeOnGet: boolean\n  /**\n   * {@link LRUCache.OptionsBase.updateAgeOnHas}\n   */\n  updateAgeOnHas: boolean\n  /**\n   * {@link LRUCache.OptionsBase.allowStale}\n   */\n  allowStale: boolean\n\n  /**\n   * {@link LRUCache.OptionsBase.noDisposeOnSet}\n   */\n  noDisposeOnSet: boolean\n  /**\n   * {@link LRUCache.OptionsBase.noUpdateTTL}\n   */\n  noUpdateTTL: boolean\n  /**\n   * {@link LRUCache.OptionsBase.maxEntrySize}\n   */\n  maxEntrySize: LRUCache.Size\n  /**\n   * {@link LRUCache.OptionsBase.sizeCalculation}\n   */\n  sizeCalculation?: LRUCache.SizeCalculator<K, V>\n  /**\n   * {@link LRUCache.OptionsBase.noDeleteOnFetchRejection}\n   */\n  noDeleteOnFetchRejection: boolean\n  /**\n   * {@link LRUCache.OptionsBase.noDeleteOnStaleGet}\n   */\n  noDeleteOnStaleGet: boolean\n  /**\n   * {@link LRUCache.OptionsBase.allowStaleOnFetchAbort}\n   */\n  allowStaleOnFetchAbort: boolean\n  /**\n   * {@link LRUCache.OptionsBase.allowStaleOnFetchRejection}\n   */\n  allowStaleOnFetchRejection: boolean\n  /**\n   * {@link LRUCache.OptionsBase.ignoreFetchAbort}\n   */\n  ignoreFetchAbort: boolean\n\n  // computed properties\n  #size: LRUCache.Count\n  #calculatedSize: LRUCache.Size\n  #keyMap: Map<K, Index>\n  #keyList: (K | undefined)[]\n  #valList: (V | BackgroundFetch<V> | undefined)[]\n  #next: NumberArray\n  #prev: NumberArray\n  #head: Index\n  #tail: Index\n  #free: StackLike\n  #disposed?: DisposeTask<K, V>[]\n  #sizes?: ZeroArray\n  #starts?: ZeroArray\n  #ttls?: ZeroArray\n\n  #hasDispose: boolean\n  #hasFetchMethod: boolean\n  #hasDisposeAfter: boolean\n\n  /**\n   * Do not call this method unless you need to inspect the\n   * inner workings of the cache.  If anything returned by this\n   * object is modified in any way, strange breakage may occur.\n   *\n   * These fields are private for a reason!\n   *\n   * @internal\n   */\n  static unsafeExposeInternals<\n    K extends {},\n    V extends {},\n    FC extends unknown = unknown\n  >(c: LRUCache<K, V, FC>) {\n    return {\n      // properties\n      starts: c.#starts,\n      ttls: c.#ttls,\n      sizes: c.#sizes,\n      keyMap: c.#keyMap as Map<K, number>,\n      keyList: c.#keyList,\n      valList: c.#valList,\n      next: c.#next,\n      prev: c.#prev,\n      get head() {\n        return c.#head\n      },\n      get tail() {\n        return c.#tail\n      },\n      free: c.#free,\n      // methods\n      isBackgroundFetch: (p: any) => c.#isBackgroundFetch(p),\n      backgroundFetch: (\n        k: K,\n        index: number | undefined,\n        options: LRUCache.FetchOptions<K, V, FC>,\n        context: any\n      ): BackgroundFetch<V> =>\n        c.#backgroundFetch(\n          k,\n          index as Index | undefined,\n          options,\n          context\n        ),\n      moveToTail: (index: number): void =>\n        c.#moveToTail(index as Index),\n      indexes: (options?: { allowStale: boolean }) =>\n        c.#indexes(options),\n      rindexes: (options?: { allowStale: boolean }) =>\n        c.#rindexes(options),\n      isStale: (index: number | undefined) =>\n        c.#isStale(index as Index),\n    }\n  }\n\n  // Protected read-only members\n\n  /**\n   * {@link LRUCache.OptionsBase.max} (read-only)\n   */\n  get max(): LRUCache.Count {\n    return this.#max\n  }\n  /**\n   * {@link LRUCache.OptionsBase.maxSize} (read-only)\n   */\n  get maxSize(): LRUCache.Count {\n    return this.#maxSize\n  }\n  /**\n   * The total computed size of items in the cache (read-only)\n   */\n  get calculatedSize(): LRUCache.Size {\n    return this.#calculatedSize\n  }\n  /**\n   * The number of items stored in the cache (read-only)\n   */\n  get size(): LRUCache.Count {\n    return this.#size\n  }\n  /**\n   * {@link LRUCache.OptionsBase.fetchMethod} (read-only)\n   */\n  get fetchMethod(): LRUCache.Fetcher<K, V, FC> | undefined {\n    return this.#fetchMethod\n  }\n  get memoMethod(): LRUCache.Memoizer<K, V, FC> | undefined {\n    return this.#memoMethod\n  }\n  /**\n   * {@link LRUCache.OptionsBase.dispose} (read-only)\n   */\n  get dispose() {\n    return this.#dispose\n  }\n  /**\n   * {@link LRUCache.OptionsBase.disposeAfter} (read-only)\n   */\n  get disposeAfter() {\n    return this.#disposeAfter\n  }\n\n  constructor(\n    options: LRUCache.Options<K, V, FC> | LRUCache<K, V, FC>\n  ) {\n    const {\n      max = 0,\n      ttl,\n      ttlResolution = 1,\n      ttlAutopurge,\n      updateAgeOnGet,\n      updateAgeOnHas,\n      allowStale,\n      dispose,\n      disposeAfter,\n      noDisposeOnSet,\n      noUpdateTTL,\n      maxSize = 0,\n      maxEntrySize = 0,\n      sizeCalculation,\n      fetchMethod,\n      memoMethod,\n      noDeleteOnFetchRejection,\n      noDeleteOnStaleGet,\n      allowStaleOnFetchRejection,\n      allowStaleOnFetchAbort,\n      ignoreFetchAbort,\n    } = options\n\n    if (max !== 0 && !isPosInt(max)) {\n      throw new TypeError('max option must be a nonnegative integer')\n    }\n\n    const UintArray = max ? getUintArray(max) : Array\n    if (!UintArray) {\n      throw new Error('invalid max value: ' + max)\n    }\n\n    this.#max = max\n    this.#maxSize = maxSize\n    this.maxEntrySize = maxEntrySize || this.#maxSize\n    this.sizeCalculation = sizeCalculation\n    if (this.sizeCalculation) {\n      if (!this.#maxSize && !this.maxEntrySize) {\n        throw new TypeError(\n          'cannot set sizeCalculation without setting maxSize or maxEntrySize'\n        )\n      }\n      if (typeof this.sizeCalculation !== 'function') {\n        throw new TypeError('sizeCalculation set to non-function')\n      }\n    }\n\n    if (\n      memoMethod !== undefined &&\n      typeof memoMethod !== 'function'\n    ) {\n      throw new TypeError('memoMethod must be a function if defined')\n    }\n    this.#memoMethod = memoMethod\n\n    if (\n      fetchMethod !== undefined &&\n      typeof fetchMethod !== 'function'\n    ) {\n      throw new TypeError(\n        'fetchMethod must be a function if specified'\n      )\n    }\n    this.#fetchMethod = fetchMethod\n    this.#hasFetchMethod = !!fetchMethod\n\n    this.#keyMap = new Map()\n    this.#keyList = new Array(max).fill(undefined)\n    this.#valList = new Array(max).fill(undefined)\n    this.#next = new UintArray(max)\n    this.#prev = new UintArray(max)\n    this.#head = 0 as Index\n    this.#tail = 0 as Index\n    this.#free = Stack.create(max)\n    this.#size = 0\n    this.#calculatedSize = 0\n\n    if (typeof dispose === 'function') {\n      this.#dispose = dispose\n    }\n    if (typeof disposeAfter === 'function') {\n      this.#disposeAfter = disposeAfter\n      this.#disposed = []\n    } else {\n      this.#disposeAfter = undefined\n      this.#disposed = undefined\n    }\n    this.#hasDispose = !!this.#dispose\n    this.#hasDisposeAfter = !!this.#disposeAfter\n\n    this.noDisposeOnSet = !!noDisposeOnSet\n    this.noUpdateTTL = !!noUpdateTTL\n    this.noDeleteOnFetchRejection = !!noDeleteOnFetchRejection\n    this.allowStaleOnFetchRejection = !!allowStaleOnFetchRejection\n    this.allowStaleOnFetchAbort = !!allowStaleOnFetchAbort\n    this.ignoreFetchAbort = !!ignoreFetchAbort\n\n    // NB: maxEntrySize is set to maxSize if it's set\n    if (this.maxEntrySize !== 0) {\n      if (this.#maxSize !== 0) {\n        if (!isPosInt(this.#maxSize)) {\n          throw new TypeError(\n            'maxSize must be a positive integer if specified'\n          )\n        }\n      }\n      if (!isPosInt(this.maxEntrySize)) {\n        throw new TypeError(\n          'maxEntrySize must be a positive integer if specified'\n        )\n      }\n      this.#initializeSizeTracking()\n    }\n\n    this.allowStale = !!allowStale\n    this.noDeleteOnStaleGet = !!noDeleteOnStaleGet\n    this.updateAgeOnGet = !!updateAgeOnGet\n    this.updateAgeOnHas = !!updateAgeOnHas\n    this.ttlResolution =\n      isPosInt(ttlResolution) || ttlResolution === 0\n        ? ttlResolution\n        : 1\n    this.ttlAutopurge = !!ttlAutopurge\n    this.ttl = ttl || 0\n    if (this.ttl) {\n      if (!isPosInt(this.ttl)) {\n        throw new TypeError(\n          'ttl must be a positive integer if specified'\n        )\n      }\n      this.#initializeTTLTracking()\n    }\n\n    // do not allow completely unbounded caches\n    if (this.#max === 0 && this.ttl === 0 && this.#maxSize === 0) {\n      throw new TypeError(\n        'At least one of max, maxSize, or ttl is required'\n      )\n    }\n    if (!this.ttlAutopurge && !this.#max && !this.#maxSize) {\n      const code = 'LRU_CACHE_UNBOUNDED'\n      if (shouldWarn(code)) {\n        warned.add(code)\n        const msg =\n          'TTL caching without ttlAutopurge, max, or maxSize can ' +\n          'result in unbounded memory consumption.'\n        emitWarning(msg, 'UnboundedCacheWarning', code, LRUCache)\n      }\n    }\n  }\n\n  /**\n   * Return the number of ms left in the item's TTL. If item is not in cache,\n   * returns `0`. Returns `Infinity` if item is in cache without a defined TTL.\n   */\n  getRemainingTTL(key: K) {\n    return this.#keyMap.has(key) ? Infinity : 0\n  }\n\n  #initializeTTLTracking() {\n    const ttls = new ZeroArray(this.#max)\n    const starts = new ZeroArray(this.#max)\n    this.#ttls = ttls\n    this.#starts = starts\n\n    this.#setItemTTL = (index, ttl, start = perf.now()) => {\n      starts[index] = ttl !== 0 ? start : 0\n      ttls[index] = ttl\n      if (ttl !== 0 && this.ttlAutopurge) {\n        const t = setTimeout(() => {\n          if (this.#isStale(index)) {\n            this.#delete(this.#keyList[index] as K, 'expire')\n          }\n        }, ttl + 1)\n        // unref() not supported on all platforms\n        /* c8 ignore start */\n        if (t.unref) {\n          t.unref()\n        }\n        /* c8 ignore stop */\n      }\n    }\n\n    this.#updateItemAge = index => {\n      starts[index] = ttls[index] !== 0 ? perf.now() : 0\n    }\n\n    this.#statusTTL = (status, index) => {\n      if (ttls[index]) {\n        const ttl = ttls[index]\n        const start = starts[index]\n        /* c8 ignore next */\n        if (!ttl || !start) return\n        status.ttl = ttl\n        status.start = start\n        status.now = cachedNow || getNow()\n        const age = status.now - start\n        status.remainingTTL = ttl - age\n      }\n    }\n\n    // debounce calls to perf.now() to 1s so we're not hitting\n    // that costly call repeatedly.\n    let cachedNow = 0\n    const getNow = () => {\n      const n = perf.now()\n      if (this.ttlResolution > 0) {\n        cachedNow = n\n        const t = setTimeout(\n          () => (cachedNow = 0),\n          this.ttlResolution\n        )\n        // not available on all platforms\n        /* c8 ignore start */\n        if (t.unref) {\n          t.unref()\n        }\n        /* c8 ignore stop */\n      }\n      return n\n    }\n\n    this.getRemainingTTL = key => {\n      const index = this.#keyMap.get(key)\n      if (index === undefined) {\n        return 0\n      }\n      const ttl = ttls[index]\n      const start = starts[index]\n      if (!ttl || !start) {\n        return Infinity\n      }\n      const age = (cachedNow || getNow()) - start\n      return ttl - age\n    }\n\n    this.#isStale = index => {\n      const s = starts[index]\n      const t = ttls[index]\n      return !!t && !!s && (cachedNow || getNow()) - s > t\n    }\n  }\n\n  // conditionally set private methods related to TTL\n  #updateItemAge: (index: Index) => void = () => {}\n  #statusTTL: (status: LRUCache.Status<V>, index: Index) => void =\n    () => {}\n  #setItemTTL: (\n    index: Index,\n    ttl: LRUCache.Milliseconds,\n    start?: LRUCache.Milliseconds\n    // ignore because we never call this if we're not already in TTL mode\n    /* c8 ignore start */\n  ) => void = () => {}\n  /* c8 ignore stop */\n\n  #isStale: (index: Index) => boolean = () => false\n\n  #initializeSizeTracking() {\n    const sizes = new ZeroArray(this.#max)\n    this.#calculatedSize = 0\n    this.#sizes = sizes\n    this.#removeItemSize = index => {\n      this.#calculatedSize -= sizes[index] as number\n      sizes[index] = 0\n    }\n    this.#requireSize = (k, v, size, sizeCalculation) => {\n      // provisionally accept background fetches.\n      // actual value size will be checked when they return.\n      if (this.#isBackgroundFetch(v)) {\n        return 0\n      }\n      if (!isPosInt(size)) {\n        if (sizeCalculation) {\n          if (typeof sizeCalculation !== 'function') {\n            throw new TypeError('sizeCalculation must be a function')\n          }\n          size = sizeCalculation(v, k)\n          if (!isPosInt(size)) {\n            throw new TypeError(\n              'sizeCalculation return invalid (expect positive integer)'\n            )\n          }\n        } else {\n          throw new TypeError(\n            'invalid size value (must be positive integer). ' +\n              'When maxSize or maxEntrySize is used, sizeCalculation ' +\n              'or size must be set.'\n          )\n        }\n      }\n      return size\n    }\n    this.#addItemSize = (\n      index: Index,\n      size: LRUCache.Size,\n      status?: LRUCache.Status<V>\n    ) => {\n      sizes[index] = size\n      if (this.#maxSize) {\n        const maxSize = this.#maxSize - (sizes[index] as number)\n        while (this.#calculatedSize > maxSize) {\n          this.#evict(true)\n        }\n      }\n      this.#calculatedSize += sizes[index] as number\n      if (status) {\n        status.entrySize = size\n        status.totalCalculatedSize = this.#calculatedSize\n      }\n    }\n  }\n\n  #removeItemSize: (index: Index) => void = _i => {}\n  #addItemSize: (\n    index: Index,\n    size: LRUCache.Size,\n    status?: LRUCache.Status<V>\n  ) => void = (_i, _s, _st) => {}\n  #requireSize: (\n    k: K,\n    v: V | BackgroundFetch<V>,\n    size?: LRUCache.Size,\n    sizeCalculation?: LRUCache.SizeCalculator<K, V>\n  ) => LRUCache.Size = (\n    _k: K,\n    _v: V | BackgroundFetch<V>,\n    size?: LRUCache.Size,\n    sizeCalculation?: LRUCache.SizeCalculator<K, V>\n  ) => {\n    if (size || sizeCalculation) {\n      throw new TypeError(\n        'cannot set size without setting maxSize or maxEntrySize on cache'\n      )\n    }\n    return 0\n  };\n\n  *#indexes({ allowStale = this.allowStale } = {}) {\n    if (this.#size) {\n      for (let i = this.#tail; true; ) {\n        if (!this.#isValidIndex(i)) {\n          break\n        }\n        if (allowStale || !this.#isStale(i)) {\n          yield i\n        }\n        if (i === this.#head) {\n          break\n        } else {\n          i = this.#prev[i] as Index\n        }\n      }\n    }\n  }\n\n  *#rindexes({ allowStale = this.allowStale } = {}) {\n    if (this.#size) {\n      for (let i = this.#head; true; ) {\n        if (!this.#isValidIndex(i)) {\n          break\n        }\n        if (allowStale || !this.#isStale(i)) {\n          yield i\n        }\n        if (i === this.#tail) {\n          break\n        } else {\n          i = this.#next[i] as Index\n        }\n      }\n    }\n  }\n\n  #isValidIndex(index: Index) {\n    return (\n      index !== undefined &&\n      this.#keyMap.get(this.#keyList[index] as K) === index\n    )\n  }\n\n  /**\n   * Return a generator yielding `[key, value]` pairs,\n   * in order from most recently used to least recently used.\n   */\n  *entries() {\n    for (const i of this.#indexes()) {\n      if (\n        this.#valList[i] !== undefined &&\n        this.#keyList[i] !== undefined &&\n        !this.#isBackgroundFetch(this.#valList[i])\n      ) {\n        yield [this.#keyList[i], this.#valList[i]] as [K, V]\n      }\n    }\n  }\n\n  /**\n   * Inverse order version of {@link LRUCache.entries}\n   *\n   * Return a generator yielding `[key, value]` pairs,\n   * in order from least recently used to most recently used.\n   */\n  *rentries() {\n    for (const i of this.#rindexes()) {\n      if (\n        this.#valList[i] !== undefined &&\n        this.#keyList[i] !== undefined &&\n        !this.#isBackgroundFetch(this.#valList[i])\n      ) {\n        yield [this.#keyList[i], this.#valList[i]]\n      }\n    }\n  }\n\n  /**\n   * Return a generator yielding the keys in the cache,\n   * in order from most recently used to least recently used.\n   */\n  *keys() {\n    for (const i of this.#indexes()) {\n      const k = this.#keyList[i]\n      if (\n        k !== undefined &&\n        !this.#isBackgroundFetch(this.#valList[i])\n      ) {\n        yield k\n      }\n    }\n  }\n\n  /**\n   * Inverse order version of {@link LRUCache.keys}\n   *\n   * Return a generator yielding the keys in the cache,\n   * in order from least recently used to most recently used.\n   */\n  *rkeys() {\n    for (const i of this.#rindexes()) {\n      const k = this.#keyList[i]\n      if (\n        k !== undefined &&\n        !this.#isBackgroundFetch(this.#valList[i])\n      ) {\n        yield k\n      }\n    }\n  }\n\n  /**\n   * Return a generator yielding the values in the cache,\n   * in order from most recently used to least recently used.\n   */\n  *values() {\n    for (const i of this.#indexes()) {\n      const v = this.#valList[i]\n      if (\n        v !== undefined &&\n        !this.#isBackgroundFetch(this.#valList[i])\n      ) {\n        yield this.#valList[i] as V\n      }\n    }\n  }\n\n  /**\n   * Inverse order version of {@link LRUCache.values}\n   *\n   * Return a generator yielding the values in the cache,\n   * in order from least recently used to most recently used.\n   */\n  *rvalues() {\n    for (const i of this.#rindexes()) {\n      const v = this.#valList[i]\n      if (\n        v !== undefined &&\n        !this.#isBackgroundFetch(this.#valList[i])\n      ) {\n        yield this.#valList[i]\n      }\n    }\n  }\n\n  /**\n   * Iterating over the cache itself yields the same results as\n   * {@link LRUCache.entries}\n   */\n  [Symbol.iterator]() {\n    return this.entries()\n  }\n\n  /**\n   * A String value that is used in the creation of the default string\n   * description of an object. Called by the built-in method\n   * `Object.prototype.toString`.\n   */\n  [Symbol.toStringTag] = 'LRUCache'\n\n  /**\n   * Find a value for which the supplied fn method returns a truthy value,\n   * similar to `Array.find()`. fn is called as `fn(value, key, cache)`.\n   */\n  find(\n    fn: (v: V, k: K, self: LRUCache<K, V, FC>) => boolean,\n    getOptions: LRUCache.GetOptions<K, V, FC> = {}\n  ) {\n    for (const i of this.#indexes()) {\n      const v = this.#valList[i]\n      const value = this.#isBackgroundFetch(v)\n        ? v.__staleWhileFetching\n        : v\n      if (value === undefined) continue\n      if (fn(value, this.#keyList[i] as K, this)) {\n        return this.get(this.#keyList[i] as K, getOptions)\n      }\n    }\n  }\n\n  /**\n   * Call the supplied function on each item in the cache, in order from most\n   * recently used to least recently used.\n   *\n   * `fn` is called as `fn(value, key, cache)`.\n   *\n   * If `thisp` is provided, function will be called in the `this`-context of\n   * the provided object, or the cache if no `thisp` object is provided.\n   *\n   * Does not update age or recenty of use, or iterate over stale values.\n   */\n  forEach(\n    fn: (v: V, k: K, self: LRUCache<K, V, FC>) => any,\n    thisp: any = this\n  ) {\n    for (const i of this.#indexes()) {\n      const v = this.#valList[i]\n      const value = this.#isBackgroundFetch(v)\n        ? v.__staleWhileFetching\n        : v\n      if (value === undefined) continue\n      fn.call(thisp, value, this.#keyList[i] as K, this)\n    }\n  }\n\n  /**\n   * The same as {@link LRUCache.forEach} but items are iterated over in\n   * reverse order.  (ie, less recently used items are iterated over first.)\n   */\n  rforEach(\n    fn: (v: V, k: K, self: LRUCache<K, V, FC>) => any,\n    thisp: any = this\n  ) {\n    for (const i of this.#rindexes()) {\n      const v = this.#valList[i]\n      const value = this.#isBackgroundFetch(v)\n        ? v.__staleWhileFetching\n        : v\n      if (value === undefined) continue\n      fn.call(thisp, value, this.#keyList[i] as K, this)\n    }\n  }\n\n  /**\n   * Delete any stale entries. Returns true if anything was removed,\n   * false otherwise.\n   */\n  purgeStale() {\n    let deleted = false\n    for (const i of this.#rindexes({ allowStale: true })) {\n      if (this.#isStale(i)) {\n        this.#delete(this.#keyList[i] as K, 'expire')\n        deleted = true\n      }\n    }\n    return deleted\n  }\n\n  /**\n   * Get the extended info about a given entry, to get its value, size, and\n   * TTL info simultaneously. Returns `undefined` if the key is not present.\n   *\n   * Unlike {@link LRUCache#dump}, which is designed to be portable and survive\n   * serialization, the `start` value is always the current timestamp, and the\n   * `ttl` is a calculated remaining time to live (negative if expired).\n   *\n   * Always returns stale values, if their info is found in the cache, so be\n   * sure to check for expirations (ie, a negative {@link LRUCache.Entry#ttl})\n   * if relevant.\n   */\n  info(key: K): LRUCache.Entry<V> | undefined {\n    const i = this.#keyMap.get(key)\n    if (i === undefined) return undefined\n    const v = this.#valList[i]\n    const value: V | undefined = this.#isBackgroundFetch(v)\n      ? v.__staleWhileFetching\n      : v\n    if (value === undefined) return undefined\n    const entry: LRUCache.Entry<V> = { value }\n    if (this.#ttls && this.#starts) {\n      const ttl = this.#ttls[i]\n      const start = this.#starts[i]\n      if (ttl && start) {\n        const remain = ttl - (perf.now() - start)\n        entry.ttl = remain\n        entry.start = Date.now()\n      }\n    }\n    if (this.#sizes) {\n      entry.size = this.#sizes[i]\n    }\n    return entry\n  }\n\n  /**\n   * Return an array of [key, {@link LRUCache.Entry}] tuples which can be\n   * passed to {@link LRLUCache#load}.\n   *\n   * The `start` fields are calculated relative to a portable `Date.now()`\n   * timestamp, even if `performance.now()` is available.\n   *\n   * Stale entries are always included in the `dump`, even if\n   * {@link LRUCache.OptionsBase.allowStale} is false.\n   *\n   * Note: this returns an actual array, not a generator, so it can be more\n   * easily passed around.\n   */\n  dump() {\n    const arr: [K, LRUCache.Entry<V>][] = []\n    for (const i of this.#indexes({ allowStale: true })) {\n      const key = this.#keyList[i]\n      const v = this.#valList[i]\n      const value: V | undefined = this.#isBackgroundFetch(v)\n        ? v.__staleWhileFetching\n        : v\n      if (value === undefined || key === undefined) continue\n      const entry: LRUCache.Entry<V> = { value }\n      if (this.#ttls && this.#starts) {\n        entry.ttl = this.#ttls[i]\n        // always dump the start relative to a portable timestamp\n        // it's ok for this to be a bit slow, it's a rare operation.\n        const age = perf.now() - (this.#starts[i] as number)\n        entry.start = Math.floor(Date.now() - age)\n      }\n      if (this.#sizes) {\n        entry.size = this.#sizes[i]\n      }\n      arr.unshift([key, entry])\n    }\n    return arr\n  }\n\n  /**\n   * Reset the cache and load in the items in entries in the order listed.\n   *\n   * The shape of the resulting cache may be different if the same options are\n   * not used in both caches.\n   *\n   * The `start` fields are assumed to be calculated relative to a portable\n   * `Date.now()` timestamp, even if `performance.now()` is available.\n   */\n  load(arr: [K, LRUCache.Entry<V>][]) {\n    this.clear()\n    for (const [key, entry] of arr) {\n      if (entry.start) {\n        // entry.start is a portable timestamp, but we may be using\n        // node's performance.now(), so calculate the offset, so that\n        // we get the intended remaining TTL, no matter how long it's\n        // been on ice.\n        //\n        // it's ok for this to be a bit slow, it's a rare operation.\n        const age = Date.now() - entry.start\n        entry.start = perf.now() - age\n      }\n      this.set(key, entry.value, entry)\n    }\n  }\n\n  /**\n   * Add a value to the cache.\n   *\n   * Note: if `undefined` is specified as a value, this is an alias for\n   * {@link LRUCache#delete}\n   *\n   * Fields on the {@link LRUCache.SetOptions} options param will override\n   * their corresponding values in the constructor options for the scope\n   * of this single `set()` operation.\n   *\n   * If `start` is provided, then that will set the effective start\n   * time for the TTL calculation. Note that this must be a previous\n   * value of `performance.now()` if supported, or a previous value of\n   * `Date.now()` if not.\n   *\n   * Options object may also include `size`, which will prevent\n   * calling the `sizeCalculation` function and just use the specified\n   * number if it is a positive integer, and `noDisposeOnSet` which\n   * will prevent calling a `dispose` function in the case of\n   * overwrites.\n   *\n   * If the `size` (or return value of `sizeCalculation`) for a given\n   * entry is greater than `maxEntrySize`, then the item will not be\n   * added to the cache.\n   *\n   * Will update the recency of the entry.\n   *\n   * If the value is `undefined`, then this is an alias for\n   * `cache.delete(key)`. `undefined` is never stored in the cache.\n   */\n  set(\n    k: K,\n    v: V | BackgroundFetch<V> | undefined,\n    setOptions: LRUCache.SetOptions<K, V, FC> = {}\n  ) {\n    if (v === undefined) {\n      this.delete(k)\n      return this\n    }\n    const {\n      ttl = this.ttl,\n      start,\n      noDisposeOnSet = this.noDisposeOnSet,\n      sizeCalculation = this.sizeCalculation,\n      status,\n    } = setOptions\n    let { noUpdateTTL = this.noUpdateTTL } = setOptions\n\n    const size = this.#requireSize(\n      k,\n      v,\n      setOptions.size || 0,\n      sizeCalculation\n    )\n    // if the item doesn't fit, don't do anything\n    // NB: maxEntrySize set to maxSize by default\n    if (this.maxEntrySize && size > this.maxEntrySize) {\n      if (status) {\n        status.set = 'miss'\n        status.maxEntrySizeExceeded = true\n      }\n      // have to delete, in case something is there already.\n      this.#delete(k, 'set')\n      return this\n    }\n    let index = this.#size === 0 ? undefined : this.#keyMap.get(k)\n    if (index === undefined) {\n      // addition\n      index = (\n        this.#size === 0\n          ? this.#tail\n          : this.#free.length !== 0\n          ? this.#free.pop()\n          : this.#size === this.#max\n          ? this.#evict(false)\n          : this.#size\n      ) as Index\n      this.#keyList[index] = k\n      this.#valList[index] = v\n      this.#keyMap.set(k, index)\n      this.#next[this.#tail] = index\n      this.#prev[index] = this.#tail\n      this.#tail = index\n      this.#size++\n      this.#addItemSize(index, size, status)\n      if (status) status.set = 'add'\n      noUpdateTTL = false\n    } else {\n      // update\n      this.#moveToTail(index)\n      const oldVal = this.#valList[index] as V | BackgroundFetch<V>\n      if (v !== oldVal) {\n        if (this.#hasFetchMethod && this.#isBackgroundFetch(oldVal)) {\n          oldVal.__abortController.abort(new Error('replaced'))\n          const { __staleWhileFetching: s } = oldVal\n          if (s !== undefined && !noDisposeOnSet) {\n            if (this.#hasDispose) {\n              this.#dispose?.(s as V, k, 'set')\n            }\n            if (this.#hasDisposeAfter) {\n              this.#disposed?.push([s as V, k, 'set'])\n            }\n          }\n        } else if (!noDisposeOnSet) {\n          if (this.#hasDispose) {\n            this.#dispose?.(oldVal as V, k, 'set')\n          }\n          if (this.#hasDisposeAfter) {\n            this.#disposed?.push([oldVal as V, k, 'set'])\n          }\n        }\n        this.#removeItemSize(index)\n        this.#addItemSize(index, size, status)\n        this.#valList[index] = v\n        if (status) {\n          status.set = 'replace'\n          const oldValue =\n            oldVal && this.#isBackgroundFetch(oldVal)\n              ? oldVal.__staleWhileFetching\n              : oldVal\n          if (oldValue !== undefined) status.oldValue = oldValue\n        }\n      } else if (status) {\n        status.set = 'update'\n      }\n    }\n    if (ttl !== 0 && !this.#ttls) {\n      this.#initializeTTLTracking()\n    }\n    if (this.#ttls) {\n      if (!noUpdateTTL) {\n        this.#setItemTTL(index, ttl, start)\n      }\n      if (status) this.#statusTTL(status, index)\n    }\n    if (!noDisposeOnSet && this.#hasDisposeAfter && this.#disposed) {\n      const dt = this.#disposed\n      let task: DisposeTask<K, V> | undefined\n      while ((task = dt?.shift())) {\n        this.#disposeAfter?.(...task)\n      }\n    }\n    return this\n  }\n\n  /**\n   * Evict the least recently used item, returning its value or\n   * `undefined` if cache is empty.\n   */\n  pop(): V | undefined {\n    try {\n      while (this.#size) {\n        const val = this.#valList[this.#head]\n        this.#evict(true)\n        if (this.#isBackgroundFetch(val)) {\n          if (val.__staleWhileFetching) {\n            return val.__staleWhileFetching\n          }\n        } else if (val !== undefined) {\n          return val\n        }\n      }\n    } finally {\n      if (this.#hasDisposeAfter && this.#disposed) {\n        const dt = this.#disposed\n        let task: DisposeTask<K, V> | undefined\n        while ((task = dt?.shift())) {\n          this.#disposeAfter?.(...task)\n        }\n      }\n    }\n  }\n\n  #evict(free: boolean) {\n    const head = this.#head\n    const k = this.#keyList[head] as K\n    const v = this.#valList[head] as V\n    if (this.#hasFetchMethod && this.#isBackgroundFetch(v)) {\n      v.__abortController.abort(new Error('evicted'))\n    } else if (this.#hasDispose || this.#hasDisposeAfter) {\n      if (this.#hasDispose) {\n        this.#dispose?.(v, k, 'evict')\n      }\n      if (this.#hasDisposeAfter) {\n        this.#disposed?.push([v, k, 'evict'])\n      }\n    }\n    this.#removeItemSize(head)\n    // if we aren't about to use the index, then null these out\n    if (free) {\n      this.#keyList[head] = undefined\n      this.#valList[head] = undefined\n      this.#free.push(head)\n    }\n    if (this.#size === 1) {\n      this.#head = this.#tail = 0 as Index\n      this.#free.length = 0\n    } else {\n      this.#head = this.#next[head] as Index\n    }\n    this.#keyMap.delete(k)\n    this.#size--\n    return head\n  }\n\n  /**\n   * Check if a key is in the cache, without updating the recency of use.\n   * Will return false if the item is stale, even though it is technically\n   * in the cache.\n   *\n   * Check if a key is in the cache, without updating the recency of\n   * use. Age is updated if {@link LRUCache.OptionsBase.updateAgeOnHas} is set\n   * to `true` in either the options or the constructor.\n   *\n   * Will return `false` if the item is stale, even though it is technically in\n   * the cache. The difference can be determined (if it matters) by using a\n   * `status` argument, and inspecting the `has` field.\n   *\n   * Will not update item age unless\n   * {@link LRUCache.OptionsBase.updateAgeOnHas} is set.\n   */\n  has(k: K, hasOptions: LRUCache.HasOptions<K, V, FC> = {}) {\n    const { updateAgeOnHas = this.updateAgeOnHas, status } =\n      hasOptions\n    const index = this.#keyMap.get(k)\n    if (index !== undefined) {\n      const v = this.#valList[index]\n      if (\n        this.#isBackgroundFetch(v) &&\n        v.__staleWhileFetching === undefined\n      ) {\n        return false\n      }\n      if (!this.#isStale(index)) {\n        if (updateAgeOnHas) {\n          this.#updateItemAge(index)\n        }\n        if (status) {\n          status.has = 'hit'\n          this.#statusTTL(status, index)\n        }\n        return true\n      } else if (status) {\n        status.has = 'stale'\n        this.#statusTTL(status, index)\n      }\n    } else if (status) {\n      status.has = 'miss'\n    }\n    return false\n  }\n\n  /**\n   * Like {@link LRUCache#get} but doesn't update recency or delete stale\n   * items.\n   *\n   * Returns `undefined` if the item is stale, unless\n   * {@link LRUCache.OptionsBase.allowStale} is set.\n   */\n  peek(k: K, peekOptions: LRUCache.PeekOptions<K, V, FC> = {}) {\n    const { allowStale = this.allowStale } = peekOptions\n    const index = this.#keyMap.get(k)\n    if (\n      index === undefined ||\n      (!allowStale && this.#isStale(index))\n    ) {\n      return\n    }\n    const v = this.#valList[index]\n    // either stale and allowed, or forcing a refresh of non-stale value\n    return this.#isBackgroundFetch(v) ? v.__staleWhileFetching : v\n  }\n\n  #backgroundFetch(\n    k: K,\n    index: Index | undefined,\n    options: LRUCache.FetchOptions<K, V, FC>,\n    context: any\n  ): BackgroundFetch<V> {\n    const v = index === undefined ? undefined : this.#valList[index]\n    if (this.#isBackgroundFetch(v)) {\n      return v\n    }\n\n    const ac = new AC()\n    const { signal } = options\n    // when/if our AC signals, then stop listening to theirs.\n    signal?.addEventListener('abort', () => ac.abort(signal.reason), {\n      signal: ac.signal,\n    })\n\n    const fetchOpts = {\n      signal: ac.signal,\n      options,\n      context,\n    }\n\n    const cb = (\n      v: V | undefined,\n      updateCache = false\n    ): V | undefined => {\n      const { aborted } = ac.signal\n      const ignoreAbort = options.ignoreFetchAbort && v !== undefined\n      if (options.status) {\n        if (aborted && !updateCache) {\n          options.status.fetchAborted = true\n          options.status.fetchError = ac.signal.reason\n          if (ignoreAbort) options.status.fetchAbortIgnored = true\n        } else {\n          options.status.fetchResolved = true\n        }\n      }\n      if (aborted && !ignoreAbort && !updateCache) {\n        return fetchFail(ac.signal.reason)\n      }\n      // either we didn't abort, and are still here, or we did, and ignored\n      const bf = p as BackgroundFetch<V>\n      if (this.#valList[index as Index] === p) {\n        if (v === undefined) {\n          if (bf.__staleWhileFetching) {\n            this.#valList[index as Index] = bf.__staleWhileFetching\n          } else {\n            this.#delete(k, 'fetch')\n          }\n        } else {\n          if (options.status) options.status.fetchUpdated = true\n          this.set(k, v, fetchOpts.options)\n        }\n      }\n      return v\n    }\n\n    const eb = (er: any) => {\n      if (options.status) {\n        options.status.fetchRejected = true\n        options.status.fetchError = er\n      }\n      return fetchFail(er)\n    }\n\n    const fetchFail = (er: any): V | undefined => {\n      const { aborted } = ac.signal\n      const allowStaleAborted =\n        aborted && options.allowStaleOnFetchAbort\n      const allowStale =\n        allowStaleAborted || options.allowStaleOnFetchRejection\n      const noDelete = allowStale || options.noDeleteOnFetchRejection\n      const bf = p as BackgroundFetch<V>\n      if (this.#valList[index as Index] === p) {\n        // if we allow stale on fetch rejections, then we need to ensure that\n        // the stale value is not removed from the cache when the fetch fails.\n        const del = !noDelete || bf.__staleWhileFetching === undefined\n        if (del) {\n          this.#delete(k, 'fetch')\n        } else if (!allowStaleAborted) {\n          // still replace the *promise* with the stale value,\n          // since we are done with the promise at this point.\n          // leave it untouched if we're still waiting for an\n          // aborted background fetch that hasn't yet returned.\n          this.#valList[index as Index] = bf.__staleWhileFetching\n        }\n      }\n      if (allowStale) {\n        if (options.status && bf.__staleWhileFetching !== undefined) {\n          options.status.returnedStale = true\n        }\n        return bf.__staleWhileFetching\n      } else if (bf.__returned === bf) {\n        throw er\n      }\n    }\n\n    const pcall = (\n      res: (v: V | undefined) => void,\n      rej: (e: any) => void\n    ) => {\n      const fmp = this.#fetchMethod?.(k, v, fetchOpts)\n      if (fmp && fmp instanceof Promise) {\n        fmp.then(v => res(v === undefined ? undefined : v), rej)\n      }\n      // ignored, we go until we finish, regardless.\n      // defer check until we are actually aborting,\n      // so fetchMethod can override.\n      ac.signal.addEventListener('abort', () => {\n        if (\n          !options.ignoreFetchAbort ||\n          options.allowStaleOnFetchAbort\n        ) {\n          res(undefined)\n          // when it eventually resolves, update the cache.\n          if (options.allowStaleOnFetchAbort) {\n            res = v => cb(v, true)\n          }\n        }\n      })\n    }\n\n    if (options.status) options.status.fetchDispatched = true\n    const p = new Promise(pcall).then(cb, eb)\n    const bf: BackgroundFetch<V> = Object.assign(p, {\n      __abortController: ac,\n      __staleWhileFetching: v,\n      __returned: undefined,\n    })\n\n    if (index === undefined) {\n      // internal, don't expose status.\n      this.set(k, bf, { ...fetchOpts.options, status: undefined })\n      index = this.#keyMap.get(k)\n    } else {\n      this.#valList[index] = bf\n    }\n    return bf\n  }\n\n  #isBackgroundFetch(p: any): p is BackgroundFetch<V> {\n    if (!this.#hasFetchMethod) return false\n    const b = p as BackgroundFetch<V>\n    return (\n      !!b &&\n      b instanceof Promise &&\n      b.hasOwnProperty('__staleWhileFetching') &&\n      b.__abortController instanceof AC\n    )\n  }\n\n  /**\n   * Make an asynchronous cached fetch using the\n   * {@link LRUCache.OptionsBase.fetchMethod} function.\n   *\n   * If the value is in the cache and not stale, then the returned\n   * Promise resolves to the value.\n   *\n   * If not in the cache, or beyond its TTL staleness, then\n   * `fetchMethod(key, staleValue, { options, signal, context })` is\n   * called, and the value returned will be added to the cache once\n   * resolved.\n   *\n   * If called with `allowStale`, and an asynchronous fetch is\n   * currently in progress to reload a stale value, then the former\n   * stale value will be returned.\n   *\n   * If called with `forceRefresh`, then the cached item will be\n   * re-fetched, even if it is not stale. However, if `allowStale` is also\n   * set, then the old value will still be returned. This is useful\n   * in cases where you want to force a reload of a cached value. If\n   * a background fetch is already in progress, then `forceRefresh`\n   * has no effect.\n   *\n   * If multiple fetches for the same key are issued, then they will all be\n   * coalesced into a single call to fetchMethod.\n   *\n   * Note that this means that handling options such as\n   * {@link LRUCache.OptionsBase.allowStaleOnFetchAbort},\n   * {@link LRUCache.FetchOptions.signal},\n   * and {@link LRUCache.OptionsBase.allowStaleOnFetchRejection} will be\n   * determined by the FIRST fetch() call for a given key.\n   *\n   * This is a known (fixable) shortcoming which will be addresed on when\n   * someone complains about it, as the fix would involve added complexity and\n   * may not be worth the costs for this edge case.\n   *\n   * If {@link LRUCache.OptionsBase.fetchMethod} is not specified, then this is\n   * effectively an alias for `Promise.resolve(cache.get(key))`.\n   *\n   * When the fetch method resolves to a value, if the fetch has not\n   * been aborted due to deletion, eviction, or being overwritten,\n   * then it is added to the cache using the options provided.\n   *\n   * If the key is evicted or deleted before the `fetchMethod`\n   * resolves, then the AbortSignal passed to the `fetchMethod` will\n   * receive an `abort` event, and the promise returned by `fetch()`\n   * will reject with the reason for the abort.\n   *\n   * If a `signal` is passed to the `fetch()` call, then aborting the\n   * signal will abort the fetch and cause the `fetch()` promise to\n   * reject with the reason provided.\n   *\n   * **Setting `context`**\n   *\n   * If an `FC` type is set to a type other than `unknown`, `void`, or\n   * `undefined` in the {@link LRUCache} constructor, then all\n   * calls to `cache.fetch()` _must_ provide a `context` option. If\n   * set to `undefined` or `void`, then calls to fetch _must not_\n   * provide a `context` option.\n   *\n   * The `context` param allows you to provide arbitrary data that\n   * might be relevant in the course of fetching the data. It is only\n   * relevant for the course of a single `fetch()` operation, and\n   * discarded afterwards.\n   *\n   * **Note: `fetch()` calls are inflight-unique**\n   *\n   * If you call `fetch()` multiple times with the same key value,\n   * then every call after the first will resolve on the same\n   * promise<sup>1</sup>,\n   * _even if they have different settings that would otherwise change\n   * the behavior of the fetch_, such as `noDeleteOnFetchRejection`\n   * or `ignoreFetchAbort`.\n   *\n   * In most cases, this is not a problem (in fact, only fetching\n   * something once is what you probably want, if you're caching in\n   * the first place). If you are changing the fetch() options\n   * dramatically between runs, there's a good chance that you might\n   * be trying to fit divergent semantics into a single object, and\n   * would be better off with multiple cache instances.\n   *\n   * **1**: Ie, they're not the \"same Promise\", but they resolve at\n   * the same time, because they're both waiting on the same\n   * underlying fetchMethod response.\n   */\n\n  fetch(\n    k: K,\n    fetchOptions: unknown extends FC\n      ? LRUCache.FetchOptions<K, V, FC>\n      : FC extends undefined | void\n      ? LRUCache.FetchOptionsNoContext<K, V>\n      : LRUCache.FetchOptionsWithContext<K, V, FC>\n  ): Promise<undefined | V>\n\n  // this overload not allowed if context is required\n  fetch(\n    k: unknown extends FC\n      ? K\n      : FC extends undefined | void\n      ? K\n      : never,\n    fetchOptions?: unknown extends FC\n      ? LRUCache.FetchOptions<K, V, FC>\n      : FC extends undefined | void\n      ? LRUCache.FetchOptionsNoContext<K, V>\n      : never\n  ): Promise<undefined | V>\n\n  async fetch(\n    k: K,\n    fetchOptions: LRUCache.FetchOptions<K, V, FC> = {}\n  ): Promise<undefined | V> {\n    const {\n      // get options\n      allowStale = this.allowStale,\n      updateAgeOnGet = this.updateAgeOnGet,\n      noDeleteOnStaleGet = this.noDeleteOnStaleGet,\n      // set options\n      ttl = this.ttl,\n      noDisposeOnSet = this.noDisposeOnSet,\n      size = 0,\n      sizeCalculation = this.sizeCalculation,\n      noUpdateTTL = this.noUpdateTTL,\n      // fetch exclusive options\n      noDeleteOnFetchRejection = this.noDeleteOnFetchRejection,\n      allowStaleOnFetchRejection = this.allowStaleOnFetchRejection,\n      ignoreFetchAbort = this.ignoreFetchAbort,\n      allowStaleOnFetchAbort = this.allowStaleOnFetchAbort,\n      context,\n      forceRefresh = false,\n      status,\n      signal,\n    } = fetchOptions\n\n    if (!this.#hasFetchMethod) {\n      if (status) status.fetch = 'get'\n      return this.get(k, {\n        allowStale,\n        updateAgeOnGet,\n        noDeleteOnStaleGet,\n        status,\n      })\n    }\n\n    const options = {\n      allowStale,\n      updateAgeOnGet,\n      noDeleteOnStaleGet,\n      ttl,\n      noDisposeOnSet,\n      size,\n      sizeCalculation,\n      noUpdateTTL,\n      noDeleteOnFetchRejection,\n      allowStaleOnFetchRejection,\n      allowStaleOnFetchAbort,\n      ignoreFetchAbort,\n      status,\n      signal,\n    }\n\n    let index = this.#keyMap.get(k)\n    if (index === undefined) {\n      if (status) status.fetch = 'miss'\n      const p = this.#backgroundFetch(k, index, options, context)\n      return (p.__returned = p)\n    } else {\n      // in cache, maybe already fetching\n      const v = this.#valList[index]\n      if (this.#isBackgroundFetch(v)) {\n        const stale =\n          allowStale && v.__staleWhileFetching !== undefined\n        if (status) {\n          status.fetch = 'inflight'\n          if (stale) status.returnedStale = true\n        }\n        return stale ? v.__staleWhileFetching : (v.__returned = v)\n      }\n\n      // if we force a refresh, that means do NOT serve the cached value,\n      // unless we are already in the process of refreshing the cache.\n      const isStale = this.#isStale(index)\n      if (!forceRefresh && !isStale) {\n        if (status) status.fetch = 'hit'\n        this.#moveToTail(index)\n        if (updateAgeOnGet) {\n          this.#updateItemAge(index)\n        }\n        if (status) this.#statusTTL(status, index)\n        return v\n      }\n\n      // ok, it is stale or a forced refresh, and not already fetching.\n      // refresh the cache.\n      const p = this.#backgroundFetch(k, index, options, context)\n      const hasStale = p.__staleWhileFetching !== undefined\n      const staleVal = hasStale && allowStale\n      if (status) {\n        status.fetch = isStale ? 'stale' : 'refresh'\n        if (staleVal && isStale) status.returnedStale = true\n      }\n      return staleVal ? p.__staleWhileFetching : (p.__returned = p)\n    }\n  }\n\n  /**\n   * In some cases, `cache.fetch()` may resolve to `undefined`, either because\n   * a {@link LRUCache.OptionsBase#fetchMethod} was not provided (turning\n   * `cache.fetch(k)` into just an async wrapper around `cache.get(k)`) or\n   * because `ignoreFetchAbort` was specified (either to the constructor or\n   * in the {@link LRUCache.FetchOptions}). Also, the\n   * {@link OptionsBase.fetchMethod} may return `undefined` or `void`, making\n   * the test even more complicated.\n   *\n   * Because inferring the cases where `undefined` might be returned are so\n   * cumbersome, but testing for `undefined` can also be annoying, this method\n   * can be used, which will reject if `this.fetch()` resolves to undefined.\n   */\n  forceFetch(\n    k: K,\n    fetchOptions: unknown extends FC\n      ? LRUCache.FetchOptions<K, V, FC>\n      : FC extends undefined | void\n      ? LRUCache.FetchOptionsNoContext<K, V>\n      : LRUCache.FetchOptionsWithContext<K, V, FC>\n  ): Promise<V>\n  // this overload not allowed if context is required\n  forceFetch(\n    k: unknown extends FC\n      ? K\n      : FC extends undefined | void\n      ? K\n      : never,\n    fetchOptions?: unknown extends FC\n      ? LRUCache.FetchOptions<K, V, FC>\n      : FC extends undefined | void\n      ? LRUCache.FetchOptionsNoContext<K, V>\n      : never\n  ): Promise<V>\n  async forceFetch(\n    k: K,\n    fetchOptions: LRUCache.FetchOptions<K, V, FC> = {}\n  ): Promise<V> {\n    const v = await this.fetch(\n      k,\n      fetchOptions as unknown extends FC\n        ? LRUCache.FetchOptions<K, V, FC>\n        : FC extends undefined | void\n        ? LRUCache.FetchOptionsNoContext<K, V>\n        : LRUCache.FetchOptionsWithContext<K, V, FC>\n    )\n    if (v === undefined) throw new Error('fetch() returned undefined')\n    return v\n  }\n\n  /**\n   * If the key is found in the cache, then this is equivalent to\n   * {@link LRUCache#get}. If not, in the cache, then calculate the value using\n   * the {@link LRUCache.OptionsBase.memoMethod}, and add it to the cache.\n   *\n   * If an `FC` type is set to a type other than `unknown`, `void`, or\n   * `undefined` in the LRUCache constructor, then all calls to `cache.memo()`\n   * _must_ provide a `context` option. If set to `undefined` or `void`, then\n   * calls to memo _must not_ provide a `context` option.\n   *\n   * The `context` param allows you to provide arbitrary data that might be\n   * relevant in the course of fetching the data. It is only relevant for the\n   * course of a single `memo()` operation, and discarded afterwards.\n   */\n  memo(\n    k: K,\n    memoOptions: unknown extends FC\n      ? LRUCache.MemoOptions<K, V, FC>\n      : FC extends undefined | void\n      ? LRUCache.MemoOptionsNoContext<K, V>\n      : LRUCache.MemoOptionsWithContext<K, V, FC>\n  ): V\n  // this overload not allowed if context is required\n  memo(\n    k: unknown extends FC\n      ? K\n      : FC extends undefined | void\n      ? K\n      : never,\n    memoOptions?: unknown extends FC\n      ? LRUCache.MemoOptions<K, V, FC>\n      : FC extends undefined | void\n      ? LRUCache.MemoOptionsNoContext<K, V>\n      : never\n  ): V\n  memo(k: K, memoOptions: LRUCache.MemoOptions<K, V, FC> = {}) {\n    const memoMethod = this.#memoMethod\n    if (!memoMethod) {\n      throw new Error('no memoMethod provided to constructor')\n    }\n    const { context, forceRefresh, ...options } = memoOptions\n    const v = this.get(k, options)\n    if (!forceRefresh && v !== undefined) return v\n    const vv = memoMethod(k, v, {\n      options,\n      context,\n    } as LRUCache.MemoizerOptions<K, V, FC>)\n    this.set(k, vv, options)\n    return vv\n  }\n\n  /**\n   * Return a value from the cache. Will update the recency of the cache\n   * entry found.\n   *\n   * If the key is not found, get() will return `undefined`.\n   */\n  get(k: K, getOptions: LRUCache.GetOptions<K, V, FC> = {}) {\n    const {\n      allowStale = this.allowStale,\n      updateAgeOnGet = this.updateAgeOnGet,\n      noDeleteOnStaleGet = this.noDeleteOnStaleGet,\n      status,\n    } = getOptions\n    const index = this.#keyMap.get(k)\n    if (index !== undefined) {\n      const value = this.#valList[index]\n      const fetching = this.#isBackgroundFetch(value)\n      if (status) this.#statusTTL(status, index)\n      if (this.#isStale(index)) {\n        if (status) status.get = 'stale'\n        // delete only if not an in-flight background fetch\n        if (!fetching) {\n          if (!noDeleteOnStaleGet) {\n            this.#delete(k, 'expire')\n          }\n          if (status && allowStale) status.returnedStale = true\n          return allowStale ? value : undefined\n        } else {\n          if (\n            status &&\n            allowStale &&\n            value.__staleWhileFetching !== undefined\n          ) {\n            status.returnedStale = true\n          }\n          return allowStale ? value.__staleWhileFetching : undefined\n        }\n      } else {\n        if (status) status.get = 'hit'\n        // if we're currently fetching it, we don't actually have it yet\n        // it's not stale, which means this isn't a staleWhileRefetching.\n        // If it's not stale, and fetching, AND has a __staleWhileFetching\n        // value, then that means the user fetched with {forceRefresh:true},\n        // so it's safe to return that value.\n        if (fetching) {\n          return value.__staleWhileFetching\n        }\n        this.#moveToTail(index)\n        if (updateAgeOnGet) {\n          this.#updateItemAge(index)\n        }\n        return value\n      }\n    } else if (status) {\n      status.get = 'miss'\n    }\n  }\n\n  #connect(p: Index, n: Index) {\n    this.#prev[n] = p\n    this.#next[p] = n\n  }\n\n  #moveToTail(index: Index): void {\n    // if tail already, nothing to do\n    // if head, move head to next[index]\n    // else\n    //   move next[prev[index]] to next[index] (head has no prev)\n    //   move prev[next[index]] to prev[index]\n    // prev[index] = tail\n    // next[tail] = index\n    // tail = index\n    if (index !== this.#tail) {\n      if (index === this.#head) {\n        this.#head = this.#next[index] as Index\n      } else {\n        this.#connect(\n          this.#prev[index] as Index,\n          this.#next[index] as Index\n        )\n      }\n      this.#connect(this.#tail, index)\n      this.#tail = index\n    }\n  }\n\n  /**\n   * Deletes a key out of the cache.\n   *\n   * Returns true if the key was deleted, false otherwise.\n   */\n  delete(k: K) {\n    return this.#delete(k, 'delete')\n  }\n\n  #delete(k: K, reason: LRUCache.DisposeReason) {\n    let deleted = false\n    if (this.#size !== 0) {\n      const index = this.#keyMap.get(k)\n      if (index !== undefined) {\n        deleted = true\n        if (this.#size === 1) {\n          this.#clear(reason)\n        } else {\n          this.#removeItemSize(index)\n          const v = this.#valList[index]\n          if (this.#isBackgroundFetch(v)) {\n            v.__abortController.abort(new Error('deleted'))\n          } else if (this.#hasDispose || this.#hasDisposeAfter) {\n            if (this.#hasDispose) {\n              this.#dispose?.(v as V, k, reason)\n            }\n            if (this.#hasDisposeAfter) {\n              this.#disposed?.push([v as V, k, reason])\n            }\n          }\n          this.#keyMap.delete(k)\n          this.#keyList[index] = undefined\n          this.#valList[index] = undefined\n          if (index === this.#tail) {\n            this.#tail = this.#prev[index] as Index\n          } else if (index === this.#head) {\n            this.#head = this.#next[index] as Index\n          } else {\n            const pi = this.#prev[index] as number\n            this.#next[pi] = this.#next[index] as number\n            const ni = this.#next[index] as number\n            this.#prev[ni] = this.#prev[index] as number\n          }\n          this.#size--\n          this.#free.push(index)\n        }\n      }\n    }\n    if (this.#hasDisposeAfter && this.#disposed?.length) {\n      const dt = this.#disposed\n      let task: DisposeTask<K, V> | undefined\n      while ((task = dt?.shift())) {\n        this.#disposeAfter?.(...task)\n      }\n    }\n    return deleted\n  }\n\n  /**\n   * Clear the cache entirely, throwing away all values.\n   */\n  clear() {\n    return this.#clear('delete')\n  }\n  #clear(reason: LRUCache.DisposeReason) {\n    for (const index of this.#rindexes({ allowStale: true })) {\n      const v = this.#valList[index]\n      if (this.#isBackgroundFetch(v)) {\n        v.__abortController.abort(new Error('deleted'))\n      } else {\n        const k = this.#keyList[index]\n        if (this.#hasDispose) {\n          this.#dispose?.(v as V, k as K, reason)\n        }\n        if (this.#hasDisposeAfter) {\n          this.#disposed?.push([v as V, k as K, reason])\n        }\n      }\n    }\n\n    this.#keyMap.clear()\n    this.#valList.fill(undefined)\n    this.#keyList.fill(undefined)\n    if (this.#ttls && this.#starts) {\n      this.#ttls.fill(0)\n      this.#starts.fill(0)\n    }\n    if (this.#sizes) {\n      this.#sizes.fill(0)\n    }\n    this.#head = 0 as Index\n    this.#tail = 0 as Index\n    this.#free.length = 0\n    this.#calculatedSize = 0\n    this.#size = 0\n    if (this.#hasDisposeAfter && this.#disposed) {\n      const dt = this.#disposed\n      let task: DisposeTask<K, V> | undefined\n      while ((task = dt?.shift())) {\n        this.#disposeAfter?.(...task)\n      }\n    }\n  }\n}\n"],"names":[],"mappings":"AAoBS;;AApBT;;GAEG;;;;AAIH,MAAM,IAAI,GACR,OAAO,WAAW,KAAK,QAAQ,IAC/B,WAAW,IACX,OAAO,WAAW,CAAC,GAAG,KAAK,UAAU,GACjC,WAAW,GACX,IAAI,CAAA;AAEV,MAAM,MAAM,GAAG,IAAI,GAAG,EAAU,CAAA;AAKhC,mBAAA,EAAqB,CACrB,MAAM,OAAO,GAAG,AACd,kLAAc,KAAK,QAAQ,IAAI,CAAC,kKAAC,UAAO,CAAC,CAAC,iKAAC,WAAO,CAAC,CAAC,CAAC,CAAA,CAAE,CAChC,CAAA;AACzB,mBAAA,EAAqB,CAErB,MAAM,WAAW,GAAG,CAClB,GAAW,EACX,IAAY,EACZ,IAAY,EACZ,EAAQ,EACR,EAAE;IACF,OAAO,OAAO,CAAC,WAAW,KAAK,UAAU,GACrC,OAAO,CAAC,WAAW,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,CAAC,GACxC,OAAO,CAAC,KAAK,CAAC,CAAA,CAAA,EAAI,IAAI,CAAA,EAAA,EAAK,IAAI,CAAA,EAAA,EAAK,GAAG,EAAE,CAAC,CAAA;AAChD,CAAC,CAAA;AAED,IAAI,EAAE,GAAG,UAAU,CAAC,eAAe,CAAA;AACnC,IAAI,EAAE,GAAG,UAAU,CAAC,WAAW,CAAA;AAE/B,mBAAA,EAAqB,CACrB,IAAI,OAAO,EAAE,KAAK,WAAW,EAAE;IAC7B,YAAY;IACZ,EAAE,GAAG,MAAM,WAAW;QACpB,OAAO,CAAuB;QAC9B,QAAQ,GAA6B,EAAE,CAAA;QACvC,MAAM,CAAM;QACZ,OAAO,GAAY,KAAK,CAAA;QACxB,gBAAgB,CAAC,CAAS,EAAE,EAAwB,EAAA;YAClD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;QACxB,CAAC;KACF,CAAA;IACD,YAAY;IACZ,EAAE,GAAG,MAAM,eAAe;QACxB,aAAA;YACE,cAAc,EAAE,CAAA;QAClB,CAAC;QACD,MAAM,GAAG,IAAI,EAAE,EAAE,CAAA;QACjB,KAAK,CAAC,MAAW,EAAA;YACf,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAM;YAC/B,YAAY;YACZ,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,MAAM,CAAA;YAC3B,YAAY;YACZ,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAA;YAC1B,YAAY;YACZ,KAAK,MAAM,EAAE,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAE;gBACrC,EAAE,CAAC,MAAM,CAAC,CAAA;aACX;YACD,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC,CAAA;QAC/B,CAAC;KACF,CAAA;IACD,IAAI,sBAAsB,GACxB,OAAO,CAAC,GAAG,EAAE,2BAA2B,KAAK,GAAG,CAAA;IAClD,MAAM,cAAc,GAAG,GAAG,EAAE;QAC1B,IAAI,CAAC,sBAAsB,EAAE,OAAM;QACnC,sBAAsB,GAAG,KAAK,CAAA;QAC9B,WAAW,CACT,wDAAwD,GACtD,qDAAqD,GACrD,yDAAyD,GACzD,6DAA6D,GAC7D,mEAAmE,GACnE,mEAAmE,GACnE,qEAAqE,EACvE,qBAAqB,EACrB,SAAS,EACT,cAAc,CACf,CAAA;IACH,CAAC,CAAA;CACF;AACD,kBAAA,EAAoB,CAEpB,MAAM,UAAU,GAAG,CAAC,IAAY,EAAE,CAAG,CAAD,AAAE,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;AAEtD,MAAM,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,CAAA;AAI3B,MAAM,QAAQ,GAAG,CAAC,CAAM,EAAe,CACrC,CADuC,AACtC,IAAI,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAA;AAKlD,mBAAA,EAAqB,CACrB,wCAAwC;AACxC,sEAAsE;AACtE,uEAAuE;AACvE,uEAAuE;AACvE,wEAAwE;AACxE,uDAAuD;AACvD,2BAA2B;AAC3B,wDAAwD;AACxD,MAAM,YAAY,GAAG,CAAC,GAAW,EAAE,CACjC,CADmC,AAClC,QAAQ,CAAC,GAAG,CAAC,GACV,IAAI,GACJ,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GACrB,UAAU,GACV,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC,GACtB,WAAW,GACX,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC,GACtB,WAAW,GACX,GAAG,IAAI,MAAM,CAAC,gBAAgB,GAC9B,SAAS,GACT,IAAI,CAAA;AACV,kBAAA,EAAoB,CAEpB,MAAM,SAAU,SAAQ,KAAa;IACnC,YAAY,IAAY,CAAA;QACtB,KAAK,CAAC,IAAI,CAAC,CAAA;QACX,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;IACd,CAAC;CACF;AAKD,MAAM,KAAK;IACT,IAAI,CAAa;IACjB,MAAM,CAAQ;IACd,sBAAsB;IACtB,MAAM,EAAC,YAAa,GAAY,KAAK,CAAA;IACrC,MAAM,CAAC,MAAM,CAAC,GAAW,EAAA;QACvB,MAAM,OAAO,GAAG,YAAY,CAAC,GAAG,CAAC,CAAA;QACjC,IAAI,CAAC,OAAO,EAAE,OAAO,EAAE,CAAA;QACvB,KAAK,EAAC,YAAa,GAAG,IAAI,CAAA;QAC1B,MAAM,CAAC,GAAG,IAAI,KAAK,CAAC,GAAG,EAAE,OAAO,CAAC,CAAA;QACjC,KAAK,EAAC,YAAa,GAAG,KAAK,CAAA;QAC3B,OAAO,CAAC,CAAA;IACV,CAAC;IACD,YACE,GAAW,EACX,OAAyC,CAAA;QAEzC,mBAAA,EAAqB,CACrB,IAAI,CAAC,KAAK,EAAC,YAAa,EAAE;YACxB,MAAM,IAAI,SAAS,CAAC,yCAAyC,CAAC,CAAA;SAC/D;QACD,kBAAA,EAAoB,CACpB,IAAI,CAAC,IAAI,GAAG,IAAI,OAAO,CAAC,GAAG,CAAC,CAAA;QAC5B,IAAI,CAAC,MAAM,GAAG,CAAC,CAAA;IACjB,CAAC;IACD,IAAI,CAAC,CAAQ,EAAA;QACX,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAA;IAC9B,CAAC;IACD,GAAG,GAAA;QACD,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,MAAM,CAAU,CAAA;IAC1C,CAAC;;AAw6BH;;;;;;;;;;;;;;GAcG,CACH,MAAa,QAAQ;IAGnB,kDAAkD;KACzC,GAAI,CAAgB;KACpB,OAAQ,CAAe;KACvB,OAAQ,CAA0B;KAClC,YAAa,CAA0B;KACvC,WAAY,CAA6B;KACzC,UAAW,CAA8B;IAElD;;OAEG,CACH,GAAG,CAAuB;IAE1B;;OAEG,CACH,aAAa,CAAuB;IACpC;;OAEG,CACH,YAAY,CAAS;IACrB;;OAEG,CACH,cAAc,CAAS;IACvB;;OAEG,CACH,cAAc,CAAS;IACvB;;OAEG,CACH,UAAU,CAAS;IAEnB;;OAEG,CACH,cAAc,CAAS;IACvB;;OAEG,CACH,WAAW,CAAS;IACpB;;OAEG,CACH,YAAY,CAAe;IAC3B;;OAEG,CACH,eAAe,CAAgC;IAC/C;;OAEG,CACH,wBAAwB,CAAS;IACjC;;OAEG,CACH,kBAAkB,CAAS;IAC3B;;OAEG,CACH,sBAAsB,CAAS;IAC/B;;OAEG,CACH,0BAA0B,CAAS;IACnC;;OAEG,CACH,gBAAgB,CAAS;IAEzB,sBAAsB;KACtB,IAAK,CAAgB;KACrB,cAAe,CAAe;KAC9B,MAAO,CAAe;KACtB,OAAQ,CAAmB;KAC3B,OAAQ,CAAwC;KAChD,IAAK,CAAa;KAClB,IAAK,CAAa;KAClB,IAAK,CAAO;KACZ,IAAK,CAAO;IACZ,KAAK,CAAW;KAChB,QAAS,CAAsB;KAC/B,KAAM,CAAY;KAClB,MAAO,CAAY;KACnB,IAAK,CAAY;KAEjB,UAAW,CAAS;KACpB,cAAe,CAAS;IACxB,gBAAgB,CAAS;IAEzB;;;;;;;;OAQG,CACH,MAAM,CAAC,qBAAqB,CAI1B,CAAqB,EAAA;QACrB,OAAO;YACL,aAAa;YACb,MAAM,EAAE,CAAC,EAAC,MAAO;YACjB,IAAI,EAAE,CAAC,EAAC,IAAK;YACb,KAAK,EAAE,CAAC,CAAC,MAAM;YACf,MAAM,EAAE,CAAC,EAAC,MAAyB;YACnC,OAAO,EAAE,CAAC,EAAC,OAAQ;YACnB,OAAO,EAAE,CAAC,EAAC,OAAQ;YACnB,IAAI,EAAE,CAAC,EAAC,IAAK;YACb,IAAI,EAAE,CAAC,EAAC,IAAK;YACb,IAAI,IAAI,IAAA;gBACN,OAAO,CAAC,EAAC,IAAK,CAAA;YAChB,CAAC;YACD,IAAI,IAAI,IAAA;gBACN,OAAO,CAAC,EAAC,IAAK,CAAA;YAChB,CAAC;YACD,IAAI,EAAE,CAAC,EAAC,IAAK;YACb,UAAU;YACV,iBAAiB,EAAE,CAAC,CAAM,EAAE,CAAG,CAAD,AAAE,EAAC,iBAAkB,CAAC,CAAC,CAAC;YACtD,eAAe,EAAE,CACf,CAAI,EACJ,KAAyB,EACzB,OAAwC,EACxC,OAAY,EACQ,CACpB,CADsB,AACrB,EAAC,eAAgB,CAChB,CAAC,EACD,KAA0B,EAC1B,OAAO,EACP,OAAO,CACR;YACH,UAAU,EAAE,CAAC,KAAa,EAAQ,CAChC,CADkC,AACjC,EAAC,UAAW,CAAC,KAAc,CAAC;YAC/B,OAAO,EAAE,CAAC,OAAiC,EAAE,CAC3C,CAD6C,AAC5C,CAAC,QAAQ,CAAC,OAAO,CAAC;YACrB,QAAQ,EAAE,CAAC,OAAiC,EAAE,CAC5C,CAD8C,AAC7C,EAAC,QAAS,CAAC,OAAO,CAAC;YACtB,OAAO,EAAE,CAAC,KAAyB,EAAE,CACnC,CAAC,AADoC,EACnC,OAAQ,CAAC,KAAc,CAAC;SAC7B,CAAA;IACH,CAAC;IAED,8BAA8B;IAE9B;;OAEG,CACH,IAAI,GAAG,GAAA;QACL,OAAO,IAAI,EAAC,GAAI,CAAA;IAClB,CAAC;IACD;;OAEG,CACH,IAAI,OAAO,GAAA;QACT,OAAO,IAAI,EAAC,OAAQ,CAAA;IACtB,CAAC;IACD;;OAEG,CACH,IAAI,cAAc,GAAA;QAChB,OAAO,IAAI,EAAC,cAAe,CAAA;IAC7B,CAAC;IACD;;OAEG,CACH,IAAI,IAAI,GAAA;QACN,OAAO,IAAI,CAAC,KAAK,CAAA;IACnB,CAAC;IACD;;OAEG,CACH,IAAI,WAAW,GAAA;QACb,OAAO,IAAI,EAAC,WAAY,CAAA;IAC1B,CAAC;IACD,IAAI,UAAU,GAAA;QACZ,OAAO,IAAI,EAAC,UAAW,CAAA;IACzB,CAAC;IACD;;OAEG,CACH,IAAI,OAAO,GAAA;QACT,OAAO,IAAI,EAAC,OAAQ,CAAA;IACtB,CAAC;IACD;;OAEG,CACH,IAAI,YAAY,GAAA;QACd,OAAO,IAAI,EAAC,YAAa,CAAA;IAC3B,CAAC;IAED,YACE,OAAwD,CAAA;QAExD,MAAM,EACJ,GAAG,GAAG,CAAC,EACP,GAAG,EACH,aAAa,GAAG,CAAC,EACjB,YAAY,EACZ,cAAc,EACd,cAAc,EACd,UAAU,EACV,OAAO,EACP,YAAY,EACZ,cAAc,EACd,WAAW,EACX,OAAO,GAAG,CAAC,EACX,YAAY,GAAG,CAAC,EAChB,eAAe,EACf,WAAW,EACX,UAAU,EACV,wBAAwB,EACxB,kBAAkB,EAClB,0BAA0B,EAC1B,sBAAsB,EACtB,gBAAgB,EACjB,GAAG,OAAO,CAAA;QAEX,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;YAC/B,MAAM,IAAI,SAAS,CAAC,0CAA0C,CAAC,CAAA;SAChE;QAED,MAAM,SAAS,GAAG,GAAG,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAA;QACjD,IAAI,CAAC,SAAS,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,qBAAqB,GAAG,GAAG,CAAC,CAAA;SAC7C;QAED,IAAI,EAAC,GAAI,GAAG,GAAG,CAAA;QACf,IAAI,EAAC,OAAQ,GAAG,OAAO,CAAA;QACvB,IAAI,CAAC,YAAY,GAAG,YAAY,IAAI,IAAI,CAAC,QAAQ,CAAA;QACjD,IAAI,CAAC,eAAe,GAAG,eAAe,CAAA;QACtC,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,IAAI,EAAC,OAAQ,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACxC,MAAM,IAAI,SAAS,CACjB,oEAAoE,CACrE,CAAA;aACF;YACD,IAAI,OAAO,IAAI,CAAC,eAAe,KAAK,UAAU,EAAE;gBAC9C,MAAM,IAAI,SAAS,CAAC,qCAAqC,CAAC,CAAA;aAC3D;SACF;QAED,IACE,UAAU,KAAK,SAAS,IACxB,OAAO,UAAU,KAAK,UAAU,EAChC;YACA,MAAM,IAAI,SAAS,CAAC,0CAA0C,CAAC,CAAA;SAChE;QACD,IAAI,EAAC,UAAW,GAAG,UAAU,CAAA;QAE7B,IACE,WAAW,KAAK,SAAS,IACzB,OAAO,WAAW,KAAK,UAAU,EACjC;YACA,MAAM,IAAI,SAAS,CACjB,6CAA6C,CAC9C,CAAA;SACF;QACD,IAAI,EAAC,WAAY,GAAG,WAAW,CAAA;QAC/B,IAAI,EAAC,cAAe,GAAG,CAAC,CAAC,WAAW,CAAA;QAEpC,IAAI,EAAC,MAAO,GAAG,IAAI,GAAG,EAAE,CAAA;QACxB,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;QAC9C,IAAI,EAAC,OAAQ,GAAG,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;QAC9C,IAAI,EAAC,IAAK,GAAG,IAAI,SAAS,CAAC,GAAG,CAAC,CAAA;QAC/B,IAAI,EAAC,IAAK,GAAG,IAAI,SAAS,CAAC,GAAG,CAAC,CAAA;QAC/B,IAAI,EAAC,IAAK,GAAG,CAAU,CAAA;QACvB,IAAI,EAAC,IAAK,GAAG,CAAU,CAAA;QACvB,IAAI,EAAC,IAAK,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;QAC9B,IAAI,EAAC,IAAK,GAAG,CAAC,CAAA;QACd,IAAI,CAAC,eAAe,GAAG,CAAC,CAAA;QAExB,IAAI,OAAO,OAAO,KAAK,UAAU,EAAE;YACjC,IAAI,EAAC,OAAQ,GAAG,OAAO,CAAA;SACxB;QACD,IAAI,OAAO,YAAY,KAAK,UAAU,EAAE;YACtC,IAAI,EAAC,YAAa,GAAG,YAAY,CAAA;YACjC,IAAI,CAAC,SAAS,GAAG,EAAE,CAAA;SACpB,MAAM;YACL,IAAI,EAAC,YAAa,GAAG,SAAS,CAAA;YAC9B,IAAI,EAAC,QAAS,GAAG,SAAS,CAAA;SAC3B;QACD,IAAI,EAAC,UAAW,GAAG,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAA;QAClC,IAAI,EAAC,eAAgB,GAAG,CAAC,CAAC,IAAI,EAAC,YAAa,CAAA;QAE5C,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC,cAAc,CAAA;QACtC,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,WAAW,CAAA;QAChC,IAAI,CAAC,wBAAwB,GAAG,CAAC,CAAC,wBAAwB,CAAA;QAC1D,IAAI,CAAC,0BAA0B,GAAG,CAAC,CAAC,0BAA0B,CAAA;QAC9D,IAAI,CAAC,sBAAsB,GAAG,CAAC,CAAC,sBAAsB,CAAA;QACtD,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC,gBAAgB,CAAA;QAE1C,iDAAiD;QACjD,IAAI,IAAI,CAAC,YAAY,KAAK,CAAC,EAAE;YAC3B,IAAI,IAAI,CAAC,QAAQ,KAAK,CAAC,EAAE;gBACvB,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAC,OAAQ,CAAC,EAAE;oBAC5B,MAAM,IAAI,SAAS,CACjB,iDAAiD,CAClD,CAAA;iBACF;aACF;YACD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE;gBAChC,MAAM,IAAI,SAAS,CACjB,sDAAsD,CACvD,CAAA;aACF;YACD,IAAI,EAAC,sBAAuB,EAAE,CAAA;SAC/B;QAED,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,UAAU,CAAA;QAC9B,IAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC,kBAAkB,CAAA;QAC9C,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC,cAAc,CAAA;QACtC,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC,cAAc,CAAA;QACtC,IAAI,CAAC,aAAa,GAChB,QAAQ,CAAC,aAAa,CAAC,IAAI,aAAa,KAAK,CAAC,GAC1C,aAAa,GACb,CAAC,CAAA;QACP,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC,YAAY,CAAA;QAClC,IAAI,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,CAAA;QACnB,IAAI,IAAI,CAAC,GAAG,EAAE;YACZ,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;gBACvB,MAAM,IAAI,SAAS,CACjB,6CAA6C,CAC9C,CAAA;aACF;YACD,IAAI,EAAC,qBAAsB,EAAE,CAAA;SAC9B;QAED,2CAA2C;QAC3C,IAAI,IAAI,EAAC,GAAI,KAAK,CAAC,IAAI,IAAI,CAAC,GAAG,KAAK,CAAC,IAAI,IAAI,EAAC,OAAQ,KAAK,CAAC,EAAE;YAC5D,MAAM,IAAI,SAAS,CACjB,kDAAkD,CACnD,CAAA;SACF;QACD,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,EAAC,GAAI,IAAI,CAAC,IAAI,EAAC,OAAQ,EAAE;YACtD,MAAM,IAAI,GAAG,qBAAqB,CAAA;YAClC,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE;gBACpB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;gBAChB,MAAM,GAAG,GACP,wDAAwD,GACxD,yCAAyC,CAAA;gBAC3C,WAAW,CAAC,GAAG,EAAE,uBAAuB,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAA;aAC1D;SACF;IACH,CAAC;IAED;;;OAGG,CACH,eAAe,CAAC,GAAM,EAAA;QACpB,OAAO,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAA;IAC7C,CAAC;KAED,qBAAsB;QACpB,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,IAAI,EAAC,GAAI,CAAC,CAAA;QACrC,MAAM,MAAM,GAAG,IAAI,SAAS,CAAC,IAAI,EAAC,GAAI,CAAC,CAAA;QACvC,IAAI,EAAC,IAAK,GAAG,IAAI,CAAA;QACjB,IAAI,EAAC,MAAO,GAAG,MAAM,CAAA;QAErB,IAAI,EAAC,UAAW,GAAG,CAAC,KAAK,EAAE,GAAG,EAAE,KAAK,GAAG,IAAI,CAAC,GAAG,EAAE,EAAE,EAAE;YACpD,MAAM,CAAC,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAA;YACrC,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,CAAA;YACjB,IAAI,GAAG,KAAK,CAAC,IAAI,IAAI,CAAC,YAAY,EAAE;gBAClC,MAAM,CAAC,GAAG,UAAU,CAAC,GAAG,EAAE;oBACxB,IAAI,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,EAAE;wBACxB,IAAI,EAAC,MAAO,CAAC,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAM,EAAE,QAAQ,CAAC,CAAA;qBAClD;gBACH,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC,CAAA;gBACX,yCAAyC;gBACzC,mBAAA,EAAqB,CACrB,IAAI,CAAC,CAAC,KAAK,EAAE;oBACX,CAAC,CAAC,KAAK,EAAE,CAAA;iBACV;YACD,kBAAA,EAAoB,EACrB;QACH,CAAC,CAAA;QAED,IAAI,EAAC,aAAc,IAAG,KAAK,CAAC,EAAE;YAC5B,MAAM,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAA;QACpD,CAAC,CAAA;QAED,IAAI,EAAC,SAAU,GAAG,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE;YAClC,IAAI,IAAI,CAAC,KAAK,CAAC,EAAE;gBACf,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAA;gBACvB,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,CAAA;gBAC3B,kBAAA,EAAoB,CACpB,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE,OAAM;gBAC1B,MAAM,CAAC,GAAG,GAAG,GAAG,CAAA;gBAChB,MAAM,CAAC,KAAK,GAAG,KAAK,CAAA;gBACpB,MAAM,CAAC,GAAG,GAAG,SAAS,IAAI,MAAM,EAAE,CAAA;gBAClC,MAAM,GAAG,GAAG,MAAM,CAAC,GAAG,GAAG,KAAK,CAAA;gBAC9B,MAAM,CAAC,YAAY,GAAG,GAAG,GAAG,GAAG,CAAA;aAChC;QACH,CAAC,CAAA;QAED,0DAA0D;QAC1D,+BAA+B;QAC/B,IAAI,SAAS,GAAG,CAAC,CAAA;QACjB,MAAM,MAAM,GAAG,GAAG,EAAE;YAClB,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,EAAE,CAAA;YACpB,IAAI,IAAI,CAAC,aAAa,GAAG,CAAC,EAAE;gBAC1B,SAAS,GAAG,CAAC,CAAA;gBACb,MAAM,CAAC,GAAG,UAAU,CAClB,GAAG,CAAI,CAAF,CAAC,OAAU,GAAG,CAAC,CAAC,CACrB,IAAI,CAAC,aAAa,CACnB,CAAA;gBACD,iCAAiC;gBACjC,mBAAA,EAAqB,CACrB,IAAI,CAAC,CAAC,KAAK,EAAE;oBACX,CAAC,CAAC,KAAK,EAAE,CAAA;iBACV;YACD,kBAAA,EAAoB,EACrB;YACD,OAAO,CAAC,CAAA;QACV,CAAC,CAAA;QAED,IAAI,CAAC,eAAe,IAAG,GAAG,CAAC,EAAE;YAC3B,MAAM,KAAK,GAAG,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;YACnC,IAAI,KAAK,KAAK,SAAS,EAAE;gBACvB,OAAO,CAAC,CAAA;aACT;YACD,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAA;YACvB,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,CAAA;YAC3B,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE;gBAClB,OAAO,QAAQ,CAAA;aAChB;YACD,MAAM,GAAG,GAAG,CAAC,SAAS,IAAI,MAAM,EAAE,CAAC,GAAG,KAAK,CAAA;YAC3C,OAAO,GAAG,GAAG,GAAG,CAAA;QAClB,CAAC,CAAA;QAED,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC,EAAE;YACtB,MAAM,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAA;YACvB,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAA;YACrB,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,IAAI,MAAM,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;QACtD,CAAC,CAAA;IACH,CAAC;IAED,mDAAmD;KACnD,aAAc,GAA2B,GAAG,EAAE,AAAE,CAAC,CAAA;KACjD,SAAU,GACR,GAAG,EAAE,AAAE,CAAC,CAAA;KACV,UAAW,GAMC,GAAG,EAAE,AAAE,CAAC,CAAA;IACpB,kBAAA,EAAoB,EAEpB,OAAQ,GAA8B,GAAG,CAAG,CAAD,IAAM,CAAA;KAEjD,sBAAuB;QACrB,MAAM,KAAK,GAAG,IAAI,SAAS,CAAC,IAAI,EAAC,GAAI,CAAC,CAAA;QACtC,IAAI,EAAC,cAAe,GAAG,CAAC,CAAA;QACxB,IAAI,EAAC,KAAM,GAAG,KAAK,CAAA;QACnB,IAAI,EAAC,cAAe,IAAG,KAAK,CAAC,EAAE;YAC7B,IAAI,EAAC,cAAe,IAAI,KAAK,CAAC,KAAK,CAAW,CAAA;YAC9C,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;QAClB,CAAC,CAAA;QACD,IAAI,EAAC,WAAY,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,eAAe,EAAE,EAAE;YAClD,2CAA2C;YAC3C,sDAAsD;YACtD,IAAI,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,EAAE;gBAC9B,OAAO,CAAC,CAAA;aACT;YACD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;gBACnB,IAAI,eAAe,EAAE;oBACnB,IAAI,OAAO,eAAe,KAAK,UAAU,EAAE;wBACzC,MAAM,IAAI,SAAS,CAAC,oCAAoC,CAAC,CAAA;qBAC1D;oBACD,IAAI,GAAG,eAAe,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;oBAC5B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;wBACnB,MAAM,IAAI,SAAS,CACjB,0DAA0D,CAC3D,CAAA;qBACF;iBACF,MAAM;oBACL,MAAM,IAAI,SAAS,CACjB,iDAAiD,GAC/C,wDAAwD,GACxD,sBAAsB,CACzB,CAAA;iBACF;aACF;YACD,OAAO,IAAI,CAAA;QACb,CAAC,CAAA;QACD,IAAI,EAAC,WAAY,GAAG,CAClB,KAAY,EACZ,IAAmB,EACnB,MAA2B,EAC3B,EAAE;YACF,KAAK,CAAC,KAAK,CAAC,GAAG,IAAI,CAAA;YACnB,IAAI,IAAI,EAAC,OAAQ,EAAE;gBACjB,MAAM,OAAO,GAAG,IAAI,EAAC,OAAQ,GAAI,KAAK,CAAC,KAAK,CAAY,CAAA;gBACxD,MAAO,IAAI,CAAC,eAAe,GAAG,OAAO,CAAE;oBACrC,IAAI,EAAC,KAAM,CAAC,IAAI,CAAC,CAAA;iBAClB;aACF;YACD,IAAI,EAAC,cAAe,IAAI,KAAK,CAAC,KAAK,CAAW,CAAA;YAC9C,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,SAAS,GAAG,IAAI,CAAA;gBACvB,MAAM,CAAC,mBAAmB,GAAG,IAAI,EAAC,cAAe,CAAA;aAClD;QACH,CAAC,CAAA;IACH,CAAC;IAED,eAAe,IAA2B,EAAE,CAAC,EAAE,CAAE,CAAC,CAAA;IAClD,YAAY,GAIA,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,AAAE,CAAC,CAAA;KAC/B,WAAY,GAKS,CACnB,EAAK,EACL,EAA0B,EAC1B,IAAoB,EACpB,eAA+C,EAC/C,EAAE;QACF,IAAI,IAAI,IAAI,eAAe,EAAE;YAC3B,MAAM,IAAI,SAAS,CACjB,kEAAkE,CACnE,CAAA;SACF;QACD,OAAO,CAAC,CAAA;IACV,CAAC,CAAC;IAEF,EAAC,OAAQ,CAAC,EAAE,UAAU,GAAG,IAAI,CAAC,UAAU,EAAE,GAAG,CAAA,CAAE;QAC7C,IAAI,IAAI,EAAC,IAAK,EAAE;YACd,IAAK,IAAI,CAAC,GAAG,IAAI,EAAC,IAAK,EAAE,IAAI,EAAI;gBAC/B,IAAI,CAAC,IAAI,EAAC,YAAa,CAAC,CAAC,CAAC,EAAE;oBAC1B,MAAK;iBACN;gBACD,IAAI,UAAU,IAAI,CAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,EAAE;oBACnC,MAAM,CAAC,CAAA;iBACR;gBACD,IAAI,CAAC,KAAK,IAAI,EAAC,IAAK,EAAE;oBACpB,MAAK;iBACN,MAAM;oBACL,CAAC,GAAG,IAAI,EAAC,IAAK,CAAC,CAAC,CAAU,CAAA;iBAC3B;aACF;SACF;IACH,CAAC;IAED,EAAC,QAAS,CAAC,EAAE,UAAU,GAAG,IAAI,CAAC,UAAU,EAAE,GAAG,CAAA,CAAE;QAC9C,IAAI,IAAI,EAAC,IAAK,EAAE;YACd,IAAK,IAAI,CAAC,GAAG,IAAI,EAAC,IAAK,EAAE,IAAI,EAAI;gBAC/B,IAAI,CAAC,IAAI,EAAC,YAAa,CAAC,CAAC,CAAC,EAAE;oBAC1B,MAAK;iBACN;gBACD,IAAI,UAAU,IAAI,CAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,EAAE;oBACnC,MAAM,CAAC,CAAA;iBACR;gBACD,IAAI,CAAC,KAAK,IAAI,EAAC,IAAK,EAAE;oBACpB,MAAK;iBACN,MAAM;oBACL,CAAC,GAAG,IAAI,EAAC,IAAK,CAAC,CAAC,CAAU,CAAA;iBAC3B;aACF;SACF;IACH,CAAC;KAED,YAAa,CAAC,KAAY;QACxB,OAAO,AACL,KAAK,KAAK,SAAS,IACnB,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAM,CAAC,KAAK,KAAK,CACtD,CAAA;IACH,CAAC;IAED;;;OAGG,CACH,CAAC,OAAO,GAAA;QACN,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,OAAQ,EAAE,CAAE;YAC/B,IACE,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,KAAK,SAAS,IAC9B,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,KAAK,SAAS,IAC9B,CAAC,IAAI,EAAC,iBAAkB,CAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAC,EAC1C;gBACA,MAAM;oBAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC;oBAAE,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC;iBAAW,CAAA;aACrD;SACF;IACH,CAAC;IAED;;;;;OAKG,CACH,CAAC,QAAQ,GAAA;QACP,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,QAAS,EAAE,CAAE;YAChC,IACE,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,KAAK,SAAS,IAC9B,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,KAAK,SAAS,IAC9B,CAAC,IAAI,EAAC,iBAAkB,CAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAC,EAC1C;gBACA,MAAM;oBAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC;oBAAE,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC;iBAAC,CAAA;aAC3C;SACF;IACH,CAAC;IAED;;;OAGG,CACH,CAAC,IAAI,GAAA;QACH,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,OAAQ,EAAE,CAAE;YAC/B,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAA;YAC1B,IACE,CAAC,KAAK,SAAS,IACf,CAAC,IAAI,EAAC,iBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAC1C;gBACA,MAAM,CAAC,CAAA;aACR;SACF;IACH,CAAC;IAED;;;;;OAKG,CACH,CAAC,KAAK,GAAA;QACJ,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,QAAS,EAAE,CAAE;YAChC,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAA;YAC1B,IACE,CAAC,KAAK,SAAS,IACf,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAC1C;gBACA,MAAM,CAAC,CAAA;aACR;SACF;IACH,CAAC;IAED;;;OAGG,CACH,CAAC,MAAM,GAAA;QACL,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,OAAQ,EAAE,CAAE;YAC/B,MAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;YAC1B,IACE,CAAC,KAAK,SAAS,IACf,CAAC,IAAI,EAAC,iBAAkB,CAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAC,EAC1C;gBACA,MAAM,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAM,CAAA;aAC5B;SACF;IACH,CAAC;IAED;;;;;OAKG,CACH,CAAC,OAAO,GAAA;QACN,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,QAAS,EAAE,CAAE;YAChC,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAA;YAC1B,IACE,CAAC,KAAK,SAAS,IACf,CAAC,IAAI,EAAC,iBAAkB,CAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAC,EAC1C;gBACA,MAAM,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAA;aACvB;SACF;IACH,CAAC;IAED;;;OAGG,CACH,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAA;QACf,OAAO,IAAI,CAAC,OAAO,EAAE,CAAA;IACvB,CAAC;IAED;;;;OAIG,CACH,CAAC,MAAM,CAAC,WAAW,CAAC,GAAG,UAAU,CAAA;IAEjC;;;OAGG,CACH,IAAI,CACF,EAAqD,EACrD,aAA4C,CAAA,CAAE,EAAA;QAE9C,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,OAAQ,EAAE,CAAE;YAC/B,MAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;YAC1B,MAAM,KAAK,GAAG,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,GACpC,CAAC,CAAC,oBAAoB,GACtB,CAAC,CAAA;YACL,IAAI,KAAK,KAAK,SAAS,EAAE,SAAQ;YACjC,IAAI,EAAE,CAAC,KAAK,EAAE,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAM,EAAE,IAAI,CAAC,EAAE;gBAC1C,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAM,EAAE,UAAU,CAAC,CAAA;aACnD;SACF;IACH,CAAC;IAED;;;;;;;;;;OAUG,CACH,OAAO,CACL,EAAiD,EACjD,QAAa,IAAI,EAAA;QAEjB,KAAK,MAAM,CAAC,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAE;YAC/B,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAA;YAC1B,MAAM,KAAK,GAAG,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,GACpC,CAAC,CAAC,oBAAoB,GACtB,CAAC,CAAA;YACL,IAAI,KAAK,KAAK,SAAS,EAAE,SAAQ;YACjC,EAAE,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAM,EAAE,IAAI,CAAC,CAAA;SACnD;IACH,CAAC;IAED;;;OAGG,CACH,QAAQ,CACN,EAAiD,EACjD,QAAa,IAAI,EAAA;QAEjB,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,QAAS,EAAE,CAAE;YAChC,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAA;YAC1B,MAAM,KAAK,GAAG,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,GACpC,CAAC,CAAC,oBAAoB,GACtB,CAAC,CAAA;YACL,IAAI,KAAK,KAAK,SAAS,EAAE,SAAQ;YACjC,EAAE,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAM,EAAE,IAAI,CAAC,CAAA;SACnD;IACH,CAAC;IAED;;;OAGG,CACH,UAAU,GAAA;QACR,IAAI,OAAO,GAAG,KAAK,CAAA;QACnB,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,QAAS,CAAC;YAAE,UAAU,EAAE,IAAI;QAAA,CAAE,CAAC,CAAE;YACpD,IAAI,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,EAAE;gBACpB,IAAI,CAAC,OAAO,CAAC,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAM,EAAE,QAAQ,CAAC,CAAA;gBAC7C,OAAO,GAAG,IAAI,CAAA;aACf;SACF;QACD,OAAO,OAAO,CAAA;IAChB,CAAC;IAED;;;;;;;;;;;OAWG,CACH,IAAI,CAAC,GAAM,EAAA;QACT,MAAM,CAAC,GAAG,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;QAC/B,IAAI,CAAC,KAAK,SAAS,EAAE,OAAO,SAAS,CAAA;QACrC,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAA;QAC1B,MAAM,KAAK,GAAkB,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,GACnD,CAAC,CAAC,oBAAoB,GACtB,CAAC,CAAA;QACL,IAAI,KAAK,KAAK,SAAS,EAAE,OAAO,SAAS,CAAA;QACzC,MAAM,KAAK,GAAsB;YAAE,KAAK;QAAA,CAAE,CAAA;QAC1C,IAAI,IAAI,EAAC,IAAK,IAAI,IAAI,EAAC,MAAO,EAAE;YAC9B,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;YACzB,MAAM,KAAK,GAAG,IAAI,EAAC,MAAO,CAAC,CAAC,CAAC,CAAA;YAC7B,IAAI,GAAG,IAAI,KAAK,EAAE;gBAChB,MAAM,MAAM,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC,CAAA;gBACzC,KAAK,CAAC,GAAG,GAAG,MAAM,CAAA;gBAClB,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,EAAE,CAAA;aACzB;SACF;QACD,IAAI,IAAI,EAAC,KAAM,EAAE;YACf,KAAK,CAAC,IAAI,GAAG,IAAI,EAAC,KAAM,CAAC,CAAC,CAAC,CAAA;SAC5B;QACD,OAAO,KAAK,CAAA;IACd,CAAC;IAED;;;;;;;;;;;;OAYG,CACH,IAAI,GAAA;QACF,MAAM,GAAG,GAA6B,EAAE,CAAA;QACxC,KAAK,MAAM,CAAC,IAAI,IAAI,EAAC,OAAQ,CAAC;YAAE,UAAU,EAAE,IAAI;QAAA,CAAE,CAAC,CAAE;YACnD,MAAM,GAAG,GAAG,IAAI,EAAC,OAAQ,CAAC,CAAC,CAAC,CAAA;YAC5B,MAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;YAC1B,MAAM,KAAK,GAAkB,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,GACnD,CAAC,CAAC,oBAAoB,GACtB,CAAC,CAAA;YACL,IAAI,KAAK,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,EAAE,SAAQ;YACtD,MAAM,KAAK,GAAsB;gBAAE,KAAK;YAAA,CAAE,CAAA;YAC1C,IAAI,IAAI,EAAC,IAAK,IAAI,IAAI,EAAC,MAAO,EAAE;gBAC9B,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;gBACzB,yDAAyD;gBACzD,4DAA4D;gBAC5D,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,GAAI,IAAI,EAAC,MAAO,CAAC,CAAC,CAAY,CAAA;gBACpD,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,GAAG,CAAC,CAAA;aAC3C;YACD,IAAI,IAAI,EAAC,KAAM,EAAE;gBACf,KAAK,CAAC,IAAI,GAAG,IAAI,EAAC,KAAM,CAAC,CAAC,CAAC,CAAA;aAC5B;YACD,GAAG,CAAC,OAAO,CAAC;gBAAC,GAAG;gBAAE,KAAK;aAAC,CAAC,CAAA;SAC1B;QACD,OAAO,GAAG,CAAA;IACZ,CAAC;IAED;;;;;;;;OAQG,CACH,IAAI,CAAC,GAA6B,EAAA;QAChC,IAAI,CAAC,KAAK,EAAE,CAAA;QACZ,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,GAAG,CAAE;YAC9B,IAAI,KAAK,CAAC,KAAK,EAAE;gBACf,2DAA2D;gBAC3D,6DAA6D;gBAC7D,6DAA6D;gBAC7D,eAAe;gBACf,EAAE;gBACF,4DAA4D;gBAC5D,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC,KAAK,CAAA;gBACpC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,GAAG,CAAA;aAC/B;YACD,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,CAAA;SAClC;IACH,CAAC;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OA6BG,CACH,GAAG,CACD,CAAI,EACJ,CAAqC,EACrC,aAA4C,CAAA,CAAE,EAAA;QAE9C,IAAI,CAAC,KAAK,SAAS,EAAE;YACnB,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAA;YACd,OAAO,IAAI,CAAA;SACZ;QACD,MAAM,EACJ,GAAG,GAAG,IAAI,CAAC,GAAG,EACd,KAAK,EACL,cAAc,GAAG,IAAI,CAAC,cAAc,EACpC,eAAe,GAAG,IAAI,CAAC,eAAe,EACtC,MAAM,EACP,GAAG,UAAU,CAAA;QACd,IAAI,EAAE,WAAW,GAAG,IAAI,CAAC,WAAW,EAAE,GAAG,UAAU,CAAA;QAEnD,MAAM,IAAI,GAAG,IAAI,EAAC,WAAY,CAC5B,CAAC,EACD,CAAC,EACD,UAAU,CAAC,IAAI,IAAI,CAAC,EACpB,eAAe,CAChB,CAAA;QACD,6CAA6C;QAC7C,6CAA6C;QAC7C,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,GAAG,IAAI,CAAC,YAAY,EAAE;YACjD,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,GAAG,GAAG,MAAM,CAAA;gBACnB,MAAM,CAAC,oBAAoB,GAAG,IAAI,CAAA;aACnC;YACD,sDAAsD;YACtD,IAAI,EAAC,MAAO,CAAC,CAAC,EAAE,KAAK,CAAC,CAAA;YACtB,OAAO,IAAI,CAAA;SACZ;QACD,IAAI,KAAK,GAAG,IAAI,EAAC,IAAK,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;QAC9D,IAAI,KAAK,KAAK,SAAS,EAAE;YACvB,WAAW;YACX,KAAK,GAAG,AACN,IAAI,EAAC,IAAK,KAAK,CAAC,GACZ,IAAI,EAAC,IAAK,GACV,IAAI,EAAC,IAAK,CAAC,MAAM,KAAK,CAAC,GACvB,IAAI,EAAC,IAAK,CAAC,GAAG,EAAE,GAChB,IAAI,CAAC,KAAK,KAAK,IAAI,EAAC,GAAI,GACxB,IAAI,EAAC,KAAM,CAAC,KAAK,CAAC,GAClB,IAAI,EAAC,IAAK,CACN,CAAA;YACV,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;YACxB,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;YACxB,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAA;YAC1B,IAAI,EAAC,IAAK,CAAC,IAAI,EAAC,IAAK,CAAC,GAAG,KAAK,CAAA;YAC9B,IAAI,EAAC,IAAK,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAA;YAC9B,IAAI,EAAC,IAAK,GAAG,KAAK,CAAA;YAClB,IAAI,EAAC,IAAK,EAAE,CAAA;YACZ,IAAI,EAAC,WAAY,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,CAAC,CAAA;YACtC,IAAI,MAAM,EAAE,MAAM,CAAC,GAAG,GAAG,KAAK,CAAA;YAC9B,WAAW,GAAG,KAAK,CAAA;SACpB,MAAM;YACL,SAAS;YACT,IAAI,EAAC,UAAW,CAAC,KAAK,CAAC,CAAA;YACvB,MAAM,MAAM,GAAG,IAAI,EAAC,OAAQ,CAAC,KAAK,CAA2B,CAAA;YAC7D,IAAI,CAAC,KAAK,MAAM,EAAE;gBAChB,IAAI,IAAI,EAAC,cAAe,IAAI,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,EAAE;oBAC3D,MAAM,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC,CAAA;oBACrD,MAAM,EAAE,oBAAoB,EAAE,CAAC,EAAE,GAAG,MAAM,CAAA;oBAC1C,IAAI,CAAC,KAAK,SAAS,IAAI,CAAC,cAAc,EAAE;wBACtC,IAAI,IAAI,EAAC,UAAW,EAAE;4BACpB,IAAI,EAAC,OAAQ,EAAE,CAAC,CAAM,EAAE,CAAC,EAAE,KAAK,CAAC,CAAA;yBAClC;wBACD,IAAI,IAAI,EAAC,eAAgB,EAAE;4BACzB,IAAI,EAAC,QAAS,EAAE,IAAI,CAAC;gCAAC,CAAM;gCAAE,CAAC;gCAAE,KAAK;6BAAC,CAAC,CAAA;yBACzC;qBACF;iBACF,MAAM,IAAI,CAAC,cAAc,EAAE;oBAC1B,IAAI,IAAI,EAAC,UAAW,EAAE;wBACpB,IAAI,EAAC,OAAQ,EAAE,CAAC,MAAW,EAAE,CAAC,EAAE,KAAK,CAAC,CAAA;qBACvC;oBACD,IAAI,IAAI,EAAC,eAAgB,EAAE;wBACzB,IAAI,EAAC,QAAS,EAAE,IAAI,CAAC;4BAAC,MAAW;4BAAE,CAAC;4BAAE,KAAK;yBAAC,CAAC,CAAA;qBAC9C;iBACF;gBACD,IAAI,EAAC,cAAe,CAAC,KAAK,CAAC,CAAA;gBAC3B,IAAI,EAAC,WAAY,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,CAAC,CAAA;gBACtC,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;gBACxB,IAAI,MAAM,EAAE;oBACV,MAAM,CAAC,GAAG,GAAG,SAAS,CAAA;oBACtB,MAAM,QAAQ,GACZ,MAAM,IAAI,IAAI,EAAC,iBAAkB,CAAC,MAAM,CAAC,GACrC,MAAM,CAAC,oBAAoB,GAC3B,MAAM,CAAA;oBACZ,IAAI,QAAQ,KAAK,SAAS,EAAE,MAAM,CAAC,QAAQ,GAAG,QAAQ,CAAA;iBACvD;aACF,MAAM,IAAI,MAAM,EAAE;gBACjB,MAAM,CAAC,GAAG,GAAG,QAAQ,CAAA;aACtB;SACF;QACD,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,EAAC,IAAK,EAAE;YAC5B,IAAI,EAAC,qBAAsB,EAAE,CAAA;SAC9B;QACD,IAAI,IAAI,EAAC,IAAK,EAAE;YACd,IAAI,CAAC,WAAW,EAAE;gBAChB,IAAI,EAAC,UAAW,CAAC,KAAK,EAAE,GAAG,EAAE,KAAK,CAAC,CAAA;aACpC;YACD,IAAI,MAAM,EAAE,IAAI,EAAC,SAAU,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;SAC3C;QACD,IAAI,CAAC,cAAc,IAAI,IAAI,EAAC,eAAgB,IAAI,IAAI,EAAC,QAAS,EAAE;YAC9D,MAAM,EAAE,GAAG,IAAI,EAAC,QAAS,CAAA;YACzB,IAAI,IAAmC,CAAA;YACvC,MAAQ,CAAD,GAAK,GAAG,EAAE,EAAE,KAAK,EAAE,CAAC,AAAE;gBAC3B,IAAI,CAAC,aAAa,EAAE,CAAC,GAAG,IAAI,CAAC,CAAA;aAC9B;SACF;QACD,OAAO,IAAI,CAAA;IACb,CAAC;IAED;;;OAGG,CACH,GAAG,GAAA;QACD,IAAI;YACF,MAAO,IAAI,EAAC,IAAK,CAAE;gBACjB,MAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAC,IAAK,CAAC,CAAA;gBACrC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;gBACjB,IAAI,IAAI,EAAC,iBAAkB,CAAC,GAAG,CAAC,EAAE;oBAChC,IAAI,GAAG,CAAC,oBAAoB,EAAE;wBAC5B,OAAO,GAAG,CAAC,oBAAoB,CAAA;qBAChC;iBACF,MAAM,IAAI,GAAG,KAAK,SAAS,EAAE;oBAC5B,OAAO,GAAG,CAAA;iBACX;aACF;SACF,QAAS;YACR,IAAI,IAAI,EAAC,eAAgB,IAAI,IAAI,EAAC,QAAS,EAAE;gBAC3C,MAAM,EAAE,GAAG,IAAI,EAAC,QAAS,CAAA;gBACzB,IAAI,IAAmC,CAAA;gBACvC,MAAQ,CAAD,GAAK,GAAG,EAAE,EAAE,KAAK,EAAE,CAAC,AAAE;oBAC3B,IAAI,EAAC,YAAa,EAAE,CAAC,GAAG,IAAI,CAAC,CAAA;iBAC9B;aACF;SACF;IACH,CAAC;KAED,KAAM,CAAC,IAAa;QAClB,MAAM,IAAI,GAAG,IAAI,EAAC,IAAK,CAAA;QACvB,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,IAAI,CAAM,CAAA;QAClC,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,IAAI,CAAM,CAAA;QAClC,IAAI,IAAI,EAAC,cAAe,IAAI,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,EAAE;YACtD,CAAC,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC,CAAA;SAChD,MAAM,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,EAAC,eAAgB,EAAE;YACpD,IAAI,IAAI,EAAC,UAAW,EAAE;gBACpB,IAAI,EAAC,OAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,OAAO,CAAC,CAAA;aAC/B;YACD,IAAI,IAAI,CAAC,gBAAgB,EAAE;gBACzB,IAAI,EAAC,QAAS,EAAE,IAAI,CAAC;oBAAC,CAAC;oBAAE,CAAC;oBAAE,OAAO;iBAAC,CAAC,CAAA;aACtC;SACF;QACD,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAA;QAC1B,2DAA2D;QAC3D,IAAI,IAAI,EAAE;YACR,IAAI,EAAC,OAAQ,CAAC,IAAI,CAAC,GAAG,SAAS,CAAA;YAC/B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,SAAS,CAAA;YAC/B,IAAI,EAAC,IAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SACtB;QACD,IAAI,IAAI,EAAC,IAAK,KAAK,CAAC,EAAE;YACpB,IAAI,EAAC,IAAK,GAAG,IAAI,EAAC,IAAK,GAAG,CAAU,CAAA;YACpC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAA;SACtB,MAAM;YACL,IAAI,EAAC,IAAK,GAAG,IAAI,EAAC,IAAK,CAAC,IAAI,CAAU,CAAA;SACvC;QACD,IAAI,EAAC,MAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAA;QACtB,IAAI,CAAC,KAAK,EAAE,CAAA;QACZ,OAAO,IAAI,CAAA;IACb,CAAC;IAED;;;;;;;;;;;;;;;OAeG,CACH,GAAG,CAAC,CAAI,EAAE,aAA4C,CAAA,CAAE,EAAA;QACtD,MAAM,EAAE,cAAc,GAAG,IAAI,CAAC,cAAc,EAAE,MAAM,EAAE,GACpD,UAAU,CAAA;QACZ,MAAM,KAAK,GAAG,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;QACjC,IAAI,KAAK,KAAK,SAAS,EAAE;YACvB,MAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;YAC9B,IACE,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,IAC1B,CAAC,CAAC,oBAAoB,KAAK,SAAS,EACpC;gBACA,OAAO,KAAK,CAAA;aACb;YACD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;gBACzB,IAAI,cAAc,EAAE;oBAClB,IAAI,EAAC,aAAc,CAAC,KAAK,CAAC,CAAA;iBAC3B;gBACD,IAAI,MAAM,EAAE;oBACV,MAAM,CAAC,GAAG,GAAG,KAAK,CAAA;oBAClB,IAAI,EAAC,SAAU,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;iBAC/B;gBACD,OAAO,IAAI,CAAA;aACZ,MAAM,IAAI,MAAM,EAAE;gBACjB,MAAM,CAAC,GAAG,GAAG,OAAO,CAAA;gBACpB,IAAI,EAAC,SAAU,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;aAC/B;SACF,MAAM,IAAI,MAAM,EAAE;YACjB,MAAM,CAAC,GAAG,GAAG,MAAM,CAAA;SACpB;QACD,OAAO,KAAK,CAAA;IACd,CAAC;IAED;;;;;;OAMG,CACH,IAAI,CAAC,CAAI,EAAE,cAA8C,CAAA,CAAE,EAAA;QACzD,MAAM,EAAE,UAAU,GAAG,IAAI,CAAC,UAAU,EAAE,GAAG,WAAW,CAAA;QACpD,MAAM,KAAK,GAAG,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;QACjC,IACE,KAAK,KAAK,SAAS,IAClB,CAAC,UAAU,IAAI,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,CAAC,CACrC;YACA,OAAM;SACP;QACD,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,CAAA;QAC9B,oEAAoE;QACpE,OAAO,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,CAAA;IAChE,CAAC;KAED,eAAgB,CACd,CAAI,EACJ,KAAwB,EACxB,OAAwC,EACxC,OAAY;QAEZ,MAAM,CAAC,GAAG,KAAK,KAAK,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,CAAA;QAChE,IAAI,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,EAAE;YAC9B,OAAO,CAAC,CAAA;SACT;QAED,MAAM,EAAE,GAAG,IAAI,EAAE,EAAE,CAAA;QACnB,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO,CAAA;QAC1B,yDAAyD;QACzD,MAAM,EAAE,gBAAgB,CAAC,OAAO,EAAE,GAAG,CAAG,CAAD,CAAG,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE;YAC/D,MAAM,EAAE,EAAE,CAAC,MAAM;SAClB,CAAC,CAAA;QAEF,MAAM,SAAS,GAAG;YAChB,MAAM,EAAE,EAAE,CAAC,MAAM;YACjB,OAAO;YACP,OAAO;SACR,CAAA;QAED,MAAM,EAAE,GAAG,CACT,CAAgB,EAChB,WAAW,GAAG,KAAK,EACJ,EAAE;YACjB,MAAM,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC,MAAM,CAAA;YAC7B,MAAM,WAAW,GAAG,OAAO,CAAC,gBAAgB,IAAI,CAAC,KAAK,SAAS,CAAA;YAC/D,IAAI,OAAO,CAAC,MAAM,EAAE;gBAClB,IAAI,OAAO,IAAI,CAAC,WAAW,EAAE;oBAC3B,OAAO,CAAC,MAAM,CAAC,YAAY,GAAG,IAAI,CAAA;oBAClC,OAAO,CAAC,MAAM,CAAC,UAAU,GAAG,EAAE,CAAC,MAAM,CAAC,MAAM,CAAA;oBAC5C,IAAI,WAAW,EAAE,OAAO,CAAC,MAAM,CAAC,iBAAiB,GAAG,IAAI,CAAA;iBACzD,MAAM;oBACL,OAAO,CAAC,MAAM,CAAC,aAAa,GAAG,IAAI,CAAA;iBACpC;aACF;YACD,IAAI,OAAO,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW,EAAE;gBAC3C,OAAO,SAAS,CAAC,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA;aACnC;YACD,qEAAqE;YACrE,MAAM,EAAE,GAAG,CAAuB,CAAA;YAClC,IAAI,IAAI,EAAC,OAAQ,CAAC,KAAc,CAAC,KAAK,CAAC,EAAE;gBACvC,IAAI,CAAC,KAAK,SAAS,EAAE;oBACnB,IAAI,EAAE,CAAC,oBAAoB,EAAE;wBAC3B,IAAI,EAAC,OAAQ,CAAC,KAAc,CAAC,GAAG,EAAE,CAAC,oBAAoB,CAAA;qBACxD,MAAM;wBACL,IAAI,EAAC,MAAO,CAAC,CAAC,EAAE,OAAO,CAAC,CAAA;qBACzB;iBACF,MAAM;oBACL,IAAI,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC,YAAY,GAAG,IAAI,CAAA;oBACtD,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,OAAO,CAAC,CAAA;iBAClC;aACF;YACD,OAAO,CAAC,CAAA;QACV,CAAC,CAAA;QAED,MAAM,EAAE,GAAG,CAAC,EAAO,EAAE,EAAE;YACrB,IAAI,OAAO,CAAC,MAAM,EAAE;gBAClB,OAAO,CAAC,MAAM,CAAC,aAAa,GAAG,IAAI,CAAA;gBACnC,OAAO,CAAC,MAAM,CAAC,UAAU,GAAG,EAAE,CAAA;aAC/B;YACD,OAAO,SAAS,CAAC,EAAE,CAAC,CAAA;QACtB,CAAC,CAAA;QAED,MAAM,SAAS,GAAG,CAAC,EAAO,EAAiB,EAAE;YAC3C,MAAM,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC,MAAM,CAAA;YAC7B,MAAM,iBAAiB,GACrB,OAAO,IAAI,OAAO,CAAC,sBAAsB,CAAA;YAC3C,MAAM,UAAU,GACd,iBAAiB,IAAI,OAAO,CAAC,0BAA0B,CAAA;YACzD,MAAM,QAAQ,GAAG,UAAU,IAAI,OAAO,CAAC,wBAAwB,CAAA;YAC/D,MAAM,EAAE,GAAG,CAAuB,CAAA;YAClC,IAAI,IAAI,EAAC,OAAQ,CAAC,KAAc,CAAC,KAAK,CAAC,EAAE;gBACvC,qEAAqE;gBACrE,sEAAsE;gBACtE,MAAM,GAAG,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAC,oBAAoB,KAAK,SAAS,CAAA;gBAC9D,IAAI,GAAG,EAAE;oBACP,IAAI,EAAC,MAAO,CAAC,CAAC,EAAE,OAAO,CAAC,CAAA;iBACzB,MAAM,IAAI,CAAC,iBAAiB,EAAE;oBAC7B,oDAAoD;oBACpD,oDAAoD;oBACpD,mDAAmD;oBACnD,qDAAqD;oBACrD,IAAI,EAAC,OAAQ,CAAC,KAAc,CAAC,GAAG,EAAE,CAAC,oBAAoB,CAAA;iBACxD;aACF;YACD,IAAI,UAAU,EAAE;gBACd,IAAI,OAAO,CAAC,MAAM,IAAI,EAAE,CAAC,oBAAoB,KAAK,SAAS,EAAE;oBAC3D,OAAO,CAAC,MAAM,CAAC,aAAa,GAAG,IAAI,CAAA;iBACpC;gBACD,OAAO,EAAE,CAAC,oBAAoB,CAAA;aAC/B,MAAM,IAAI,EAAE,CAAC,UAAU,KAAK,EAAE,EAAE;gBAC/B,MAAM,EAAE,CAAA;aACT;QACH,CAAC,CAAA;QAED,MAAM,KAAK,GAAG,CACZ,GAA+B,EAC/B,GAAqB,EACrB,EAAE;YACF,MAAM,GAAG,GAAG,IAAI,EAAC,WAAY,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,CAAA;YAChD,IAAI,GAAG,IAAI,GAAG,YAAY,OAAO,EAAE;gBACjC,GAAG,CAAC,IAAI,EAAC,CAAC,CAAC,EAAE,AAAC,GAAG,CAAC,CAAC,KAAK,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAA;aACzD;YACD,8CAA8C;YAC9C,8CAA8C;YAC9C,+BAA+B;YAC/B,EAAE,CAAC,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE;gBACvC,IACE,CAAC,OAAO,CAAC,gBAAgB,IACzB,OAAO,CAAC,sBAAsB,EAC9B;oBACA,GAAG,CAAC,SAAS,CAAC,CAAA;oBACd,iDAAiD;oBACjD,IAAI,OAAO,CAAC,sBAAsB,EAAE;wBAClC,GAAG,IAAG,CAAC,CAAC,EAAE,AAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,CAAA;qBACvB;iBACF;YACH,CAAC,CAAC,CAAA;QACJ,CAAC,CAAA;QAED,IAAI,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC,eAAe,GAAG,IAAI,CAAA;QACzD,MAAM,CAAC,GAAG,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;QACzC,MAAM,EAAE,GAAuB,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE;YAC9C,iBAAiB,EAAE,EAAE;YACrB,oBAAoB,EAAE,CAAC;YACvB,UAAU,EAAE,SAAS;SACtB,CAAC,CAAA;QAEF,IAAI,KAAK,KAAK,SAAS,EAAE;YACvB,iCAAiC;YACjC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE;gBAAE,GAAG,SAAS,CAAC,OAAO;gBAAE,MAAM,EAAE,SAAS;YAAA,CAAE,CAAC,CAAA;YAC5D,KAAK,GAAG,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;SAC5B,MAAM;YACL,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,GAAG,EAAE,CAAA;SAC1B;QACD,OAAO,EAAE,CAAA;IACX,CAAC;KAED,iBAAkB,CAAC,CAAM;QACvB,IAAI,CAAC,IAAI,EAAC,cAAe,EAAE,OAAO,KAAK,CAAA;QACvC,MAAM,CAAC,GAAG,CAAuB,CAAA;QACjC,OAAO,AACL,CAAC,CAAC,CAAC,IACH,CAAC,YAAY,OAAO,IACpB,CAAC,CAAC,cAAc,CAAC,sBAAsB,CAAC,IACxC,CAAC,CAAC,iBAAiB,YAAY,EAAE,CAClC,CAAA;IACH,CAAC;IA+GD,KAAK,CAAC,KAAK,CACT,CAAI,EACJ,eAAgD,CAAA,CAAE,EAAA;QAElD,MAAM,EACJ,cAAc;QACd,UAAU,GAAG,IAAI,CAAC,UAAU,EAC5B,cAAc,GAAG,IAAI,CAAC,cAAc,EACpC,kBAAkB,GAAG,IAAI,CAAC,kBAAkB,EAC5C,cAAc;QACd,GAAG,GAAG,IAAI,CAAC,GAAG,EACd,cAAc,GAAG,IAAI,CAAC,cAAc,EACpC,IAAI,GAAG,CAAC,EACR,eAAe,GAAG,IAAI,CAAC,eAAe,EACtC,WAAW,GAAG,IAAI,CAAC,WAAW,EAC9B,0BAA0B;QAC1B,wBAAwB,GAAG,IAAI,CAAC,wBAAwB,EACxD,0BAA0B,GAAG,IAAI,CAAC,0BAA0B,EAC5D,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,EACxC,sBAAsB,GAAG,IAAI,CAAC,sBAAsB,EACpD,OAAO,EACP,YAAY,GAAG,KAAK,EACpB,MAAM,EACN,MAAM,EACP,GAAG,YAAY,CAAA;QAEhB,IAAI,CAAC,IAAI,EAAC,cAAe,EAAE;YACzB,IAAI,MAAM,EAAE,MAAM,CAAC,KAAK,GAAG,KAAK,CAAA;YAChC,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE;gBACjB,UAAU;gBACV,cAAc;gBACd,kBAAkB;gBAClB,MAAM;aACP,CAAC,CAAA;SACH;QAED,MAAM,OAAO,GAAG;YACd,UAAU;YACV,cAAc;YACd,kBAAkB;YAClB,GAAG;YACH,cAAc;YACd,IAAI;YACJ,eAAe;YACf,WAAW;YACX,wBAAwB;YACxB,0BAA0B;YAC1B,sBAAsB;YACtB,gBAAgB;YAChB,MAAM;YACN,MAAM;SACP,CAAA;QAED,IAAI,KAAK,GAAG,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;QAC/B,IAAI,KAAK,KAAK,SAAS,EAAE;YACvB,IAAI,MAAM,EAAE,MAAM,CAAC,KAAK,GAAG,MAAM,CAAA;YACjC,MAAM,CAAC,GAAG,IAAI,EAAC,eAAgB,CAAC,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAA;YAC3D,OAAQ,AAAD,CAAE,CAAC,UAAU,GAAG,CAAC,CAAC,CAAA;SAC1B,MAAM;YACL,mCAAmC;YACnC,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,CAAA;YAC9B,IAAI,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE;gBAC9B,MAAM,KAAK,GACT,UAAU,IAAI,CAAC,CAAC,oBAAoB,KAAK,SAAS,CAAA;gBACpD,IAAI,MAAM,EAAE;oBACV,MAAM,CAAC,KAAK,GAAG,UAAU,CAAA;oBACzB,IAAI,KAAK,EAAE,MAAM,CAAC,aAAa,GAAG,IAAI,CAAA;iBACvC;gBACD,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,oBAAoB,CAAC,CAAC,CAAE,AAAD,CAAE,CAAC,UAAU,GAAG,CAAC,CAAC,CAAA;aAC3D;YAED,mEAAmE;YACnE,gEAAgE;YAChE,MAAM,OAAO,GAAG,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,CAAA;YACpC,IAAI,CAAC,YAAY,IAAI,CAAC,OAAO,EAAE;gBAC7B,IAAI,MAAM,EAAE,MAAM,CAAC,KAAK,GAAG,KAAK,CAAA;gBAChC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAA;gBACvB,IAAI,cAAc,EAAE;oBAClB,IAAI,EAAC,aAAc,CAAC,KAAK,CAAC,CAAA;iBAC3B;gBACD,IAAI,MAAM,EAAE,IAAI,EAAC,SAAU,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;gBAC1C,OAAO,CAAC,CAAA;aACT;YAED,iEAAiE;YACjE,qBAAqB;YACrB,MAAM,CAAC,GAAG,IAAI,EAAC,eAAgB,CAAC,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAA;YAC3D,MAAM,QAAQ,GAAG,CAAC,CAAC,oBAAoB,KAAK,SAAS,CAAA;YACrD,MAAM,QAAQ,GAAG,QAAQ,IAAI,UAAU,CAAA;YACvC,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,KAAK,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAA;gBAC5C,IAAI,QAAQ,IAAI,OAAO,EAAE,MAAM,CAAC,aAAa,GAAG,IAAI,CAAA;aACrD;YACD,OAAO,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,oBAAoB,CAAC,CAAC,CAAC,AAAC,CAAC,CAAC,UAAU,GAAG,CAAC,CAAC,CAAA;SAC9D;IACH,CAAC;IAoCD,KAAK,CAAC,UAAU,CACd,CAAI,EACJ,eAAgD,CAAA,CAAE,EAAA;QAElD,MAAM,CAAC,GAAG,MAAM,IAAI,CAAC,KAAK,CACxB,CAAC,EACD,YAI8C,CAC/C,CAAA;QACD,IAAI,CAAC,KAAK,SAAS,EAAE,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAA;QAClE,OAAO,CAAC,CAAA;IACV,CAAC;IAqCD,IAAI,CAAC,CAAI,EAAE,cAA8C,CAAA,CAAE,EAAA;QACzD,MAAM,UAAU,GAAG,IAAI,EAAC,UAAW,CAAA;QACnC,IAAI,CAAC,UAAU,EAAE;YACf,MAAM,IAAI,KAAK,CAAC,uCAAuC,CAAC,CAAA;SACzD;QACD,MAAM,EAAE,OAAO,EAAE,YAAY,EAAE,GAAG,OAAO,EAAE,GAAG,WAAW,CAAA;QACzD,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,CAAC,CAAA;QAC9B,IAAI,CAAC,YAAY,IAAI,CAAC,KAAK,SAAS,EAAE,OAAO,CAAC,CAAA;QAC9C,MAAM,EAAE,GAAG,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE;YAC1B,OAAO;YACP,OAAO;SAC8B,CAAC,CAAA;QACxC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,OAAO,CAAC,CAAA;QACxB,OAAO,EAAE,CAAA;IACX,CAAC;IAED;;;;;OAKG,CACH,GAAG,CAAC,CAAI,EAAE,aAA4C,CAAA,CAAE,EAAA;QACtD,MAAM,EACJ,UAAU,GAAG,IAAI,CAAC,UAAU,EAC5B,cAAc,GAAG,IAAI,CAAC,cAAc,EACpC,kBAAkB,GAAG,IAAI,CAAC,kBAAkB,EAC5C,MAAM,EACP,GAAG,UAAU,CAAA;QACd,MAAM,KAAK,GAAG,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;QACjC,IAAI,KAAK,KAAK,SAAS,EAAE;YACvB,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;YAClC,MAAM,QAAQ,GAAG,IAAI,EAAC,iBAAkB,CAAC,KAAK,CAAC,CAAA;YAC/C,IAAI,MAAM,EAAE,IAAI,EAAC,SAAU,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;YAC1C,IAAI,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,EAAE;gBACxB,IAAI,MAAM,EAAE,MAAM,CAAC,GAAG,GAAG,OAAO,CAAA;gBAChC,mDAAmD;gBACnD,IAAI,CAAC,QAAQ,EAAE;oBACb,IAAI,CAAC,kBAAkB,EAAE;wBACvB,IAAI,EAAC,MAAO,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAA;qBAC1B;oBACD,IAAI,MAAM,IAAI,UAAU,EAAE,MAAM,CAAC,aAAa,GAAG,IAAI,CAAA;oBACrD,OAAO,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,SAAS,CAAA;iBACtC,MAAM;oBACL,IACE,MAAM,IACN,UAAU,IACV,KAAK,CAAC,oBAAoB,KAAK,SAAS,EACxC;wBACA,MAAM,CAAC,aAAa,GAAG,IAAI,CAAA;qBAC5B;oBACD,OAAO,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC,CAAC,SAAS,CAAA;iBAC3D;aACF,MAAM;gBACL,IAAI,MAAM,EAAE,MAAM,CAAC,GAAG,GAAG,KAAK,CAAA;gBAC9B,gEAAgE;gBAChE,iEAAiE;gBACjE,kEAAkE;gBAClE,oEAAoE;gBACpE,qCAAqC;gBACrC,IAAI,QAAQ,EAAE;oBACZ,OAAO,KAAK,CAAC,oBAAoB,CAAA;iBAClC;gBACD,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAA;gBACvB,IAAI,cAAc,EAAE;oBAClB,IAAI,EAAC,aAAc,CAAC,KAAK,CAAC,CAAA;iBAC3B;gBACD,OAAO,KAAK,CAAA;aACb;SACF,MAAM,IAAI,MAAM,EAAE;YACjB,MAAM,CAAC,GAAG,GAAG,MAAM,CAAA;SACpB;IACH,CAAC;KAED,OAAQ,CAAC,CAAQ,EAAE,CAAQ;QACzB,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAA;QACjB,IAAI,EAAC,IAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAA;IACnB,CAAC;IAED,WAAW,CAAC,KAAY;QACtB,iCAAiC;QACjC,oCAAoC;QACpC,OAAO;QACP,6DAA6D;QAC7D,0CAA0C;QAC1C,qBAAqB;QACrB,qBAAqB;QACrB,eAAe;QACf,IAAI,KAAK,KAAK,IAAI,EAAC,IAAK,EAAE;YACxB,IAAI,KAAK,KAAK,IAAI,EAAC,IAAK,EAAE;gBACxB,IAAI,EAAC,IAAK,GAAG,IAAI,EAAC,IAAK,CAAC,KAAK,CAAU,CAAA;aACxC,MAAM;gBACL,IAAI,EAAC,OAAQ,CACX,IAAI,EAAC,IAAK,CAAC,KAAK,CAAU,EAC1B,IAAI,EAAC,IAAK,CAAC,KAAK,CAAU,CAC3B,CAAA;aACF;YACD,IAAI,EAAC,OAAQ,CAAC,IAAI,EAAC,IAAK,EAAE,KAAK,CAAC,CAAA;YAChC,IAAI,EAAC,IAAK,GAAG,KAAK,CAAA;SACnB;IACH,CAAC;IAED;;;;OAIG,CACH,MAAM,CAAC,CAAI,EAAA;QACT,OAAO,IAAI,EAAC,MAAO,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAA;IAClC,CAAC;KAED,MAAO,CAAC,CAAI,EAAE,MAA8B;QAC1C,IAAI,OAAO,GAAG,KAAK,CAAA;QACnB,IAAI,IAAI,EAAC,IAAK,KAAK,CAAC,EAAE;YACpB,MAAM,KAAK,GAAG,IAAI,EAAC,MAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;YACjC,IAAI,KAAK,KAAK,SAAS,EAAE;gBACvB,OAAO,GAAG,IAAI,CAAA;gBACd,IAAI,IAAI,EAAC,IAAK,KAAK,CAAC,EAAE;oBACpB,IAAI,EAAC,KAAM,CAAC,MAAM,CAAC,CAAA;iBACpB,MAAM;oBACL,IAAI,EAAC,cAAe,CAAC,KAAK,CAAC,CAAA;oBAC3B,MAAM,CAAC,GAAG,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,CAAA;oBAC9B,IAAI,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE;wBAC9B,CAAC,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC,CAAA;qBAChD,MAAM,IAAI,IAAI,EAAC,UAAW,IAAI,IAAI,EAAC,eAAgB,EAAE;wBACpD,IAAI,IAAI,EAAC,UAAW,EAAE;4BACpB,IAAI,EAAC,OAAQ,EAAE,CAAC,CAAM,EAAE,CAAC,EAAE,MAAM,CAAC,CAAA;yBACnC;wBACD,IAAI,IAAI,EAAC,eAAgB,EAAE;4BACzB,IAAI,EAAC,QAAS,EAAE,IAAI,CAAC;gCAAC,CAAM;gCAAE,CAAC;gCAAE,MAAM;6BAAC,CAAC,CAAA;yBAC1C;qBACF;oBACD,IAAI,EAAC,MAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAA;oBACtB,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,GAAG,SAAS,CAAA;oBAChC,IAAI,EAAC,OAAQ,CAAC,KAAK,CAAC,GAAG,SAAS,CAAA;oBAChC,IAAI,KAAK,KAAK,IAAI,EAAC,IAAK,EAAE;wBACxB,IAAI,EAAC,IAAK,GAAG,IAAI,EAAC,IAAK,CAAC,KAAK,CAAU,CAAA;qBACxC,MAAM,IAAI,KAAK,KAAK,IAAI,EAAC,IAAK,EAAE;wBAC/B,IAAI,CAAC,KAAK,GAAG,IAAI,EAAC,IAAK,CAAC,KAAK,CAAU,CAAA;qBACxC,MAAM;wBACL,MAAM,EAAE,GAAG,IAAI,EAAC,IAAK,CAAC,KAAK,CAAW,CAAA;wBACtC,IAAI,EAAC,IAAK,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAW,CAAA;wBAC5C,MAAM,EAAE,GAAG,IAAI,EAAC,IAAK,CAAC,KAAK,CAAW,CAAA;wBACtC,IAAI,EAAC,IAAK,CAAC,EAAE,CAAC,GAAG,IAAI,EAAC,IAAK,CAAC,KAAK,CAAW,CAAA;qBAC7C;oBACD,IAAI,EAAC,IAAK,EAAE,CAAA;oBACZ,IAAI,EAAC,IAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;iBACvB;aACF;SACF;QACD,IAAI,IAAI,EAAC,eAAgB,IAAI,IAAI,EAAC,QAAS,EAAE,MAAM,EAAE;YACnD,MAAM,EAAE,GAAG,IAAI,CAAC,SAAS,CAAA;YACzB,IAAI,IAAmC,CAAA;YACvC,MAAQ,CAAD,GAAK,GAAG,EAAE,EAAE,KAAK,EAAE,CAAG,AAAF;gBACzB,IAAI,EAAC,YAAa,EAAE,CAAC,GAAG,IAAI,CAAC,CAAA;aAC9B;SACF;QACD,OAAO,OAAO,CAAA;IAChB,CAAC;IAED;;OAEG,CACH,KAAK,GAAA;QACH,OAAO,IAAI,EAAC,KAAM,CAAC,QAAQ,CAAC,CAAA;IAC9B,CAAC;KACD,KAAM,CAAC,MAA8B;QACnC,KAAK,MAAM,KAAK,IAAI,IAAI,EAAC,QAAS,CAAC;YAAE,UAAU,EAAE,IAAI;QAAA,CAAE,CAAC,CAAE;YACxD,MAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;YAC9B,IAAI,IAAI,EAAC,iBAAkB,CAAC,CAAC,CAAC,EAAE;gBAC9B,CAAC,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC,CAAA;aAChD,MAAM;gBACL,MAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;gBAC9B,IAAI,IAAI,EAAC,UAAW,EAAE;oBACpB,IAAI,EAAC,OAAQ,EAAE,CAAC,CAAM,EAAE,CAAM,EAAE,MAAM,CAAC,CAAA;iBACxC;gBACD,IAAI,IAAI,EAAC,eAAgB,EAAE;oBACzB,IAAI,EAAC,QAAS,EAAE,IAAI,CAAC;wBAAC,CAAM;wBAAE,CAAM;wBAAE,MAAM;qBAAC,CAAC,CAAA;iBAC/C;aACF;SACF;QAED,IAAI,EAAC,MAAO,CAAC,KAAK,EAAE,CAAA;QACpB,IAAI,EAAC,OAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;QAC7B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;QAC7B,IAAI,IAAI,EAAC,IAAK,IAAI,IAAI,EAAC,MAAO,EAAE;YAC9B,IAAI,EAAC,IAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;YAClB,IAAI,EAAC,MAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;SACrB;QACD,IAAI,IAAI,EAAC,KAAM,EAAE;YACf,IAAI,EAAC,KAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;SACpB;QACD,IAAI,CAAC,KAAK,GAAG,CAAU,CAAA;QACvB,IAAI,EAAC,IAAK,GAAG,CAAU,CAAA;QACvB,IAAI,EAAC,IAAK,CAAC,MAAM,GAAG,CAAC,CAAA;QACrB,IAAI,EAAC,cAAe,GAAG,CAAC,CAAA;QACxB,IAAI,EAAC,IAAK,GAAG,CAAC,CAAA;QACd,IAAI,IAAI,EAAC,eAAgB,IAAI,IAAI,EAAC,QAAS,EAAE;YAC3C,MAAM,EAAE,GAAG,IAAI,EAAC,QAAS,CAAA;YACzB,IAAI,IAAmC,CAAA;YACvC,MAAQ,CAAD,GAAK,GAAG,EAAE,EAAE,KAAK,EAAE,CAAC,AAAE;gBAC3B,IAAI,EAAC,YAAa,EAAE,CAAC,GAAG,IAAI,CAAC,CAAA;aAC9B;SACF;IACH,CAAC;CACF;AAxwDD,QAAA,QAAA,GAAA,SAwwDC","ignoreList":[0]}},
    {"offset": {"line": 13061, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13066, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/simple-store-memory/src/util.ts"],"sourcesContent":["const knownSizes = new WeakMap<object, number>()\n\n/**\n * @see {@link https://stackoverflow.com/a/11900218/356537}\n */\nexport function roughSizeOfObject(value: unknown): number {\n  const objectList = new Set()\n  const stack = [value] // This would be more efficient using a circular buffer\n  let bytes = 0\n\n  while (stack.length) {\n    const value = stack.pop()\n\n    // > All objects on the heap start with a shape descriptor, which takes one\n    // > pointer size (usually 4 bytes these days, thanks to \"pointer\n    // > compression\" on 64-bit platforms).\n\n    switch (typeof value) {\n      // Types are ordered by frequency\n      case 'string':\n        // https://stackoverflow.com/a/68791382/356537\n        bytes += 12 + 4 * Math.ceil(value.length / 4)\n        break\n      case 'number':\n        bytes += 12 // Shape descriptor + double\n        break\n      case 'boolean':\n        bytes += 4 // Shape descriptor\n        break\n      case 'object':\n        bytes += 4 // Shape descriptor\n\n        if (value === null) {\n          break\n        }\n\n        if (knownSizes.has(value)) {\n          bytes += knownSizes.get(value)!\n          break\n        }\n\n        if (objectList.has(value)) continue\n        objectList.add(value)\n\n        if (Array.isArray(value)) {\n          bytes += 4\n          stack.push(...value)\n        } else {\n          bytes += 8\n          const keys = Object.getOwnPropertyNames(value)\n          for (let i = 0; i < keys.length; i++) {\n            bytes += 4\n            const key = keys[i]\n            const val = value[key]\n            if (val !== undefined) stack.push(val)\n            stack.push(key)\n          }\n        }\n        break\n      case 'function':\n        bytes += 8 // Shape descriptor + pointer (assuming functions are shared)\n        break\n      case 'symbol':\n        bytes += 8 // Shape descriptor + pointer\n        break\n      case 'bigint':\n        bytes += 16 // Shape descriptor + BigInt\n        break\n    }\n  }\n\n  if (typeof value === 'object' && value !== null) {\n    knownSizes.set(value, bytes)\n  }\n\n  return bytes\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAM,UAAU,GAAG,IAAI,OAAO,EAAkB,CAAA;AAEhD;;GAEG,CACH,SAAgB,iBAAiB,CAAC,KAAc;IAC9C,MAAM,UAAU,GAAG,IAAI,GAAG,EAAE,CAAA;IAC5B,MAAM,KAAK,GAAG;QAAC,KAAK;KAAC,CAAA,CAAC,uDAAuD;IAC7E,IAAI,KAAK,GAAG,CAAC,CAAA;IAEb,MAAO,KAAK,CAAC,MAAM,CAAE,CAAC;QACpB,MAAM,KAAK,GAAG,KAAK,CAAC,GAAG,EAAE,CAAA;QAEzB,2EAA2E;QAC3E,iEAAiE;QACjE,uCAAuC;QAEvC,OAAQ,OAAO,KAAK,EAAE,CAAC;YACrB,iCAAiC;YACjC,KAAK,QAAQ;gBACX,8CAA8C;gBAC9C,KAAK,IAAI,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA;gBAC7C,MAAK;YACP,KAAK,QAAQ;gBACX,KAAK,IAAI,EAAE,CAAA,CAAC,4BAA4B;gBACxC,MAAK;YACP,KAAK,SAAS;gBACZ,KAAK,IAAI,CAAC,CAAA,CAAC,mBAAmB;gBAC9B,MAAK;YACP,KAAK,QAAQ;gBACX,KAAK,IAAI,CAAC,CAAA,CAAC,mBAAmB;gBAE9B,IAAI,KAAK,KAAK,IAAI,EAAE,CAAC;oBACnB,MAAK;gBACP,CAAC;gBAED,IAAI,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC;oBAC1B,KAAK,IAAI,UAAU,CAAC,GAAG,CAAC,KAAK,CAAE,CAAA;oBAC/B,MAAK;gBACP,CAAC;gBAED,IAAI,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,SAAQ;gBACnC,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;gBAErB,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC;oBACzB,KAAK,IAAI,CAAC,CAAA;oBACV,KAAK,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,CAAA;gBACtB,CAAC,MAAM,CAAC;oBACN,KAAK,IAAI,CAAC,CAAA;oBACV,MAAM,IAAI,GAAG,MAAM,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAA;oBAC9C,IAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,CAAE,CAAC;wBACrC,KAAK,IAAI,CAAC,CAAA;wBACV,MAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;wBACnB,MAAM,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,CAAA;wBACtB,IAAI,GAAG,KAAK,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;wBACtC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;oBACjB,CAAC;gBACH,CAAC;gBACD,MAAK;YACP,KAAK,UAAU;gBACb,KAAK,IAAI,CAAC,CAAA,CAAC,6DAA6D;gBACxE,MAAK;YACP,KAAK,QAAQ;gBACX,KAAK,IAAI,CAAC,CAAA,CAAC,6BAA6B;gBACxC,MAAK;YACP,KAAK,QAAQ;gBACX,KAAK,IAAI,EAAE,CAAA,CAAC,4BAA4B;gBACxC,MAAK;QACT,CAAC;IACH,CAAC;IAED,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,KAAK,IAAI,EAAE,CAAC;QAChD,UAAU,CAAC,GAAG,CAAC,KAAK,EAAE,KAAK,CAAC,CAAA;IAC9B,CAAC;IAED,OAAO,KAAK,CAAA;AACd,CAAC;AAvED,QAAA,iBAAA,GAAA,kBAuEC","ignoreList":[0]}},
    {"offset": {"line": 13140, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13145, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/simple-store-memory/src/index.ts"],"sourcesContent":["import { SimpleStore, Key, Value } from '@atproto-labs/simple-store'\nimport { LRUCache } from 'lru-cache'\n\nimport { roughSizeOfObject } from './util.js'\n\nexport type SimpleStoreMemoryOptions<K extends Key, V extends Value> = {\n  /**\n   * The maximum number of entries in the cache.\n   */\n  max?: number\n\n  /**\n   * The time-to-live of a cache entry, in milliseconds.\n   */\n  ttl?: number\n\n  /**\n   * Whether to automatically prune expired entries.\n   */\n  ttlAutopurge?: boolean\n\n  /**\n   * The maximum total size of the cache, in units defined by the sizeCalculation\n   * function.\n   *\n   * @default No limit\n   */\n  maxSize?: number\n\n  /**\n   * The maximum size of a single cache entry, in units defined by the\n   * sizeCalculation function.\n   *\n   * @default No limit\n   */\n  maxEntrySize?: number\n\n  /**\n   * A function that returns the size of a value. The size is used to determine\n   * when the cache should be pruned, based on `maxSize`.\n   *\n   * @default The (rough) size in bytes used in memory.\n   */\n  sizeCalculation?: (value: V, key: K) => number\n} & ( // Memory is not infinite, so at least one pruning option is required.\n  | { max: number }\n  | { maxSize: number }\n  | { ttl: number; ttlAutopurge: boolean }\n)\n\n// LRUCache does not allow storing \"null\", so we use a symbol to represent it.\nconst nullSymbol = Symbol('nullItem')\ntype AsLruValue<V extends Value> = V extends null\n  ? typeof nullSymbol\n  : Exclude<V, null>\nconst toLruValue = <V extends Value>(value: V) =>\n  (value === null ? nullSymbol : value) as AsLruValue<V>\nconst fromLruValue = <V extends Value>(value: AsLruValue<V>) =>\n  (value === nullSymbol ? null : value) as V\n\nexport class SimpleStoreMemory<K extends Key, V extends Value>\n  implements SimpleStore<K, V>\n{\n  #cache: LRUCache<K, AsLruValue<V>>\n\n  constructor({ sizeCalculation, ...options }: SimpleStoreMemoryOptions<K, V>) {\n    this.#cache = new LRUCache<K, AsLruValue<V>>({\n      ...options,\n      allowStale: false,\n      updateAgeOnGet: false,\n      updateAgeOnHas: false,\n      sizeCalculation: sizeCalculation\n        ? (value, key) => sizeCalculation(fromLruValue(value), key)\n        : options.maxEntrySize != null || options.maxSize != null\n          ? // maxEntrySize and maxSize require a size calculation function.\n            roughSizeOfObject\n          : undefined,\n    })\n  }\n\n  get(key: K): V | undefined {\n    const value = this.#cache.get(key)\n    if (value === undefined) return undefined\n\n    return fromLruValue(value)\n  }\n\n  set(key: K, value: V): void {\n    this.#cache.set(key, toLruValue(value))\n  }\n\n  del(key: K): void {\n    this.#cache.delete(key)\n  }\n\n  clear(): void {\n    this.#cache.clear()\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AACA,MAAA,mCAAoC;AAEpC,MAAA,iCAA6C;AA+C7C,8EAA8E;AAC9E,MAAM,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC,CAAA;AAIrC,MAAM,UAAU,GAAG,CAAkB,KAAQ,EAAE,CAC5C,CAD8C,CAC/C,GAAM,KAAK,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,CAAkB,CAAA;AACxD,MAAM,YAAY,GAAG,CAAkB,KAAoB,EAAE,CAC1D,CAD4D,CAC7D,GAAM,KAAK,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAM,CAAA;AAE5C,MAAa,iBAAiB;IAK5B,YAAY,EAAE,eAAe,EAAE,GAAG,OAAO,EAAkC,CAAA;QAF3E,yBAAA,GAAA,CAAA,IAAA,EAAA,KAAA,GAAkC;QAGhC,uBAAA,IAAI,EAAA,0BAAU,IAAI,YAAA,QAAQ,CAAmB;YAC3C,GAAG,OAAO;YACV,UAAU,EAAE,KAAK;YACjB,cAAc,EAAE,KAAK;YACrB,cAAc,EAAE,KAAK;YACrB,eAAe,EAAE,eAAe,GAC5B,CAAC,KAAK,EAAE,GAAG,EAAE,CAAG,CAAD,cAAgB,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE,GAAG,CAAC,GACzD,OAAO,CAAC,YAAY,IAAI,IAAI,IAAI,OAAO,CAAC,OAAO,IAAI,IAAI,GAErD,UAAA,iBAAiB,GACjB,SAAS;SAChB,CAAC,EAAA,IAAA,CAAA;IACJ,CAAC;IAED,GAAG,CAAC,GAAM,EAAA;QACR,MAAM,KAAK,GAAG,uBAAA,IAAI,EAAA,0BAAA,IAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;QAClC,IAAI,KAAK,KAAK,SAAS,EAAE,OAAO,SAAS,CAAA;QAEzC,OAAO,YAAY,CAAC,KAAK,CAAC,CAAA;IAC5B,CAAC;IAED,GAAG,CAAC,GAAM,EAAE,KAAQ,EAAA;QAClB,uBAAA,IAAI,EAAA,0BAAA,IAAO,CAAC,GAAG,CAAC,GAAG,EAAE,UAAU,CAAC,KAAK,CAAC,CAAC,CAAA;IACzC,CAAC;IAED,GAAG,CAAC,GAAM,EAAA;QACR,uBAAA,IAAI,EAAA,0BAAA,IAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;IACzB,CAAC;IAED,KAAK,GAAA;QACH,uBAAA,IAAI,EAAA,0BAAA,IAAO,CAAC,KAAK,EAAE,CAAA;IACrB,CAAC;CACF;AAtCD,QAAA,iBAAA,GAAA,kBAsCC","ignoreList":[0]}},
    {"offset": {"line": 13196, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13201, "column": 0}, "map": {"version":3,"file":"did-cache-memory.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/did-cache-memory.ts"],"sourcesContent":["import { Did, DidDocument } from '@atproto/did'\nimport {\n  SimpleStoreMemory,\n  SimpleStoreMemoryOptions,\n} from '@atproto-labs/simple-store-memory'\n\nimport { DidCache } from './did-cache.js'\n\nconst DEFAULT_TTL = 3600 * 1000 // 1 hour\nconst DEFAULT_MAX_SIZE = 50 * 1024 * 1024 // ~50MB\n\nexport type DidCacheMemoryOptions = SimpleStoreMemoryOptions<Did, DidDocument>\n\nexport class DidCacheMemory\n  extends SimpleStoreMemory<Did, DidDocument>\n  implements DidCache\n{\n  constructor(options?: DidCacheMemoryOptions) {\n    super(\n      options?.max == null\n        ? { ttl: DEFAULT_TTL, maxSize: DEFAULT_MAX_SIZE, ...options }\n        : { ttl: DEFAULT_TTL, ...options },\n    )\n  }\n}\n"],"names":[],"mappings":";;;;;AACA,MAAA,qEAG0C;AAI1C,MAAM,WAAW,GAAG,IAAI,GAAG,IAAI,CAAA,CAAC,SAAS;AACzC,MAAM,gBAAgB,GAAG,EAAE,GAAG,IAAI,GAAG,IAAI,CAAA,CAAC,QAAQ;AAIlD,MAAa,cACX,SAAQ,sBAAA,iBAAmC;IAG3C,YAAY,OAA+B,CAAA;QACzC,KAAK,CACH,OAAO,EAAE,GAAG,IAAI,IAAI,GAChB;YAAE,GAAG,EAAE,WAAW;YAAE,OAAO,EAAE,gBAAgB;YAAE,GAAG,OAAO;QAAA,CAAE,GAC3D;YAAE,GAAG,EAAE,WAAW;YAAE,GAAG,OAAO;QAAA,CAAE,CACrC,CAAA;IACH,CAAC;CACF;AAXD,QAAA,cAAA,GAAA,eAWC","ignoreList":[0]}},
    {"offset": {"line": 13222, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13227, "column": 0}, "map": {"version":3,"file":"did-cache.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/did-cache.ts"],"sourcesContent":["import { CachedGetter, SimpleStore } from '@atproto-labs/simple-store'\nimport { Did, DidDocument } from '@atproto/did'\n\nimport { DidCacheMemory } from './did-cache-memory.js'\nimport { DidMethod, ResolveDidOptions } from './did-method.js'\nimport { DidResolver, ResolvedDocument } from './did-resolver.js'\n\nexport type { DidMethod, ResolvedDocument, ResolveDidOptions }\n\nexport type DidCache = SimpleStore<Did, DidDocument>\n\nexport type DidResolverCachedOptions = { cache?: DidCache }\n\nexport class DidResolverCached<M extends string = string>\n  implements DidResolver<M>\n{\n  protected readonly getter: CachedGetter<Did, DidDocument>\n  constructor(\n    resolver: DidResolver<M>,\n    cache: DidCache = new DidCacheMemory(),\n  ) {\n    this.getter = new CachedGetter<Did, DidDocument>(\n      (did, options) => resolver.resolve(did, options),\n      cache,\n    )\n  }\n\n  public async resolve<D extends Did>(did: D, options?: ResolveDidOptions) {\n    return this.getter.get(did, options) as Promise<ResolvedDocument<D, M>>\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uDAAsE;AAGtE,MAAA,yDAAsD;AAUtD,MAAa,iBAAiB;IAI5B,YACE,QAAwB,EACxB,QAAkB,IAAI,sBAAA,cAAc,EAAE,CAAA;QAHrB,OAAA,cAAA,CAAA,IAAA,EAAA,UAAA;;;;;WAAsC;QAKvD,IAAI,CAAC,MAAM,GAAG,IAAI,eAAA,YAAY,CAC5B,CAAC,GAAG,EAAE,OAAO,EAAE,CAAG,CAAD,OAAS,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC,EAChD,KAAK,CACN,CAAA;IACH,CAAC;IAEM,KAAK,CAAC,OAAO,CAAgB,GAAM,EAAE,OAA2B,EAAA;QACrE,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,OAAO,CAAoC,CAAA;IACzE,CAAC;CACF;AAjBD,QAAA,iBAAA,GAAA,kBAiBC","ignoreList":[0]}},
    {"offset": {"line": 13249, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13254, "column": 0}, "map": {"version":3,"file":"did-method.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/did-method.ts"],"sourcesContent":["import { Did, DidDocument } from '@atproto/did'\n\nexport type ResolveDidOptions = {\n  signal?: AbortSignal\n  noCache?: boolean\n}\n\nexport interface DidMethod<Method extends string> {\n  resolve: (\n    did: Did<Method>,\n    options?: ResolveDidOptions,\n  ) => DidDocument | PromiseLike<DidDocument>\n}\n\nexport type DidMethods<M extends string> = {\n  [K in M]: DidMethod<K>\n}\n"],"names":[],"mappings":"","ignoreList":[0]}},
    {"offset": {"line": 13258, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13263, "column": 0}, "map": {"version":3,"file":"did-resolver-base.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/did-resolver-base.ts"],"sourcesContent":["import { FetchRequestError } from '@atproto-labs/fetch'\nimport { Did, DidError, extractDidMethod } from '@atproto/did'\nimport { ZodError } from 'zod'\n\nimport { DidMethod, DidMethods, ResolveDidOptions } from './did-method.js'\nimport { DidResolver, ResolvedDocument } from './did-resolver.js'\n\nexport type { DidMethod, ResolvedDocument, ResolveDidOptions }\n\nexport class DidResolverBase<M extends string = string>\n  implements DidResolver<M>\n{\n  protected readonly methods: Map<string, DidMethod<M>>\n\n  constructor(methods: DidMethods<M>) {\n    this.methods = new Map(Object.entries(methods))\n  }\n\n  async resolve<D extends Did>(\n    did: D,\n    options?: ResolveDidOptions,\n  ): Promise<ResolvedDocument<D, M>> {\n    options?.signal?.throwIfAborted()\n\n    const method = extractDidMethod(did)\n    const resolver = this.methods.get(method)\n    if (!resolver) {\n      throw new DidError(\n        did,\n        `Unsupported DID method`,\n        'did-method-invalid',\n        400,\n      )\n    }\n\n    try {\n      const document = await resolver.resolve(did as Did<M>, options)\n      if (document.id !== did) {\n        throw new DidError(\n          did,\n          `DID document id (${document.id}) does not match DID`,\n          'did-document-id-mismatch',\n          400,\n        )\n      }\n\n      return document as ResolvedDocument<D, M>\n    } catch (err) {\n      if (err instanceof FetchRequestError) {\n        throw new DidError(did, err.message, 'did-fetch-error', 400, err)\n      }\n\n      if (err instanceof ZodError) {\n        throw new DidError(\n          did,\n          err.message,\n          'did-document-format-error',\n          503,\n          err,\n        )\n      }\n\n      throw DidError.from(err, did)\n    }\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,yCAAuD;AACvD,MAAA,gCAA8D;AAC9D,MAAA,uBAA8B;AAO9B,MAAa,eAAe;IAK1B,YAAY,OAAsB,CAAA;QAFf,OAAA,cAAA,CAAA,IAAA,EAAA,WAAA;;;;;WAAkC;QAGnD,IAAI,CAAC,OAAO,GAAG,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAA;IACjD,CAAC;IAED,KAAK,CAAC,OAAO,CACX,GAAM,EACN,OAA2B,EAAA;QAE3B,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QAEjC,MAAM,MAAM,GAAG,CAAA,GAAA,MAAA,gBAAgB,EAAC,GAAG,CAAC,CAAA;QACpC,MAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;QACzC,IAAI,CAAC,QAAQ,EAAE,CAAC;YACd,MAAM,IAAI,MAAA,QAAQ,CAChB,GAAG,EACH,CAAA,sBAAA,CAAwB,EACxB,oBAAoB,EACpB,GAAG,CACJ,CAAA;QACH,CAAC;QAED,IAAI,CAAC;YACH,MAAM,QAAQ,GAAG,MAAM,QAAQ,CAAC,OAAO,CAAC,GAAa,EAAE,OAAO,CAAC,CAAA;YAC/D,IAAI,QAAQ,CAAC,EAAE,KAAK,GAAG,EAAE,CAAC;gBACxB,MAAM,IAAI,MAAA,QAAQ,CAChB,GAAG,EACH,CAAA,iBAAA,EAAoB,QAAQ,CAAC,EAAE,CAAA,oBAAA,CAAsB,EACrD,0BAA0B,EAC1B,GAAG,CACJ,CAAA;YACH,CAAC;YAED,OAAO,QAAkC,CAAA;QAC3C,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;YACb,IAAI,GAAG,YAAY,QAAA,iBAAiB,EAAE,CAAC;gBACrC,MAAM,IAAI,MAAA,QAAQ,CAAC,GAAG,EAAE,GAAG,CAAC,OAAO,EAAE,iBAAiB,EAAE,GAAG,EAAE,GAAG,CAAC,CAAA;YACnE,CAAC;YAED,IAAI,GAAG,YAAY,MAAA,QAAQ,EAAE,CAAC;gBAC5B,MAAM,IAAI,MAAA,QAAQ,CAChB,GAAG,EACH,GAAG,CAAC,OAAO,EACX,2BAA2B,EAC3B,GAAG,EACH,GAAG,CACJ,CAAA;YACH,CAAC;YAED,MAAM,MAAA,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAAA;QAC/B,CAAC;IACH,CAAC;CACF;AAxDD,QAAA,eAAA,GAAA,gBAwDC","ignoreList":[0]}},
    {"offset": {"line": 13306, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13311, "column": 0}, "map": {"version":3,"file":"plc.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/methods/plc.ts"],"sourcesContent":["import {\n  Fetch,\n  bindFetch,\n  fetchJsonProcessor,\n  fetchJsonZodProcessor,\n  fetchOkProcessor,\n} from '@atproto-labs/fetch'\nimport { pipe } from '@atproto-labs/pipe'\nimport { Did, assertDidPlc, didDocumentValidator } from '@atproto/did'\n\nimport { DidMethod, ResolveDidOptions } from '../did-method.js'\n\nconst fetchSuccessHandler = pipe(\n  fetchOkProcessor(),\n  fetchJsonProcessor(/^application\\/(did\\+ld\\+)?json$/),\n  fetchJsonZodProcessor(didDocumentValidator),\n)\n\nexport type DidPlcMethodOptions = {\n  /**\n   * @default globalThis.fetch\n   */\n  fetch?: Fetch\n\n  /**\n   * @default 'https://plc.directory/'\n   */\n  plcDirectoryUrl?: string | URL\n}\n\nexport class DidPlcMethod implements DidMethod<'plc'> {\n  protected readonly fetch: Fetch<unknown>\n\n  public readonly plcDirectoryUrl: URL\n\n  constructor(options?: DidPlcMethodOptions) {\n    this.plcDirectoryUrl = new URL(\n      options?.plcDirectoryUrl || 'https://plc.directory/',\n    )\n    this.fetch = bindFetch(options?.fetch)\n  }\n\n  async resolve(did: Did<'plc'>, options?: ResolveDidOptions) {\n    // Although the did should start with `did:plc:` (thanks to typings), we\n    // should still check if the msid is valid.\n    assertDidPlc(did)\n\n    const url = new URL(`/${encodeURIComponent(did)}`, this.plcDirectoryUrl)\n\n    return this.fetch(url, {\n      redirect: 'error',\n      headers: { accept: 'application/did+ld+json,application/json' },\n      signal: options?.signal,\n    }).then(fetchSuccessHandler)\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,yCAM4B;AAC5B,MAAA,uCAAyC;AACzC,MAAA,gCAAsE;AAItE,MAAM,mBAAmB,GAAG,CAAA,GAAA,OAAA,IAAI,EAC9B,CAAA,GAAA,QAAA,gBAAgB,GAAE,EAClB,CAAA,GAAA,QAAA,kBAAkB,EAAC,iCAAiC,CAAC,EACrD,CAAA,GAAA,QAAA,qBAAqB,EAAC,MAAA,oBAAoB,CAAC,CAC5C,CAAA;AAcD,MAAa,YAAY;IAKvB,YAAY,OAA6B,CAAA;QAJtB,OAAA,cAAA,CAAA,IAAA,EAAA,SAAA;;;;;WAAqB;QAExB,OAAA,cAAA,CAAA,IAAA,EAAA,mBAAA;;;;;WAAoB;QAGlC,IAAI,CAAC,eAAe,GAAG,IAAI,GAAG,CAC5B,OAAO,EAAE,eAAe,IAAI,wBAAwB,CACrD,CAAA;QACD,IAAI,CAAC,KAAK,GAAG,CAAA,GAAA,QAAA,SAAS,EAAC,OAAO,EAAE,KAAK,CAAC,CAAA;IACxC,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,GAAe,EAAE,OAA2B,EAAA;QACxD,wEAAwE;QACxE,2CAA2C;QAC3C,CAAA,GAAA,MAAA,YAAY,EAAC,GAAG,CAAC,CAAA;QAEjB,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,CAAA,CAAA,EAAI,kBAAkB,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,eAAe,CAAC,CAAA;QAExE,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE;YACrB,QAAQ,EAAE,OAAO;YACjB,OAAO,EAAE;gBAAE,MAAM,EAAE,0CAA0C;YAAA,CAAE;YAC/D,MAAM,EAAE,OAAO,EAAE,MAAM;SACxB,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAA;IAC9B,CAAC;CACF;AAzBD,QAAA,YAAA,GAAA,aAyBC","ignoreList":[0]}},
    {"offset": {"line": 13352, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13357, "column": 0}, "map": {"version":3,"file":"web.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/methods/web.ts"],"sourcesContent":["import {\n  bindFetch,\n  Fetch,\n  fetchJsonProcessor,\n  fetchJsonZodProcessor,\n  fetchOkProcessor,\n} from '@atproto-labs/fetch'\nimport { pipe } from '@atproto-labs/pipe'\nimport { Did, didDocumentValidator, didWebToUrl } from '@atproto/did'\n\nimport { DidMethod, ResolveDidOptions } from '../did-method.js'\n\nconst fetchSuccessHandler = pipe(\n  fetchOkProcessor(),\n  fetchJsonProcessor(/^application\\/(did\\+ld\\+)?json$/),\n  fetchJsonZodProcessor(didDocumentValidator),\n)\n\nexport type DidWebMethodOptions = {\n  fetch?: Fetch\n  /** @default true */\n  allowHttp?: boolean\n}\n\nexport class DidWebMethod implements DidMethod<'web'> {\n  protected readonly fetch: Fetch<unknown>\n  protected readonly allowHttp: boolean\n\n  constructor({\n    fetch = globalThis.fetch,\n    allowHttp = true,\n  }: DidWebMethodOptions = {}) {\n    this.fetch = bindFetch(fetch)\n    this.allowHttp = allowHttp\n  }\n\n  async resolve(did: Did<'web'>, options?: ResolveDidOptions) {\n    const didDocumentUrl = buildDidWebDocumentUrl(did)\n\n    if (!this.allowHttp && didDocumentUrl.protocol === 'http:') {\n      throw new Error(\n        `Cannot resolve DID document for localhost: ${didDocumentUrl}`,\n      )\n    }\n\n    // Note we do not explicitly check for \"localhost\" here. Instead, we rely on\n    // the injected 'fetch' function to handle the URL. If the URL is\n    // \"localhost\", or resolves to a private IP address, the fetch function is\n    // responsible for handling it.\n\n    return this.fetch(didDocumentUrl, {\n      redirect: 'error',\n      headers: { accept: 'application/did+ld+json,application/json' },\n      signal: options?.signal,\n    }).then(fetchSuccessHandler)\n  }\n}\n\n/**\n * @see {@link https://datatracker.ietf.org/doc/html/rfc8615}\n * @see {@link https://w3c-ccg.github.io/did-method-web/#create-register}\n */\nexport function buildDidWebDocumentUrl(did: Did<'web'>) {\n  const url = didWebToUrl(did) // Will throw if the DID is invalid\n\n  // Note: DID cannot end with an `:`, so they cannot end with a `/`. This is\n  // true unless when there is no path at all, in which case the URL constructor\n  // will set the pathname to `/`.\n\n  // https://w3c-ccg.github.io/did-method-web/#read-resolve\n  if (url.pathname === '/') {\n    return new URL(`/.well-known/did.json`, url)\n  } else {\n    return new URL(`${url.pathname}/did.json`, url)\n  }\n}\n"],"names":[],"mappings":";;;;;AA8DA,QAAA,sBAAA,GAAA,uBAaC;AA3ED,MAAA,yCAM4B;AAC5B,MAAA,uCAAyC;AACzC,MAAA,gCAAqE;AAIrE,MAAM,mBAAmB,GAAG,CAAA,GAAA,OAAA,IAAI,EAC9B,CAAA,GAAA,QAAA,gBAAgB,GAAE,EAClB,CAAA,GAAA,QAAA,kBAAkB,EAAC,iCAAiC,CAAC,EACrD,CAAA,GAAA,QAAA,qBAAqB,EAAC,MAAA,oBAAoB,CAAC,CAC5C,CAAA;AAQD,MAAa,YAAY;IAIvB,YAAY,EACV,KAAK,GAAG,UAAU,CAAC,KAAK,EACxB,SAAS,GAAG,IAAI,EAAA,GACO,CAAA,CAAE,CAAA;QANR,OAAA,cAAA,CAAA,IAAA,EAAA,SAAA;;;;;WAAqB;QACrB,OAAA,cAAA,CAAA,IAAA,EAAA,aAAA;;;;;WAAkB;QAMnC,IAAI,CAAC,KAAK,GAAG,CAAA,GAAA,QAAA,SAAS,EAAC,KAAK,CAAC,CAAA;QAC7B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;IAC5B,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,GAAe,EAAE,OAA2B,EAAA;QACxD,MAAM,cAAc,GAAG,sBAAsB,CAAC,GAAG,CAAC,CAAA;QAElD,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,cAAc,CAAC,QAAQ,KAAK,OAAO,EAAE,CAAC;YAC3D,MAAM,IAAI,KAAK,CACb,CAAA,2CAAA,EAA8C,cAAc,EAAE,CAC/D,CAAA;QACH,CAAC;QAED,4EAA4E;QAC5E,iEAAiE;QACjE,0EAA0E;QAC1E,+BAA+B;QAE/B,OAAO,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE;YAChC,QAAQ,EAAE,OAAO;YACjB,OAAO,EAAE;gBAAE,MAAM,EAAE,0CAA0C;YAAA,CAAE;YAC/D,MAAM,EAAE,OAAO,EAAE,MAAM;SACxB,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAA;IAC9B,CAAC;CACF;AAhCD,QAAA,YAAA,GAAA,aAgCC;AAED;;;GAGG,CACH,SAAgB,sBAAsB,CAAC,GAAe;IACpD,MAAM,GAAG,GAAG,CAAA,GAAA,MAAA,WAAW,EAAC,GAAG,CAAC,CAAA,CAAC,mCAAmC;IAEhE,2EAA2E;IAC3E,8EAA8E;IAC9E,gCAAgC;IAEhC,yDAAyD;IACzD,IAAI,GAAG,CAAC,QAAQ,KAAK,GAAG,EAAE,CAAC;QACzB,OAAO,IAAI,GAAG,CAAC,CAAA,qBAAA,CAAuB,EAAE,GAAG,CAAC,CAAA;IAC9C,CAAC,MAAM,CAAC;QACN,OAAO,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAA,SAAA,CAAW,EAAE,GAAG,CAAC,CAAA;IACjD,CAAC;AACH,CAAC","ignoreList":[0]}},
    {"offset": {"line": 13418, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13423, "column": 0}, "map": {"version":3,"file":"did-resolver-common.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/did-resolver-common.ts"],"sourcesContent":["import { DidResolverBase } from './did-resolver-base.js'\nimport { DidPlcMethod, DidPlcMethodOptions } from './methods/plc.js'\nimport { DidWebMethod, DidWebMethodOptions } from './methods/web.js'\nimport { Simplify } from './util.js'\n\nexport type DidResolverCommonOptions = Simplify<\n  DidPlcMethodOptions & DidWebMethodOptions\n>\n\nexport class DidResolverCommon\n  extends DidResolverBase<'plc' | 'web'>\n  implements DidResolverBase<'plc' | 'web'>\n{\n  constructor(options?: DidResolverCommonOptions) {\n    super({\n      plc: new DidPlcMethod(options),\n      web: new DidWebMethod(options),\n    })\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,2DAAwD;AACxD,MAAA,uCAAoE;AACpE,MAAA,uCAAoE;AAOpE,MAAa,iBACX,SAAQ,uBAAA,eAA8B;IAGtC,YAAY,OAAkC,CAAA;QAC5C,KAAK,CAAC;YACJ,GAAG,EAAE,IAAI,SAAA,YAAY,CAAC,OAAO,CAAC;YAC9B,GAAG,EAAE,IAAI,SAAA,YAAY,CAAC,OAAO,CAAC;SAC/B,CAAC,CAAA;IACJ,CAAC;CACF;AAVD,QAAA,iBAAA,GAAA,kBAUC","ignoreList":[0]}},
    {"offset": {"line": 13440, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13445, "column": 0}, "map": {"version":3,"file":"did-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/did-resolver.ts"],"sourcesContent":["import { Did, DidDocument } from '@atproto/did'\n\nimport { ResolveDidOptions } from './did-method.js'\n\nexport type ResolvedDocument<D extends Did, M extends string = string> =\n  D extends Did<infer N>\n    ? DidDocument<N extends string ? M : N extends M ? N : never>\n    : never\n\nexport interface DidResolver<M extends string = string> {\n  resolve<D extends Did>(\n    did: D,\n    options?: ResolveDidOptions,\n  ): Promise<ResolvedDocument<D, M>>\n}\n"],"names":[],"mappings":"","ignoreList":[0]}},
    {"offset": {"line": 13449, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13454, "column": 0}, "map": {"version":3,"file":"methods.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/methods.ts"],"sourcesContent":["export * from './methods/plc.js'\nexport * from './methods/web.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,uIAAA,SAAgC;AAChC,uIAAA,SAAgC","ignoreList":[0]}},
    {"offset": {"line": 13479, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13484, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/util.ts"],"sourcesContent":["export type Simplify<T> = { [K in keyof T]: T[K] } & NonNullable<unknown>\n"],"names":[],"mappings":"","ignoreList":[0]}},
    {"offset": {"line": 13488, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13493, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/did-resolver/src/index.ts"],"sourcesContent":["export * from '@atproto/did'\n\nexport * from './did-cache-memory.js'\nexport * from './did-cache.js'\nexport * from './did-method.js'\nexport * from './did-resolver-common.js'\nexport * from './did-resolver.js'\nexport * from './methods.js'\nexport * from './util.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,mHAAA,SAA4B;AAE5B,4IAAA,SAAqC;AACrC,qIAAA,SAA8B;AAC9B,sIAAA,SAA+B;AAC/B,+IAAA,SAAwC;AACxC,wIAAA,SAAiC;AACjC,mIAAA,SAA4B;AAC5B,gIAAA,SAAyB","ignoreList":[0]}},
    {"offset": {"line": 13524, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13529, "column": 0}, "map": {"version":3,"file":"cached-getter.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/simple-store/src/cached-getter.ts"],"sourcesContent":["import { Awaitable, SimpleStore, Key, Value } from './simple-store.js'\n\nexport type GetCachedOptions = {\n  signal?: AbortSignal\n\n  /**\n   * Do not use the cache to get the value. Always get a new value from the\n   * getter function.\n   *\n   * @default false\n   */\n  noCache?: boolean\n\n  /**\n   * When getting a value from the cache, allow the value to be returned even if\n   * it is stale.\n   *\n   * Has no effect if the `isStale` option was not provided to the CachedGetter.\n   *\n   * @default true // If the CachedGetter has an isStale option\n   * @default false // If no isStale option was provided to the CachedGetter\n   */\n  allowStale?: boolean\n}\n\nexport type Getter<K, V> = (\n  key: K,\n  options: undefined | GetCachedOptions,\n  storedValue: undefined | V,\n) => Awaitable<V>\n\nexport type CachedGetterOptions<K, V> = {\n  isStale?: (key: K, value: V) => boolean | PromiseLike<boolean>\n  onStoreError?: (err: unknown, key: K, value: V) => void | PromiseLike<void>\n  deleteOnError?: (\n    err: unknown,\n    key: K,\n    value: V,\n  ) => boolean | PromiseLike<boolean>\n}\n\ntype PendingItem<V> = Promise<{ value: V; isFresh: boolean }>\n\nconst returnTrue = () => true\nconst returnFalse = () => false\n\n/**\n * Wrapper utility that uses a store to speed up the retrieval of values from an\n * (expensive) getter function.\n */\nexport class CachedGetter<K extends Key = string, V extends Value = Value> {\n  private pending = new Map<K, PendingItem<V>>()\n\n  constructor(\n    readonly getter: Getter<K, V>,\n    readonly store: SimpleStore<K, V>,\n    readonly options?: Readonly<CachedGetterOptions<K, V>>,\n  ) {}\n\n  async get(key: K, options?: GetCachedOptions): Promise<V> {\n    options?.signal?.throwIfAborted()\n\n    const isStale = this.options?.isStale\n\n    const allowStored: (value: V) => Awaitable<boolean> = options?.noCache\n      ? returnFalse // Never allow stored values to be returned\n      : options?.allowStale || isStale == null\n        ? returnTrue // Always allow stored values to be returned\n        : async (value: V) => !(await isStale(key, value))\n\n    // As long as concurrent requests are made for the same key, only one\n    // request will be made to the cache & getter function at a time. This works\n    // because there is no async operation between the while() loop and the\n    // pending.set() call. Because of the \"single threaded\" nature of\n    // JavaScript, the pending item will be set before the next iteration of the\n    // while loop.\n    let previousExecutionFlow: undefined | PendingItem<V>\n    while ((previousExecutionFlow = this.pending.get(key))) {\n      try {\n        const { isFresh, value } = await previousExecutionFlow\n\n        if (isFresh) return value\n        if (await allowStored(value)) return value\n      } catch {\n        // Ignore errors from previous execution flows (they will have been\n        // propagated by that flow).\n      }\n\n      options?.signal?.throwIfAborted()\n    }\n\n    const currentExecutionFlow: PendingItem<V> = Promise.resolve()\n      .then(async () => {\n        const storedValue = await this.getStored(key, options)\n        if (storedValue !== undefined && (await allowStored(storedValue))) {\n          // Use the stored value as return value for the current execution\n          // flow. Notify other concurrent execution flows (that should be\n          // \"stuck\" in the loop before until this promise resolves) that we got\n          // a value, but that it came from the store (isFresh = false).\n          return { isFresh: false, value: storedValue }\n        }\n\n        return Promise.resolve()\n          .then(async () => (0, this.getter)(key, options, storedValue))\n          .catch(async (err) => {\n            if (storedValue !== undefined) {\n              try {\n                const deleteOnError = this.options?.deleteOnError\n                if (await deleteOnError?.(err, key, storedValue)) {\n                  await this.delStored(key, err)\n                }\n              } catch (error) {\n                throw new AggregateError(\n                  [err, error],\n                  'Error while deleting stored value',\n                )\n              }\n            }\n            throw err\n          })\n          .then(async (value) => {\n            // The value should be stored even is the signal was aborted.\n            await this.setStored(key, value)\n            return { isFresh: true, value }\n          })\n      })\n      .finally(() => {\n        this.pending.delete(key)\n      })\n\n    if (this.pending.has(key)) {\n      // This should never happen. Indeed, there must not be any 'await'\n      // statement between this and the loop iteration check meaning that\n      // this.pending.get returned undefined. It is there to catch bugs that\n      // would occur in future changes to the code.\n      throw new Error('Concurrent request for the same key')\n    }\n\n    this.pending.set(key, currentExecutionFlow)\n\n    const { value } = await currentExecutionFlow\n    return value\n  }\n\n  bind(key: K): (options?: GetCachedOptions) => Promise<V> {\n    return async (options) => this.get(key, options)\n  }\n\n  async getStored(key: K, options?: GetCachedOptions): Promise<V | undefined> {\n    try {\n      return await this.store.get(key, options)\n    } catch (err) {\n      return undefined\n    }\n  }\n\n  async setStored(key: K, value: V): Promise<void> {\n    try {\n      await this.store.set(key, value)\n    } catch (err) {\n      const onStoreError = this.options?.onStoreError\n      await onStoreError?.(err, key, value)\n    }\n  }\n\n  async delStored(key: K, _cause?: unknown): Promise<void> {\n    await this.store.del(key)\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 13662, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13667, "column": 0}, "map": {"version":3,"file":"simple-store.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/simple-store/src/simple-store.ts"],"sourcesContent":["export type Awaitable<V> = V | PromiseLike<V>\n\nexport type Key = string | number\nexport type Value = NonNullable<unknown> | null\n\nexport type GetOptions = { signal?: AbortSignal }\n\nexport interface SimpleStore<K extends Key = string, V extends Value = Value> {\n  /**\n   * @return undefined if the key is not in the store (which is why Value cannot contain \"undefined\").\n   */\n  get: (key: K, options?: GetOptions) => Awaitable<undefined | V>\n  set: (key: K, value: V) => Awaitable<void>\n  del: (key: K) => Awaitable<void>\n  clear?: () => Awaitable<void>\n}\n"],"names":[],"mappings":"","ignoreList":[0]}},
    {"offset": {"line": 13671, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13676, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/simple-store/src/index.ts"],"sourcesContent":["export * from './cached-getter.js'\nexport * from './simple-store.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,yIAAA,SAAkC;AAClC,wIAAA,SAAiC","ignoreList":[0]}},
    {"offset": {"line": 13701, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13706, "column": 0}, "map": {"version":3,"file":"fetch-error.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/fetch/src/fetch-error.ts"],"sourcesContent":["export abstract class FetchError extends Error {\n  constructor(\n    public readonly statusCode: number,\n    message?: string,\n    options?: ErrorOptions,\n  ) {\n    super(message, options)\n  }\n\n  get expose() {\n    return true\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAsB,UAAW,SAAQ,KAAK;IAC5C,YACkB,UAAkB,EAClC,OAAgB,EAChB,OAAsB,CAAA;QAEtB,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;QAJvB,OAAA,cAAA,CAAA,IAAA,EAAA,cAAA;;;;mBAAgB,UAAU;WAAQ;IAKpC,CAAC;IAED,IAAI,MAAM,GAAA;QACR,OAAO,IAAI,CAAA;IACb,CAAC;CACF;AAZD,QAAA,UAAA,GAAA,WAYC","ignoreList":[0]}},
    {"offset": {"line": 13726, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13731, "column": 0}, "map": {"version":3,"file":"fetch.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/fetch/src/fetch.ts"],"sourcesContent":["import { ThisParameterOverride } from './util.js'\n\nexport type FetchContext = void | null | typeof globalThis\n\nexport type FetchBound = (\n  input: string | URL | Request,\n  init?: RequestInit,\n) => Promise<Response>\n\n// NOT using \"typeof globalThis.fetch\" here because \"globalThis.fetch\" does not\n// have a \"this\" parameter, while runtimes do ensure that \"fetch\" is called with\n// the correct \"this\" parameter (either null, undefined, or window).\n\nexport type Fetch<C = FetchContext> = ThisParameterOverride<C, FetchBound>\n\nexport type SimpleFetchBound = (input: Request) => Promise<Response>\nexport type SimpleFetch<C = FetchContext> = ThisParameterOverride<\n  C,\n  SimpleFetchBound\n>\n\nexport function toRequestTransformer<C, O>(\n  requestTransformer: (this: C, input: Request) => O,\n): ThisParameterOverride<\n  C,\n  (input: string | URL | Request, init?: RequestInit) => O\n> {\n  return function (this: C, input, init) {\n    return requestTransformer.call(this, asRequest(input, init))\n  }\n}\n\nexport function asRequest(\n  input: string | URL | Request,\n  init?: RequestInit,\n): Request {\n  if (!init && input instanceof Request) return input\n  return new Request(input, init)\n}\n"],"names":[],"mappings":";;;;AAqBA,QAAA,oBAAA,GAAA,qBASC;AAED,QAAA,SAAA,GAAA,UAMC;AAjBD,SAAgB,oBAAoB,CAClC,kBAAkD;IAKlD,OAAO,SAAmB,KAAK,EAAE,IAAI;QACnC,OAAO,kBAAkB,CAAC,IAAI,CAAC,IAAI,EAAE,SAAS,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAA;IAC9D,CAAC,CAAA;AACH,CAAC;AAED,SAAgB,SAAS,CACvB,KAA6B,EAC7B,IAAkB;IAElB,IAAI,CAAC,IAAI,IAAI,KAAK,YAAY,OAAO,EAAE,OAAO,KAAK,CAAA;IACnD,OAAO,IAAI,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,CAAA;AACjC,CAAC","ignoreList":[0]}},
    {"offset": {"line": 13746, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13751, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/fetch/src/util.ts"],"sourcesContent":["// @TODO: Move some of these to a shared package ?\n\nexport type JsonScalar = string | number | boolean | null\nexport type Json = JsonScalar | Json[] | { [key: string]: undefined | Json }\nexport type JsonObject = { [key: string]: Json }\nexport type JsonArray = Json[]\n\nexport type ThisParameterOverride<\n  C,\n  Fn extends (...a: any) => any,\n> = Fn extends (...args: infer P) => infer R\n  ? ((this: C, ...args: P) => R) & {\n      bind(context: C): (...args: P) => R\n    }\n  : never\n\nexport function isIp(hostname: string) {\n  // IPv4\n  if (hostname.match(/^\\d+\\.\\d+\\.\\d+\\.\\d+$/)) return true\n\n  // IPv6\n  if (hostname.startsWith('[') && hostname.endsWith(']')) return true\n\n  return false\n}\n\nconst plainObjectProto = Object.prototype\nexport const ifObject = <V>(v: V) => {\n  if (typeof v === 'object' && v != null && !Array.isArray(v)) {\n    const proto = Object.getPrototypeOf(v)\n    if (proto === null || proto === plainObjectProto) {\n      // eslint-disable-next-line @typescript-eslint/ban-types\n      return v as V extends JsonScalar | JsonArray | Function | symbol\n        ? never\n        : V extends Json\n          ? V\n          : // Plain object are (mostly) safe to access using a string index\n            Record<string, unknown>\n    }\n  }\n\n  return undefined\n}\n\nexport const ifString = <V>(v: V) => (typeof v === 'string' ? v : undefined)\n\nexport class MaxBytesTransformStream extends TransformStream<\n  Uint8Array,\n  Uint8Array\n> {\n  constructor(maxBytes: number) {\n    // Note: negation accounts for invalid value types (NaN, non numbers)\n    if (!(maxBytes >= 0)) {\n      throw new TypeError('maxBytes must be a non-negative number')\n    }\n\n    let bytesRead = 0\n\n    super({\n      transform: (\n        chunk: Uint8Array,\n        ctrl: TransformStreamDefaultController<Uint8Array>,\n      ) => {\n        if ((bytesRead += chunk.length) <= maxBytes) {\n          ctrl.enqueue(chunk)\n        } else {\n          ctrl.error(new Error('Response too large'))\n        }\n      },\n    })\n  }\n}\n\nconst LINE_BREAK = /\\r?\\n/g\nexport function padLines(input: string, pad: string) {\n  if (!input) return input\n  return pad + input.replace(LINE_BREAK, `$&${pad}`)\n}\n\n/**\n * @param [onCancellationError] - Callback that will trigger to asynchronously\n * handle any error that occurs while cancelling the response body. Providing\n * this will speed up the process and avoid potential deadlocks. Defaults to\n * awaiting the cancellation operation. use `\"log\"` to log the error.\n * @see {@link https://undici.nodejs.org/#/?id=garbage-collection}\n * @note awaiting this function's result, when no `onCancellationError` is\n * provided, might result in a dead lock. Indeed, if the response was cloned(),\n * the response.body.cancel() method will not resolve until the other response's\n * body is consumed/cancelled.\n *\n * @example\n * ```ts\n * // Make sure response was not cloned, or that every cloned response was\n * // consumed/cancelled before awaiting this function's result.\n * await cancelBody(response)\n * ```\n * @example\n * ```ts\n * await cancelBody(response, (err) => {\n *   // No biggie, let's just log the error\n *   console.warn('Failed to cancel response body', err)\n * })\n * ```\n * @example\n * ```ts\n * // Will generate an \"unhandledRejection\" if an error occurs while cancelling\n * // the response body. This will likely crash the process.\n * await cancelBody(response, (err) => { throw err })\n * ```\n */\nexport async function cancelBody(\n  body: Body,\n  onCancellationError?: 'log' | ((err: unknown) => void),\n): Promise<void> {\n  if (\n    body.body &&\n    !body.bodyUsed &&\n    !body.body.locked &&\n    // Support for alternative fetch implementations\n    typeof body.body.cancel === 'function'\n  ) {\n    if (typeof onCancellationError === 'function') {\n      void body.body.cancel().catch(onCancellationError)\n    } else if (onCancellationError === 'log') {\n      void body.body.cancel().catch(logCancellationError)\n    } else {\n      await body.body.cancel()\n    }\n  }\n}\n\nexport function logCancellationError(err: unknown): void {\n  console.warn('Failed to cancel response body', err)\n}\n\nexport async function stringifyMessage(input: Body & { headers: Headers }) {\n  try {\n    const headers = stringifyHeaders(input.headers)\n    const payload = await stringifyBody(input)\n    return headers && payload ? `${headers}\\n${payload}` : headers || payload\n  } finally {\n    void cancelBody(input, 'log')\n  }\n}\n\nfunction stringifyHeaders(headers: Headers) {\n  return Array.from(headers)\n    .map(([name, value]) => `${name}: ${value}`)\n    .join('\\n')\n}\n\nasync function stringifyBody(body: Body) {\n  try {\n    const blob = await body.blob()\n    if (blob.type?.startsWith('text/')) {\n      const text = await blob.text()\n      return JSON.stringify(text)\n    }\n\n    if (/application\\/(?:\\w+\\+)?json/.test(blob.type)) {\n      const text = await blob.text()\n      return text.includes('\\n') ? JSON.stringify(JSON.parse(text)) : text\n    }\n\n    return `[Body size: ${blob.size}, type: ${JSON.stringify(blob.type)} ]`\n  } catch {\n    return '[Body could not be read]'\n  }\n}\n\nexport const extractUrl = (input: Request | string | URL) =>\n  typeof input === 'string'\n    ? new URL(input)\n    : input instanceof URL\n      ? input\n      : new URL(input.url)\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 13882, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13887, "column": 0}, "map": {"version":3,"file":"fetch-request.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/fetch/src/fetch-request.ts"],"sourcesContent":["import { FetchError } from './fetch-error.js'\nimport { asRequest } from './fetch.js'\nimport { extractUrl, isIp } from './util.js'\n\nexport class FetchRequestError extends FetchError {\n  constructor(\n    public readonly request: Request,\n    statusCode?: number,\n    message?: string,\n    options?: ErrorOptions,\n  ) {\n    if (statusCode == null || !message) {\n      const info = extractInfo(extractRootCause(options?.cause))\n      statusCode ??= info[0]\n      message ||= info[1]\n    }\n\n    super(statusCode, message, options)\n  }\n\n  get expose() {\n    // A 500 request error means that the request was not made due to an infra,\n    // programming or server side issue. The message should no be exposed to\n    // downstream clients.\n    return this.statusCode !== 500\n  }\n\n  static from(request: Request, cause: unknown): FetchRequestError {\n    if (cause instanceof FetchRequestError) return cause\n    return new FetchRequestError(request, undefined, undefined, { cause })\n  }\n}\n\nfunction extractRootCause(err: unknown): unknown {\n  // Unwrap the Network error from undici (i.e. Node's internal fetch() implementation)\n  // https://github.com/nodejs/undici/blob/3274c975947ce11a08508743df026f73598bfead/lib/web/fetch/index.js#L223-L228\n  if (\n    err instanceof TypeError &&\n    err.message === 'fetch failed' &&\n    err.cause !== undefined\n  ) {\n    return err.cause\n  }\n\n  return err\n}\n\nfunction extractInfo(err: unknown): [statusCode: number, message: string] {\n  if (typeof err === 'string' && err.length > 0) {\n    return [500, err]\n  }\n\n  if (!(err instanceof Error)) {\n    return [500, 'Failed to fetch']\n  }\n\n  // Undici fetch() \"network\" errors\n  switch (err.message) {\n    case 'failed to fetch the data URL':\n      return [400, err.message]\n    case 'unexpected redirect':\n    case 'cors failure':\n    case 'blocked':\n    case 'proxy authentication required':\n      // These cases could be represented either as a 4xx user error (invalid\n      // URL provided), or as a 5xx server error (server didn't behave as\n      // expected).\n      return [502, err.message]\n  }\n\n  // NodeJS errors\n  const code = err['code']\n  if (typeof code === 'string') {\n    switch (true) {\n      case code === 'ENOTFOUND':\n        return [400, 'Invalid hostname']\n      case code === 'ECONNREFUSED':\n        return [502, 'Connection refused']\n      case code === 'DEPTH_ZERO_SELF_SIGNED_CERT':\n        return [502, 'Self-signed certificate']\n      case code.startsWith('ERR_TLS'):\n        return [502, 'TLS error']\n      case code.startsWith('ECONN'):\n        return [502, 'Connection error']\n      default:\n        return [500, `${code} error`]\n    }\n  }\n\n  return [500, err.message]\n}\n\nexport function protocolCheckRequestTransform(protocols: {\n  'about:'?: boolean\n  'blob:'?: boolean\n  'data:'?: boolean\n  'file:'?: boolean\n  'http:'?: boolean | { allowCustomPort: boolean }\n  'https:'?: boolean | { allowCustomPort: boolean }\n}) {\n  return (input: Request | string | URL, init?: RequestInit) => {\n    const { protocol, port } = extractUrl(input)\n\n    const request = asRequest(input, init)\n\n    const config: undefined | boolean | { allowCustomPort?: boolean } =\n      Object.hasOwn(protocols, protocol) ? protocols[protocol] : undefined\n\n    if (!config) {\n      throw new FetchRequestError(\n        request,\n        400,\n        `Forbidden protocol \"${protocol}\"`,\n      )\n    } else if (config === true) {\n      // Safe to proceed\n    } else if (!config['allowCustomPort'] && port !== '') {\n      throw new FetchRequestError(\n        request,\n        400,\n        `Custom ${protocol} ports not allowed`,\n      )\n    }\n\n    return request\n  }\n}\n\nexport function redirectCheckRequestTransform() {\n  return (input: Request | string | URL, init?: RequestInit) => {\n    const request = asRequest(input, init)\n\n    if (request.redirect === 'follow') {\n      throw new FetchRequestError(\n        request,\n        500,\n        'Request redirect must be \"error\" or \"manual\"',\n      )\n    }\n\n    return request\n  }\n}\n\nexport function requireHostHeaderTransform() {\n  return (input: Request | string | URL, init?: RequestInit) => {\n    // Note that fetch() will automatically add the Host header from the URL and\n    // discard any Host header manually set in the request.\n\n    const { protocol, hostname } = extractUrl(input)\n\n    const request = asRequest(input, init)\n\n    // \"Host\" header only makes sense in the context of an HTTP request\n    if (protocol !== 'http:' && protocol !== 'https:') {\n      throw new FetchRequestError(\n        request,\n        400,\n        `\"${protocol}\" requests are not allowed`,\n      )\n    }\n\n    if (!hostname || isIp(hostname)) {\n      throw new FetchRequestError(request, 400, 'Invalid hostname')\n    }\n\n    return request\n  }\n}\n\nexport const DEFAULT_FORBIDDEN_DOMAIN_NAMES = [\n  'example.com',\n  '*.example.com',\n  'example.org',\n  '*.example.org',\n  'example.net',\n  '*.example.net',\n  'googleusercontent.com',\n  '*.googleusercontent.com',\n]\n\nexport function forbiddenDomainNameRequestTransform(\n  denyList: Iterable<string> = DEFAULT_FORBIDDEN_DOMAIN_NAMES,\n) {\n  const denySet = new Set<string>(denyList)\n\n  // Optimization: if no forbidden domain names are provided, we can skip the\n  // check entirely.\n  if (denySet.size === 0) {\n    return asRequest\n  }\n\n  return async (input: Request | string | URL, init?: RequestInit) => {\n    const { hostname } = extractUrl(input)\n\n    const request = asRequest(input, init)\n\n    // Full domain name check\n    if (denySet.has(hostname)) {\n      throw new FetchRequestError(request, 403, 'Forbidden hostname')\n    }\n\n    // Sub domain name check\n    let curDot = hostname.indexOf('.')\n    while (curDot !== -1) {\n      const subdomain = hostname.slice(curDot + 1)\n      if (denySet.has(`*.${subdomain}`)) {\n        throw new FetchRequestError(request, 403, 'Forbidden hostname')\n      }\n      curDot = hostname.indexOf('.', curDot + 1)\n    }\n\n    return request\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 14085, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14090, "column": 0}, "map": {"version":3,"file":"transformed-response.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/fetch/src/transformed-response.ts"],"sourcesContent":["export class TransformedResponse extends Response {\n  #response: Response\n\n  constructor(response: Response, transform: TransformStream) {\n    if (!response.body) {\n      throw new TypeError('Response body is not available')\n    }\n    if (response.bodyUsed) {\n      throw new TypeError('Response body is already used')\n    }\n\n    super(response.body.pipeThrough(transform), {\n      status: response.status,\n      statusText: response.statusText,\n      headers: response.headers,\n    })\n\n    this.#response = response\n  }\n\n  /**\n   * Some props can't be set through ResponseInit, so we need to proxy them\n   */\n  get url() {\n    return this.#response.url\n  }\n  get redirected() {\n    return this.#response.redirected\n  }\n  get type() {\n    return this.#response.type\n  }\n  get statusText() {\n    return this.#response.statusText\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA,MAAa,mBAAoB,SAAQ,QAAQ;IAG/C,YAAY,QAAkB,EAAE,SAA0B,CAAA;QACxD,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;YACnB,MAAM,IAAI,SAAS,CAAC,gCAAgC,CAAC,CAAA;QACvD,CAAC;QACD,IAAI,QAAQ,CAAC,QAAQ,EAAE,CAAC;YACtB,MAAM,IAAI,SAAS,CAAC,+BAA+B,CAAC,CAAA;QACtD,CAAC;QAED,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,EAAE;YAC1C,MAAM,EAAE,QAAQ,CAAC,MAAM;YACvB,UAAU,EAAE,QAAQ,CAAC,UAAU;YAC/B,OAAO,EAAE,QAAQ,CAAC,OAAO;SAC1B,CAAC,CAAA;QAdJ,8BAAA,GAAA,CAAA,IAAA,EAAA,KAAA,GAAmB;QAgBjB,uBAAA,IAAI,EAAA,+BAAa,QAAQ,EAAA,IAAA,CAAA;IAC3B,CAAC;IAED;;OAEG,CACH,IAAI,GAAG,GAAA;QACL,OAAO,uBAAA,IAAI,EAAA,+BAAA,IAAU,CAAC,GAAG,CAAA;IAC3B,CAAC;IACD,IAAI,UAAU,GAAA;QACZ,OAAO,uBAAA,IAAI,EAAA,+BAAA,IAAU,CAAC,UAAU,CAAA;IAClC,CAAC;IACD,IAAI,IAAI,GAAA;QACN,OAAO,uBAAA,IAAI,EAAA,+BAAA,IAAU,CAAC,IAAI,CAAA;IAC5B,CAAC;IACD,IAAI,UAAU,GAAA;QACZ,OAAO,uBAAA,IAAI,EAAA,+BAAA,IAAU,CAAC,UAAU,CAAA;IAClC,CAAC;CACF;AAnCD,QAAA,mBAAA,GAAA,oBAmCC","ignoreList":[0]}},
    {"offset": {"line": 14140, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14145, "column": 0}, "map": {"version":3,"file":"fetch-response.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/fetch/src/fetch-response.ts"],"sourcesContent":["import { Transformer, pipe } from '@atproto-labs/pipe'\n\n// optional dependency for typing purposes\nimport type { ZodTypeAny, ParseParams, TypeOf } from 'zod'\n\nimport { FetchError } from './fetch-error.js'\nimport { TransformedResponse } from './transformed-response.js'\nimport {\n  Json,\n  MaxBytesTransformStream,\n  cancelBody,\n  ifObject,\n  ifString,\n  logCancellationError,\n} from './util.js'\n\n/**\n * media-type     = type \"/\" subtype *( \";\" parameter )\n * type           = token\n * subtype        = token\n * token          = 1*<any CHAR except CTLs or separators>\n * separators     = \"(\" | \")\" | \"<\" | \">\" | \"@\"\n *                | \",\" | \";\" | \":\" | \"\\\" | <\">\n *                | \"/\" | \"[\" | \"]\" | \"?\" | \"=\"\n *                | \"{\" | \"}\" | SP | HT\n * CTL            = <any US-ASCII control character (octets 0 - 31) and DEL (127)>\n * SP             = <US-ASCII SP, space (32)>\n * HT             = <US-ASCII HT, horizontal-tab (9)>\n * @note The type, subtype, and parameter attribute names are case-insensitive.\n * @see {@link https://datatracker.ietf.org/doc/html/rfc2616#autoid-23}\n */\nconst JSON_MIME = /^application\\/(?:[^()<>@,;:/[\\]\\\\?={} \\t]+\\+)?json$/i\n\nexport type ResponseTransformer = Transformer<Response>\nexport type ResponseMessageGetter = Transformer<Response, string | undefined>\n\nexport class FetchResponseError extends FetchError {\n  constructor(\n    public readonly response: Response,\n    statusCode: number = response.status,\n    message: string = response.statusText,\n    options?: ErrorOptions,\n  ) {\n    super(statusCode, message, options)\n  }\n\n  static async from(\n    response: Response,\n    customMessage: string | ResponseMessageGetter = extractResponseMessage,\n    statusCode = response.status,\n    options?: ErrorOptions,\n  ) {\n    const message =\n      typeof customMessage === 'string'\n        ? customMessage\n        : typeof customMessage === 'function'\n          ? await customMessage(response)\n          : undefined\n\n    return new FetchResponseError(response, statusCode, message, options)\n  }\n}\n\nconst extractResponseMessage: ResponseMessageGetter = async (response) => {\n  const mimeType = extractMime(response)\n  if (!mimeType) return undefined\n\n  try {\n    if (mimeType === 'text/plain') {\n      return await response.text()\n    } else if (JSON_MIME.test(mimeType)) {\n      const json: unknown = await response.json()\n\n      if (typeof json === 'string') return json\n\n      const errorDescription = ifString(ifObject(json)?.['error_description'])\n      if (errorDescription) return errorDescription\n\n      const error = ifString(ifObject(json)?.['error'])\n      if (error) return error\n\n      const message = ifString(ifObject(json)?.['message'])\n      if (message) return message\n    }\n  } catch {\n    // noop\n  }\n\n  return undefined\n}\n\nexport async function peekJson(\n  response: Response,\n  maxSize = Infinity,\n): Promise<undefined | Json> {\n  const type = extractMime(response)\n  if (type !== 'application/json') return undefined\n  checkLength(response, maxSize)\n\n  // 1) Clone the request so we can consume the body\n  const clonedResponse = response.clone()\n\n  // 2) Make sure the request's body is not too large\n  const limitedResponse =\n    response.body && maxSize < Infinity\n      ? new TransformedResponse(\n          clonedResponse,\n          new MaxBytesTransformStream(maxSize),\n        )\n      : // Note: some runtimes (e.g. react-native) don't expose a body property\n        clonedResponse\n\n  // 3) Parse the JSON\n  return limitedResponse.json()\n}\n\nexport function checkLength(response: Response, maxBytes: number) {\n  // Note: negation accounts for invalid value types (NaN, non numbers)\n  if (!(maxBytes >= 0)) {\n    throw new TypeError('maxBytes must be a non-negative number')\n  }\n  const length = extractLength(response)\n  if (length != null && length > maxBytes) {\n    throw new FetchResponseError(response, 502, 'Response too large')\n  }\n  return length\n}\n\nexport function extractLength(response: Response) {\n  const contentLength = response.headers.get('Content-Length')\n  if (contentLength == null) return undefined\n  if (!/^\\d+$/.test(contentLength)) {\n    throw new FetchResponseError(response, 502, 'Invalid Content-Length')\n  }\n  const length = Number(contentLength)\n  if (!Number.isSafeInteger(length)) {\n    throw new FetchResponseError(response, 502, 'Content-Length too large')\n  }\n  return length\n}\n\nexport function extractMime(response: Response) {\n  const contentType = response.headers.get('Content-Type')\n  if (contentType == null) return undefined\n\n  return contentType.split(';', 1)[0]!.trim()\n}\n\n/**\n * If the transformer results in an error, ensure that the response body is\n * consumed as, in some environments (Node 👀), the response will not\n * automatically be GC'd.\n *\n * @see {@link https://undici.nodejs.org/#/?id=garbage-collection}\n * @param [onCancellationError] - Callback to handle any async body cancelling\n * error. Defaults to logging the error. Do not use `null` if the request is\n * cloned.\n */\nexport function cancelBodyOnError<T>(\n  transformer: Transformer<Response, T>,\n  onCancellationError: null | ((err: unknown) => void) = logCancellationError,\n): (response: Response) => Promise<T> {\n  return async (response) => {\n    try {\n      return await transformer(response)\n    } catch (err) {\n      await cancelBody(response, onCancellationError ?? undefined)\n      throw err\n    }\n  }\n}\n\nexport function fetchOkProcessor(\n  customMessage?: string | ResponseMessageGetter,\n): ResponseTransformer {\n  return cancelBodyOnError((response) => {\n    return fetchOkTransformer(response, customMessage)\n  })\n}\n\nexport async function fetchOkTransformer(\n  response: Response,\n  customMessage?: string | ResponseMessageGetter,\n) {\n  if (response.ok) return response\n  throw await FetchResponseError.from(response, customMessage)\n}\n\nexport function fetchMaxSizeProcessor(maxBytes: number): ResponseTransformer {\n  if (maxBytes === Infinity) return (response) => response\n  if (!Number.isFinite(maxBytes) || maxBytes < 0) {\n    throw new TypeError('maxBytes must be a 0, Infinity or a positive number')\n  }\n  return cancelBodyOnError((response) => {\n    return fetchResponseMaxSizeChecker(response, maxBytes)\n  })\n}\n\nexport function fetchResponseMaxSizeChecker(\n  response: Response,\n  maxBytes: number,\n): Response {\n  if (maxBytes === Infinity) return response\n  checkLength(response, maxBytes)\n\n  // Some engines (react-native 👀) don't expose a body property. In that case,\n  // we will only rely on the Content-Length header.\n  if (!response.body) return response\n\n  const transform = new MaxBytesTransformStream(maxBytes)\n  return new TransformedResponse(response, transform)\n}\n\nexport type MimeTypeCheckFn = (mimeType: string) => boolean\nexport type MimeTypeCheck = string | RegExp | MimeTypeCheckFn\n\nexport function fetchTypeProcessor(\n  expectedMime: MimeTypeCheck,\n  contentTypeRequired = true,\n): ResponseTransformer {\n  const isExpected: MimeTypeCheckFn =\n    typeof expectedMime === 'string'\n      ? (mimeType) => mimeType === expectedMime\n      : expectedMime instanceof RegExp\n        ? (mimeType) => expectedMime.test(mimeType)\n        : expectedMime\n\n  return cancelBodyOnError((response) => {\n    return fetchResponseTypeChecker(response, isExpected, contentTypeRequired)\n  })\n}\n\nexport async function fetchResponseTypeChecker(\n  response: Response,\n  isExpectedMime: MimeTypeCheckFn,\n  contentTypeRequired = true,\n): Promise<Response> {\n  const mimeType = extractMime(response)\n  if (mimeType) {\n    if (!isExpectedMime(mimeType.toLowerCase())) {\n      throw await FetchResponseError.from(\n        response,\n        `Unexpected response Content-Type (${mimeType})`,\n        502,\n      )\n    }\n  } else if (contentTypeRequired) {\n    throw await FetchResponseError.from(\n      response,\n      'Missing response Content-Type header',\n      502,\n    )\n  }\n\n  return response\n}\n\nexport type ParsedJsonResponse<T = Json> = {\n  response: Response\n  json: T\n}\n\nexport async function fetchResponseJsonTransformer<T = Json>(\n  response: Response,\n): Promise<ParsedJsonResponse<T>> {\n  try {\n    const json = (await response.json()) as T\n    return { response, json }\n  } catch (cause) {\n    throw new FetchResponseError(\n      response,\n      502,\n      'Unable to parse response as JSON',\n      { cause },\n    )\n  }\n}\n\nexport function fetchJsonProcessor<T = Json>(\n  expectedMime: MimeTypeCheck = JSON_MIME,\n  contentTypeRequired = true,\n): Transformer<Response, ParsedJsonResponse<T>> {\n  return pipe(\n    fetchTypeProcessor(expectedMime, contentTypeRequired),\n    cancelBodyOnError(fetchResponseJsonTransformer<T>),\n  )\n}\n\nexport function fetchJsonZodProcessor<S extends ZodTypeAny>(\n  schema: S,\n  params?: Partial<ParseParams>,\n): Transformer<ParsedJsonResponse, TypeOf<S>> {\n  return async (jsonResponse: ParsedJsonResponse): Promise<TypeOf<S>> =>\n    schema.parseAsync(jsonResponse.json, params)\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 14341, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14346, "column": 0}, "map": {"version":3,"file":"fetch-wrap.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/fetch/src/fetch-wrap.ts"],"sourcesContent":["import { FetchRequestError } from './fetch-request.js'\nimport { Fetch, FetchContext, toRequestTransformer } from './fetch.js'\nimport { TransformedResponse } from './transformed-response.js'\nimport { padLines, stringifyMessage } from './util.js'\n\ntype LogFn<Args extends unknown[]> = (...args: Args) => void | PromiseLike<void>\n\nexport function loggedFetch<C = FetchContext>({\n  fetch = globalThis.fetch as Fetch<C>,\n  logRequest = true as boolean | LogFn<[request: Request]>,\n  logResponse = true as boolean | LogFn<[response: Response, request: Request]>,\n  logError = true as boolean | LogFn<[error: unknown, request: Request]>,\n}) {\n  const onRequest =\n    logRequest === true\n      ? async (request) => {\n          const requestMessage = await stringifyMessage(request)\n          console.info(\n            `> ${request.method} ${request.url}\\n${padLines(requestMessage, '  ')}`,\n          )\n        }\n      : logRequest || undefined\n\n  const onResponse =\n    logResponse === true\n      ? async (response) => {\n          const responseMessage = await stringifyMessage(response.clone())\n          console.info(\n            `< HTTP/1.1 ${response.status} ${response.statusText}\\n${padLines(responseMessage, '  ')}`,\n          )\n        }\n      : logResponse || undefined\n\n  const onError =\n    logError === true\n      ? async (error) => {\n          console.error(`< Error:`, error)\n        }\n      : logError || undefined\n\n  if (!onRequest && !onResponse && !onError) return fetch\n\n  return toRequestTransformer(async function (\n    this: C,\n    request,\n  ): Promise<Response> {\n    if (onRequest) await onRequest(request)\n\n    try {\n      const response = await fetch.call(this, request)\n\n      if (onResponse) await onResponse(response, request)\n\n      return response\n    } catch (error) {\n      if (onError) await onError(error, request)\n\n      throw error\n    }\n  })\n}\n\nexport const timedFetch = <C = FetchContext>(\n  timeout = 60e3,\n  fetch: Fetch<C> = globalThis.fetch,\n): Fetch<C> => {\n  if (timeout === Infinity) return fetch\n  if (!Number.isFinite(timeout) || timeout <= 0) {\n    throw new TypeError('Timeout must be positive')\n  }\n  return toRequestTransformer(async function (\n    this: C,\n    request,\n  ): Promise<Response> {\n    const controller = new AbortController()\n    const signal = controller.signal\n\n    const abort = () => {\n      controller.abort()\n    }\n    const cleanup = () => {\n      clearTimeout(timer)\n      request.signal?.removeEventListener('abort', abort)\n    }\n\n    const timer = setTimeout(abort, timeout)\n    if (typeof timer === 'object') timer.unref?.() // only on node\n    request.signal?.addEventListener('abort', abort)\n\n    signal.addEventListener('abort', cleanup)\n\n    const response = await fetch.call(this, request, { signal })\n\n    if (!response.body) {\n      cleanup()\n      return response\n    } else {\n      // Cleanup the timer & event listeners when the body stream is closed\n      const transform = new TransformStream({ flush: cleanup })\n      return new TransformedResponse(response, transform)\n    }\n  })\n}\n\n/**\n * Wraps a fetch function to bind it to a specific context, and wrap any thrown\n * errors into a FetchRequestError.\n *\n * @example\n *\n * ```ts\n * class MyClient {\n *   constructor(private fetch = globalThis.fetch) {}\n *\n *   async get(url: string) {\n *     // This will generate an error, because the context used is not a\n *     // FetchContext (it's a MyClient instance).\n *     return this.fetch(url)\n *   }\n * }\n * ```\n *\n * @example\n *\n * ```ts\n * class MyClient {\n *   private fetch: Fetch<unknown>\n *\n *   constructor(fetch = globalThis.fetch) {\n *     this.fetch = bindFetch(fetch)\n *   }\n *\n *   async get(url: string) {\n *     return this.fetch(url) // no more error\n *   }\n * }\n * ```\n */\nexport function bindFetch<C = FetchContext>(\n  fetch: Fetch<C> = globalThis.fetch,\n  context: C = globalThis as C,\n) {\n  return toRequestTransformer(async (request) => {\n    try {\n      return await fetch.call(context, request)\n    } catch (err) {\n      throw FetchRequestError.from(request, err)\n    }\n  })\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 14459, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14464, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/fetch/src/index.ts"],"sourcesContent":["export * from './fetch-error.js'\nexport * from './fetch-request.js'\nexport * from './fetch-response.js'\nexport * from './fetch-wrap.js'\nexport * from './fetch.js'\nexport * from './util.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,gIAAA,SAAgC;AAChC,kIAAA,SAAkC;AAClC,mIAAA,SAAmC;AACnC,+HAAA,SAA+B;AAC/B,0HAAA,SAA0B;AAC1B,yHAAA,SAAyB","ignoreList":[0]}},
    {"offset": {"line": 14493, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14498, "column": 0}, "map": {"version":3,"file":"pipe.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/pipe/src/pipe.ts"],"sourcesContent":["import { Transformer } from './transformer.js'\n\ntype PipelineInput<T extends readonly Transformer<any>[]> = T extends [\n  Transformer<infer I, any>,\n  ...any[],\n]\n  ? I\n  : T extends Transformer<infer I, any>[]\n    ? I\n    : never\n\ntype PipelineOutput<T extends readonly Transformer<any>[]> = T extends [\n  ...any[],\n  Transformer<any, infer O>,\n]\n  ? O\n  : T extends Transformer<any, infer O>[]\n    ? O\n    : never\n\ntype Pipeline<\n  F extends readonly Transformer<any>[],\n  Acc extends readonly Transformer<any>[] = [],\n> = F extends [Transformer<infer I, infer O>]\n  ? [...Acc, Transformer<I, O>]\n  : F extends [Transformer<infer A, any>, ...infer Tail]\n    ? Tail extends [Transformer<infer B, any>, ...any[]]\n      ? Pipeline<Tail, [...Acc, Transformer<A, B>]>\n      : Acc\n    : Acc\n\n/**\n * This utility function allows to properly type a pipeline of transformers.\n *\n * @example\n * ```ts\n * // Will be typed as \"(input: string) => Promise<number>\"\n * const parse = pipe(\n *   async (input: string) => JSON.parse(input),\n *   async (input: unknown) => {\n *     if (typeof input === 'number') return input\n *     throw new TypeError('Invalid input')\n *   },\n *   (input: number) => input * 2,\n * )\n * ```\n */\nexport function pipe(): never\nexport function pipe<T extends readonly Transformer<any>[]>(\n  ...pipeline: Pipeline<T> extends T ? T : Pipeline<T>\n): (input: PipelineInput<T>) => Promise<PipelineOutput<T>>\nexport function pipe<T extends readonly Transformer<any>[]>(\n  ...pipeline: Pipeline<T> extends T ? T : Pipeline<T>\n): (input: PipelineInput<T>) => Promise<PipelineOutput<T>> {\n  return pipeline.reduce(pipeTwo)\n}\n\nexport function pipeTwo<I, O, X = unknown>(\n  first: Transformer<I, X>,\n  second: Transformer<X, O>,\n): (input: I) => Promise<O> {\n  return async (input) => second(await first(input))\n}\n"],"names":[],"mappings":";;;;;AAmDA,SAAgB,IAAI,CAClB,GAAG,QAAiD;IAEpD,OAAO,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,CAAA;AACjC,CAAC;AAJD,QAAA,IAAA,GAAA,KAIC;AAED,SAAgB,OAAO,CACrB,KAAwB,EACxB,MAAyB;IAEzB,OAAO,KAAK,EAAE,KAAK,EAAE,CAAG,CAAD,KAAO,CAAC,MAAM,KAAK,CAAC,KAAK,CAAC,CAAC,CAAA;AACpD,CAAC;AALD,QAAA,OAAA,GAAA,QAKC","ignoreList":[0]}},
    {"offset": {"line": 14511, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14516, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/pipe/src/index.ts"],"sourcesContent":["export { pipe, pipeTwo } from './pipe.js'\nexport { type Transformer } from './transformer.js'\n"],"names":[],"mappings":";;;;;AAAA,IAAA,iCAAyC;AAAhC,OAAA,cAAA,CAAA,SAAA,QAAA;IAAA,YAAA;IAAA,KAAA;QAAA,OAAA,UAAA,IAAI;IAAA;AAAA,GAAA;AAAE,OAAA,cAAA,CAAA,SAAA,WAAA;IAAA,YAAA;IAAA,KAAA;QAAA,OAAA,UAAA,OAAO;IAAA;AAAA,GAAA","ignoreList":[0]}},
    {"offset": {"line": 14534, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14539, "column": 0}, "map": {"version":3,"file":"types.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/handle-resolver/src/types.ts"],"sourcesContent":["import { AtprotoDid, isAtprotoDid } from '@atproto/did'\nexport type { AtprotoDid, AtprotoIdentityDidMethods } from '@atproto/did'\n\nexport type ResolveHandleOptions = {\n  signal?: AbortSignal\n  noCache?: boolean\n}\n\n/**\n * @see {@link https://atproto.com/specs/did#blessed-did-methods}\n */\nexport type ResolvedHandle = null | AtprotoDid\n\n/**\n * @see {@link https://atproto.com/specs/did#blessed-did-methods}\n */\nexport function isResolvedHandle<T>(value: T): value is T & ResolvedHandle {\n  return value === null || isAtprotoDid(value)\n}\n\nexport interface HandleResolver {\n  /**\n   * @returns the DID that corresponds to the given handle, or `null` if no DID\n   * is found. `null` should only be returned if no unexpected behavior occurred\n   * during the resolution process.\n   * @throws Error if the resolution method fails due to an unexpected error, or\n   * if the resolution is aborted ({@link ResolveHandleOptions}).\n   */\n  resolve(\n    handle: string,\n    options?: ResolveHandleOptions,\n  ): Promise<ResolvedHandle>\n}\n"],"names":[],"mappings":";;;;AAgBA,QAAA,gBAAA,GAAA,iBAEC;AAlBD,MAAA,gCAAuD;AAavD;;GAEG,CACH,SAAgB,gBAAgB,CAAI,KAAQ;IAC1C,OAAO,KAAK,KAAK,IAAI,IAAI,CAAA,GAAA,MAAA,YAAY,EAAC,KAAK,CAAC,CAAA;AAC9C,CAAC","ignoreList":[0]}},
    {"offset": {"line": 14550, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14555, "column": 0}, "map": {"version":3,"file":"app-view-handle-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/handle-resolver/src/app-view-handle-resolver.ts"],"sourcesContent":["import z from 'zod'\n\nimport {\n  HandleResolver,\n  ResolveHandleOptions,\n  ResolvedHandle,\n  isResolvedHandle,\n} from './types.js'\n\nexport const xrpcErrorSchema = z.object({\n  error: z.string(),\n  message: z.string().optional(),\n})\n\nexport type AppViewHandleResolverOptions = {\n  /**\n   * Fetch function to use for HTTP requests. Allows customizing the request\n   * behavior, e.g. adding headers, setting a timeout, mocking, etc.\n   *\n   * @default globalThis.fetch\n   */\n  fetch?: typeof globalThis.fetch\n}\n\nexport class AppViewHandleResolver implements HandleResolver {\n  static from(\n    service: URL | string | HandleResolver,\n    options?: AppViewHandleResolverOptions,\n  ): HandleResolver {\n    if (typeof service === 'string' || service instanceof URL) {\n      return new AppViewHandleResolver(service, options)\n    }\n    return service\n  }\n\n  /**\n   * URL of the atproto lexicon server. This is the base URL where the\n   * `com.atproto.identity.resolveHandle` XRPC method is located.\n   */\n  protected readonly serviceUrl: URL\n  protected readonly fetch: typeof globalThis.fetch\n\n  constructor(service: URL | string, options?: AppViewHandleResolverOptions) {\n    this.serviceUrl = new URL(service)\n    this.fetch = options?.fetch ?? globalThis.fetch\n  }\n\n  public async resolve(\n    handle: string,\n    options?: ResolveHandleOptions,\n  ): Promise<ResolvedHandle> {\n    const url = new URL(\n      '/xrpc/com.atproto.identity.resolveHandle',\n      this.serviceUrl,\n    )\n    url.searchParams.set('handle', handle)\n\n    const response = await this.fetch.call(null, url, {\n      cache: options?.noCache ? 'no-cache' : undefined,\n      signal: options?.signal,\n      redirect: 'error',\n    })\n    const payload = await response.json()\n\n    // The response should either be\n    // - 400 Bad Request with { error: 'InvalidRequest', message: 'Unable to resolve handle' }\n    // - 200 OK with { did: NonNullable<ResolvedHandle> }\n    // Any other response is considered unexpected behavior an should throw an error.\n\n    if (response.status === 400) {\n      const data = xrpcErrorSchema.parse(payload)\n      if (\n        data.error === 'InvalidRequest' &&\n        data.message === 'Unable to resolve handle'\n      ) {\n        return null\n      }\n    }\n\n    if (!response.ok) {\n      throw new TypeError('Invalid response from resolveHandle method')\n    }\n\n    const value: unknown = payload?.did\n\n    if (!isResolvedHandle(value)) {\n      throw new TypeError('Invalid DID returned from resolveHandle method')\n    }\n\n    return value\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA,MAAA,QAAA,gCAAmB;AAEnB,MAAA,mCAKmB;AAEN,QAAA,eAAe,GAAG,MAAA,OAAC,CAAC,MAAM,CAAC;IACtC,KAAK,EAAE,MAAA,OAAC,CAAC,MAAM,EAAE;IACjB,OAAO,EAAE,MAAA,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;CAC/B,CAAC,CAAA;AAYF,MAAa,qBAAqB;IAChC,MAAM,CAAC,IAAI,CACT,OAAsC,EACtC,OAAsC,EAAA;QAEtC,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,YAAY,GAAG,EAAE,CAAC;YAC1D,OAAO,IAAI,qBAAqB,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;QACpD,CAAC;QACD,OAAO,OAAO,CAAA;IAChB,CAAC;IASD,YAAY,OAAqB,EAAE,OAAsC,CAAA;QAPzE;;;WAGG,CACgB,OAAA,cAAA,CAAA,IAAA,EAAA,cAAA;;;;;WAAe;QACf,OAAA,cAAA,CAAA,IAAA,EAAA,SAAA;;;;;WAA8B;QAG/C,IAAI,CAAC,UAAU,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,CAAA;QAClC,IAAI,CAAC,KAAK,GAAG,OAAO,EAAE,KAAK,IAAI,UAAU,CAAC,KAAK,CAAA;IACjD,CAAC;IAEM,KAAK,CAAC,OAAO,CAClB,MAAc,EACd,OAA8B,EAAA;QAE9B,MAAM,GAAG,GAAG,IAAI,GAAG,CACjB,0CAA0C,EAC1C,IAAI,CAAC,UAAU,CAChB,CAAA;QACD,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAA;QAEtC,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE;YAChD,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS;YAChD,MAAM,EAAE,OAAO,EAAE,MAAM;YACvB,QAAQ,EAAE,OAAO;SAClB,CAAC,CAAA;QACF,MAAM,OAAO,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAA;QAErC,gCAAgC;QAChC,0FAA0F;QAC1F,qDAAqD;QACrD,iFAAiF;QAEjF,IAAI,QAAQ,CAAC,MAAM,KAAK,GAAG,EAAE,CAAC;YAC5B,MAAM,IAAI,GAAG,QAAA,eAAe,CAAC,KAAK,CAAC,OAAO,CAAC,CAAA;YAC3C,IACE,IAAI,CAAC,KAAK,KAAK,gBAAgB,IAC/B,IAAI,CAAC,OAAO,KAAK,0BAA0B,EAC3C,CAAC;gBACD,OAAO,IAAI,CAAA;YACb,CAAC;QACH,CAAC;QAED,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC;YACjB,MAAM,IAAI,SAAS,CAAC,4CAA4C,CAAC,CAAA;QACnE,CAAC;QAED,MAAM,KAAK,GAAY,OAAO,EAAE,GAAG,CAAA;QAEnC,IAAI,CAAC,CAAA,GAAA,WAAA,gBAAgB,EAAC,KAAK,CAAC,EAAE,CAAC;YAC7B,MAAM,IAAI,SAAS,CAAC,gDAAgD,CAAC,CAAA;QACvE,CAAC;QAED,OAAO,KAAK,CAAA;IACd,CAAC;CACF;AAnED,QAAA,qBAAA,GAAA,sBAmEC","ignoreList":[0]}},
    {"offset": {"line": 14627, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14632, "column": 0}, "map": {"version":3,"file":"dns-handle-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/handle-resolver/src/internal-resolvers/dns-handle-resolver.ts"],"sourcesContent":["import { HandleResolver, ResolvedHandle, isResolvedHandle } from '../types'\n\nconst SUBDOMAIN = '_atproto'\nconst PREFIX = 'did='\n\n/**\n * DNS TXT record resolver. Return `null` if the hostname successfully does not\n * resolve to a valid DID. Throw an error if an unexpected error occurs.\n */\nexport type ResolveTxt = (hostname: string) => Promise<null | string[]>\n\nexport class DnsHandleResolver implements HandleResolver {\n  constructor(protected resolveTxt: ResolveTxt) {}\n\n  async resolve(handle: string): Promise<ResolvedHandle> {\n    const results = await this.resolveTxt.call(null, `${SUBDOMAIN}.${handle}`)\n\n    if (!results) return null\n\n    for (let i = 0; i < results.length; i++) {\n      // If the line does not start with \"did=\", skip it\n      if (!results[i].startsWith(PREFIX)) continue\n\n      // Ensure no other entry starting with \"did=\" follows\n      for (let j = i + 1; j < results.length; j++) {\n        if (results[j].startsWith(PREFIX)) return null\n      }\n\n      // Note: No trimming (to be consistent with spec)\n      const did = results[i].slice(PREFIX.length)\n\n      // Invalid DBS record\n      return isResolvedHandle(did) ? did : null\n    }\n\n    return null\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,8BAA2E;AAE3E,MAAM,SAAS,GAAG,UAAU,CAAA;AAC5B,MAAM,MAAM,GAAG,MAAM,CAAA;AAQrB,MAAa,iBAAiB;IAC5B,YAAsB,UAAsB,CAAA;QAAhC,OAAA,cAAA,CAAA,IAAA,EAAA,cAAA;;;;mBAAU,UAAU;WAAY;IAAG,CAAC;IAEhD,KAAK,CAAC,OAAO,CAAC,MAAc,EAAA;QAC1B,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,SAAS,CAAA,CAAA,EAAI,MAAM,EAAE,CAAC,CAAA;QAE1E,IAAI,CAAC,OAAO,EAAE,OAAO,IAAI,CAAA;QAEzB,IAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,CAAE,CAAC;YACxC,kDAAkD;YAClD,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,SAAQ;YAE5C,qDAAqD;YACrD,IAAK,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,CAAE,CAAC;gBAC5C,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,OAAO,IAAI,CAAA;YAChD,CAAC;YAED,iDAAiD;YACjD,MAAM,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA;YAE3C,qBAAqB;YACrB,OAAO,CAAA,GAAA,QAAA,gBAAgB,EAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAA;QAC3C,CAAC;QAED,OAAO,IAAI,CAAA;IACb,CAAC;CACF;AA1BD,QAAA,iBAAA,GAAA,kBA0BC","ignoreList":[0]}},
    {"offset": {"line": 14668, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14673, "column": 0}, "map": {"version":3,"file":"well-known-handler-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/handle-resolver/src/internal-resolvers/well-known-handler-resolver.ts"],"sourcesContent":["import {\n  HandleResolver,\n  ResolveHandleOptions,\n  ResolvedHandle,\n  isResolvedHandle,\n} from '../types.js'\n\nexport type WellKnownHandleResolverOptions = {\n  /**\n   * Fetch function to use for HTTP requests. Allows customizing the request\n   * behavior, e.g. adding headers, setting a timeout, mocking, etc. The\n   * provided fetch function will be wrapped with a safeFetchWrap function that\n   * adds SSRF protection.\n   *\n   * @default `globalThis.fetch`\n   */\n  fetch?: typeof globalThis.fetch\n}\n\nexport class WellKnownHandleResolver implements HandleResolver {\n  protected readonly fetch: typeof globalThis.fetch\n\n  constructor(options?: WellKnownHandleResolverOptions) {\n    this.fetch = options?.fetch ?? globalThis.fetch\n  }\n\n  public async resolve(\n    handle: string,\n    options?: ResolveHandleOptions,\n  ): Promise<ResolvedHandle> {\n    const url = new URL('/.well-known/atproto-did', `https://${handle}`)\n\n    try {\n      const response = await this.fetch.call(null, url, {\n        cache: options?.noCache ? 'no-cache' : undefined,\n        signal: options?.signal,\n        redirect: 'error',\n      })\n      const text = await response.text()\n      const firstLine = text.split('\\n')[0]!.trim()\n\n      if (isResolvedHandle(firstLine)) return firstLine\n\n      return null\n    } catch (err) {\n      // The the request failed, assume the handle does not resolve to a DID,\n      // unless the failure was due to the signal being aborted.\n      options?.signal?.throwIfAborted()\n\n      return null\n    }\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,oCAKoB;AAcpB,MAAa,uBAAuB;IAGlC,YAAY,OAAwC,CAAA;QAFjC,OAAA,cAAA,CAAA,IAAA,EAAA,SAAA;;;;;WAA8B;QAG/C,IAAI,CAAC,KAAK,GAAG,OAAO,EAAE,KAAK,IAAI,UAAU,CAAC,KAAK,CAAA;IACjD,CAAC;IAEM,KAAK,CAAC,OAAO,CAClB,MAAc,EACd,OAA8B,EAAA;QAE9B,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,0BAA0B,EAAE,CAAA,QAAA,EAAW,MAAM,EAAE,CAAC,CAAA;QAEpE,IAAI,CAAC;YACH,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE;gBAChD,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS;gBAChD,MAAM,EAAE,OAAO,EAAE,MAAM;gBACvB,QAAQ,EAAE,OAAO;aAClB,CAAC,CAAA;YACF,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAA;YAClC,MAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,CAAA;YAE7C,IAAI,CAAA,GAAA,WAAA,gBAAgB,EAAC,SAAS,CAAC,EAAE,OAAO,SAAS,CAAA;YAEjD,OAAO,IAAI,CAAA;QACb,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;YACb,uEAAuE;YACvE,0DAA0D;YAC1D,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;YAEjC,OAAO,IAAI,CAAA;QACb,CAAC;IACH,CAAC;CACF;AAjCD,QAAA,uBAAA,GAAA,wBAiCC","ignoreList":[0]}},
    {"offset": {"line": 14710, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14715, "column": 0}, "map": {"version":3,"file":"atproto-handle-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/handle-resolver/src/atproto-handle-resolver.ts"],"sourcesContent":["import {\n  DnsHandleResolver,\n  ResolveTxt,\n} from './internal-resolvers/dns-handle-resolver.js'\nimport {\n  WellKnownHandleResolver,\n  WellKnownHandleResolverOptions,\n} from './internal-resolvers/well-known-handler-resolver.js'\nimport {\n  HandleResolver,\n  ResolveHandleOptions,\n  ResolvedHandle,\n} from './types.js'\n\nexport type { ResolveTxt }\nexport type AtprotoHandleResolverOptions = WellKnownHandleResolverOptions & {\n  resolveTxt: ResolveTxt\n  resolveTxtFallback?: ResolveTxt\n}\n\nconst noop = () => {}\n\n/**\n * Implementation of the official ATPROTO handle resolution strategy.\n * This implementation relies on two primitives:\n * - HTTP Well-Known URI resolution (requires a `fetch()` implementation)\n * - DNS TXT record resolution (requires a `resolveTxt()` function)\n */\nexport class AtprotoHandleResolver implements HandleResolver {\n  private readonly httpResolver: HandleResolver\n  private readonly dnsResolver: HandleResolver\n  private readonly dnsResolverFallback?: HandleResolver\n\n  constructor(options: AtprotoHandleResolverOptions) {\n    this.httpResolver = new WellKnownHandleResolver(options)\n    this.dnsResolver = new DnsHandleResolver(options.resolveTxt)\n    this.dnsResolverFallback = options.resolveTxtFallback\n      ? new DnsHandleResolver(options.resolveTxtFallback)\n      : undefined\n  }\n\n  async resolve(\n    handle: string,\n    options?: ResolveHandleOptions,\n  ): Promise<ResolvedHandle> {\n    options?.signal?.throwIfAborted()\n\n    const abortController = new AbortController()\n    const { signal } = abortController\n    options?.signal?.addEventListener('abort', () => abortController.abort(), {\n      signal,\n    })\n\n    const wrappedOptions = { ...options, signal }\n\n    try {\n      const dnsPromise = this.dnsResolver.resolve(handle, wrappedOptions)\n      const httpPromise = this.httpResolver.resolve(handle, wrappedOptions)\n\n      // Prevent uncaught promise rejection\n      httpPromise.catch(noop)\n\n      const dnsRes = await dnsPromise\n      if (dnsRes) return dnsRes\n\n      signal.throwIfAborted()\n\n      const res = await httpPromise\n      if (res) return res\n\n      signal.throwIfAborted()\n\n      return this.dnsResolverFallback?.resolve(handle, wrappedOptions) ?? null\n    } finally {\n      // Cancel pending requests, and remove \"abort\" listener on incoming signal\n      abortController.abort()\n    }\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,kFAGoD;AACpD,MAAA,kGAG4D;AAa5D,MAAM,IAAI,GAAG,GAAG,EAAE,AAAE,CAAC,CAAA;AAErB;;;;;GAKG,CACH,MAAa,qBAAqB;IAKhC,YAAY,OAAqC,CAAA;QAJhC,OAAA,cAAA,CAAA,IAAA,EAAA,gBAAA;;;;;WAA4B;QAC5B,OAAA,cAAA,CAAA,IAAA,EAAA,eAAA;;;;;WAA2B;QAC3B,OAAA,cAAA,CAAA,IAAA,EAAA,uBAAA;;;;;WAAoC;QAGnD,IAAI,CAAC,YAAY,GAAG,IAAI,iCAAA,uBAAuB,CAAC,OAAO,CAAC,CAAA;QACxD,IAAI,CAAC,WAAW,GAAG,IAAI,yBAAA,iBAAiB,CAAC,OAAO,CAAC,UAAU,CAAC,CAAA;QAC5D,IAAI,CAAC,mBAAmB,GAAG,OAAO,CAAC,kBAAkB,GACjD,IAAI,yBAAA,iBAAiB,CAAC,OAAO,CAAC,kBAAkB,CAAC,GACjD,SAAS,CAAA;IACf,CAAC;IAED,KAAK,CAAC,OAAO,CACX,MAAc,EACd,OAA8B,EAAA;QAE9B,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QAEjC,MAAM,eAAe,GAAG,IAAI,eAAe,EAAE,CAAA;QAC7C,MAAM,EAAE,MAAM,EAAE,GAAG,eAAe,CAAA;QAClC,OAAO,EAAE,MAAM,EAAE,gBAAgB,CAAC,OAAO,EAAE,GAAG,CAAG,CAAD,cAAgB,CAAC,KAAK,EAAE,EAAE;YACxE,MAAM;SACP,CAAC,CAAA;QAEF,MAAM,cAAc,GAAG;YAAE,GAAG,OAAO;YAAE,MAAM;QAAA,CAAE,CAAA;QAE7C,IAAI,CAAC;YACH,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,MAAM,EAAE,cAAc,CAAC,CAAA;YACnE,MAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,EAAE,cAAc,CAAC,CAAA;YAErE,qCAAqC;YACrC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,CAAA;YAEvB,MAAM,MAAM,GAAG,MAAM,UAAU,CAAA;YAC/B,IAAI,MAAM,EAAE,OAAO,MAAM,CAAA;YAEzB,MAAM,CAAC,cAAc,EAAE,CAAA;YAEvB,MAAM,GAAG,GAAG,MAAM,WAAW,CAAA;YAC7B,IAAI,GAAG,EAAE,OAAO,GAAG,CAAA;YAEnB,MAAM,CAAC,cAAc,EAAE,CAAA;YAEvB,OAAO,IAAI,CAAC,mBAAmB,EAAE,OAAO,CAAC,MAAM,EAAE,cAAc,CAAC,IAAI,IAAI,CAAA;QAC1E,CAAC,QAAS,CAAC;YACT,0EAA0E;YAC1E,eAAe,CAAC,KAAK,EAAE,CAAA;QACzB,CAAC;IACH,CAAC;CACF;AAlDD,QAAA,qBAAA,GAAA,sBAkDC","ignoreList":[0]}},
    {"offset": {"line": 14782, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14787, "column": 0}, "map": {"version":3,"file":"atproto-doh-handle-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/handle-resolver/src/atproto-doh-handle-resolver.ts"],"sourcesContent":["import {\n  AtprotoHandleResolver,\n  AtprotoHandleResolverOptions,\n} from './atproto-handle-resolver.js'\nimport { HandleResolver } from './types.js'\nimport { ResolveTxt } from './internal-resolvers/dns-handle-resolver.js'\n\nexport type AtprotoDohHandleResolverOptions = Omit<\n  AtprotoHandleResolverOptions,\n  'resolveTxt' | 'resolveTxtFallback'\n> & {\n  dohEndpoint: string | URL\n}\n\nexport class AtprotoDohHandleResolver\n  extends AtprotoHandleResolver\n  implements HandleResolver\n{\n  constructor(options: AtprotoDohHandleResolverOptions) {\n    super({\n      ...options,\n      resolveTxt: dohResolveTxtFactory(options),\n      resolveTxtFallback: undefined,\n    })\n  }\n}\n\n/**\n * Resolver for DNS-over-HTTPS (DoH) handles. Only works with servers supporting\n * Google Flavoured \"application/dns-json\" queries.\n *\n * @see {@link https://developers.google.com/speed/public-dns/docs/doh/json}\n * @see {@link https://developers.cloudflare.com/1.1.1.1/encryption/dns-over-https/make-api-requests/dns-json/}\n * @todo Add support for DoH using application/dns-message (?)\n */\nfunction dohResolveTxtFactory({\n  dohEndpoint,\n  fetch = globalThis.fetch,\n}: AtprotoDohHandleResolverOptions): ResolveTxt {\n  return async (hostname) => {\n    const url = new URL(dohEndpoint)\n    url.searchParams.set('type', 'TXT')\n    url.searchParams.set('name', hostname)\n\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: { accept: 'application/dns-json' },\n      redirect: 'follow',\n    })\n    try {\n      const contentType = response.headers.get('content-type')?.trim()\n      if (!response.ok) {\n        const message = contentType?.startsWith('text/plain')\n          ? await response.text()\n          : `Failed to resolve ${hostname}`\n        throw new TypeError(message)\n      } else if (contentType?.match(/application\\/(dns-)?json/i) == null) {\n        throw new TypeError('Unexpected response from DoH server')\n      }\n\n      const result = asResult(await response.json())\n      return result.Answer?.filter(isAnswerTxt).map(extractTxtData) ?? null\n    } finally {\n      // Make sure to always cancel the response body as some engines (Node 👀)\n      // do not do this automatically.\n      // https://undici.nodejs.org/#/?id=garbage-collection\n      if (response.bodyUsed === false) {\n        // Handle rejection asynchronously\n        void response.body?.cancel().catch(onCancelError)\n      }\n    }\n  }\n}\n\nfunction onCancelError(err: unknown) {\n  if (!(err instanceof DOMException) || err.name !== 'AbortError') {\n    console.error('An error occurred while cancelling the response body:', err)\n  }\n}\n\ntype Result = { Status: number; Answer?: Answer[] }\nfunction isResult(result: unknown): result is Result {\n  if (typeof result !== 'object' || result === null) return false\n  if (!('Status' in result) || typeof result.Status !== 'number') return false\n  if ('Answer' in result && !isArrayOf(result.Answer, isAnswer)) return false\n  return true\n}\nfunction asResult(result: unknown): Result {\n  if (isResult(result)) return result\n  throw new TypeError('Invalid DoH response')\n}\n\nfunction isArrayOf<T>(\n  value: unknown,\n  predicate: (v: unknown) => v is T,\n): value is T[] {\n  return Array.isArray(value) && value.every(predicate)\n}\n\ntype Answer = { name: string; type: number; data: string; TTL: number }\nfunction isAnswer(answer: unknown): answer is Answer {\n  return (\n    typeof answer === 'object' &&\n    answer !== null &&\n    'name' in answer &&\n    typeof answer.name === 'string' &&\n    'type' in answer &&\n    typeof answer.type === 'number' &&\n    'data' in answer &&\n    typeof answer.data === 'string' &&\n    'TTL' in answer &&\n    typeof answer.TTL === 'number'\n  )\n}\n\ntype AnswerTxt = Answer & { type: 16 }\nfunction isAnswerTxt(answer: Answer): answer is AnswerTxt {\n  return answer.type === 16\n}\n\nfunction extractTxtData(answer: AnswerTxt): string {\n  return answer.data.replace(/^\"|\"$/g, '').replace(/\\\\\"/g, '\"')\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 14870, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14875, "column": 0}, "map": {"version":3,"file":"cached-handle-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/handle-resolver/src/cached-handle-resolver.ts"],"sourcesContent":["import { CachedGetter, SimpleStore } from '@atproto-labs/simple-store'\nimport { SimpleStoreMemory } from '@atproto-labs/simple-store-memory'\nimport {\n  HandleResolver,\n  ResolvedHandle,\n  ResolveHandleOptions,\n} from './types.js'\n\nexport type HandleCache = SimpleStore<string, ResolvedHandle>\n\nexport class CachedHandleResolver implements HandleResolver {\n  private getter: CachedGetter<string, ResolvedHandle>\n\n  constructor(\n    /**\n     * The resolver that will be used to resolve handles.\n     */\n    resolver: HandleResolver,\n    cache: HandleCache = new SimpleStoreMemory<string, ResolvedHandle>({\n      max: 1000,\n      ttl: 10 * 60e3,\n    }),\n  ) {\n    this.getter = new CachedGetter<string, ResolvedHandle>(\n      (handle, options) => resolver.resolve(handle, options),\n      cache,\n    )\n  }\n\n  async resolve(\n    handle: string,\n    options?: ResolveHandleOptions,\n  ): Promise<ResolvedHandle> {\n    return this.getter.get(handle, options)\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uDAAsE;AACtE,MAAA,qEAAqE;AASrE,MAAa,oBAAoB;IAG/B,YACE;;OAEG,CACH,QAAwB,EACxB,QAAqB,IAAI,sBAAA,iBAAiB,CAAyB;QACjE,GAAG,EAAE,IAAI;QACT,GAAG,EAAE,EAAE,GAAG,IAAI;KACf,CAAC,CAAA;QAVI,OAAA,cAAA,CAAA,IAAA,EAAA,UAAA;;;;;WAA4C;QAYlD,IAAI,CAAC,MAAM,GAAG,IAAI,eAAA,YAAY,CAC5B,CAAC,MAAM,EAAE,OAAO,EAAE,CAAG,CAAD,OAAS,CAAC,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,EACtD,KAAK,CACN,CAAA;IACH,CAAC;IAED,KAAK,CAAC,OAAO,CACX,MAAc,EACd,OAA8B,EAAA;QAE9B,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,OAAO,CAAC,CAAA;IACzC,CAAC;CACF;AAzBD,QAAA,oBAAA,GAAA,qBAyBC","ignoreList":[0]}},
    {"offset": {"line": 14902, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14907, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/handle-resolver/src/index.ts"],"sourcesContent":["export * from './types.js'\n\n// Main Handle Resolvers strategies\nexport * from './app-view-handle-resolver.js'\nexport * from './atproto-doh-handle-resolver.js'\nexport * from './atproto-handle-resolver.js'\n\n// Handle Resolver Caching utility\nexport * from './cached-handle-resolver.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,oIAAA,SAA0B;AAE1B,mCAAmC;AACnC,uJAAA,SAA6C;AAC7C,0JAAA,SAAgD;AAChD,sJAAA,SAA4C;AAE5C,kCAAkC;AAClC,qJAAA,SAA2C","ignoreList":[0]}},
    {"offset": {"line": 14937, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14942, "column": 0}, "map": {"version":3,"file":"constants.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/constants.ts"],"sourcesContent":["export const CLIENT_ASSERTION_TYPE_JWT_BEARER =\n  'urn:ietf:params:oauth:client-assertion-type:jwt-bearer'\n"],"names":[],"mappings":";;;;;AAAa,QAAA,gCAAgC,GAC3C,wDAAwD,CAAA","ignoreList":[0]}},
    {"offset": {"line": 14948, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 14953, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/util.ts"],"sourcesContent":["export function isHostnameIP(hostname: string) {\n  // IPv4\n  if (hostname.match(/^\\d+\\.\\d+\\.\\d+\\.\\d+$/)) return true\n\n  // IPv6\n  if (hostname.startsWith('[') && hostname.endsWith(']')) return true\n\n  return false\n}\n\nexport type LoopbackHost = 'localhost' | '127.0.0.1' | '[::1]'\n\nexport function isLoopbackHost(host: unknown): host is LoopbackHost {\n  return host === 'localhost' || host === '127.0.0.1' || host === '[::1]'\n}\n\nexport function isLoopbackUrl(input: URL | string): boolean {\n  const url = typeof input === 'string' ? new URL(input) : input\n  return isLoopbackHost(url.hostname)\n}\n\nexport function safeUrl(input: URL | string): URL | null {\n  try {\n    return new URL(input)\n  } catch {\n    return null\n  }\n}\n\nexport function extractUrlPath(url) {\n  // Extracts the path from a URL, without relying on the URL constructor\n  // (because it normalizes the URL)\n  const endOfProtocol = url.startsWith('https://')\n    ? 8\n    : url.startsWith('http://')\n      ? 7\n      : -1\n  if (endOfProtocol === -1) {\n    throw new TypeError('URL must use the \"https:\" or \"http:\" protocol')\n  }\n\n  const hashIdx = url.indexOf('#', endOfProtocol)\n  const questionIdx = url.indexOf('?', endOfProtocol)\n\n  const queryStrIdx =\n    questionIdx !== -1 && (hashIdx === -1 || questionIdx < hashIdx)\n      ? questionIdx\n      : -1\n\n  const pathEnd =\n    hashIdx === -1\n      ? queryStrIdx === -1\n        ? url.length\n        : queryStrIdx\n      : queryStrIdx === -1\n        ? hashIdx\n        : Math.min(hashIdx, queryStrIdx)\n\n  const slashIdx = url.indexOf('/', endOfProtocol)\n\n  const pathStart = slashIdx === -1 || slashIdx > pathEnd ? pathEnd : slashIdx\n\n  if (endOfProtocol === pathStart) {\n    throw new TypeError('URL must contain a host')\n  }\n\n  return url.substring(pathStart, pathEnd)\n}\n"],"names":[],"mappings":";;;;AAAA,QAAA,YAAA,GAAA,aAQC;AAID,QAAA,cAAA,GAAA,eAEC;AAED,QAAA,aAAA,GAAA,cAGC;AAED,QAAA,OAAA,GAAA,QAMC;AAED,QAAA,cAAA,GAAA,eAsCC;AAnED,SAAgB,YAAY,CAAC,QAAgB;IAC3C,OAAO;IACP,IAAI,QAAQ,CAAC,KAAK,CAAC,sBAAsB,CAAC,EAAE,OAAO,IAAI,CAAA;IAEvD,OAAO;IACP,IAAI,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,OAAO,IAAI,CAAA;IAEnE,OAAO,KAAK,CAAA;AACd,CAAC;AAID,SAAgB,cAAc,CAAC,IAAa;IAC1C,OAAO,IAAI,KAAK,WAAW,IAAI,IAAI,KAAK,WAAW,IAAI,IAAI,KAAK,OAAO,CAAA;AACzE,CAAC;AAED,SAAgB,aAAa,CAAC,KAAmB;IAC/C,MAAM,GAAG,GAAG,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAA;IAC9D,OAAO,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;AACrC,CAAC;AAED,SAAgB,OAAO,CAAC,KAAmB;IACzC,IAAI,CAAC;QACH,OAAO,IAAI,GAAG,CAAC,KAAK,CAAC,CAAA;IACvB,CAAC,CAAC,OAAM,CAAC;QACP,OAAO,IAAI,CAAA;IACb,CAAC;AACH,CAAC;AAED,SAAgB,cAAc,CAAC,GAAG;IAChC,uEAAuE;IACvE,kCAAkC;IAClC,MAAM,aAAa,GAAG,GAAG,CAAC,UAAU,CAAC,UAAU,CAAC,GAC5C,CAAC,GACD,GAAG,CAAC,UAAU,CAAC,SAAS,CAAC,GACvB,CAAC,GACD,CAAC,CAAC,CAAA;IACR,IAAI,aAAa,KAAK,CAAC,CAAC,EAAE,CAAC;QACzB,MAAM,IAAI,SAAS,CAAC,+CAA+C,CAAC,CAAA;IACtE,CAAC;IAED,MAAM,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,aAAa,CAAC,CAAA;IAC/C,MAAM,WAAW,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,aAAa,CAAC,CAAA;IAEnD,MAAM,WAAW,GACf,WAAW,KAAK,CAAC,CAAC,IAAI,CAAC,OAAO,KAAK,CAAC,CAAC,IAAI,WAAW,GAAG,OAAO,CAAC,GAC3D,WAAW,GACX,CAAC,CAAC,CAAA;IAER,MAAM,OAAO,GACX,OAAO,KAAK,CAAC,CAAC,GACV,WAAW,KAAK,CAAC,CAAC,GAChB,GAAG,CAAC,MAAM,GACV,WAAW,GACb,WAAW,KAAK,CAAC,CAAC,GAChB,OAAO,GACP,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,WAAW,CAAC,CAAA;IAEtC,MAAM,QAAQ,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,aAAa,CAAC,CAAA;IAEhD,MAAM,SAAS,GAAG,QAAQ,KAAK,CAAC,CAAC,IAAI,QAAQ,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAA;IAE5E,IAAI,aAAa,KAAK,SAAS,EAAE,CAAC;QAChC,MAAM,IAAI,SAAS,CAAC,yBAAyB,CAAC,CAAA;IAChD,CAAC;IAED,OAAO,GAAG,CAAC,SAAS,CAAC,SAAS,EAAE,OAAO,CAAC,CAAA;AAC1C,CAAC","ignoreList":[0]}},
    {"offset": {"line": 15001, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15006, "column": 0}, "map": {"version":3,"file":"uri.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/uri.ts"],"sourcesContent":["import { TypeOf, z, ZodIssueCode } from 'zod'\nimport { isHostnameIP, isLoopbackHost } from './util.js'\n\n/**\n * Valid, but potentially dangerous URL (`data:`, `file:`, `javascript:`, etc.).\n *\n * Any value that matches this schema is safe to parse using `new URL()`.\n */\nexport const dangerousUriSchema = z\n  .string()\n  .refine(\n    (data): data is `${string}:${string}` =>\n      data.includes(':') && URL.canParse(data),\n    {\n      message: 'Invalid URL',\n    },\n  )\n\n/**\n * Valid, but potentially dangerous URL (`data:`, `file:`, `javascript:`, etc.).\n */\nexport type DangerousUrl = TypeOf<typeof dangerousUriSchema>\n\nexport const loopbackUriSchema = dangerousUriSchema.superRefine(\n  (\n    value,\n    ctx,\n  ): value is\n    | `http://[::1]${string}`\n    | `http://localhost${'' | `${':' | '/' | '?' | '#'}${string}`}`\n    | `http://127.0.0.1${'' | `${':' | '/' | '?' | '#'}${string}`}` => {\n    // Loopback url must use the \"http:\" protocol\n    if (!value.startsWith('http://')) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message: 'URL must use the \"http:\" protocol',\n      })\n      return false\n    }\n\n    const url = new URL(value)\n\n    if (!isLoopbackHost(url.hostname)) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message: 'URL must use \"localhost\", \"127.0.0.1\" or \"[::1]\" as hostname',\n      })\n      return false\n    }\n\n    return true\n  },\n)\n\nexport type LoopbackUri = TypeOf<typeof loopbackUriSchema>\n\nexport const httpsUriSchema = dangerousUriSchema.superRefine(\n  (value, ctx): value is `https://${string}` => {\n    if (!value.startsWith('https://')) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message: 'URL must use the \"https:\" protocol',\n      })\n      return false\n    }\n\n    const url = new URL(value)\n\n    // Disallow loopback URLs with the `https:` protocol\n    if (isLoopbackHost(url.hostname)) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message: 'https: URL must not use a loopback host',\n      })\n      return false\n    }\n\n    if (isHostnameIP(url.hostname)) {\n      // Hostname is an IP address\n    } else {\n      // Hostname is a domain name\n      if (!url.hostname.includes('.')) {\n        // we don't depend on PSL here, so we only check for a dot\n        ctx.addIssue({\n          code: ZodIssueCode.custom,\n          message: 'Domain name must contain at least two segments',\n        })\n        return false\n      }\n\n      if (url.hostname.endsWith('.local')) {\n        ctx.addIssue({\n          code: ZodIssueCode.custom,\n          message: 'Domain name must not end with \".local\"',\n        })\n        return false\n      }\n    }\n\n    return true\n  },\n)\n\nexport type HttpsUri = TypeOf<typeof httpsUriSchema>\n\nexport const webUriSchema = z\n  .string()\n  .superRefine((value, ctx): value is LoopbackUri | HttpsUri => {\n    // discriminated union of `loopbackUriSchema` and `httpsUriSchema`\n    if (value.startsWith('http://')) {\n      const result = loopbackUriSchema.safeParse(value)\n      if (!result.success) result.error.issues.forEach(ctx.addIssue, ctx)\n      return result.success\n    }\n\n    if (value.startsWith('https://')) {\n      const result = httpsUriSchema.safeParse(value)\n      if (!result.success) result.error.issues.forEach(ctx.addIssue, ctx)\n      return result.success\n    }\n\n    ctx.addIssue({\n      code: ZodIssueCode.custom,\n      message: 'URL must use the \"http:\" or \"https:\" protocol',\n    })\n    return false\n  })\n\nexport type WebUri = TypeOf<typeof webUriSchema>\n\nexport const privateUseUriSchema = dangerousUriSchema.superRefine(\n  (value, ctx): value is `${string}.${string}:/${string}` => {\n    const dotIdx = value.indexOf('.')\n    const colonIdx = value.indexOf(':')\n\n    // Optimization: avoid parsing the URL if the protocol does not contain a \".\"\n    if (dotIdx === -1 || colonIdx === -1 || dotIdx > colonIdx) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message:\n          'Private-use URI scheme requires a \".\" as part of the protocol',\n      })\n      return false\n    }\n\n    const url = new URL(value)\n\n    // Should be covered by the check before, but let's be extra sure\n    if (!url.protocol.includes('.')) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message: 'Invalid private-use URI scheme',\n      })\n      return false\n    }\n\n    if (url.hostname) {\n      // https://datatracker.ietf.org/doc/html/rfc8252#section-7.1\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message:\n          'Private-use URI schemes must not include a hostname (only one \"/\" is allowed after the protocol, as per RFC 8252)',\n      })\n      return false\n    }\n\n    return true\n  },\n)\n\nexport type PrivateUseUri = TypeOf<typeof privateUseUriSchema>\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 15126, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15131, "column": 0}, "map": {"version":3,"file":"oauth-client-id.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-client-id.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthClientIdSchema = z.string().min(1)\nexport type OAuthClientId = z.infer<typeof oauthClientIdSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,mBAAmB,GAAG,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15138, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15143, "column": 0}, "map": {"version":3,"file":"oauth-redirect-uri.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-redirect-uri.ts"],"sourcesContent":["import { TypeOf, z, ZodIssueCode } from 'zod'\nimport {\n  httpsUriSchema,\n  LoopbackUri,\n  loopbackUriSchema,\n  privateUseUriSchema,\n} from './uri.js'\n\nexport const oauthLoopbackRedirectURISchema = loopbackUriSchema.superRefine(\n  (value, ctx): value is Exclude<LoopbackUri, `http://localhost${string}`> => {\n    if (value.startsWith('http://localhost')) {\n      // https://datatracker.ietf.org/doc/html/rfc8252#section-8.3\n      //\n      // > While redirect URIs using localhost (i.e.,\n      // > \"http://localhost:{port}/{path}\") function similarly to loopback IP\n      // > redirects described in Section 7.3, the use of localhost is NOT\n      // > RECOMMENDED.  Specifying a redirect URI with the loopback IP literal\n      // > rather than localhost avoids inadvertently listening on network\n      // > interfaces other than the loopback interface.  It is also less\n      // > susceptible to client-side firewalls and misconfigured host name\n      // > resolution on the user's device.\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message:\n          'Use of \"localhost\" hostname is not allowed (RFC 8252), use a loopback IP such as \"127.0.0.1\" instead',\n      })\n      return false\n    }\n\n    return true\n  },\n)\nexport type OAuthLoopbackRedirectURI = TypeOf<\n  typeof oauthLoopbackRedirectURISchema\n>\n\nexport const oauthHttpsRedirectURISchema = httpsUriSchema\nexport type OAuthHttpsRedirectURI = TypeOf<typeof oauthHttpsRedirectURISchema>\n\nexport const oauthPrivateUseRedirectURISchema = privateUseUriSchema\nexport type OAuthPrivateUseRedirectURI = TypeOf<\n  typeof oauthPrivateUseRedirectURISchema\n>\n\nexport const oauthRedirectUriSchema = z.union(\n  [\n    oauthLoopbackRedirectURISchema,\n    oauthHttpsRedirectURISchema,\n    oauthPrivateUseRedirectURISchema,\n  ],\n  {\n    message: `URL must use the \"https:\" or \"http:\" protocol, or a private-use URI scheme (RFC 8252)`,\n  },\n)\n\nexport type OAuthRedirectUri = TypeOf<typeof oauthRedirectUriSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAA6C;AAC7C,MAAA,+BAKiB;AAEJ,QAAA,8BAA8B,GAAG,SAAA,iBAAiB,CAAC,WAAW,CACzE,CAAC,KAAK,EAAE,GAAG,EAA8D,EAAE;IACzE,IAAI,KAAK,CAAC,UAAU,CAAC,kBAAkB,CAAC,EAAE,CAAC;QACzC,4DAA4D;QAC5D,EAAE;QACF,+CAA+C;QAC/C,wEAAwE;QACxE,oEAAoE;QACpE,yEAAyE;QACzE,oEAAoE;QACpE,mEAAmE;QACnE,qEAAqE;QACrE,qCAAqC;QACrC,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,YAAY,CAAC,MAAM;YACzB,OAAO,EACL,sGAAsG;SACzG,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,OAAO,IAAI,CAAA;AACb,CAAC,CACF,CAAA;AAKY,QAAA,2BAA2B,GAAG,SAAA,cAAc,CAAA;AAG5C,QAAA,gCAAgC,GAAG,SAAA,mBAAmB,CAAA;AAKtD,QAAA,sBAAsB,GAAG,MAAA,CAAC,CAAC,KAAK,CAC3C;IACE,QAAA,8BAA8B;IAC9B,QAAA,2BAA2B;IAC3B,QAAA,gCAAgC;CACjC,EACD;IACE,OAAO,EAAE,CAAA,qFAAA,CAAuF;CACjG,CACF,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15179, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15184, "column": 0}, "map": {"version":3,"file":"oauth-scope.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-scope.ts"],"sourcesContent":["import { z } from 'zod'\n\n/**\n * A space separated list of most non-control ASCII characters except backslash\n * and double quote.\n *\n * @see {@link https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-11#section-1.4.1}\n */\nexport const oauthScopeSchema = z\n  .string()\n  // scope       = scope-token *( SP scope-token )\n  // scope-token = 1*( %x21 / %x23-5B / %x5D-7E )\n  .regex(/^[\\x21\\x23-\\x5B\\x5D-\\x7E]+(?: [\\x21\\x23-\\x5B\\x5D-\\x7E]+)*$/)\n\nexport type OAuthScope = z.infer<typeof oauthScopeSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEvB;;;;;GAKG,CACU,QAAA,gBAAgB,GAAG,MAAA,CAAC,CAC9B,MAAM,EAAE,AACT,gDAAgD;AAChD,+CAA+C;CAC9C,KAAK,CAAC,4DAA4D,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15198, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15203, "column": 0}, "map": {"version":3,"file":"oauth-client-id-loopback.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-client-id-loopback.ts"],"sourcesContent":["import { TypeOf, ZodIssueCode } from 'zod'\nimport { oauthClientIdSchema } from './oauth-client-id.js'\nimport {\n  OAuthLoopbackRedirectURI,\n  oauthLoopbackRedirectURISchema,\n  OAuthRedirectUri,\n} from './oauth-redirect-uri.js'\nimport { OAuthScope, oauthScopeSchema } from './oauth-scope.js'\n\nconst PREFIX = 'http://localhost'\n\nexport const oauthClientIdLoopbackSchema = oauthClientIdSchema.superRefine(\n  (value, ctx): value is `${typeof PREFIX}${'' | '/'}${'' | `?${string}`}` => {\n    try {\n      assertOAuthLoopbackClientId(value)\n      return true\n    } catch (error) {\n      ctx.addIssue({\n        code: ZodIssueCode.custom,\n        message:\n          error instanceof TypeError\n            ? error.message\n            : 'Invalid loopback client ID',\n      })\n      return false\n    }\n  },\n)\n\nexport type OAuthClientIdLoopback = TypeOf<typeof oauthClientIdLoopbackSchema>\n\nexport function isOAuthClientIdLoopback(\n  clientId: string,\n): clientId is OAuthClientIdLoopback {\n  try {\n    parseOAuthLoopbackClientId(clientId)\n    return true\n  } catch {\n    return false\n  }\n}\n\nexport function assertOAuthLoopbackClientId(\n  clientId: string,\n): asserts clientId is OAuthClientIdLoopback {\n  void parseOAuthLoopbackClientId(clientId)\n}\n\n// @TODO: should we turn this into a zod schema? (more coherent error with other\n// validation functions)\nexport function parseOAuthLoopbackClientId(clientId: string): {\n  scope?: OAuthScope\n  redirect_uris?: [OAuthRedirectUri, ...OAuthRedirectUri[]]\n} {\n  if (!clientId.startsWith(PREFIX)) {\n    throw new TypeError(`Loopback ClientID must start with \"${PREFIX}\"`)\n  } else if (clientId.includes('#', PREFIX.length)) {\n    throw new TypeError('Loopback ClientID must not contain a hash component')\n  }\n\n  const queryStringIdx =\n    clientId.length > PREFIX.length && clientId[PREFIX.length] === '/'\n      ? PREFIX.length + 1\n      : PREFIX.length\n\n  if (clientId.length === queryStringIdx) {\n    return {} // no query string to parse\n  }\n\n  if (clientId[queryStringIdx] !== '?') {\n    throw new TypeError('Loopback ClientID must not contain a path component')\n  }\n\n  const searchParams = new URLSearchParams(clientId.slice(queryStringIdx + 1))\n\n  for (const name of searchParams.keys()) {\n    if (name !== 'redirect_uri' && name !== 'scope') {\n      throw new TypeError(`Invalid query parameter \"${name}\" in client ID`)\n    }\n  }\n\n  const scope = searchParams.get('scope') ?? undefined\n  if (scope != null) {\n    if (searchParams.getAll('scope').length > 1) {\n      throw new TypeError(\n        'Loopback ClientID must contain at most one scope query parameter',\n      )\n    } else if (!oauthScopeSchema.safeParse(scope).success) {\n      throw new TypeError('Invalid scope query parameter in client ID')\n    }\n  }\n\n  const redirect_uris = searchParams.has('redirect_uri')\n    ? (searchParams\n        .getAll('redirect_uri')\n        .map((value) => oauthLoopbackRedirectURISchema.parse(value)) as [\n        OAuthLoopbackRedirectURI,\n        ...OAuthLoopbackRedirectURI[],\n      ])\n    : undefined\n\n  return {\n    scope,\n    redirect_uris,\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 15274, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15279, "column": 0}, "map": {"version":3,"file":"atproto-loopback-client-metadata.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/atproto-loopback-client-metadata.ts"],"sourcesContent":["import {\n  OAuthClientIdLoopback,\n  parseOAuthLoopbackClientId,\n} from './oauth-client-id-loopback.js'\nimport { OAuthClientMetadataInput } from './oauth-client-metadata.js'\n\nexport function atprotoLoopbackClientMetadata(\n  clientId: string,\n): OAuthClientMetadataInput & {\n  client_id: OAuthClientIdLoopback\n} {\n  const {\n    scope = 'atproto',\n    redirect_uris = [`http://127.0.0.1/`, `http://[::1]/`],\n  } = parseOAuthLoopbackClientId(clientId)\n\n  return {\n    client_id: clientId as OAuthClientIdLoopback,\n    scope,\n    redirect_uris,\n    client_name: 'Loopback client',\n    response_types: ['code'],\n    grant_types: ['authorization_code', 'refresh_token'],\n    token_endpoint_auth_method: 'none',\n    application_type: 'native',\n    dpop_bound_access_tokens: true,\n  }\n}\n"],"names":[],"mappings":";;;;AAMA,QAAA,6BAAA,GAAA,8BAqBC;AA3BD,MAAA,yEAGsC;AAGtC,SAAgB,6BAA6B,CAC3C,QAAgB;IAIhB,MAAM,EACJ,KAAK,GAAG,SAAS,EACjB,aAAa,GAAG;QAAC,CAAA,iBAAA,CAAmB;QAAE,CAAA,aAAA,CAAe;KAAC,EACvD,GAAG,CAAA,GAAA,8BAAA,0BAA0B,EAAC,QAAQ,CAAC,CAAA;IAExC,OAAO;QACL,SAAS,EAAE,QAAiC;QAC5C,KAAK;QACL,aAAa;QACb,WAAW,EAAE,iBAAiB;QAC9B,cAAc,EAAE;YAAC,MAAM;SAAC;QACxB,WAAW,EAAE;YAAC,oBAAoB;YAAE,eAAe;SAAC;QACpD,0BAA0B,EAAE,MAAM;QAClC,gBAAgB,EAAE,QAAQ;QAC1B,wBAAwB,EAAE,IAAI;KAC/B,CAAA;AACH,CAAC","ignoreList":[0]}},
    {"offset": {"line": 15307, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15312, "column": 0}, "map": {"version":3,"file":"oauth-access-token.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-access-token.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthAccessTokenSchema = z.string().min(1)\nexport type OAuthAccessToken = z.infer<typeof oauthAccessTokenSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,sBAAsB,GAAG,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15319, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15324, "column": 0}, "map": {"version":3,"file":"oauth-authorization-code-grant-token-request.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-authorization-code-grant-token-request.ts"],"sourcesContent":["import { z } from 'zod'\nimport { oauthRedirectUriSchema } from './oauth-redirect-uri.js'\n\nexport const oauthAuthorizationCodeGrantTokenRequestSchema = z.object({\n  grant_type: z.literal('authorization_code'),\n  code: z.string().min(1),\n  redirect_uri: oauthRedirectUriSchema,\n  /** @see {@link https://datatracker.ietf.org/doc/html/rfc7636#section-4.1} */\n  code_verifier: z\n    .string()\n    .min(43)\n    .max(128)\n    .regex(/^[a-zA-Z0-9-._~]+$/)\n    .optional(),\n})\n\nexport type OAuthAuthorizationCodeGrantTokenRequest = z.infer<\n  typeof oauthAuthorizationCodeGrantTokenRequestSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AACvB,MAAA,6DAAgE;AAEnD,QAAA,6CAA6C,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACpE,UAAU,EAAE,MAAA,CAAC,CAAC,OAAO,CAAC,oBAAoB,CAAC;IAC3C,IAAI,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;IACvB,YAAY,EAAE,wBAAA,sBAAsB;IACpC,2EAAA,EAA6E,CAC7E,aAAa,EAAE,MAAA,CAAC,CACb,MAAM,EAAE,CACR,GAAG,CAAC,EAAE,CAAC,CACP,GAAG,CAAC,GAAG,CAAC,CACR,KAAK,CAAC,oBAAoB,CAAC,CAC3B,QAAQ,EAAE;CACd,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15337, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15342, "column": 0}, "map": {"version":3,"file":"oauth-authorization-details.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-authorization-details.ts"],"sourcesContent":["import { z } from 'zod'\nimport { dangerousUriSchema } from './uri.js'\n\n/**\n * @see {@link https://datatracker.ietf.org/doc/html/rfc9396#section-2 | RFC 9396, Section 2}\n */\nexport const oauthAuthorizationDetailSchema = z.object({\n  type: z.string(),\n  /**\n   * An array of strings representing the location of the resource or RS. These\n   * strings are typically URIs identifying the location of the RS.\n   */\n  locations: z.array(dangerousUriSchema).optional(),\n  /**\n   * An array of strings representing the kinds of actions to be taken at the\n   * resource.\n   */\n  actions: z.array(z.string()).optional(),\n  /**\n   * An array of strings representing the kinds of data being requested from the\n   * resource.\n   */\n  datatypes: z.array(z.string()).optional(),\n  /**\n   * A string identifier indicating a specific resource available at the API.\n   */\n  identifier: z.string().optional(),\n  /**\n   * An array of strings representing the types or levels of privilege being\n   * requested at the resource.\n   */\n  privileges: z.array(z.string()).optional(),\n})\n\nexport type OAuthAuthorizationDetail = z.infer<\n  typeof oauthAuthorizationDetailSchema\n>\n\n/**\n * @see {@link https://datatracker.ietf.org/doc/html/rfc9396#section-2 | RFC 9396, Section 2}\n */\nexport const oauthAuthorizationDetailsSchema = z.array(\n  oauthAuthorizationDetailSchema,\n)\n\nexport type OAuthAuthorizationDetails = z.infer<\n  typeof oauthAuthorizationDetailsSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AACvB,MAAA,+BAA6C;AAE7C;;GAEG,CACU,QAAA,8BAA8B,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACrD,IAAI,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;IAChB;;;OAGG,CACH,SAAS,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,SAAA,kBAAkB,CAAC,CAAC,QAAQ,EAAE;IACjD;;;OAGG,CACH,OAAO,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,QAAQ,EAAE;IACvC;;;OAGG,CACH,SAAS,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,QAAQ,EAAE;IACzC;;OAEG,CACH,UAAU,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IACjC;;;OAGG,CACH,UAAU,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,QAAQ,EAAE;CAC3C,CAAC,CAAA;AAMF;;GAEG,CACU,QAAA,+BAA+B,GAAG,MAAA,CAAC,CAAC,KAAK,CACpD,QAAA,8BAA8B,CAC/B,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15376, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15381, "column": 0}, "map": {"version":3,"file":"oauth-authorization-request-jar.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-authorization-request-jar.ts"],"sourcesContent":["import { signedJwtSchema, unsignedJwtSchema } from '@atproto/jwk'\nimport { z } from 'zod'\n\nexport const oauthAuthorizationRequestJarSchema = z.object({\n  /**\n   * AuthorizationRequest inside a JWT:\n   * - \"iat\" is required and **MUST** be less than one minute\n   *\n   * @see {@link https://datatracker.ietf.org/doc/html/rfc9101}\n   */\n  request: z.union([signedJwtSchema, unsignedJwtSchema]),\n})\n\nexport type OAuthAuthorizationRequestJar = z.infer<\n  typeof oauthAuthorizationRequestJarSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,gCAAiE;AACjE,MAAA,uBAAuB;AAEV,QAAA,kCAAkC,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACzD;;;;;OAKG,CACH,OAAO,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC;QAAC,MAAA,eAAe;QAAE,MAAA,iBAAiB;KAAC,CAAC;CACvD,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15399, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15404, "column": 0}, "map": {"version":3,"file":"oauth-code-challenge-method.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-code-challenge-method.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthCodeChallengeMethodSchema = z.enum(['S256', 'plain'])\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,8BAA8B,GAAG,MAAA,CAAC,CAAC,IAAI,CAAC;IAAC,MAAM;IAAE,OAAO;CAAC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15414, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15419, "column": 0}, "map": {"version":3,"file":"oauth-response-type.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-response-type.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthResponseTypeSchema = z.enum([\n  // OAuth2 (https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-10#section-4.1.1)\n  'code', // Authorization Code Grant\n  'token', // Implicit Grant\n\n  // OIDC (https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html)\n  'none',\n  'code id_token token',\n  'code id_token',\n  'code token',\n  'id_token token',\n  'id_token',\n])\n\nexport type OAuthResponseType = z.infer<typeof oauthResponseTypeSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,uBAAuB,GAAG,MAAA,CAAC,CAAC,IAAI,CAAC;IAC5C,wFAAwF;IACxF,MAAM,EAAE,2BAA2B;IACnC,OAAO,EAAE,iBAAiB;IAE1B,4EAA4E;IAC5E,MAAM;IACN,qBAAqB;IACrB,eAAe;IACf,YAAY;IACZ,gBAAgB;IAChB,UAAU;CACX,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15437, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15442, "column": 0}, "map": {"version":3,"file":"oidc-claims-parameter.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oidc-claims-parameter.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oidcClaimsParameterSchema = z.enum([\n  // https://openid.net/specs/openid-provider-authentication-policy-extension-1_0.html#rfc.section.5.2\n  // if client metadata \"require_auth_time\" is true, this *must* be provided\n  'auth_time',\n\n  // OIDC\n  'nonce',\n  'acr',\n\n  // OpenID: \"profile\" scope\n  'name',\n  'family_name',\n  'given_name',\n  'middle_name',\n  'nickname',\n  'preferred_username',\n  'gender',\n  'picture',\n  'profile',\n  'website',\n  'birthdate',\n  'zoneinfo',\n  'locale',\n  'updated_at',\n\n  // OpenID: \"email\" scope\n  'email',\n  'email_verified',\n\n  // OpenID: \"phone\" scope\n  'phone_number',\n  'phone_number_verified',\n\n  // OpenID: \"address\" scope\n  'address',\n])\n\nexport type OidcClaimsParameter = z.infer<typeof oidcClaimsParameterSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,yBAAyB,GAAG,MAAA,CAAC,CAAC,IAAI,CAAC;IAC9C,oGAAoG;IACpG,0EAA0E;IAC1E,WAAW;IAEX,OAAO;IACP,OAAO;IACP,KAAK;IAEL,0BAA0B;IAC1B,MAAM;IACN,aAAa;IACb,YAAY;IACZ,aAAa;IACb,UAAU;IACV,oBAAoB;IACpB,QAAQ;IACR,SAAS;IACT,SAAS;IACT,SAAS;IACT,WAAW;IACX,UAAU;IACV,QAAQ;IACR,YAAY;IAEZ,wBAAwB;IACxB,OAAO;IACP,gBAAgB;IAEhB,wBAAwB;IACxB,cAAc;IACd,uBAAuB;IAEvB,0BAA0B;IAC1B,SAAS;CACV,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15479, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15484, "column": 0}, "map": {"version":3,"file":"oidc-claims-properties.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oidc-claims-properties.ts"],"sourcesContent":["import { z } from 'zod'\n\nconst oidcClaimsValueSchema = z.union([z.string(), z.number(), z.boolean()])\n\nexport const oidcClaimsPropertiesSchema = z.object({\n  essential: z.boolean().optional(),\n  value: oidcClaimsValueSchema.optional(),\n  values: z.array(oidcClaimsValueSchema).optional(),\n})\n\nexport type OidcClaimsProperties = z.infer<typeof oidcClaimsPropertiesSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEvB,MAAM,qBAAqB,GAAG,MAAA,CAAC,CAAC,KAAK,CAAC;IAAC,MAAA,CAAC,CAAC,MAAM,EAAE;IAAE,MAAA,CAAC,CAAC,MAAM,EAAE;IAAE,MAAA,CAAC,CAAC,OAAO,EAAE;CAAC,CAAC,CAAA;AAE/D,QAAA,0BAA0B,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACjD,SAAS,EAAE,MAAA,CAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;IACjC,KAAK,EAAE,qBAAqB,CAAC,QAAQ,EAAE;IACvC,MAAM,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC,QAAQ,EAAE;CAClD,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15500, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15505, "column": 0}, "map": {"version":3,"file":"oidc-entity-type.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oidc-entity-type.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oidcEntityTypeSchema = z.enum(['userinfo', 'id_token'])\n\nexport type OidcEntityType = z.infer<typeof oidcEntityTypeSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,oBAAoB,GAAG,MAAA,CAAC,CAAC,IAAI,CAAC;IAAC,UAAU;IAAE,UAAU;CAAC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15515, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15520, "column": 0}, "map": {"version":3,"file":"oauth-authorization-request-parameters.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-authorization-request-parameters.ts"],"sourcesContent":["import { signedJwtSchema } from '@atproto/jwk'\nimport { z } from 'zod'\n\nimport { oauthAuthorizationDetailsSchema } from './oauth-authorization-details.js'\nimport { oauthClientIdSchema } from './oauth-client-id.js'\nimport { oauthCodeChallengeMethodSchema } from './oauth-code-challenge-method.js'\nimport { oauthRedirectUriSchema } from './oauth-redirect-uri.js'\nimport { oauthResponseTypeSchema } from './oauth-response-type.js'\nimport { oauthScopeSchema } from './oauth-scope.js'\nimport { oidcClaimsParameterSchema } from './oidc-claims-parameter.js'\nimport { oidcClaimsPropertiesSchema } from './oidc-claims-properties.js'\nimport { oidcEntityTypeSchema } from './oidc-entity-type.js'\n\n/**\n * @see {@link https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest | OIDC}\n */\nexport const oauthAuthorizationRequestParametersSchema = z.object({\n  client_id: oauthClientIdSchema,\n  state: z.string().optional(),\n  redirect_uri: oauthRedirectUriSchema.optional(),\n  scope: oauthScopeSchema.optional(),\n  response_type: oauthResponseTypeSchema,\n\n  // PKCE\n\n  code_challenge: z.string().optional(),\n  code_challenge_method: oauthCodeChallengeMethodSchema\n    .default('S256')\n    .optional(),\n\n  // DPOP\n\n  // https://datatracker.ietf.org/doc/html/rfc9449#section-12.3\n  dpop_jkt: z.string().optional(),\n\n  // OIDC\n\n  // Default depend on response_type\n  response_mode: z.enum(['query', 'fragment', 'form_post']).optional(),\n\n  nonce: z.string().optional(),\n\n  // Specifies the allowable elapsed time in seconds since the last time the\n  // End-User was actively authenticated by the OP. If the elapsed time is\n  // greater than this value, the OP MUST attempt to actively re-authenticate\n  // the End-User. (The max_age request parameter corresponds to the OpenID 2.0\n  // PAPE [OpenID.PAPE] max_auth_age request parameter.) When max_age is used,\n  // the ID Token returned MUST include an auth_time Claim Value. Note that\n  // max_age=0 is equivalent to prompt=login.\n  max_age: z.number().int().min(0).optional(),\n\n  claims: z\n    .record(\n      oidcEntityTypeSchema,\n      z.record(\n        oidcClaimsParameterSchema,\n        z.union([z.literal(null), oidcClaimsPropertiesSchema]),\n      ),\n    )\n    .optional(),\n\n  // https://openid.net/specs/openid-connect-core-1_0.html#RegistrationParameter\n  // Not supported by this library (yet?)\n  // registration: clientMetadataSchema.optional(),\n\n  login_hint: z.string().min(1).optional(),\n\n  ui_locales: z\n    .string()\n    .regex(/^[a-z]{2}(-[A-Z]{2})?( [a-z]{2}(-[A-Z]{2})?)*$/) // fr-CA fr en\n    .optional(),\n\n  // Previous ID Token, should be provided when prompt=none is used\n  id_token_hint: signedJwtSchema.optional(),\n\n  // Type of UI the AS is displayed on\n  display: z.enum(['page', 'popup', 'touch', 'wap']).optional(),\n\n  /**\n   * - \"none\" will only be allowed if the user already allowed the client on the same device\n   * - \"login\" will force the user to login again, unless he very recently logged in\n   * - \"consent\" will force the user to consent again\n   * - \"select_account\" will force the user to select an account\n   */\n  prompt: z.enum(['none', 'login', 'consent', 'select_account']).optional(),\n\n  // https://datatracker.ietf.org/doc/html/rfc9396\n  authorization_details: oauthAuthorizationDetailsSchema.optional(),\n})\n\n/**\n * @see {oauthAuthorizationRequestParametersSchema}\n */\nexport type OAuthAuthorizationRequestParameters = z.infer<\n  typeof oauthAuthorizationRequestParametersSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,gCAA8C;AAC9C,MAAA,uBAAuB;AAEvB,MAAA,+EAAkF;AAClF,MAAA,uDAA0D;AAC1D,MAAA,+EAAiF;AACjF,MAAA,6DAAgE;AAChE,MAAA,+DAAkE;AAClE,MAAA,+CAAmD;AACnD,MAAA,mEAAsE;AACtE,MAAA,qEAAwE;AACxE,MAAA,yDAA4D;AAE5D;;GAEG,CACU,QAAA,yCAAyC,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IAChE,SAAS,EAAE,qBAAA,mBAAmB;IAC9B,KAAK,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IAC5B,YAAY,EAAE,wBAAA,sBAAsB,CAAC,QAAQ,EAAE;IAC/C,KAAK,EAAE,iBAAA,gBAAgB,CAAC,QAAQ,EAAE;IAClC,aAAa,EAAE,yBAAA,uBAAuB;IAEtC,OAAO;IAEP,cAAc,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IACrC,qBAAqB,EAAE,iCAAA,8BAA8B,CAClD,OAAO,CAAC,MAAM,CAAC,CACf,QAAQ,EAAE;IAEb,OAAO;IAEP,6DAA6D;IAC7D,QAAQ,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IAE/B,OAAO;IAEP,kCAAkC;IAClC,aAAa,EAAE,MAAA,CAAC,CAAC,IAAI,CAAC;QAAC,OAAO;QAAE,UAAU;QAAE,WAAW;KAAC,CAAC,CAAC,QAAQ,EAAE;IAEpE,KAAK,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IAE5B,0EAA0E;IAC1E,wEAAwE;IACxE,2EAA2E;IAC3E,6EAA6E;IAC7E,4EAA4E;IAC5E,yEAAyE;IACzE,2CAA2C;IAC3C,OAAO,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;IAE3C,MAAM,EAAE,MAAA,CAAC,CACN,MAAM,CACL,sBAAA,oBAAoB,EACpB,MAAA,CAAC,CAAC,MAAM,CACN,2BAAA,yBAAyB,EACzB,MAAA,CAAC,CAAC,KAAK,CAAC;QAAC,MAAA,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC;QAAE,4BAAA,0BAA0B;KAAC,CAAC,CACvD,CACF,CACA,QAAQ,EAAE;IAEb,8EAA8E;IAC9E,uCAAuC;IACvC,iDAAiD;IAEjD,UAAU,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;IAExC,UAAU,EAAE,MAAA,CAAC,CACV,MAAM,EAAE,CACR,KAAK,CAAC,gDAAgD,CAAC,CAAC,cAAc;KACtE,QAAQ,EAAE;IAEb,iEAAiE;IACjE,aAAa,EAAE,MAAA,eAAe,CAAC,QAAQ,EAAE;IAEzC,oCAAoC;IACpC,OAAO,EAAE,MAAA,CAAC,CAAC,IAAI,CAAC;QAAC,MAAM;QAAE,OAAO;QAAE,OAAO;QAAE,KAAK;KAAC,CAAC,CAAC,QAAQ,EAAE;IAE7D;;;;;OAKG,CACH,MAAM,EAAE,MAAA,CAAC,CAAC,IAAI,CAAC;QAAC,MAAM;QAAE,OAAO;QAAE,SAAS;QAAE,gBAAgB;KAAC,CAAC,CAAC,QAAQ,EAAE;IAEzE,gDAAgD;IAChD,qBAAqB,EAAE,iCAAA,+BAA+B,CAAC,QAAQ,EAAE;CAClE,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15599, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15604, "column": 0}, "map": {"version":3,"file":"oauth-authorization-request-par.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-authorization-request-par.ts"],"sourcesContent":["import { z } from 'zod'\n\nimport { oauthAuthorizationRequestJarSchema } from './oauth-authorization-request-jar.js'\nimport { oauthAuthorizationRequestParametersSchema } from './oauth-authorization-request-parameters.js'\n\nexport const oauthAuthorizationRequestParSchema = z.union([\n  oauthAuthorizationRequestParametersSchema,\n  oauthAuthorizationRequestJarSchema,\n])\n\nexport type OAuthAuthorizationRequestPar = z.infer<\n  typeof oauthAuthorizationRequestParSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEvB,MAAA,uFAAyF;AACzF,MAAA,qGAAuG;AAE1F,QAAA,kCAAkC,GAAG,MAAA,CAAC,CAAC,KAAK,CAAC;IACxD,4CAAA,yCAAyC;IACzC,qCAAA,kCAAkC;CACnC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15616, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15621, "column": 0}, "map": {"version":3,"file":"oauth-request-uri.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-request-uri.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthRequestUriSchema = z.string()\n\nexport type OAuthRequestUri = z.infer<typeof oauthRequestUriSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,qBAAqB,GAAG,MAAA,CAAC,CAAC,MAAM,EAAE,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15628, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15633, "column": 0}, "map": {"version":3,"file":"oauth-authorization-request-uri.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-authorization-request-uri.ts"],"sourcesContent":["import { z } from 'zod'\n\nimport { oauthRequestUriSchema } from './oauth-request-uri.js'\n\nexport const oauthAuthorizationRequestUriSchema = z.object({\n  request_uri: oauthRequestUriSchema,\n})\n\nexport type OAuthAuthorizationRequestUri = z.infer<\n  typeof oauthAuthorizationRequestUriSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEvB,MAAA,2DAA8D;AAEjD,QAAA,kCAAkC,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACzD,WAAW,EAAE,uBAAA,qBAAqB;CACnC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15643, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15648, "column": 0}, "map": {"version":3,"file":"oauth-authorization-request-query.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-authorization-request-query.ts"],"sourcesContent":["import { z } from 'zod'\n\nimport { oauthAuthorizationRequestJarSchema } from './oauth-authorization-request-jar.js'\nimport { oauthAuthorizationRequestParametersSchema } from './oauth-authorization-request-parameters.js'\nimport { oauthAuthorizationRequestUriSchema } from './oauth-authorization-request-uri.js'\n\nexport const oauthAuthorizationRequestQuerySchema = z.union([\n  oauthAuthorizationRequestParametersSchema,\n  oauthAuthorizationRequestJarSchema,\n  oauthAuthorizationRequestUriSchema,\n])\n\nexport type OAuthAuthorizationRequestQuery = z.infer<\n  typeof oauthAuthorizationRequestQuerySchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEvB,MAAA,uFAAyF;AACzF,MAAA,qGAAuG;AACvG,MAAA,uFAAyF;AAE5E,QAAA,oCAAoC,GAAG,MAAA,CAAC,CAAC,KAAK,CAAC;IAC1D,4CAAA,yCAAyC;IACzC,qCAAA,kCAAkC;IAClC,qCAAA,kCAAkC;CACnC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15662, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15667, "column": 0}, "map": {"version":3,"file":"oauth-issuer-identifier.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-issuer-identifier.ts"],"sourcesContent":["import { z } from 'zod'\nimport { webUriSchema } from './uri.js'\n\nexport const oauthIssuerIdentifierSchema = webUriSchema.superRefine(\n  (value, ctx) => {\n    // Validate the issuer (MIX-UP attacks)\n\n    if (value.endsWith('/')) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'Issuer URL must not end with a slash',\n      })\n      return false\n    }\n\n    const url = new URL(value)\n\n    if (url.username || url.password) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'Issuer URL must not contain a username or password',\n      })\n      return false\n    }\n\n    if (url.hash || url.search) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'Issuer URL must not contain a query or fragment',\n      })\n      return false\n    }\n\n    const canonicalValue = url.pathname === '/' ? url.origin : url.href\n    if (value !== canonicalValue) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'Issuer URL must be in the canonical form',\n      })\n      return false\n    }\n\n    return true\n  },\n)\n\nexport type OAuthIssuerIdentifier = z.infer<typeof oauthIssuerIdentifierSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AACvB,MAAA,+BAAuC;AAE1B,QAAA,2BAA2B,GAAG,SAAA,YAAY,CAAC,WAAW,CACjE,CAAC,KAAK,EAAE,GAAG,EAAE,EAAE;IACb,uCAAuC;IAEvC,IAAI,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;QACxB,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,sCAAsC;SAChD,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,KAAK,CAAC,CAAA;IAE1B,IAAI,GAAG,CAAC,QAAQ,IAAI,GAAG,CAAC,QAAQ,EAAE,CAAC;QACjC,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,oDAAoD;SAC9D,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,IAAI,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,MAAM,EAAE,CAAC;QAC3B,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,iDAAiD;SAC3D,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,MAAM,cAAc,GAAG,GAAG,CAAC,QAAQ,KAAK,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAA;IACnE,IAAI,KAAK,KAAK,cAAc,EAAE,CAAC;QAC7B,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,0CAA0C;SACpD,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,OAAO,IAAI,CAAA;AACb,CAAC,CACF,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15708, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15713, "column": 0}, "map": {"version":3,"file":"oauth-authorization-server-metadata.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-authorization-server-metadata.ts"],"sourcesContent":["import { z } from 'zod'\n\nimport { oauthCodeChallengeMethodSchema } from './oauth-code-challenge-method.js'\nimport { oauthIssuerIdentifierSchema } from './oauth-issuer-identifier.js'\nimport { webUriSchema } from './uri.js'\n\n/**\n * @see {@link https://datatracker.ietf.org/doc/html/rfc8414}\n * @note we do not enforce https: scheme in URIs to support development\n * environments. Make sure to validate the URIs before using it in a production\n * environment.\n */\nexport const oauthAuthorizationServerMetadataSchema = z.object({\n  issuer: oauthIssuerIdentifierSchema,\n\n  claims_supported: z.array(z.string()).optional(),\n  claims_locales_supported: z.array(z.string()).optional(),\n  claims_parameter_supported: z.boolean().optional(),\n  request_parameter_supported: z.boolean().optional(),\n  request_uri_parameter_supported: z.boolean().optional(),\n  require_request_uri_registration: z.boolean().optional(),\n  scopes_supported: z.array(z.string()).optional(),\n  subject_types_supported: z.array(z.string()).optional(),\n  response_types_supported: z.array(z.string()).optional(),\n  response_modes_supported: z.array(z.string()).optional(),\n  grant_types_supported: z.array(z.string()).optional(),\n  code_challenge_methods_supported: z\n    .array(oauthCodeChallengeMethodSchema)\n    .min(1)\n    .optional(),\n  ui_locales_supported: z.array(z.string()).optional(),\n  id_token_signing_alg_values_supported: z.array(z.string()).optional(),\n  display_values_supported: z.array(z.string()).optional(),\n  request_object_signing_alg_values_supported: z.array(z.string()).optional(),\n  authorization_response_iss_parameter_supported: z.boolean().optional(),\n  authorization_details_types_supported: z.array(z.string()).optional(),\n  request_object_encryption_alg_values_supported: z\n    .array(z.string())\n    .optional(),\n  request_object_encryption_enc_values_supported: z\n    .array(z.string())\n    .optional(),\n\n  jwks_uri: webUriSchema.optional(),\n\n  authorization_endpoint: webUriSchema, // .optional(),\n\n  token_endpoint: webUriSchema, // .optional(),\n  token_endpoint_auth_methods_supported: z.array(z.string()).optional(),\n  token_endpoint_auth_signing_alg_values_supported: z\n    .array(z.string())\n    .optional(),\n\n  revocation_endpoint: webUriSchema.optional(),\n  introspection_endpoint: webUriSchema.optional(),\n  pushed_authorization_request_endpoint: webUriSchema.optional(),\n\n  require_pushed_authorization_requests: z.boolean().optional(),\n\n  userinfo_endpoint: webUriSchema.optional(),\n  end_session_endpoint: webUriSchema.optional(),\n  registration_endpoint: webUriSchema.optional(),\n\n  // https://datatracker.ietf.org/doc/html/rfc9449#section-5.1\n  dpop_signing_alg_values_supported: z.array(z.string()).optional(),\n\n  // https://datatracker.ietf.org/doc/html/draft-ietf-oauth-resource-metadata-05#section-4\n  protected_resources: z.array(webUriSchema).optional(),\n\n  // https://drafts.aaronpk.com/draft-parecki-oauth-client-id-metadata-document/draft-parecki-oauth-client-id-metadata-document.html\n  client_id_metadata_document_supported: z.boolean().optional(),\n})\n\nexport type OAuthAuthorizationServerMetadata = z.infer<\n  typeof oauthAuthorizationServerMetadataSchema\n>\n\nexport const oauthAuthorizationServerMetadataValidator =\n  oauthAuthorizationServerMetadataSchema\n    .superRefine((data, ctx) => {\n      if (\n        data.require_pushed_authorization_requests &&\n        !data.pushed_authorization_request_endpoint\n      ) {\n        ctx.addIssue({\n          code: z.ZodIssueCode.custom,\n          message:\n            '\"pushed_authorization_request_endpoint\" required when \"require_pushed_authorization_requests\" is true',\n        })\n      }\n    })\n    .superRefine((data, ctx) => {\n      if (data.response_types_supported) {\n        if (!data.response_types_supported.includes('code')) {\n          ctx.addIssue({\n            code: z.ZodIssueCode.custom,\n            message: 'Response type \"code\" is required',\n          })\n        }\n      }\n    })\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 15785, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15790, "column": 0}, "map": {"version":3,"file":"oauth-client-credentials-grant-token-request.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-client-credentials-grant-token-request.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthClientCredentialsGrantTokenRequestSchema = z.object({\n  grant_type: z.literal('client_credentials'),\n})\n\nexport type OAuthClientCredentialsGrantTokenRequest = z.infer<\n  typeof oauthClientCredentialsGrantTokenRequestSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,6CAA6C,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACpE,UAAU,EAAE,MAAA,CAAC,CAAC,OAAO,CAAC,oBAAoB,CAAC;CAC5C,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15799, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15804, "column": 0}, "map": {"version":3,"file":"oauth-client-credentials.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-client-credentials.ts"],"sourcesContent":["import { z } from 'zod'\nimport { signedJwtSchema } from '@atproto/jwk'\n\nimport { oauthClientIdSchema } from './oauth-client-id.js'\nimport { CLIENT_ASSERTION_TYPE_JWT_BEARER } from './constants.js'\n\nexport const oauthClientCredentialsJwtBearerSchema = z.object({\n  client_id: oauthClientIdSchema,\n  client_assertion_type: z.literal(CLIENT_ASSERTION_TYPE_JWT_BEARER),\n  /**\n   * - \"sub\" the subject MUST be the \"client_id\" of the OAuth client\n   * - \"iat\" is required and MUST be less than one minute\n   * - \"aud\" must containing a value that identifies the authorization server\n   * - The JWT MAY contain a \"jti\" (JWT ID) claim that provides a unique identifier for the token.\n   * - Note that the authorization server may reject JWTs with an \"exp\" claim value that is unreasonably far in the future.\n   *\n   * @see {@link https://datatracker.ietf.org/doc/html/rfc7523#section-3}\n   */\n  client_assertion: signedJwtSchema,\n})\n\nexport type OAuthClientCredentialsJwtBearer = z.infer<\n  typeof oauthClientCredentialsJwtBearerSchema\n>\n\nexport const oauthClientCredentialsSecretPostSchema = z.object({\n  client_id: oauthClientIdSchema,\n  client_secret: z.string(),\n})\n\nexport type OAuthClientCredentialsSecretPost = z.infer<\n  typeof oauthClientCredentialsSecretPostSchema\n>\n\nexport const oauthClientCredentialsNoneSchema = z.object({\n  client_id: oauthClientIdSchema,\n})\n\nexport type OAuthClientCredentialsNone = z.infer<\n  typeof oauthClientCredentialsNoneSchema\n>\n\n//\n\nexport const oauthClientCredentialsSchema = z.union([\n  oauthClientCredentialsJwtBearerSchema,\n  oauthClientCredentialsSecretPostSchema,\n  // Must be last since it is less specific\n  oauthClientCredentialsNoneSchema,\n])\n\nexport type OAuthClientCredentials = z.infer<\n  typeof oauthClientCredentialsSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AACvB,MAAA,gCAA8C;AAE9C,MAAA,uDAA0D;AAC1D,MAAA,2CAAiE;AAEpD,QAAA,qCAAqC,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IAC5D,SAAS,EAAE,qBAAA,mBAAmB;IAC9B,qBAAqB,EAAE,MAAA,CAAC,CAAC,OAAO,CAAC,eAAA,gCAAgC,CAAC;IAClE;;;;;;;;OAQG,CACH,gBAAgB,EAAE,MAAA,eAAe;CAClC,CAAC,CAAA;AAMW,QAAA,sCAAsC,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IAC7D,SAAS,EAAE,qBAAA,mBAAmB;IAC9B,aAAa,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;CAC1B,CAAC,CAAA;AAMW,QAAA,gCAAgC,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACvD,SAAS,EAAE,qBAAA,mBAAmB;CAC/B,CAAC,CAAA;AAMF,EAAE;AAEW,QAAA,4BAA4B,GAAG,MAAA,CAAC,CAAC,KAAK,CAAC;IAClD,QAAA,qCAAqC;IACrC,QAAA,sCAAsC;IACtC,yCAAyC;IACzC,QAAA,gCAAgC;CACjC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15840, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15845, "column": 0}, "map": {"version":3,"file":"oauth-client-id-discoverable.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-client-id-discoverable.ts"],"sourcesContent":["import { TypeOf, z } from 'zod'\nimport { oauthClientIdSchema } from './oauth-client-id.js'\nimport { httpsUriSchema } from './uri.js'\nimport { extractUrlPath, isHostnameIP } from './util.js'\n\n/**\n * @see {@link https://drafts.aaronpk.com/draft-parecki-oauth-client-id-metadata-document/draft-parecki-oauth-client-id-metadata-document.html}\n */\nexport const oauthClientIdDiscoverableSchema = z\n  .intersection(oauthClientIdSchema, httpsUriSchema)\n  .superRefine((value, ctx): value is `https://${string}/${string}` => {\n    const url = new URL(value)\n\n    if (url.username || url.password) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'ClientID must not contain credentials',\n      })\n      return false\n    }\n\n    if (url.hash) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'ClientID must not contain a fragment',\n      })\n      return false\n    }\n\n    if (url.pathname === '/') {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message:\n          'ClientID must contain a path component (e.g. \"/client-metadata.json\")',\n      })\n      return false\n    }\n\n    if (url.pathname.endsWith('/')) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'ClientID path must not end with a trailing slash',\n      })\n      return false\n    }\n\n    if (isHostnameIP(url.hostname)) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'ClientID hostname must not be an IP address',\n      })\n      return false\n    }\n\n    // URL constructor normalizes the URL, so we extract the path manually to\n    // avoid normalization, then compare it to the normalized path to ensure\n    // that the URL does not contain path traversal or other unexpected characters\n    if (extractUrlPath(value) !== url.pathname) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: `ClientID must be in canonical form (\"${url.href}\", got \"${value}\")`,\n      })\n      return false\n    }\n\n    return true\n  })\n\nexport type OAuthClientIdDiscoverable = TypeOf<\n  typeof oauthClientIdDiscoverableSchema\n>\n\nexport function isOAuthClientIdDiscoverable(\n  clientId: string,\n): clientId is OAuthClientIdDiscoverable {\n  return oauthClientIdDiscoverableSchema.safeParse(clientId).success\n}\n\nexport function assertOAuthDiscoverableClientId(\n  value: string,\n): asserts value is OAuthClientIdDiscoverable {\n  void oauthClientIdDiscoverableSchema.parse(value)\n}\n\nexport function parseOAuthDiscoverableClientId(clientId: string): URL {\n  return new URL(oauthClientIdDiscoverableSchema.parse(clientId))\n}\n"],"names":[],"mappings":";;;;;AAwEA,QAAA,2BAAA,GAAA,4BAIC;AAED,QAAA,+BAAA,GAAA,gCAIC;AAED,QAAA,8BAAA,GAAA,+BAEC;AAtFD,MAAA,uBAA+B;AAC/B,MAAA,uDAA0D;AAC1D,MAAA,+BAAyC;AACzC,MAAA,iCAAwD;AAExD;;GAEG,CACU,QAAA,+BAA+B,GAAG,MAAA,CAAC,CAC7C,YAAY,CAAC,qBAAA,mBAAmB,EAAE,SAAA,cAAc,CAAC,CACjD,WAAW,CAAC,CAAC,KAAK,EAAE,GAAG,EAA0C,EAAE;IAClE,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,KAAK,CAAC,CAAA;IAE1B,IAAI,GAAG,CAAC,QAAQ,IAAI,GAAG,CAAC,QAAQ,EAAE,CAAC;QACjC,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,uCAAuC;SACjD,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,IAAI,GAAG,CAAC,IAAI,EAAE,CAAC;QACb,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,sCAAsC;SAChD,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,IAAI,GAAG,CAAC,QAAQ,KAAK,GAAG,EAAE,CAAC;QACzB,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EACL,uEAAuE;SAC1E,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,IAAI,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;QAC/B,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,kDAAkD;SAC5D,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,IAAI,CAAA,GAAA,UAAA,YAAY,EAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC;QAC/B,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,6CAA6C;SACvD,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,yEAAyE;IACzE,wEAAwE;IACxE,8EAA8E;IAC9E,IAAI,CAAA,GAAA,UAAA,cAAc,EAAC,KAAK,CAAC,KAAK,GAAG,CAAC,QAAQ,EAAE,CAAC;QAC3C,GAAG,CAAC,QAAQ,CAAC;YACX,IAAI,EAAE,MAAA,CAAC,CAAC,YAAY,CAAC,MAAM;YAC3B,OAAO,EAAE,CAAA,qCAAA,EAAwC,GAAG,CAAC,IAAI,CAAA,QAAA,EAAW,KAAK,CAAA,EAAA,CAAI;SAC9E,CAAC,CAAA;QACF,OAAO,KAAK,CAAA;IACd,CAAC;IAED,OAAO,IAAI,CAAA;AACb,CAAC,CAAC,CAAA;AAMJ,SAAgB,2BAA2B,CACzC,QAAgB;IAEhB,OAAO,QAAA,+BAA+B,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAA;AACpE,CAAC;AAED,SAAgB,+BAA+B,CAC7C,KAAa;IAEb,KAAK,QAAA,+BAA+B,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;AACnD,CAAC;AAED,SAAgB,8BAA8B,CAAC,QAAgB;IAC7D,OAAO,IAAI,GAAG,CAAC,QAAA,+BAA+B,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAA;AACjE,CAAC","ignoreList":[0]}},
    {"offset": {"line": 15917, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15922, "column": 0}, "map": {"version":3,"file":"oauth-endpoint-auth-method.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-endpoint-auth-method.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthEndpointAuthMethod = z.enum([\n  'client_secret_basic',\n  'client_secret_jwt',\n  'client_secret_post',\n  'none',\n  'private_key_jwt',\n  'self_signed_tls_client_auth',\n  'tls_client_auth',\n])\n\nexport type OauthEndpointAuthMethod = z.infer<typeof oauthEndpointAuthMethod>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,uBAAuB,GAAG,MAAA,CAAC,CAAC,IAAI,CAAC;IAC5C,qBAAqB;IACrB,mBAAmB;IACnB,oBAAoB;IACpB,MAAM;IACN,iBAAiB;IACjB,6BAA6B;IAC7B,iBAAiB;CAClB,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15937, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15942, "column": 0}, "map": {"version":3,"file":"oauth-grant-type.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-grant-type.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthGrantTypeSchema = z.enum([\n  'authorization_code',\n  'implicit',\n  'refresh_token',\n  'password', // Not part of OAuth 2.1\n  'client_credentials',\n  'urn:ietf:params:oauth:grant-type:jwt-bearer',\n  'urn:ietf:params:oauth:grant-type:saml2-bearer',\n])\n\nexport type OAuthGrantType = z.infer<typeof oauthGrantTypeSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,oBAAoB,GAAG,MAAA,CAAC,CAAC,IAAI,CAAC;IACzC,oBAAoB;IACpB,UAAU;IACV,eAAe;IACf,UAAU,EAAE,wBAAwB;IACpC,oBAAoB;IACpB,6CAA6C;IAC7C,+CAA+C;CAChD,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 15957, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15962, "column": 0}, "map": {"version":3,"file":"oauth-client-metadata.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-client-metadata.ts"],"sourcesContent":["import { jwksPubSchema } from '@atproto/jwk'\nimport { z } from 'zod'\n\nimport { oauthClientIdSchema } from './oauth-client-id.js'\nimport { oauthEndpointAuthMethod } from './oauth-endpoint-auth-method.js'\nimport { oauthGrantTypeSchema } from './oauth-grant-type.js'\nimport { oauthRedirectUriSchema } from './oauth-redirect-uri.js'\nimport { oauthResponseTypeSchema } from './oauth-response-type.js'\nimport { oauthScopeSchema } from './oauth-scope.js'\nimport { webUriSchema } from './uri.js'\n\n/**\n * @see {@link https://openid.net/specs/openid-connect-registration-1_0.html}\n * @see {@link https://datatracker.ietf.org/doc/html/rfc7591}\n * @note we do not enforce https: scheme in URIs to support development\n * environments. Make sure to validate the URIs before using it in a production\n * environment.\n */\nexport const oauthClientMetadataSchema = z.object({\n  /**\n   * @note redirect_uris require additional validation\n   */\n  redirect_uris: z.array(oauthRedirectUriSchema).nonempty(),\n  response_types: z\n    .array(oauthResponseTypeSchema)\n    .nonempty()\n    // > If omitted, the default is that the client will use only the \"code\"\n    // > response type.\n    .default(['code']),\n  grant_types: z\n    .array(oauthGrantTypeSchema)\n    .nonempty()\n    // > If omitted, the default behavior is that the client will use only the\n    // > \"authorization_code\" Grant Type.\n    .default(['authorization_code']),\n  scope: oauthScopeSchema.optional(),\n  token_endpoint_auth_method: oauthEndpointAuthMethod\n    .default('none')\n    .optional(),\n  token_endpoint_auth_signing_alg: z.string().optional(),\n  userinfo_signed_response_alg: z.string().optional(),\n  userinfo_encrypted_response_alg: z.string().optional(),\n  jwks_uri: webUriSchema.optional(),\n  jwks: jwksPubSchema.optional(),\n  application_type: z.enum(['web', 'native']).default('web').optional(), // default, per spec, is \"web\"\n  subject_type: z.enum(['public', 'pairwise']).default('public').optional(),\n  request_object_signing_alg: z.string().optional(),\n  id_token_signed_response_alg: z.string().optional(),\n  authorization_signed_response_alg: z.string().default('RS256').optional(),\n  authorization_encrypted_response_enc: z.enum(['A128CBC-HS256']).optional(),\n  authorization_encrypted_response_alg: z.string().optional(),\n  client_id: oauthClientIdSchema.optional(),\n  client_name: z.string().optional(),\n  client_uri: webUriSchema.optional(),\n  policy_uri: webUriSchema.optional(),\n  tos_uri: webUriSchema.optional(),\n  logo_uri: webUriSchema.optional(), // TODO: allow data: uri ?\n\n  /**\n   * Default Maximum Authentication Age. Specifies that the End-User MUST be\n   * actively authenticated if the End-User was authenticated longer ago than\n   * the specified number of seconds. The max_age request parameter overrides\n   * this default value. If omitted, no default Maximum Authentication Age is\n   * specified.\n   */\n  default_max_age: z.number().optional(),\n  require_auth_time: z.boolean().optional(),\n  contacts: z.array(z.string().email()).optional(),\n  tls_client_certificate_bound_access_tokens: z.boolean().optional(),\n\n  // https://datatracker.ietf.org/doc/html/rfc9449#section-5.2\n  dpop_bound_access_tokens: z.boolean().optional(),\n\n  // https://datatracker.ietf.org/doc/html/rfc9396#section-14.5\n  authorization_details_types: z.array(z.string()).optional(),\n})\n\nexport type OAuthClientMetadata = z.infer<typeof oauthClientMetadataSchema>\nexport type OAuthClientMetadataInput = z.input<typeof oauthClientMetadataSchema>\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 16039, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16044, "column": 0}, "map": {"version":3,"file":"oauth-endpoint-name.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-endpoint-name.ts"],"sourcesContent":["export const OAUTH_ENDPOINT_NAMES = [\n  'token',\n  'revocation',\n  'introspection',\n  'pushed_authorization_request',\n] as const\n\nexport type OAuthEndpointName = (typeof OAUTH_ENDPOINT_NAMES)[number]\n"],"names":[],"mappings":";;;;;AAAa,QAAA,oBAAoB,GAAG;IAClC,OAAO;IACP,YAAY;IACZ,eAAe;IACf,8BAA8B;CACtB,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16055, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16060, "column": 0}, "map": {"version":3,"file":"oauth-introspection-response.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-introspection-response.ts"],"sourcesContent":["import { OAuthAuthorizationDetails } from './oauth-authorization-details.js'\nimport { OAuthTokenType } from './oauth-token-type.js'\n\n// https://datatracker.ietf.org/doc/html/rfc7662#section-2.2\nexport type OAuthIntrospectionResponse =\n  | { active: false }\n  | {\n      active: true\n\n      scope?: string\n      client_id?: string\n      username?: string\n      token_type?: OAuthTokenType\n      authorization_details?: OAuthAuthorizationDetails\n\n      aud?: string | [string, ...string[]]\n      exp?: number\n      iat?: number\n      iss?: string\n      jti?: string\n      nbf?: number\n      sub?: string\n    }\n"],"names":[],"mappings":"","ignoreList":[0]}},
    {"offset": {"line": 16064, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16069, "column": 0}, "map": {"version":3,"file":"oauth-par-response.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-par-response.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthParResponseSchema = z.object({\n  request_uri: z.string(),\n  expires_in: z.number().int().positive(),\n})\n\nexport type OAuthParResponse = z.infer<typeof oauthParResponseSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,sBAAsB,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IAC7C,WAAW,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;IACvB,UAAU,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;CACxC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16079, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16084, "column": 0}, "map": {"version":3,"file":"oauth-password-grant-token-request.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-password-grant-token-request.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthPasswordGrantTokenRequestSchema = z.object({\n  grant_type: z.literal('password'),\n  username: z.string(),\n  password: z.string(),\n})\n\nexport type OAuthPasswordGrantTokenRequest = z.infer<\n  typeof oauthPasswordGrantTokenRequestSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,oCAAoC,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IAC3D,UAAU,EAAE,MAAA,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC;IACjC,QAAQ,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;IACpB,QAAQ,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;CACrB,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16095, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16100, "column": 0}, "map": {"version":3,"file":"oauth-protected-resource-metadata.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-protected-resource-metadata.ts"],"sourcesContent":["import { z } from 'zod'\n\nimport { oauthIssuerIdentifierSchema } from './oauth-issuer-identifier.js'\nimport { webUriSchema } from './uri.js'\n\n/**\n * @see {@link https://datatracker.ietf.org/doc/html/draft-ietf-oauth-resource-metadata-05#name-protected-resource-metadata-r}\n */\nexport const oauthProtectedResourceMetadataSchema = z.object({\n  /**\n   * REQUIRED. The protected resource's resource identifier, which is a URL that\n   * uses the https scheme and has no query or fragment components. Using these\n   * well-known resources is described in Section 3.\n   *\n   * @note This schema allows non https URLs for testing & development purposes.\n   * Make sure to validate the URL before using it in a production environment.\n   */\n  resource: webUriSchema\n    .refine((url) => !url.includes('?'), {\n      message: 'Resource URL must not contain query parameters',\n    })\n    .refine((url) => !url.includes('#'), {\n      message: 'Resource URL must not contain a fragment',\n    }),\n\n  /**\n   * OPTIONAL. JSON array containing a list of OAuth authorization server issuer\n   * identifiers, as defined in [RFC8414], for authorization servers that can be\n   * used with this protected resource. Protected resources MAY choose not to\n   * advertise some supported authorization servers even when this parameter is\n   * used. In some use cases, the set of authorization servers will not be\n   * enumerable, in which case this metadata parameter would not be used.\n   */\n  authorization_servers: z.array(oauthIssuerIdentifierSchema).optional(),\n\n  /**\n   * OPTIONAL. URL of the protected resource's JWK Set [JWK] document. This\n   * contains public keys belonging to the protected resource, such as signing\n   * key(s) that the resource server uses to sign resource responses. This URL\n   * MUST use the https scheme. When both signing and encryption keys are made\n   * available, a use (public key use) parameter value is REQUIRED for all keys\n   * in the referenced JWK Set to indicate each key's intended usage.\n   */\n  jwks_uri: webUriSchema.optional(),\n\n  /**\n   * RECOMMENDED. JSON array containing a list of the OAuth 2.0 [RFC6749] scope\n   * values that are used in authorization requests to request access to this\n   * protected resource. Protected resources MAY choose not to advertise some\n   * scope values supported even when this parameter is used.\n   */\n  scopes_supported: z.array(z.string()).optional(),\n\n  /**\n   * OPTIONAL. JSON array containing a list of the supported methods of sending\n   * an OAuth 2.0 Bearer Token [RFC6750] to the protected resource. Defined\n   * values are [\"header\", \"body\", \"query\"], corresponding to Sections 2.1, 2.2,\n   * and 2.3 of RFC 6750.\n   */\n  bearer_methods_supported: z\n    .array(z.enum(['header', 'body', 'query']))\n    .optional(),\n\n  /**\n   * OPTIONAL. JSON array containing a list of the JWS [JWS] signing algorithms\n   * (alg values) [JWA] supported by the protected resource for signing resource\n   * responses, for instance, as described in [FAPI.MessageSigning]. No default\n   * algorithms are implied if this entry is omitted. The value none MUST NOT be\n   * used.\n   */\n  resource_signing_alg_values_supported: z.array(z.string()).optional(),\n\n  /**\n   * OPTIONAL. URL of a page containing human-readable information that\n   * developers might want or need to know when using the protected resource\n   */\n  resource_documentation: webUriSchema.optional(),\n\n  /**\n   * OPTIONAL. URL that the protected resource provides to read about the\n   * protected resource's requirements on how the client can use the data\n   * provided by the protected resource\n   */\n  resource_policy_uri: webUriSchema.optional(),\n\n  /**\n   * OPTIONAL. URL that the protected resource provides to read about the\n   * protected resource's terms of service\n   */\n  resource_tos_uri: webUriSchema.optional(),\n})\n\nexport type OAuthProtectedResourceMetadata = z.infer<\n  typeof oauthProtectedResourceMetadataSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEvB,MAAA,uEAA0E;AAC1E,MAAA,+BAAuC;AAEvC;;GAEG,CACU,QAAA,oCAAoC,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IAC3D;;;;;;;OAOG,CACH,QAAQ,EAAE,SAAA,YAAY,CACnB,MAAM,CAAC,CAAC,GAAG,EAAE,CAAG,CAAD,AAAE,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;QACnC,OAAO,EAAE,gDAAgD;KAC1D,CAAC,CACD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAG,CAAC,AAAF,GAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;QACnC,OAAO,EAAE,0CAA0C;KACpD,CAAC;IAEJ;;;;;;;OAOG,CACH,qBAAqB,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,6BAAA,2BAA2B,CAAC,CAAC,QAAQ,EAAE;IAEtE;;;;;;;OAOG,CACH,QAAQ,EAAE,SAAA,YAAY,CAAC,QAAQ,EAAE;IAEjC;;;;;OAKG,CACH,gBAAgB,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,QAAQ,EAAE;IAEhD;;;;;OAKG,CACH,wBAAwB,EAAE,MAAA,CAAC,CACxB,KAAK,CAAC,MAAA,CAAC,CAAC,IAAI,CAAC;QAAC,QAAQ;QAAE,MAAM;QAAE,OAAO;KAAC,CAAC,CAAC,CAC1C,QAAQ,EAAE;IAEb;;;;;;OAMG,CACH,qCAAqC,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,QAAQ,EAAE;IAErE;;;OAGG,CACH,sBAAsB,EAAE,SAAA,YAAY,CAAC,QAAQ,EAAE;IAE/C;;;;OAIG,CACH,mBAAmB,EAAE,SAAA,YAAY,CAAC,QAAQ,EAAE;IAE5C;;;OAGG,CACH,gBAAgB,EAAE,SAAA,YAAY,CAAC,QAAQ,EAAE;CAC1C,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16176, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16181, "column": 0}, "map": {"version":3,"file":"oauth-refresh-token.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-refresh-token.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthRefreshTokenSchema = z.string().min(1)\nexport type OAuthRefreshToken = z.infer<typeof oauthRefreshTokenSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,uBAAuB,GAAG,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16188, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16193, "column": 0}, "map": {"version":3,"file":"oauth-refresh-token-grant-token-request.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-refresh-token-grant-token-request.ts"],"sourcesContent":["import { z } from 'zod'\nimport { oauthRefreshTokenSchema } from './oauth-refresh-token.js'\n\nexport const oauthRefreshTokenGrantTokenRequestSchema = z.object({\n  grant_type: z.literal('refresh_token'),\n  refresh_token: oauthRefreshTokenSchema,\n})\n\nexport type OAuthRefreshTokenGrantTokenRequest = z.infer<\n  typeof oauthRefreshTokenGrantTokenRequestSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AACvB,MAAA,+DAAkE;AAErD,QAAA,wCAAwC,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IAC/D,UAAU,EAAE,MAAA,CAAC,CAAC,OAAO,CAAC,eAAe,CAAC;IACtC,aAAa,EAAE,yBAAA,uBAAuB;CACvC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16204, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16209, "column": 0}, "map": {"version":3,"file":"oauth-response-mode.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-response-mode.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const oauthResponseModeSchema = z.enum([\n  'query',\n  'fragment',\n  'form_post',\n])\n\nexport type OAuthResponseMode = z.infer<typeof oauthResponseModeSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEV,QAAA,uBAAuB,GAAG,MAAA,CAAC,CAAC,IAAI,CAAC;IAC5C,OAAO;IACP,UAAU;IACV,WAAW;CACZ,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16220, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16225, "column": 0}, "map": {"version":3,"file":"oauth-token-identification.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-token-identification.ts"],"sourcesContent":["import { z } from 'zod'\nimport { oauthAccessTokenSchema } from './oauth-access-token.js'\nimport { oauthRefreshTokenSchema } from './oauth-refresh-token.js'\n\nexport const oauthTokenIdentificationSchema = z.object({\n  token: z.union([oauthAccessTokenSchema, oauthRefreshTokenSchema]),\n  token_type_hint: z.enum(['access_token', 'refresh_token']).optional(),\n})\n\nexport type OAuthTokenIdentification = z.infer<\n  typeof oauthTokenIdentificationSchema\n>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AACvB,MAAA,6DAAgE;AAChE,MAAA,+DAAkE;AAErD,QAAA,8BAA8B,GAAG,MAAA,CAAC,CAAC,MAAM,CAAC;IACrD,KAAK,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC;QAAC,wBAAA,sBAAsB;QAAE,yBAAA,uBAAuB;KAAC,CAAC;IACjE,eAAe,EAAE,MAAA,CAAC,CAAC,IAAI,CAAC;QAAC,cAAc;QAAE,eAAe;KAAC,CAAC,CAAC,QAAQ,EAAE;CACtE,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16243, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16248, "column": 0}, "map": {"version":3,"file":"oauth-token-request.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-token-request.ts"],"sourcesContent":["import { z } from 'zod'\nimport { oauthAuthorizationCodeGrantTokenRequestSchema } from './oauth-authorization-code-grant-token-request.js'\nimport { oauthClientCredentialsGrantTokenRequestSchema } from './oauth-client-credentials-grant-token-request.js'\nimport { oauthPasswordGrantTokenRequestSchema } from './oauth-password-grant-token-request.js'\nimport { oauthRefreshTokenGrantTokenRequestSchema } from './oauth-refresh-token-grant-token-request.js'\n\nexport const oauthTokenRequestSchema = z.discriminatedUnion('grant_type', [\n  oauthAuthorizationCodeGrantTokenRequestSchema,\n  oauthRefreshTokenGrantTokenRequestSchema,\n  oauthPasswordGrantTokenRequestSchema,\n  oauthClientCredentialsGrantTokenRequestSchema,\n])\n\nexport type OAuthTokenRequest = z.infer<typeof oauthTokenRequestSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AACvB,MAAA,iHAAiH;AACjH,MAAA,iHAAiH;AACjH,MAAA,6FAA8F;AAC9F,MAAA,uGAAuG;AAE1F,QAAA,uBAAuB,GAAG,MAAA,CAAC,CAAC,kBAAkB,CAAC,YAAY,EAAE;IACxE,kDAAA,6CAA6C;IAC7C,6CAAA,wCAAwC;IACxC,wCAAA,oCAAoC;IACpC,kDAAA,6CAA6C;CAC9C,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16264, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16269, "column": 0}, "map": {"version":3,"file":"oauth-token-type.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-token-type.ts"],"sourcesContent":["import { z } from 'zod'\n\n// Case insensitive input, normalized output\nexport const oauthTokenTypeSchema = z.union([\n  z\n    .string()\n    .regex(/^DPoP$/i)\n    .transform(() => 'DPoP' as const),\n  z\n    .string()\n    .regex(/^Bearer$/i)\n    .transform(() => 'Bearer' as const),\n])\n\nexport type OAuthTokenType = z.infer<typeof oauthTokenTypeSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAAuB;AAEvB,4CAA4C;AAC/B,QAAA,oBAAoB,GAAG,MAAA,CAAC,CAAC,KAAK,CAAC;IAC1C,MAAA,CAAC,CACE,MAAM,EAAE,CACR,KAAK,CAAC,SAAS,CAAC,CAChB,SAAS,CAAC,GAAG,CAAG,CAAD,KAAgB,CAAC;IACnC,MAAA,CAAC,CACE,MAAM,EAAE,CACR,KAAK,CAAC,WAAW,CAAC,CAClB,SAAS,CAAC,GAAG,CAAG,CAAD,OAAkB,CAAC;CACtC,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16280, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16285, "column": 0}, "map": {"version":3,"file":"oauth-token-response.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/oauth-token-response.ts"],"sourcesContent":["import { signedJwtSchema } from '@atproto/jwk'\nimport { z } from 'zod'\n\nimport { oauthAuthorizationDetailsSchema } from './oauth-authorization-details.js'\nimport { oauthTokenTypeSchema } from './oauth-token-type.js'\n\n/**\n * @see {@link https://www.rfc-editor.org/rfc/rfc6749.html#section-5.1 | RFC 6749 (OAuth2), Section 5.1}\n */\nexport const oauthTokenResponseSchema = z\n  .object({\n    // https://www.rfc-editor.org/rfc/rfc6749.html#section-5.1\n    access_token: z.string(),\n    token_type: oauthTokenTypeSchema,\n    scope: z.string().optional(),\n    refresh_token: z.string().optional(),\n    expires_in: z.number().optional(),\n    // https://openid.net/specs/openid-connect-core-1_0.html#TokenResponse\n    id_token: signedJwtSchema.optional(),\n    // https://datatracker.ietf.org/doc/html/rfc9396#name-enriched-authorization-deta\n    authorization_details: oauthAuthorizationDetailsSchema.optional(),\n  })\n  // https://www.rfc-editor.org/rfc/rfc6749.html#section-5.1\n  // > The client MUST ignore unrecognized value names in the response.\n  .passthrough()\n\n/**\n * @see {@link oauthTokenResponseSchema}\n */\nexport type OAuthTokenResponse = z.infer<typeof oauthTokenResponseSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,gCAA8C;AAC9C,MAAA,uBAAuB;AAEvB,MAAA,+EAAkF;AAClF,MAAA,yDAA4D;AAE5D;;GAEG,CACU,QAAA,wBAAwB,GAAG,MAAA,CAAC,CACtC,MAAM,CAAC;IACN,0DAA0D;IAC1D,YAAY,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE;IACxB,UAAU,EAAE,sBAAA,oBAAoB;IAChC,KAAK,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IAC5B,aAAa,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IACpC,UAAU,EAAE,MAAA,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IACjC,sEAAsE;IACtE,QAAQ,EAAE,MAAA,eAAe,CAAC,QAAQ,EAAE;IACpC,iFAAiF;IACjF,qBAAqB,EAAE,iCAAA,+BAA+B,CAAC,QAAQ,EAAE;CAClE,CAAC,AACF,0DAA0D;AAC1D,qEAAqE;CACpE,WAAW,EAAE,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16310, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16315, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-types/src/index.ts"],"sourcesContent":["export * from './constants.js'\nexport * from './uri.js'\nexport * from './util.js'\n\nexport * from './atproto-loopback-client-metadata.js'\nexport * from './oauth-access-token.js'\nexport * from './oauth-authorization-code-grant-token-request.js'\nexport * from './oauth-authorization-details.js'\nexport * from './oauth-authorization-request-jar.js'\nexport * from './oauth-authorization-request-par.js'\nexport * from './oauth-authorization-request-parameters.js'\nexport * from './oauth-authorization-request-query.js'\nexport * from './oauth-authorization-request-uri.js'\nexport * from './oauth-authorization-server-metadata.js'\nexport * from './oauth-client-credentials-grant-token-request.js'\nexport * from './oauth-client-credentials.js'\nexport * from './oauth-client-id-discoverable.js'\nexport * from './oauth-client-id-loopback.js'\nexport * from './oauth-client-id.js'\nexport * from './oauth-client-metadata.js'\nexport * from './oauth-endpoint-auth-method.js'\nexport * from './oauth-endpoint-name.js'\nexport * from './oauth-grant-type.js'\nexport * from './oauth-introspection-response.js'\nexport * from './oauth-issuer-identifier.js'\nexport * from './oauth-par-response.js'\nexport * from './oauth-password-grant-token-request.js'\nexport * from './oauth-protected-resource-metadata.js'\nexport * from './oauth-redirect-uri.js'\nexport * from './oauth-refresh-token-grant-token-request.js'\nexport * from './oauth-refresh-token.js'\nexport * from './oauth-request-uri.js'\nexport * from './oauth-response-mode.js'\nexport * from './oauth-response-type.js'\nexport * from './oauth-scope.js'\nexport * from './oauth-token-identification.js'\nexport * from './oauth-token-request.js'\nexport * from './oauth-token-response.js'\nexport * from './oauth-token-type.js'\nexport * from './oidc-claims-parameter.js'\nexport * from './oidc-claims-properties.js'\nexport * from './oidc-entity-type.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,+HAAA,SAA8B;AAC9B,yHAAA,SAAwB;AACxB,0HAAA,SAAyB;AAEzB,sJAAA,SAAqD;AACrD,wIAAA,SAAuC;AACvC,kKAAA,SAAiE;AACjE,iJAAA,SAAgD;AAChD,qJAAA,SAAoD;AACpD,qJAAA,SAAoD;AACpD,4JAAA,SAA2D;AAC3D,uJAAA,SAAsD;AACtD,qJAAA,SAAoD;AACpD,yJAAA,SAAwD;AACxD,kKAAA,SAAiE;AACjE,8IAAA,SAA6C;AAC7C,kJAAA,SAAiD;AACjD,8IAAA,SAA6C;AAC7C,qIAAA,SAAoC;AACpC,2IAAA,SAA0C;AAC1C,gJAAA,SAA+C;AAC/C,yIAAA,SAAwC;AACxC,sIAAA,SAAqC;AACrC,kJAAA,SAAiD;AACjD,6IAAA,SAA4C;AAC5C,wIAAA,SAAuC;AACvC,wJAAA,SAAuD;AACvD,uJAAA,SAAsD;AACtD,wIAAA,SAAuC;AACvC,6JAAA,SAA4D;AAC5D,yIAAA,SAAwC;AACxC,uIAAA,SAAsC;AACtC,yIAAA,SAAwC;AACxC,yIAAA,SAAwC;AACxC,iIAAA,SAAgC;AAChC,gJAAA,SAA+C;AAC/C,yIAAA,SAAwC;AACxC,0IAAA,SAAyC;AACzC,sIAAA,SAAqC;AACrC,2IAAA,SAA0C;AAC1C,4IAAA,SAA2C;AAC3C,sIAAA,SAAqC","ignoreList":[0]}},
    {"offset": {"line": 16379, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16384, "column": 0}, "map": {"version":3,"file":"util.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/util.ts"],"sourcesContent":["export type Awaitable<T> = T | PromiseLike<T>\nexport type Simplify<T> = { [K in keyof T]: T[K] } & NonNullable<unknown>\n\n// @ts-expect-error\nSymbol.dispose ??= Symbol('@@dispose')\n\n/**\n * @todo (?) move to common package\n */\nexport const timeoutSignal = (\n  timeout: number,\n  options?: { signal?: AbortSignal },\n): AbortSignal & Disposable => {\n  if (!Number.isInteger(timeout) || timeout < 0) {\n    throw new TypeError('Expected a positive integer')\n  }\n\n  options?.signal?.throwIfAborted()\n\n  const controller = new AbortController()\n  const { signal } = controller\n\n  options?.signal?.addEventListener(\n    'abort',\n    (reason) => controller.abort(reason),\n    { once: true, signal },\n  )\n\n  const timeoutId = setTimeout(\n    (err) => controller.abort(err),\n    timeout,\n    // create Error here to keep original stack trace\n    new Error('Timeout'),\n  )\n\n  timeoutId?.unref?.() // NodeJS only\n\n  signal.addEventListener('abort', () => clearTimeout(timeoutId), {\n    once: true,\n    signal,\n  })\n\n  Object.defineProperty(signal, Symbol.dispose, {\n    value: () => controller.abort(),\n  })\n\n  return signal as AbortSignal & Disposable\n}\n\nexport function contentMime(headers: Headers): string | undefined {\n  return headers.get('content-type')?.split(';')[0]!.trim()\n}\n\n/**\n * Ponyfill for `CustomEvent` constructor.\n */\nexport const CustomEvent: typeof globalThis.CustomEvent =\n  globalThis.CustomEvent ??\n  (() => {\n    class CustomEvent<T> extends Event {\n      #detail: T | null\n      constructor(type: string, options?: CustomEventInit<T>) {\n        if (!arguments.length) throw new TypeError('type argument is required')\n        super(type, options)\n        this.#detail = options?.detail ?? null\n      }\n      get detail() {\n        return this.#detail\n      }\n    }\n\n    Object.defineProperties(CustomEvent.prototype, {\n      [Symbol.toStringTag]: {\n        writable: false,\n        enumerable: false,\n        configurable: true,\n        value: 'CustomEvent',\n      },\n      detail: {\n        enumerable: true,\n      },\n    })\n\n    return CustomEvent\n  })()\n\nexport class CustomEventTarget<EventDetailMap extends Record<string, unknown>> {\n  readonly eventTarget = new EventTarget()\n\n  addEventListener<T extends Extract<keyof EventDetailMap, string>>(\n    type: T,\n    callback: (event: CustomEvent<EventDetailMap[T]>) => void,\n    options?: AddEventListenerOptions | boolean,\n  ): void {\n    this.eventTarget.addEventListener(type, callback as EventListener, options)\n  }\n\n  removeEventListener<T extends Extract<keyof EventDetailMap, string>>(\n    type: T,\n    callback: (event: CustomEvent<EventDetailMap[T]>) => void,\n    options?: EventListenerOptions | boolean,\n  ): void {\n    this.eventTarget.removeEventListener(\n      type,\n      callback as EventListener,\n      options,\n    )\n  }\n\n  dispatchCustomEvent<T extends Extract<keyof EventDetailMap, string>>(\n    type: T,\n    detail: EventDetailMap[T],\n    init?: EventInit,\n  ): boolean {\n    return this.eventTarget.dispatchEvent(\n      new CustomEvent(type, { ...init, detail }),\n    )\n  }\n}\n\nexport type SpaceSeparatedValue<Value extends string> =\n  | `${Value}`\n  | `${Value} ${string}`\n  | `${string} ${Value}`\n  | `${string} ${Value} ${string}`\n\nexport const includesSpaceSeparatedValue = <Value extends string>(\n  input: string,\n  value: Value,\n): input is SpaceSeparatedValue<Value> => {\n  if (value.length === 0) throw new TypeError('Value cannot be empty')\n  if (value.includes(' ')) throw new TypeError('Value cannot contain spaces')\n\n  // Optimized version of:\n  // return input.split(' ').includes(value)\n\n  const inputLength = input.length\n  const valueLength = value.length\n\n  if (inputLength < valueLength) return false\n\n  let idx = input.indexOf(value)\n  let idxEnd: number\n\n  while (idx !== -1) {\n    idxEnd = idx + valueLength\n\n    if (\n      // at beginning or preceded by space\n      (idx === 0 || input[idx - 1] === ' ') &&\n      // at end or followed by space\n      (idxEnd === inputLength || input[idxEnd] === ' ')\n    ) {\n      return true\n    }\n\n    idx = input.indexOf(value, idxEnd + 1)\n  }\n\n  return false\n}\n\nexport function combineSignals(signals: readonly (AbortSignal | undefined)[]) {\n  const controller = new AbortController()\n\n  const onAbort = function (this: AbortSignal, _event: Event) {\n    const reason = new Error('This operation was aborted', {\n      cause: this.reason,\n    })\n\n    controller.abort(reason)\n  }\n\n  for (const sig of signals) {\n    if (!sig) continue\n\n    if (sig.aborted) {\n      // Remove \"abort\" listener that was added to sig in previous iterations\n      controller.abort()\n\n      throw new Error('One of the signals is already aborted', {\n        cause: sig.reason,\n      })\n    }\n\n    sig.addEventListener('abort', onAbort, { signal: controller.signal })\n  }\n\n  controller[Symbol.dispose] = () => {\n    const reason = new Error('AbortController was disposed')\n\n    controller.abort(reason)\n  }\n\n  return controller as AbortController & Disposable\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 16534, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16539, "column": 0}, "map": {"version":3,"file":"oauth-authorization-server-metadata-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-authorization-server-metadata-resolver.ts"],"sourcesContent":["import {\n  bindFetch,\n  cancelBody,\n  Fetch,\n  FetchResponseError,\n} from '@atproto-labs/fetch'\nimport {\n  CachedGetter,\n  GetCachedOptions,\n  SimpleStore,\n} from '@atproto-labs/simple-store'\nimport {\n  OAuthAuthorizationServerMetadata,\n  oauthAuthorizationServerMetadataValidator,\n  oauthIssuerIdentifierSchema,\n} from '@atproto/oauth-types'\nimport { contentMime } from './util.js'\n\nexport type { GetCachedOptions, OAuthAuthorizationServerMetadata }\n\nexport type AuthorizationServerMetadataCache = SimpleStore<\n  string,\n  OAuthAuthorizationServerMetadata\n>\n\nexport type OAuthAuthorizationServerMetadataResolverConfig = {\n  allowHttpIssuer?: boolean\n}\n\n/**\n * @see {@link https://datatracker.ietf.org/doc/html/rfc8414}\n */\nexport class OAuthAuthorizationServerMetadataResolver extends CachedGetter<\n  string,\n  OAuthAuthorizationServerMetadata\n> {\n  private readonly fetch: Fetch<unknown>\n  private readonly allowHttpIssuer: boolean\n\n  constructor(\n    cache: AuthorizationServerMetadataCache,\n    fetch?: Fetch,\n    config?: OAuthAuthorizationServerMetadataResolverConfig,\n  ) {\n    super(async (issuer, options) => this.fetchMetadata(issuer, options), cache)\n\n    this.fetch = bindFetch(fetch)\n    this.allowHttpIssuer = config?.allowHttpIssuer === true\n  }\n\n  async get(\n    input: string,\n    options?: GetCachedOptions,\n  ): Promise<OAuthAuthorizationServerMetadata> {\n    const issuer = oauthIssuerIdentifierSchema.parse(input)\n    if (!this.allowHttpIssuer && issuer.startsWith('http:')) {\n      throw new TypeError(\n        'Unsecure issuer URL protocol only allowed in development and test environments',\n      )\n    }\n    return super.get(issuer, options)\n  }\n\n  private async fetchMetadata(\n    issuer: string,\n    options?: GetCachedOptions,\n  ): Promise<OAuthAuthorizationServerMetadata> {\n    const url = new URL(`/.well-known/oauth-authorization-server`, issuer)\n    const request = new Request(url, {\n      headers: { accept: 'application/json' },\n      cache: options?.noCache ? 'no-cache' : undefined,\n      signal: options?.signal,\n      redirect: 'manual', // response must be 200 OK\n    })\n\n    const response = await this.fetch(request)\n\n    // https://datatracker.ietf.org/doc/html/rfc8414#section-3.2\n    if (response.status !== 200) {\n      await cancelBody(response, 'log')\n      throw await FetchResponseError.from(\n        response,\n        `Unexpected status code ${response.status} for \"${url}\"`,\n        undefined,\n        { cause: request },\n      )\n    }\n\n    if (contentMime(response.headers) !== 'application/json') {\n      await cancelBody(response, 'log')\n      throw await FetchResponseError.from(\n        response,\n        `Unexpected content type for \"${url}\"`,\n        undefined,\n        { cause: request },\n      )\n    }\n\n    const metadata = oauthAuthorizationServerMetadataValidator.parse(\n      await response.json(),\n    )\n\n    // Validate the issuer (MIX-UP attacks)\n    // https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics#name-mix-up-attacks\n    // https://datatracker.ietf.org/doc/html/rfc8414#section-2\n    if (metadata.issuer !== issuer) {\n      throw new TypeError(`Invalid issuer ${metadata.issuer}`)\n    }\n\n    // ATPROTO requires client_id_metadata_document\n    // http://drafts.aaronpk.com/draft-parecki-oauth-client-id-metadata-document/draft-parecki-oauth-client-id-metadata-document.html\n    if (metadata.client_id_metadata_document_supported !== true) {\n      throw new TypeError(\n        `Authorization server \"${issuer}\" does not support client_id_metadata_document`,\n      )\n    }\n\n    return metadata\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 16615, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16620, "column": 0}, "map": {"version":3,"file":"oauth-callback-error.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-callback-error.ts"],"sourcesContent":["export class OAuthCallbackError extends Error {\n  static from(err: unknown, params: URLSearchParams, state?: string) {\n    if (err instanceof OAuthCallbackError) return err\n    const message = err instanceof Error ? err.message : undefined\n    return new OAuthCallbackError(params, message, state, err)\n  }\n\n  constructor(\n    public readonly params: URLSearchParams,\n    message = params.get('error_description') || 'OAuth callback error',\n    public readonly state?: string,\n    cause?: unknown,\n  ) {\n    super(message, { cause })\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAa,kBAAmB,SAAQ,KAAK;IAC3C,MAAM,CAAC,IAAI,CAAC,GAAY,EAAE,MAAuB,EAAE,KAAc,EAAA;QAC/D,IAAI,GAAG,YAAY,kBAAkB,EAAE,OAAO,GAAG,CAAA;QACjD,MAAM,OAAO,GAAG,GAAG,YAAY,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAA;QAC9D,OAAO,IAAI,kBAAkB,CAAC,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,CAAC,CAAA;IAC5D,CAAC;IAED,YACkB,MAAuB,EACvC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,mBAAmB,CAAC,IAAI,sBAAsB,EACnD,KAAc,EAC9B,KAAe,CAAA;QAEf,KAAK,CAAC,OAAO,EAAE;YAAE,KAAK;QAAA,CAAE,CAAC,CAAA;QALzB,OAAA,cAAA,CAAA,IAAA,EAAA,UAAA;;;;mBAAgB,MAAM;WAAiB;QAEvC,OAAA,cAAA,CAAA,IAAA,EAAA,SAAA;;;;mBAAgB,KAAK;WAAS;IAIhC,CAAC;CACF;AAfD,QAAA,kBAAA,GAAA,mBAeC","ignoreList":[0]}},
    {"offset": {"line": 16650, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16655, "column": 0}, "map": {"version":3,"file":"constants.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/constants.ts"],"sourcesContent":["/**\n * Per ATProto spec (OpenID uses RS256)\n */\nexport const FALLBACK_ALG = 'ES256'\n"],"names":[],"mappings":";;;;;AAAA;;GAEG,CACU,QAAA,YAAY,GAAG,OAAO,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16663, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16668, "column": 0}, "map": {"version":3,"file":"token-revoked-error.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/errors/token-revoked-error.ts"],"sourcesContent":["export class TokenRevokedError extends Error {\n  constructor(\n    public readonly sub: string,\n    message = `The session for \"${sub}\" was successfully revoked`,\n    options?: { cause?: unknown },\n  ) {\n    super(message, options)\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAa,iBAAkB,SAAQ,KAAK;IAC1C,YACkB,GAAW,EAC3B,OAAO,GAAG,CAAA,iBAAA,EAAoB,GAAG,CAAA,0BAAA,CAA4B,EAC7D,OAA6B,CAAA;QAE7B,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;QAJvB,OAAA,cAAA,CAAA,IAAA,EAAA,OAAA;;;;mBAAgB,GAAG;WAAQ;IAK7B,CAAC;CACF;AARD,QAAA,iBAAA,GAAA,kBAQC","ignoreList":[0]}},
    {"offset": {"line": 16685, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16690, "column": 0}, "map": {"version":3,"file":"oauth-protected-resource-metadata-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-protected-resource-metadata-resolver.ts"],"sourcesContent":["import {\n  Fetch,\n  FetchResponseError,\n  bindFetch,\n  cancelBody,\n} from '@atproto-labs/fetch'\nimport {\n  CachedGetter,\n  GetCachedOptions,\n  SimpleStore,\n} from '@atproto-labs/simple-store'\nimport {\n  OAuthProtectedResourceMetadata,\n  oauthProtectedResourceMetadataSchema,\n} from '@atproto/oauth-types'\nimport { contentMime } from './util.js'\n\nexport type { GetCachedOptions, OAuthProtectedResourceMetadata }\n\nexport type ProtectedResourceMetadataCache = SimpleStore<\n  string,\n  OAuthProtectedResourceMetadata\n>\n\nexport type OAuthProtectedResourceMetadataResolverConfig = {\n  allowHttpResource?: boolean\n}\n\n/**\n * @see {@link https://datatracker.ietf.org/doc/html/draft-ietf-oauth-resource-metadata-05}\n */\nexport class OAuthProtectedResourceMetadataResolver extends CachedGetter<\n  string,\n  OAuthProtectedResourceMetadata\n> {\n  private readonly fetch: Fetch<unknown>\n  private readonly allowHttpResource: boolean\n\n  constructor(\n    cache: ProtectedResourceMetadataCache,\n    fetch: Fetch = globalThis.fetch,\n    config?: OAuthProtectedResourceMetadataResolverConfig,\n  ) {\n    super(async (origin, options) => this.fetchMetadata(origin, options), cache)\n\n    this.fetch = bindFetch(fetch)\n    this.allowHttpResource = config?.allowHttpResource === true\n  }\n\n  async get(\n    resource: string | URL,\n    options?: GetCachedOptions,\n  ): Promise<OAuthProtectedResourceMetadata> {\n    const { protocol, origin } = new URL(resource)\n\n    if (protocol !== 'https:' && protocol !== 'http:') {\n      throw new TypeError(\n        `Invalid protected resource metadata URL protocol: ${protocol}`,\n      )\n    }\n\n    if (protocol === 'http:' && !this.allowHttpResource) {\n      throw new TypeError(\n        `Unsecure resource metadata URL (${protocol}) only allowed in development and test environments`,\n      )\n    }\n\n    return super.get(origin, options)\n  }\n\n  private async fetchMetadata(\n    origin: string,\n    options?: GetCachedOptions,\n  ): Promise<OAuthProtectedResourceMetadata> {\n    const url = new URL(`/.well-known/oauth-protected-resource`, origin)\n    const request = new Request(url, {\n      signal: options?.signal,\n      headers: { accept: 'application/json' },\n      cache: options?.noCache ? 'no-cache' : undefined,\n      redirect: 'manual', // response must be 200 OK\n    })\n\n    const response = await this.fetch(request)\n\n    // https://datatracker.ietf.org/doc/html/draft-ietf-oauth-resource-metadata-05#section-3.2\n    if (response.status !== 200) {\n      await cancelBody(response, 'log')\n      throw await FetchResponseError.from(\n        response,\n        `Unexpected status code ${response.status} for \"${url}\"`,\n        undefined,\n        { cause: request },\n      )\n    }\n\n    if (contentMime(response.headers) !== 'application/json') {\n      await cancelBody(response, 'log')\n      throw await FetchResponseError.from(\n        response,\n        `Unexpected content type for \"${url}\"`,\n        undefined,\n        { cause: request },\n      )\n    }\n\n    const metadata = oauthProtectedResourceMetadataSchema.parse(\n      await response.json(),\n    )\n\n    // https://datatracker.ietf.org/doc/html/draft-ietf-oauth-resource-metadata-05#section-3.3\n    if (metadata.resource !== origin) {\n      throw new TypeError(`Invalid issuer ${metadata.resource}`)\n    }\n\n    return metadata\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 16762, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16767, "column": 0}, "map": {"version":3,"file":"oauth-resolver-error.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-resolver-error.ts"],"sourcesContent":["import { ZodError } from 'zod'\n\nexport class OAuthResolverError extends Error {\n  constructor(message: string, options?: { cause?: unknown }) {\n    super(message, options)\n  }\n\n  static from(cause: unknown, message?: string): OAuthResolverError {\n    if (cause instanceof OAuthResolverError) return cause\n    const validationReason =\n      cause instanceof ZodError\n        ? `${cause.errors[0].path} ${cause.errors[0].message}`\n        : null\n    const fullMessage =\n      (message ?? `Unable to resolve identity`) +\n      (validationReason ? ` (${validationReason})` : '')\n    return new OAuthResolverError(fullMessage, {\n      cause,\n    })\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,uBAA8B;AAE9B,MAAa,kBAAmB,SAAQ,KAAK;IAC3C,YAAY,OAAe,EAAE,OAA6B,CAAA;QACxD,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;IACzB,CAAC;IAED,MAAM,CAAC,IAAI,CAAC,KAAc,EAAE,OAAgB,EAAA;QAC1C,IAAI,KAAK,YAAY,kBAAkB,EAAE,OAAO,KAAK,CAAA;QACrD,MAAM,gBAAgB,GACpB,KAAK,YAAY,MAAA,QAAQ,GACrB,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAA,CAAA,EAAI,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,GACpD,IAAI,CAAA;QACV,MAAM,WAAW,GACf,CAAC,OAAO,IAAI,CAAA,0BAAA,CAA4B,CAAC,GACzC,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAA,EAAA,EAAK,gBAAgB,CAAA,CAAA,CAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAA;QACpD,OAAO,IAAI,kBAAkB,CAAC,WAAW,EAAE;YACzC,KAAK;SACN,CAAC,CAAA;IACJ,CAAC;CACF;AAlBD,QAAA,kBAAA,GAAA,mBAkBC","ignoreList":[0]}},
    {"offset": {"line": 16787, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16792, "column": 0}, "map": {"version":3,"file":"oauth-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-resolver.ts"],"sourcesContent":["import {\n  IdentityResolver,\n  ResolvedIdentity,\n  ResolveIdentityOptions,\n} from '@atproto-labs/identity-resolver'\nimport {\n  OAuthAuthorizationServerMetadata,\n  oauthIssuerIdentifierSchema,\n} from '@atproto/oauth-types'\n\nimport {\n  GetCachedOptions,\n  OAuthAuthorizationServerMetadataResolver,\n} from './oauth-authorization-server-metadata-resolver.js'\nimport { OAuthProtectedResourceMetadataResolver } from './oauth-protected-resource-metadata-resolver.js'\nimport { OAuthResolverError } from './oauth-resolver-error.js'\n\nexport type { GetCachedOptions }\nexport type ResolveOAuthOptions = GetCachedOptions & ResolveIdentityOptions\n\nexport class OAuthResolver {\n  constructor(\n    readonly identityResolver: IdentityResolver,\n    readonly protectedResourceMetadataResolver: OAuthProtectedResourceMetadataResolver,\n    readonly authorizationServerMetadataResolver: OAuthAuthorizationServerMetadataResolver,\n  ) {}\n\n  /**\n   * @param input - A handle, DID, PDS URL or Entryway URL\n   */\n  public async resolve(\n    input: string,\n    options?: ResolveOAuthOptions,\n  ): Promise<{\n    identity?: ResolvedIdentity\n    metadata: OAuthAuthorizationServerMetadata\n  }> {\n    // Allow using an entryway, or PDS url, directly as login input (e.g.\n    // when the user forgot their handle, or when the handle does not\n    // resolve to a DID)\n    return /^https?:\\/\\//.test(input)\n      ? this.resolveFromService(input, options)\n      : this.resolveFromIdentity(input, options)\n  }\n\n  /**\n   * @note this method can be used to verify if a particular uri supports OAuth\n   * based sign-in (for compatibility with legacy implementation).\n   */\n  public async resolveFromService(\n    input: string,\n    options?: ResolveOAuthOptions,\n  ): Promise<{\n    metadata: OAuthAuthorizationServerMetadata\n  }> {\n    try {\n      // Assume first that input is a PDS URL (as required by ATPROTO)\n      const metadata = await this.getResourceServerMetadata(input, options)\n      return { metadata }\n    } catch (err) {\n      if (!options?.signal?.aborted && err instanceof OAuthResolverError) {\n        try {\n          // Fallback to trying to fetch as an issuer (Entryway)\n          const result = oauthIssuerIdentifierSchema.safeParse(input)\n          if (result.success) {\n            const metadata = await this.getAuthorizationServerMetadata(\n              result.data,\n              options,\n            )\n            return { metadata }\n          }\n        } catch {\n          // Fallback failed, throw original error\n        }\n      }\n\n      throw err\n    }\n  }\n\n  public async resolveFromIdentity(\n    input: string,\n    options?: ResolveOAuthOptions,\n  ): Promise<{\n    identity: ResolvedIdentity\n    metadata: OAuthAuthorizationServerMetadata\n  }> {\n    const identity = await this.resolveIdentity(input, options)\n\n    options?.signal?.throwIfAborted()\n\n    const metadata = await this.getResourceServerMetadata(identity.pds, options)\n\n    return { identity, metadata }\n  }\n\n  public async resolveIdentity(\n    input: string,\n    options?: ResolveIdentityOptions,\n  ): Promise<ResolvedIdentity> {\n    try {\n      return await this.identityResolver.resolve(input, options)\n    } catch (cause) {\n      throw OAuthResolverError.from(\n        cause,\n        `Failed to resolve identity: ${input}`,\n      )\n    }\n  }\n\n  public async getAuthorizationServerMetadata(\n    issuer: string,\n    options?: GetCachedOptions,\n  ): Promise<OAuthAuthorizationServerMetadata> {\n    try {\n      return await this.authorizationServerMetadataResolver.get(issuer, options)\n    } catch (cause) {\n      throw OAuthResolverError.from(\n        cause,\n        `Failed to resolve OAuth server metadata for issuer: ${issuer}`,\n      )\n    }\n  }\n\n  public async getResourceServerMetadata(\n    pdsUrl: string | URL,\n    options?: GetCachedOptions,\n  ) {\n    try {\n      const rsMetadata = await this.protectedResourceMetadataResolver.get(\n        pdsUrl,\n        options,\n      )\n\n      // ATPROTO requires one, and only one, authorization server entry\n      if (rsMetadata.authorization_servers?.length !== 1) {\n        throw new OAuthResolverError(\n          rsMetadata.authorization_servers?.length\n            ? `Unable to determine authorization server for PDS: ${pdsUrl}`\n            : `No authorization servers found for PDS: ${pdsUrl}`,\n        )\n      }\n\n      const issuer = rsMetadata.authorization_servers![0]!\n\n      options?.signal?.throwIfAborted()\n\n      const asMetadata = await this.getAuthorizationServerMetadata(\n        issuer,\n        options,\n      )\n\n      // https://datatracker.ietf.org/doc/html/draft-ietf-oauth-resource-metadata-05#section-4\n      if (asMetadata.protected_resources) {\n        if (!asMetadata.protected_resources.includes(rsMetadata.resource)) {\n          throw new OAuthResolverError(\n            `PDS \"${pdsUrl}\" not protected by issuer \"${issuer}\"`,\n          )\n        }\n      }\n\n      return asMetadata\n    } catch (cause) {\n      throw OAuthResolverError.from(\n        cause,\n        `Failed to resolve OAuth server metadata for resource: ${pdsUrl}`,\n      )\n    }\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 16902, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16907, "column": 0}, "map": {"version":3,"file":"atproto-token-response.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/atproto-token-response.ts"],"sourcesContent":["import { atprotoDidSchema } from '@atproto/did'\nimport { oauthTokenResponseSchema } from '@atproto/oauth-types'\nimport { z, TypeOf } from 'zod'\n\nimport { includesSpaceSeparatedValue, SpaceSeparatedValue } from './util'\n\nexport type AtprotoScope = SpaceSeparatedValue<'atproto'>\nexport const isAtprotoScope = (input: string): input is AtprotoScope =>\n  includesSpaceSeparatedValue(input, 'atproto')\nexport const atprotoScopeSchema = z\n  .string()\n  .refine(isAtprotoScope, 'The \"atproto\" scope is required')\n\nexport const atprotoTokenResponseSchema = oauthTokenResponseSchema.extend({\n  token_type: z.literal('DPoP'),\n  sub: atprotoDidSchema,\n  scope: atprotoScopeSchema,\n  // OpenID is not compatible with atproto identities\n  id_token: z.never().optional(),\n})\n\nexport type AtprotoTokenResponse = TypeOf<typeof atprotoTokenResponseSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,gCAA+C;AAC/C,MAAA,gDAA+D;AAC/D,MAAA,uBAA+B;AAE/B,MAAA,2BAAyE;AAGlE,MAAM,cAAc,GAAG,CAAC,KAAa,EAAyB,CACnE,CADqE,AACrE,GAAA,OAAA,2BAA2B,EAAC,KAAK,EAAE,SAAS,CAAC,CAAA;AADlC,QAAA,cAAc,GAAA,eACoB;AAClC,QAAA,kBAAkB,GAAG,MAAA,CAAC,CAChC,MAAM,EAAE,CACR,MAAM,CAAC,QAAA,cAAc,EAAE,iCAAiC,CAAC,CAAA;AAE/C,QAAA,0BAA0B,GAAG,cAAA,wBAAwB,CAAC,MAAM,CAAC;IACxE,UAAU,EAAE,MAAA,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC;IAC7B,GAAG,EAAE,MAAA,gBAAgB;IACrB,KAAK,EAAE,QAAA,kBAAkB;IACzB,mDAAmD;IACnD,QAAQ,EAAE,MAAA,CAAC,CAAC,KAAK,EAAE,CAAC,QAAQ,EAAE;CAC/B,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 16926, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16931, "column": 0}, "map": {"version":3,"file":"token-refresh-error.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/errors/token-refresh-error.ts"],"sourcesContent":["export class TokenRefreshError extends Error {\n  constructor(\n    public readonly sub: string,\n    message: string,\n    options?: { cause?: unknown },\n  ) {\n    super(message, options)\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAa,iBAAkB,SAAQ,KAAK;IAC1C,YACkB,GAAW,EAC3B,OAAe,EACf,OAA6B,CAAA;QAE7B,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;QAJvB,OAAA,cAAA,CAAA,IAAA,EAAA,OAAA;;;;mBAAgB,GAAG;WAAQ;IAK7B,CAAC;CACF;AARD,QAAA,iBAAA,GAAA,kBAQC","ignoreList":[0]}},
    {"offset": {"line": 16948, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 16953, "column": 0}, "map": {"version":3,"file":"fetch-dpop.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/fetch-dpop.ts"],"sourcesContent":["import { Fetch, FetchContext, cancelBody, peekJson } from '@atproto-labs/fetch'\nimport { SimpleStore } from '@atproto-labs/simple-store'\nimport { Key } from '@atproto/jwk'\nimport { base64url } from 'multiformats/bases/base64'\n\n// \"undefined\" in non https environments or environments without crypto\nconst subtle = globalThis.crypto?.subtle as SubtleCrypto | undefined\n\nconst ReadableStream = globalThis.ReadableStream as\n  | typeof globalThis.ReadableStream\n  | undefined\n\nexport type DpopFetchWrapperOptions<C = FetchContext> = {\n  key: Key\n  iss: string\n  nonces: SimpleStore<string, string>\n  supportedAlgs?: string[]\n  sha256?: (input: string) => Promise<string>\n\n  /**\n   * Is the intended server an authorization server (true) or a resource server\n   * (false)? Setting this may allow to avoid parsing the response body to\n   * determine the dpop-nonce.\n   *\n   * @default undefined\n   */\n  isAuthServer?: boolean\n  fetch?: Fetch<C>\n}\n\nexport function dpopFetchWrapper<C = FetchContext>({\n  key,\n  iss,\n  supportedAlgs,\n  nonces,\n  sha256 = typeof subtle !== 'undefined' ? subtleSha256 : undefined,\n  isAuthServer,\n  fetch = globalThis.fetch,\n}: DpopFetchWrapperOptions<C>): Fetch<C> {\n  if (!sha256) {\n    throw new TypeError(\n      `crypto.subtle is not available in this environment. Please provide a sha256 function.`,\n    )\n  }\n\n  const alg = negotiateAlg(key, supportedAlgs)\n\n  return async function (this: C, input, init) {\n    if (!key.algorithms.includes(alg)) {\n      throw new TypeError(`Key does not support the algorithm ${alg}`)\n    }\n\n    const request: Request =\n      init == null && input instanceof Request\n        ? input\n        : new Request(input, init)\n\n    const authorizationHeader = request.headers.get('Authorization')\n    const ath = authorizationHeader?.startsWith('DPoP ')\n      ? await sha256(authorizationHeader.slice(5))\n      : undefined\n\n    const { method, url } = request\n    const { origin } = new URL(url)\n\n    let initNonce: string | undefined\n    try {\n      initNonce = await nonces.get(origin)\n    } catch {\n      // Ignore get errors, we will just not send a nonce\n    }\n\n    const initProof = await buildProof(\n      key,\n      alg,\n      iss,\n      method,\n      url,\n      initNonce,\n      ath,\n    )\n    request.headers.set('DPoP', initProof)\n\n    const initResponse = await fetch.call(this, request)\n\n    // Make sure the response body is consumed. Either by the caller (when the\n    // response is returned), of if an error is thrown (catch block).\n\n    const nextNonce = initResponse.headers.get('DPoP-Nonce')\n    if (!nextNonce || nextNonce === initNonce) {\n      // No nonce was returned or it is the same as the one we sent. No need to\n      // update the nonce store, or retry the request.\n      return initResponse\n    }\n\n    // Store the fresh nonce for future requests\n    try {\n      await nonces.set(origin, nextNonce)\n    } catch {\n      // Ignore set errors\n    }\n\n    const shouldRetry = await isUseDpopNonceError(initResponse, isAuthServer)\n    if (!shouldRetry) {\n      // Not a \"use_dpop_nonce\" error, so there is no need to retry\n      return initResponse\n    }\n\n    // If the input stream was already consumed, we cannot retry the request. A\n    // solution would be to clone() the request but that would bufferize the\n    // entire stream in memory which can lead to memory starvation. Instead, we\n    // will return the original response and let the calling code handle retries.\n\n    if (input === request) {\n      // The input request body was consumed. We cannot retry the request.\n      return initResponse\n    }\n\n    if (ReadableStream && init?.body instanceof ReadableStream) {\n      // The init body was consumed. We cannot retry the request.\n      return initResponse\n    }\n\n    // We will now retry the request with the fresh nonce.\n\n    // The initial response body must be consumed (see cancelBody's doc).\n    await cancelBody(initResponse, 'log')\n\n    const nextProof = await buildProof(\n      key,\n      alg,\n      iss,\n      method,\n      url,\n      nextNonce,\n      ath,\n    )\n    const nextRequest = new Request(input, init)\n    nextRequest.headers.set('DPoP', nextProof)\n\n    return fetch.call(this, nextRequest)\n  }\n}\n\nasync function buildProof(\n  key: Key,\n  alg: string,\n  iss: string,\n  htm: string,\n  htu: string,\n  nonce?: string,\n  ath?: string,\n) {\n  if (!key.bareJwk) {\n    throw new Error('Only asymmetric keys can be used as DPoP proofs')\n  }\n\n  const now = Math.floor(Date.now() / 1e3)\n\n  return key.createJwt(\n    // https://datatracker.ietf.org/doc/html/rfc9449#section-4.2\n    {\n      alg,\n      typ: 'dpop+jwt',\n      jwk: key.bareJwk,\n    },\n    {\n      iss,\n      iat: now,\n      // Any collision will cause the request to be rejected by the server. no biggie.\n      jti: Math.random().toString(36).slice(2),\n      htm,\n      htu,\n      nonce,\n      ath,\n    },\n  )\n}\n\nasync function isUseDpopNonceError(\n  response: Response,\n  isAuthServer?: boolean,\n): Promise<boolean> {\n  // https://datatracker.ietf.org/doc/html/rfc6750#section-3\n  // https://datatracker.ietf.org/doc/html/rfc9449#name-resource-server-provided-no\n  if (isAuthServer === undefined || isAuthServer === false) {\n    if (response.status === 401) {\n      const wwwAuth = response.headers.get('WWW-Authenticate')\n      if (wwwAuth?.startsWith('DPoP')) {\n        return wwwAuth.includes('error=\"use_dpop_nonce\"')\n      }\n    }\n  }\n\n  // https://datatracker.ietf.org/doc/html/rfc9449#name-authorization-server-provid\n  if (isAuthServer === undefined || isAuthServer === true) {\n    if (response.status === 400) {\n      try {\n        const json = await peekJson(response, 10 * 1024)\n        return typeof json === 'object' && json?.['error'] === 'use_dpop_nonce'\n      } catch {\n        // Response too big (to be \"use_dpop_nonce\" error) or invalid JSON\n        return false\n      }\n    }\n  }\n\n  return false\n}\n\nfunction negotiateAlg(key: Key, supportedAlgs: string[] | undefined): string {\n  if (supportedAlgs) {\n    // Use order of supportedAlgs as preference\n    const alg = supportedAlgs.find((a) => key.algorithms.includes(a))\n    if (alg) return alg\n  } else {\n    const [alg] = key.algorithms\n    if (alg) return alg\n  }\n\n  throw new Error('Key does not match any alg supported by the server')\n}\n\nasync function subtleSha256(input: string): Promise<string> {\n  if (subtle == null) {\n    throw new Error(\n      `crypto.subtle is not available in this environment. Please provide a sha256 function.`,\n    )\n  }\n\n  const bytes = new TextEncoder().encode(input)\n  const digest = await subtle.digest('SHA-256', bytes)\n  const digestBytes = new Uint8Array(digest)\n  return base64url.baseEncode(digestBytes)\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 17092, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 17097, "column": 0}, "map": {"version":3,"file":"oauth-response-error.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-response-error.ts"],"sourcesContent":["import { Json, ifString, ifObject } from '@atproto-labs/fetch'\n\nexport class OAuthResponseError extends Error {\n  readonly error?: string\n  readonly errorDescription?: string\n\n  constructor(\n    public readonly response: Response,\n    public readonly payload: Json,\n  ) {\n    const error = ifString(ifObject(payload)?.['error'])\n    const errorDescription = ifString(ifObject(payload)?.['error_description'])\n\n    const messageError = error ? `\"${error}\"` : 'unknown'\n    const messageDesc = errorDescription ? `: ${errorDescription}` : ''\n    const message = `OAuth ${messageError} error${messageDesc}`\n\n    super(message)\n\n    this.error = error\n    this.errorDescription = errorDescription\n  }\n\n  get status() {\n    return this.response.status\n  }\n\n  get headers() {\n    return this.response.headers\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAA,yCAA8D;AAE9D,MAAa,kBAAmB,SAAQ,KAAK;IAI3C,YACkB,QAAkB,EAClB,OAAa,CAAA;QAE7B,MAAM,KAAK,GAAG,CAAA,GAAA,QAAA,QAAQ,EAAC,CAAA,GAAA,QAAA,QAAQ,EAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC,CAAA;QACpD,MAAM,gBAAgB,GAAG,CAAA,GAAA,QAAA,QAAQ,EAAC,CAAA,GAAA,QAAA,QAAQ,EAAC,OAAO,CAAC,EAAE,CAAC,mBAAmB,CAAC,CAAC,CAAA;QAE3E,MAAM,YAAY,GAAG,KAAK,CAAC,CAAC,CAAC,CAAA,CAAA,EAAI,KAAK,CAAA,CAAA,CAAG,CAAC,CAAC,CAAC,SAAS,CAAA;QACrD,MAAM,WAAW,GAAG,gBAAgB,CAAC,CAAC,CAAC,CAAA,EAAA,EAAK,gBAAgB,EAAE,CAAC,CAAC,CAAC,EAAE,CAAA;QACnE,MAAM,OAAO,GAAG,CAAA,MAAA,EAAS,YAAY,CAAA,MAAA,EAAS,WAAW,EAAE,CAAA;QAE3D,KAAK,CAAC,OAAO,CAAC,CAAA;QAVd,OAAA,cAAA,CAAA,IAAA,EAAA,YAAA;;;;mBAAgB,QAAQ;WAAU;QAClC,OAAA,cAAA,CAAA,IAAA,EAAA,WAAA;;;;mBAAgB,OAAO;WAAM;QALtB,OAAA,cAAA,CAAA,IAAA,EAAA,SAAA;;;;;WAAc;QACd,OAAA,cAAA,CAAA,IAAA,EAAA,oBAAA;;;;;WAAyB;QAehC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QAClB,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAA;IAC1C,CAAC;IAED,IAAI,MAAM,GAAA;QACR,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAA;IAC7B,CAAC;IAED,IAAI,OAAO,GAAA;QACT,OAAO,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAA;IAC9B,CAAC;CACF;AA5BD,QAAA,kBAAA,GAAA,mBA4BC","ignoreList":[0]}},
    {"offset": {"line": 17146, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 17151, "column": 0}, "map": {"version":3,"file":"oauth-server-agent.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-server-agent.ts"],"sourcesContent":["import { Fetch, Json, bindFetch, fetchJsonProcessor } from '@atproto-labs/fetch'\nimport { SimpleStore } from '@atproto-labs/simple-store'\nimport { AtprotoDid } from '@atproto/did'\nimport { Key, Keyset } from '@atproto/jwk'\nimport {\n  CLIENT_ASSERTION_TYPE_JWT_BEARER,\n  OAuthAuthorizationRequestPar,\n  OAuthAuthorizationServerMetadata,\n  OAuthClientCredentials,\n  OAuthEndpointName,\n  OAuthParResponse,\n  OAuthTokenRequest,\n  oauthParResponseSchema,\n} from '@atproto/oauth-types'\n\nimport {\n  AtprotoScope,\n  AtprotoTokenResponse,\n  atprotoTokenResponseSchema,\n} from './atproto-token-response.js'\nimport { FALLBACK_ALG } from './constants.js'\nimport { TokenRefreshError } from './errors/token-refresh-error.js'\nimport { dpopFetchWrapper } from './fetch-dpop.js'\nimport { OAuthResolver } from './oauth-resolver.js'\nimport { OAuthResponseError } from './oauth-response-error.js'\nimport { Runtime } from './runtime.js'\nimport { ClientMetadata } from './types.js'\nimport { timeoutSignal } from './util.js'\n\nexport type TokenSet = {\n  iss: string\n  sub: AtprotoDid\n  aud: string\n  scope: AtprotoScope\n\n  refresh_token?: string\n  access_token: string\n  token_type: 'DPoP'\n  /** ISO Date */\n  expires_at?: string\n}\n\nexport type DpopNonceCache = SimpleStore<string, string>\n\nexport class OAuthServerAgent {\n  protected dpopFetch: Fetch<unknown>\n\n  constructor(\n    readonly dpopKey: Key,\n    readonly serverMetadata: OAuthAuthorizationServerMetadata,\n    readonly clientMetadata: ClientMetadata,\n    readonly dpopNonces: DpopNonceCache,\n    readonly oauthResolver: OAuthResolver,\n    readonly runtime: Runtime,\n    readonly keyset?: Keyset,\n    fetch?: Fetch,\n  ) {\n    this.dpopFetch = dpopFetchWrapper<void>({\n      fetch: bindFetch(fetch),\n      iss: clientMetadata.client_id,\n      key: dpopKey,\n      supportedAlgs: serverMetadata.dpop_signing_alg_values_supported,\n      sha256: async (v) => runtime.sha256(v),\n      nonces: dpopNonces,\n      isAuthServer: true,\n    })\n  }\n\n  get issuer() {\n    return this.serverMetadata.issuer\n  }\n\n  async revoke(token: string) {\n    try {\n      await this.request('revocation', { token })\n    } catch {\n      // Don't care\n    }\n  }\n\n  async exchangeCode(code: string, codeVerifier?: string): Promise<TokenSet> {\n    const now = Date.now()\n\n    const tokenResponse = await this.request('token', {\n      grant_type: 'authorization_code',\n      redirect_uri: this.clientMetadata.redirect_uris[0]!,\n      code,\n      code_verifier: codeVerifier,\n    })\n\n    try {\n      // /!\\ IMPORTANT /!\\\n      //\n      // The tokenResponse MUST always be valid before the \"sub\" it contains\n      // can be trusted (see Atproto's OAuth spec for details).\n      const aud = await this.verifyIssuer(tokenResponse.sub)\n\n      return {\n        aud,\n        sub: tokenResponse.sub,\n        iss: this.issuer,\n\n        scope: tokenResponse.scope,\n        refresh_token: tokenResponse.refresh_token,\n        access_token: tokenResponse.access_token,\n        token_type: tokenResponse.token_type,\n\n        expires_at:\n          typeof tokenResponse.expires_in === 'number'\n            ? new Date(now + tokenResponse.expires_in * 1000).toISOString()\n            : undefined,\n      }\n    } catch (err) {\n      await this.revoke(tokenResponse.access_token)\n\n      throw err\n    }\n  }\n\n  async refresh(tokenSet: TokenSet): Promise<TokenSet> {\n    if (!tokenSet.refresh_token) {\n      throw new TokenRefreshError(tokenSet.sub, 'No refresh token available')\n    }\n\n    // /!\\ IMPORTANT /!\\\n    //\n    // The \"sub\" MUST be a DID, whose issuer authority is indeed the server we\n    // are trying to obtain credentials from. Note that we are doing this\n    // *before* we actually try to refresh the token:\n    // 1) To avoid unnecessary refresh\n    // 2) So that the refresh is the last async operation, ensuring as few\n    //    async operations happen before the result gets a chance to be stored.\n    const aud = await this.verifyIssuer(tokenSet.sub)\n\n    const now = Date.now()\n\n    const tokenResponse = await this.request('token', {\n      grant_type: 'refresh_token',\n      refresh_token: tokenSet.refresh_token,\n    })\n\n    return {\n      aud,\n      sub: tokenSet.sub,\n      iss: this.issuer,\n\n      scope: tokenResponse.scope,\n      refresh_token: tokenResponse.refresh_token,\n      access_token: tokenResponse.access_token,\n      token_type: tokenResponse.token_type,\n\n      expires_at:\n        typeof tokenResponse.expires_in === 'number'\n          ? new Date(now + tokenResponse.expires_in * 1000).toISOString()\n          : undefined,\n    }\n  }\n\n  /**\n   * VERY IMPORTANT ! Always call this to process token responses.\n   *\n   * Whenever an OAuth token response is received, we **MUST** verify that the\n   * \"sub\" is a DID, whose issuer authority is indeed the server we just\n   * obtained credentials from. This check is a critical step to actually be\n   * able to use the \"sub\" (DID) as being the actual user's identifier.\n   *\n   * @returns The user's PDS URL (the resource server for the user)\n   */\n  protected async verifyIssuer(sub: AtprotoDid) {\n    using signal = timeoutSignal(10e3)\n\n    const resolved = await this.oauthResolver.resolveFromIdentity(sub, {\n      noCache: true,\n      allowStale: false,\n      signal,\n    })\n\n    if (this.issuer !== resolved.metadata.issuer) {\n      // Best case scenario; the user switched PDS. Worst case scenario; a bad\n      // actor is trying to impersonate a user. In any case, we must not allow\n      // this token to be used.\n      throw new TypeError('Issuer mismatch')\n    }\n\n    return resolved.identity.pds.href\n  }\n\n  async request<Endpoint extends OAuthEndpointName>(\n    endpoint: Endpoint,\n    payload: Endpoint extends 'token'\n      ? OAuthTokenRequest\n      : Endpoint extends 'pushed_authorization_request'\n        ? OAuthAuthorizationRequestPar\n        : Record<string, unknown>,\n  ): Promise<\n    Endpoint extends 'token'\n      ? AtprotoTokenResponse\n      : Endpoint extends 'pushed_authorization_request'\n        ? OAuthParResponse\n        : Json\n  >\n  async request(\n    endpoint: OAuthEndpointName,\n    payload: Record<string, unknown>,\n  ): Promise<unknown> {\n    const url = this.serverMetadata[`${endpoint}_endpoint`]\n    if (!url) throw new Error(`No ${endpoint} endpoint available`)\n\n    const auth = await this.buildClientAuth(endpoint)\n\n    const { response, json } = await this.dpopFetch(url, {\n      method: 'POST',\n      headers: { ...auth.headers, 'Content-Type': 'application/json' },\n      body: JSON.stringify({ ...payload, ...auth.payload }),\n    }).then(fetchJsonProcessor())\n\n    if (response.ok) {\n      switch (endpoint) {\n        case 'token':\n          return atprotoTokenResponseSchema.parse(json)\n        case 'pushed_authorization_request':\n          return oauthParResponseSchema.parse(json)\n        default:\n          return json\n      }\n    } else {\n      throw new OAuthResponseError(response, json)\n    }\n  }\n\n  async buildClientAuth(endpoint: OAuthEndpointName): Promise<{\n    headers?: Record<string, string>\n    payload: OAuthClientCredentials\n  }> {\n    const methodSupported =\n      this.serverMetadata[`token_endpoint_auth_methods_supported`]\n\n    const method = this.clientMetadata[`token_endpoint_auth_method`]\n\n    if (\n      method === 'private_key_jwt' ||\n      (this.keyset &&\n        !method &&\n        (methodSupported?.includes('private_key_jwt') ?? false))\n    ) {\n      if (!this.keyset) throw new Error('No keyset available')\n\n      try {\n        const alg =\n          this.serverMetadata[\n            `token_endpoint_auth_signing_alg_values_supported`\n          ] ?? FALLBACK_ALG\n\n        // If jwks is defined, make sure to only sign using a key that exists in\n        // the jwks. If jwks_uri is defined, we can't be sure that the key we're\n        // looking for is in there so we will just assume it is.\n        const kid = this.clientMetadata.jwks?.keys\n          .map(({ kid }) => kid)\n          .filter((v): v is string => typeof v === 'string')\n\n        return {\n          payload: {\n            client_id: this.clientMetadata.client_id,\n            client_assertion_type: CLIENT_ASSERTION_TYPE_JWT_BEARER,\n            client_assertion: await this.keyset.createJwt(\n              { alg, kid },\n              {\n                iss: this.clientMetadata.client_id,\n                sub: this.clientMetadata.client_id,\n                aud: this.serverMetadata.issuer,\n                jti: await this.runtime.generateNonce(),\n                iat: Math.floor(Date.now() / 1000),\n              },\n            ),\n          },\n        }\n      } catch (err) {\n        if (method === 'private_key_jwt') throw err\n\n        // Else try next method\n      }\n    }\n\n    if (\n      method === 'none' ||\n      (!method && (methodSupported?.includes('none') ?? true))\n    ) {\n      return {\n        payload: {\n          client_id: this.clientMetadata.client_id,\n        },\n      }\n    }\n\n    throw new Error(`Unsupported ${endpoint} authentication method`)\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 17465, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 17470, "column": 0}, "map": {"version":3,"file":"oauth-server-factory.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-server-factory.ts"],"sourcesContent":["import { Fetch } from '@atproto-labs/fetch'\nimport { Key, Keyset } from '@atproto/jwk'\nimport { OAuthAuthorizationServerMetadata } from '@atproto/oauth-types'\n\nimport { GetCachedOptions } from './oauth-authorization-server-metadata-resolver.js'\nimport { OAuthResolver } from './oauth-resolver.js'\nimport { DpopNonceCache, OAuthServerAgent } from './oauth-server-agent.js'\nimport { Runtime } from './runtime.js'\nimport { ClientMetadata } from './types.js'\n\nexport class OAuthServerFactory {\n  constructor(\n    readonly clientMetadata: ClientMetadata,\n    readonly runtime: Runtime,\n    readonly resolver: OAuthResolver,\n    readonly fetch: Fetch,\n    readonly keyset: Keyset | undefined,\n    readonly dpopNonceCache: DpopNonceCache,\n  ) {}\n\n  async fromIssuer(issuer: string, dpopKey: Key, options?: GetCachedOptions) {\n    const serverMetadata = await this.resolver.getAuthorizationServerMetadata(\n      issuer,\n      options,\n    )\n    return this.fromMetadata(serverMetadata, dpopKey)\n  }\n\n  async fromMetadata(\n    serverMetadata: OAuthAuthorizationServerMetadata,\n    dpopKey: Key,\n  ) {\n    return new OAuthServerAgent(\n      dpopKey,\n      serverMetadata,\n      this.clientMetadata,\n      this.dpopNonceCache,\n      this.resolver,\n      this.runtime,\n      this.keyset,\n      this.fetch,\n    )\n  }\n}\n"],"names":[],"mappings":";;;;;AAMA,MAAA,6DAA0E;AAI1E,MAAa,kBAAkB;IAC7B,YACW,cAA8B,EAC9B,OAAgB,EAChB,QAAuB,EACvB,KAAY,EACZ,MAA0B,EAC1B,cAA8B,CAAA;QALvC,OAAA,cAAA,CAAA,IAAA,EAAA,kBAAA;;;;mBAAS,cAAc;WAAgB;QACvC,OAAA,cAAA,CAAA,IAAA,EAAA,WAAA;;;;mBAAS,OAAO;WAAS;QACzB,OAAA,cAAA,CAAA,IAAA,EAAA,YAAA;;;;mBAAS,QAAQ;WAAe;QAChC,OAAA,cAAA,CAAA,IAAA,EAAA,SAAA;;;;mBAAS,KAAK;WAAO;QACrB,OAAA,cAAA,CAAA,IAAA,EAAA,UAAA;;;;mBAAS,MAAM;WAAoB;QACnC,OAAA,cAAA,CAAA,IAAA,EAAA,kBAAA;;;;mBAAS,cAAc;WAAgB;IACtC,CAAC;IAEJ,KAAK,CAAC,UAAU,CAAC,MAAc,EAAE,OAAY,EAAE,OAA0B,EAAA;QACvE,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,8BAA8B,CACvE,MAAM,EACN,OAAO,CACR,CAAA;QACD,OAAO,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,OAAO,CAAC,CAAA;IACnD,CAAC;IAED,KAAK,CAAC,YAAY,CAChB,cAAgD,EAChD,OAAY,EAAA;QAEZ,OAAO,IAAI,wBAAA,gBAAgB,CACzB,OAAO,EACP,cAAc,EACd,IAAI,CAAC,cAAc,EACnB,IAAI,CAAC,cAAc,EACnB,IAAI,CAAC,QAAQ,EACb,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,MAAM,EACX,IAAI,CAAC,KAAK,CACX,CAAA;IACH,CAAC;CACF;AAjCD,QAAA,kBAAA,GAAA,mBAiCC","ignoreList":[0]}},
    {"offset": {"line": 17524, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 17529, "column": 0}, "map": {"version":3,"file":"token-invalid-error.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/errors/token-invalid-error.ts"],"sourcesContent":["export class TokenInvalidError extends Error {\n  constructor(\n    public readonly sub: string,\n    message = `The session for \"${sub}\" is invalid`,\n    options?: { cause?: unknown },\n  ) {\n    super(message, options)\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,MAAa,iBAAkB,SAAQ,KAAK;IAC1C,YACkB,GAAW,EAC3B,OAAO,GAAG,CAAA,iBAAA,EAAoB,GAAG,CAAA,YAAA,CAAc,EAC/C,OAA6B,CAAA;QAE7B,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;QAJvB,OAAA,cAAA,CAAA,IAAA,EAAA,OAAA;;;;mBAAgB,GAAG;WAAQ;IAK7B,CAAC;CACF;AARD,QAAA,iBAAA,GAAA,kBAQC","ignoreList":[0]}},
    {"offset": {"line": 17546, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 17551, "column": 0}, "map": {"version":3,"file":"oauth-session.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-session.ts"],"sourcesContent":["import { bindFetch, Fetch } from '@atproto-labs/fetch'\nimport { AtprotoDid } from '@atproto/did'\nimport { OAuthAuthorizationServerMetadata } from '@atproto/oauth-types'\n\nimport { AtprotoScope } from './atproto-token-response.js'\nimport { TokenInvalidError } from './errors/token-invalid-error.js'\nimport { TokenRevokedError } from './errors/token-revoked-error.js'\nimport { dpopFetchWrapper } from './fetch-dpop.js'\nimport { OAuthServerAgent, TokenSet } from './oauth-server-agent.js'\nimport { SessionGetter } from './session-getter.js'\n\nconst ReadableStream = globalThis.ReadableStream as\n  | typeof globalThis.ReadableStream\n  | undefined\n\nexport type TokenInfo = {\n  expiresAt?: Date\n  expired?: boolean\n  scope: AtprotoScope\n  iss: string\n  aud: string\n  sub: AtprotoDid\n}\n\nexport class OAuthSession {\n  protected dpopFetch: Fetch<unknown>\n\n  constructor(\n    public readonly server: OAuthServerAgent,\n    public readonly sub: AtprotoDid,\n    private readonly sessionGetter: SessionGetter,\n    fetch: Fetch = globalThis.fetch,\n  ) {\n    this.dpopFetch = dpopFetchWrapper<void>({\n      fetch: bindFetch(fetch),\n      iss: server.clientMetadata.client_id,\n      key: server.dpopKey,\n      supportedAlgs: server.serverMetadata.dpop_signing_alg_values_supported,\n      sha256: async (v) => server.runtime.sha256(v),\n      nonces: server.dpopNonces,\n      isAuthServer: false,\n    })\n  }\n\n  get did(): AtprotoDid {\n    return this.sub\n  }\n\n  get serverMetadata(): Readonly<OAuthAuthorizationServerMetadata> {\n    return this.server.serverMetadata\n  }\n\n  /**\n   * @param refresh When `true`, the credentials will be refreshed even if they\n   * are not expired. When `false`, the credentials will not be refreshed even\n   * if they are expired. When `undefined`, the credentials will be refreshed\n   * if, and only if, they are (about to be) expired. Defaults to `undefined`.\n   */\n  protected async getTokenSet(refresh: boolean | 'auto'): Promise<TokenSet> {\n    const { tokenSet } = await this.sessionGetter.get(this.sub, {\n      noCache: refresh === true,\n      allowStale: refresh === false,\n    })\n\n    return tokenSet\n  }\n\n  async getTokenInfo(refresh: boolean | 'auto' = 'auto'): Promise<TokenInfo> {\n    const tokenSet = await this.getTokenSet(refresh)\n    const expiresAt =\n      tokenSet.expires_at == null ? undefined : new Date(tokenSet.expires_at)\n\n    return {\n      expiresAt,\n      get expired() {\n        return expiresAt == null\n          ? undefined\n          : expiresAt.getTime() < Date.now() - 5e3\n      },\n      scope: tokenSet.scope,\n      iss: tokenSet.iss,\n      aud: tokenSet.aud,\n      sub: tokenSet.sub,\n    }\n  }\n\n  async signOut(): Promise<void> {\n    try {\n      const tokenSet = await this.getTokenSet(false)\n      await this.server.revoke(tokenSet.access_token)\n    } finally {\n      await this.sessionGetter.delStored(\n        this.sub,\n        new TokenRevokedError(this.sub),\n      )\n    }\n  }\n\n  async fetchHandler(pathname: string, init?: RequestInit): Promise<Response> {\n    // This will try and refresh the token if it is known to be expired\n    const tokenSet = await this.getTokenSet('auto')\n\n    const initialUrl = new URL(pathname, tokenSet.aud)\n    const initialAuth = `${tokenSet.token_type} ${tokenSet.access_token}`\n\n    const headers = new Headers(init?.headers)\n    headers.set('Authorization', initialAuth)\n\n    const initialResponse = await this.dpopFetch(initialUrl, {\n      ...init,\n      headers,\n    })\n\n    // If the token is not expired, we don't need to refresh it\n    if (!isInvalidTokenResponse(initialResponse)) {\n      return initialResponse\n    }\n\n    let tokenSetFresh: TokenSet\n    try {\n      // Force a refresh\n      tokenSetFresh = await this.getTokenSet(true)\n    } catch (err) {\n      return initialResponse\n    }\n\n    // The stream was already consumed. We cannot retry the request. A solution\n    // would be to tee() the input stream but that would bufferize the entire\n    // stream in memory which can lead to memory starvation. Instead, we will\n    // return the original response and let the calling code handle retries.\n    if (ReadableStream && init?.body instanceof ReadableStream) {\n      return initialResponse\n    }\n\n    const finalAuth = `${tokenSetFresh.token_type} ${tokenSetFresh.access_token}`\n    const finalUrl = new URL(pathname, tokenSetFresh.aud)\n\n    headers.set('Authorization', finalAuth)\n\n    const finalResponse = await this.dpopFetch(finalUrl, { ...init, headers })\n\n    // The token was successfully refreshed, but is still not accepted by the\n    // resource server. This might be due to the resource server not accepting\n    // credentials from the authorization server (e.g. because some migration\n    // occurred). Any ways, there is no point in keeping the session.\n    if (isInvalidTokenResponse(finalResponse)) {\n      // TODO: Is there a \"softer\" way to handle this, e.g. by marking the\n      // session as \"expired\" in the session store, allowing the user to trigger\n      // a new login (using login_hint)?\n      await this.sessionGetter.delStored(\n        this.sub,\n        new TokenInvalidError(this.sub),\n      )\n    }\n\n    return finalResponse\n  }\n}\n\n/**\n * @see {@link https://datatracker.ietf.org/doc/html/rfc6750#section-3}\n * @see {@link https://datatracker.ietf.org/doc/html/rfc9449#name-resource-server-provided-no}\n */\nfunction isInvalidTokenResponse(response: Response) {\n  if (response.status !== 401) return false\n  const wwwAuth = response.headers.get('WWW-Authenticate')\n  return (\n    wwwAuth != null &&\n    (wwwAuth.startsWith('Bearer ') || wwwAuth.startsWith('DPoP ')) &&\n    wwwAuth.includes('error=\"invalid_token\"')\n  )\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 17695, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 17700, "column": 0}, "map": {"version":3,"file":"lock.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/lock.ts"],"sourcesContent":["import { RuntimeLock } from './runtime-implementation.js'\n\nconst locks = new Map<unknown, Promise<void>>()\n\nfunction acquireLocalLock(name: unknown): Promise<() => void> {\n  return new Promise((resolveAcquire) => {\n    const prev = locks.get(name) ?? Promise.resolve()\n    const next = prev.then(() => {\n      return new Promise<void>((resolveRelease) => {\n        const release = () => {\n          // Only delete the lock if it is still the current one\n          if (locks.get(name) === next) locks.delete(name)\n\n          resolveRelease()\n        }\n\n        resolveAcquire(release)\n      })\n    })\n\n    locks.set(name, next)\n  })\n}\n\nexport const requestLocalLock: RuntimeLock = (name, fn) => {\n  return acquireLocalLock(name).then(async (release) => {\n    try {\n      return await fn()\n    } finally {\n      release()\n    }\n  })\n}\n"],"names":[],"mappings":";;;;;AAEA,MAAM,KAAK,GAAG,IAAI,GAAG,EAA0B,CAAA;AAE/C,SAAS,gBAAgB,CAAC,IAAa;IACrC,OAAO,IAAI,OAAO,CAAC,CAAC,cAAc,EAAE,EAAE;QACpC,MAAM,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,EAAE,CAAA;QACjD,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;YAC1B,OAAO,IAAI,OAAO,CAAO,CAAC,cAAc,EAAE,EAAE;gBAC1C,MAAM,OAAO,GAAG,GAAG,EAAE;oBACnB,sDAAsD;oBACtD,IAAI,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;oBAEhD,cAAc,EAAE,CAAA;gBAClB,CAAC,CAAA;gBAED,cAAc,CAAC,OAAO,CAAC,CAAA;YACzB,CAAC,CAAC,CAAA;QACJ,CAAC,CAAC,CAAA;QAEF,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;IACvB,CAAC,CAAC,CAAA;AACJ,CAAC;AAEM,MAAM,gBAAgB,GAAgB,CAAC,IAAI,EAAE,EAAE,EAAE,EAAE;IACxD,OAAO,gBAAgB,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE;QACnD,IAAI,CAAC;YACH,OAAO,MAAM,EAAE,EAAE,CAAA;QACnB,CAAC,QAAS,CAAC;YACT,OAAO,EAAE,CAAA;QACX,CAAC;IACH,CAAC,CAAC,CAAA;AACJ,CAAC,CAAA;AARY,QAAA,gBAAgB,GAAA,iBAQ5B","ignoreList":[0]}},
    {"offset": {"line": 17732, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 17737, "column": 0}, "map": {"version":3,"file":"runtime.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/runtime.ts"],"sourcesContent":["import { Key } from '@atproto/jwk'\nimport { base64url } from 'multiformats/bases/base64'\n\nimport { requestLocalLock } from './lock.js'\nimport { RuntimeImplementation, RuntimeLock } from './runtime-implementation.js'\n\nexport class Runtime {\n  readonly hasImplementationLock: boolean\n  readonly usingLock: RuntimeLock\n\n  constructor(protected implementation: RuntimeImplementation) {\n    const { requestLock } = implementation\n\n    this.hasImplementationLock = requestLock != null\n    this.usingLock =\n      requestLock?.bind(implementation) ||\n      // Falling back to a local lock\n      requestLocalLock\n  }\n\n  public async generateKey(algs: string[]): Promise<Key> {\n    const algsSorted = Array.from(algs).sort(compareAlgos)\n    return this.implementation.createKey(algsSorted)\n  }\n\n  public async sha256(text: string): Promise<string> {\n    const bytes = new TextEncoder().encode(text)\n    const digest = await this.implementation.digest(bytes, { name: 'sha256' })\n    return base64url.baseEncode(digest)\n  }\n\n  public async generateNonce(length = 16): Promise<string> {\n    const bytes = await this.implementation.getRandomValues(length)\n    return base64url.baseEncode(bytes)\n  }\n\n  public async generatePKCE(byteLength?: number) {\n    const verifier = await this.generateVerifier(byteLength)\n    return {\n      verifier,\n      challenge: await this.sha256(verifier),\n      method: 'S256' as const,\n    }\n  }\n\n  public async calculateJwkThumbprint(jwk) {\n    const components = extractJktComponents(jwk)\n    const data = JSON.stringify(components)\n    return this.sha256(data)\n  }\n\n  /**\n   * @see {@link https://datatracker.ietf.org/doc/html/rfc7636#section-4.1}\n   * @note It is RECOMMENDED that the output of a suitable random number generator\n   * be used to create a 32-octet sequence. The octet sequence is then\n   * base64url-encoded to produce a 43-octet URL safe string to use as the code\n   * verifier.\n   */\n  protected async generateVerifier(byteLength = 32) {\n    if (byteLength < 32 || byteLength > 96) {\n      throw new TypeError('Invalid code_verifier length')\n    }\n    const bytes = await this.implementation.getRandomValues(byteLength)\n    return base64url.baseEncode(bytes)\n  }\n}\n\nfunction extractJktComponents(jwk) {\n  const get = (field) => {\n    const value = jwk[field]\n    if (typeof value !== 'string' || !value) {\n      throw new TypeError(`\"${field}\" Parameter missing or invalid`)\n    }\n    return value\n  }\n\n  switch (jwk.kty) {\n    case 'EC':\n      return { crv: get('crv'), kty: get('kty'), x: get('x'), y: get('y') }\n    case 'OKP':\n      return { crv: get('crv'), kty: get('kty'), x: get('x') }\n    case 'RSA':\n      return { e: get('e'), kty: get('kty'), n: get('n') }\n    case 'oct':\n      return { k: get('k'), kty: get('kty') }\n    default:\n      throw new TypeError('\"kty\" (Key Type) Parameter missing or unsupported')\n  }\n}\n\n/**\n * 256K > ES (256 > 384 > 512) > PS (256 > 384 > 512) > RS (256 > 384 > 512) > other (in original order)\n */\nfunction compareAlgos(a: string, b: string): number {\n  if (a === 'ES256K') return -1\n  if (b === 'ES256K') return 1\n\n  for (const prefix of ['ES', 'PS', 'RS']) {\n    if (a.startsWith(prefix)) {\n      if (b.startsWith(prefix)) {\n        const aLen = parseInt(a.slice(2, 5))\n        const bLen = parseInt(b.slice(2, 5))\n\n        // Prefer shorter key lengths\n        return aLen - bLen\n      }\n      return -1\n    } else if (b.startsWith(prefix)) {\n      return 1\n    }\n  }\n\n  // Don't know how to compare, keep original order\n  return 0\n}\n"],"names":[],"mappings":";;;;;AACA,MAAA,gDAAqD;AAErD,MAAA,iCAA4C;AAG5C,MAAa,OAAO;IAIlB,YAAsB,cAAqC,CAAA;QAA/C,OAAA,cAAA,CAAA,IAAA,EAAA,kBAAA;;;;mBAAU,cAAc;WAAuB;QAHlD,OAAA,cAAA,CAAA,IAAA,EAAA,yBAAA;;;;;WAA8B;QAC9B,OAAA,cAAA,CAAA,IAAA,EAAA,aAAA;;;;;WAAsB;QAG7B,MAAM,EAAE,WAAW,EAAE,GAAG,cAAc,CAAA;QAEtC,IAAI,CAAC,qBAAqB,GAAG,WAAW,IAAI,IAAI,CAAA;QAChD,IAAI,CAAC,SAAS,GACZ,WAAW,EAAE,IAAI,CAAC,cAAc,CAAC,IACjC,+BAA+B;QAC/B,UAAA,gBAAgB,CAAA;IACpB,CAAC;IAEM,KAAK,CAAC,WAAW,CAAC,IAAc,EAAA;QACrC,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;QACtD,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,UAAU,CAAC,CAAA;IAClD,CAAC;IAEM,KAAK,CAAC,MAAM,CAAC,IAAY,EAAA;QAC9B,MAAM,KAAK,GAAG,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;QAC5C,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,KAAK,EAAE;YAAE,IAAI,EAAE,QAAQ;QAAA,CAAE,CAAC,CAAA;QAC1E,OAAO,SAAA,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAA;IACrC,CAAC;IAEM,KAAK,CAAC,aAAa,CAAC,MAAM,GAAG,EAAE,EAAA;QACpC,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,MAAM,CAAC,CAAA;QAC/D,OAAO,SAAA,SAAS,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;IACpC,CAAC;IAEM,KAAK,CAAC,YAAY,CAAC,UAAmB,EAAA;QAC3C,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAA;QACxD,OAAO;YACL,QAAQ;YACR,SAAS,EAAE,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;YACtC,MAAM,EAAE,MAAe;SACxB,CAAA;IACH,CAAC;IAEM,KAAK,CAAC,sBAAsB,CAAC,GAAG,EAAA;QACrC,MAAM,UAAU,GAAG,oBAAoB,CAAC,GAAG,CAAC,CAAA;QAC5C,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAA;QACvC,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;IAC1B,CAAC;IAED;;;;;;OAMG,CACO,KAAK,CAAC,gBAAgB,CAAC,UAAU,GAAG,EAAE,EAAA;QAC9C,IAAI,UAAU,GAAG,EAAE,IAAI,UAAU,GAAG,EAAE,EAAE,CAAC;YACvC,MAAM,IAAI,SAAS,CAAC,8BAA8B,CAAC,CAAA;QACrD,CAAC;QACD,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,UAAU,CAAC,CAAA;QACnE,OAAO,SAAA,SAAS,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;IACpC,CAAC;CACF;AA3DD,QAAA,OAAA,GAAA,QA2DC;AAED,SAAS,oBAAoB,CAAC,GAAG;IAC/B,MAAM,GAAG,GAAG,CAAC,KAAK,EAAE,EAAE;QACpB,MAAM,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,CAAA;QACxB,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,CAAC,KAAK,EAAE,CAAC;YACxC,MAAM,IAAI,SAAS,CAAC,CAAA,CAAA,EAAI,KAAK,CAAA,8BAAA,CAAgC,CAAC,CAAA;QAChE,CAAC;QACD,OAAO,KAAK,CAAA;IACd,CAAC,CAAA;IAED,OAAQ,GAAG,CAAC,GAAG,EAAE,CAAC;QAChB,KAAK,IAAI;YACP,OAAO;gBAAE,GAAG,EAAE,GAAG,CAAC,KAAK,CAAC;gBAAE,GAAG,EAAE,GAAG,CAAC,KAAK,CAAC;gBAAE,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC;gBAAE,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC;YAAA,CAAE,CAAA;QACvE,KAAK,KAAK;YACR,OAAO;gBAAE,GAAG,EAAE,GAAG,CAAC,KAAK,CAAC;gBAAE,GAAG,EAAE,GAAG,CAAC,KAAK,CAAC;gBAAE,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC;YAAA,CAAE,CAAA;QAC1D,KAAK,KAAK;YACR,OAAO;gBAAE,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC;gBAAE,GAAG,EAAE,GAAG,CAAC,KAAK,CAAC;gBAAE,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC;YAAA,CAAE,CAAA;QACtD,KAAK,KAAK;YACR,OAAO;gBAAE,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC;gBAAE,GAAG,EAAE,GAAG,CAAC,KAAK,CAAC;YAAA,CAAE,CAAA;QACzC;YACE,MAAM,IAAI,SAAS,CAAC,mDAAmD,CAAC,CAAA;IAC5E,CAAC;AACH,CAAC;AAED;;GAEG,CACH,SAAS,YAAY,CAAC,CAAS,EAAE,CAAS;IACxC,IAAI,CAAC,KAAK,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAA;IAC7B,IAAI,CAAC,KAAK,QAAQ,EAAE,OAAO,CAAC,CAAA;IAE5B,KAAK,MAAM,MAAM,IAAI;QAAC,IAAI;QAAE,IAAI;QAAE,IAAI;KAAC,CAAE,CAAC;QACxC,IAAI,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC;YACzB,IAAI,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC;gBACzB,MAAM,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;gBACpC,MAAM,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;gBAEpC,6BAA6B;gBAC7B,OAAO,IAAI,GAAG,IAAI,CAAA;YACpB,CAAC;YACD,OAAO,CAAC,CAAC,CAAA;QACX,CAAC,MAAM,IAAI,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC;YAChC,OAAO,CAAC,CAAA;QACV,CAAC;IACH,CAAC;IAED,iDAAiD;IACjD,OAAO,CAAC,CAAA;AACV,CAAC","ignoreList":[0]}},
    {"offset": {"line": 17874, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 17879, "column": 0}, "map": {"version":3,"file":"session-getter.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/session-getter.ts"],"sourcesContent":["import {\n  CachedGetter,\n  GetCachedOptions,\n  SimpleStore,\n} from '@atproto-labs/simple-store'\nimport { AtprotoDid } from '@atproto/did'\nimport { Key } from '@atproto/jwk'\n\nimport { TokenInvalidError } from './errors/token-invalid-error.js'\nimport { TokenRefreshError } from './errors/token-refresh-error.js'\nimport { TokenRevokedError } from './errors/token-revoked-error.js'\nimport { OAuthResponseError } from './oauth-response-error.js'\nimport { TokenSet } from './oauth-server-agent.js'\nimport { OAuthServerFactory } from './oauth-server-factory.js'\nimport { Runtime } from './runtime.js'\nimport { combineSignals, CustomEventTarget, timeoutSignal } from './util.js'\n\nexport type Session = {\n  dpopKey: Key\n  tokenSet: TokenSet\n}\n\nexport type SessionStore = SimpleStore<string, Session>\n\nexport type SessionEventMap = {\n  updated: {\n    sub: string\n  } & Session\n  deleted: {\n    sub: string\n    cause: TokenRefreshError | TokenRevokedError | TokenInvalidError | unknown\n  }\n}\n\nexport type SessionEventListener<\n  T extends keyof SessionEventMap = keyof SessionEventMap,\n> = (event: CustomEvent<SessionEventMap[T]>) => void\n\n/**\n * There are several advantages to wrapping the sessionStore in a (single)\n * CachedGetter, the main of which is that the cached getter will ensure that at\n * most one fresh call is ever being made. Another advantage, is that it\n * contains the logic for reading from the cache which, if the cache is based on\n * localStorage/indexedDB, will sync across multiple tabs (for a given sub).\n */\nexport class SessionGetter extends CachedGetter<AtprotoDid, Session> {\n  private readonly eventTarget = new CustomEventTarget<SessionEventMap>()\n\n  constructor(\n    sessionStore: SessionStore,\n    serverFactory: OAuthServerFactory,\n    private readonly runtime: Runtime,\n  ) {\n    super(\n      async (sub, options, storedSession): Promise<Session> => {\n        // There needs to be a previous session to be able to refresh. If\n        // storedSession is undefined, it means that the store does not contain\n        // a session for the given sub.\n        if (storedSession === undefined) {\n          // Because the session is not in the store, this.delStored() method\n          // will not be called by the CachedGetter class (because there is\n          // nothing to delete). This would typically happen if there is no\n          // synchronization mechanism between instances of this class. Let's\n          // make sure an event is dispatched here if this occurs.\n          const msg = 'The session was deleted by another process'\n          const cause = new TokenRefreshError(sub, msg)\n          this.dispatchEvent('deleted', { sub, cause })\n          throw cause\n        }\n\n        // From this point forward, throwing a TokenRefreshError will result in\n        // this.delStored() being called, resulting in an event being\n        // dispatched, even if the session was removed from the store through a\n        // concurrent access (which, normally, should not happen if a proper\n        // runtime lock was provided).\n\n        const { dpopKey, tokenSet } = storedSession\n\n        if (sub !== tokenSet.sub) {\n          // Fool-proofing (e.g. against invalid session storage)\n          throw new TokenRefreshError(sub, 'Stored session sub mismatch')\n        }\n\n        if (!tokenSet.refresh_token) {\n          throw new TokenRefreshError(sub, 'No refresh token available')\n        }\n\n        // Since refresh tokens can only be used once, we might run into\n        // concurrency issues if multiple instances (e.g. browser tabs) are\n        // trying to refresh the same token simultaneously. The chances of this\n        // happening when multiple instances are started simultaneously is\n        // reduced by randomizing the expiry time (see isStale() below). The\n        // best solution is to use a mutex/lock to ensure that only one instance\n        // is refreshing the token at a time (runtime.usingLock) but that is not\n        // always possible. If no lock implementation is provided, we will use\n        // the store to check if a concurrent refresh occurred.\n\n        const server = await serverFactory.fromIssuer(tokenSet.iss, dpopKey)\n\n        // Because refresh tokens can only be used once, we must not use the\n        // \"signal\" to abort the refresh, or throw any abort error beyond this\n        // point. Any thrown error beyond this point will prevent the\n        // TokenGetter from obtaining, and storing, the new token set,\n        // effectively rendering the currently saved session unusable.\n        options?.signal?.throwIfAborted()\n\n        try {\n          const newTokenSet = await server.refresh(tokenSet)\n\n          if (sub !== newTokenSet.sub) {\n            // The server returned another sub. Was the tokenSet manipulated?\n            throw new TokenRefreshError(sub, 'Token set sub mismatch')\n          }\n\n          return { dpopKey, tokenSet: newTokenSet }\n        } catch (cause) {\n          // If the refresh token is invalid, let's try to recover from\n          // concurrency issues, or make sure the session is deleted by throwing\n          // a TokenRefreshError.\n          if (\n            cause instanceof OAuthResponseError &&\n            cause.status === 400 &&\n            cause.error === 'invalid_grant'\n          ) {\n            // In case there is no lock implementation in the runtime, we will\n            // wait for a short time to give the other concurrent instances a\n            // chance to finish their refreshing of the token. If a concurrent\n            // refresh did occur, we will pretend that this one succeeded.\n            if (!runtime.hasImplementationLock) {\n              await new Promise((r) => setTimeout(r, 1000))\n\n              const stored = await this.getStored(sub)\n              if (stored === undefined) {\n                // A concurrent refresh occurred and caused the session to be\n                // deleted (for a reason we can't know at this point).\n\n                // Using a distinct error message mainly for debugging\n                // purposes. Also, throwing a TokenRefreshError to trigger\n                // deletion through the deleteOnError callback.\n                const msg = 'The session was deleted by another process'\n                throw new TokenRefreshError(sub, msg, { cause })\n              } else if (\n                stored.tokenSet.access_token !== tokenSet.access_token ||\n                stored.tokenSet.refresh_token !== tokenSet.refresh_token\n              ) {\n                // A concurrent refresh occurred. Pretend this one succeeded.\n                return stored\n              } else {\n                // There were no concurrent refresh. The token is (likely)\n                // simply no longer valid.\n              }\n            }\n\n            // Make sure the session gets deleted from the store\n            const msg = cause.errorDescription ?? 'The session was revoked'\n            throw new TokenRefreshError(sub, msg, { cause })\n          }\n\n          throw cause\n        }\n      },\n      sessionStore,\n      {\n        isStale: (sub, { tokenSet }) => {\n          return (\n            tokenSet.expires_at != null &&\n            new Date(tokenSet.expires_at).getTime() <\n              Date.now() +\n                // Add some lee way to ensure the token is not expired when it\n                // reaches the server.\n                10e3 +\n                // Add some randomness to reduce the chances of multiple\n                // instances trying to refresh the token at the same.\n                30e3 * Math.random()\n          )\n        },\n        onStoreError: async (err, sub, { tokenSet, dpopKey }) => {\n          // If the token data cannot be stored, let's revoke it\n          const server = await serverFactory.fromIssuer(tokenSet.iss, dpopKey)\n          await server.revoke(tokenSet.refresh_token ?? tokenSet.access_token)\n          throw err\n        },\n        deleteOnError: async (err) =>\n          // Optimization: More likely to happen first\n          err instanceof TokenRefreshError ||\n          err instanceof TokenRevokedError ||\n          err instanceof TokenInvalidError,\n      },\n    )\n  }\n\n  addEventListener<T extends keyof SessionEventMap>(\n    type: T,\n    callback: SessionEventListener<T>,\n    options?: AddEventListenerOptions | boolean,\n  ) {\n    this.eventTarget.addEventListener(type, callback, options)\n  }\n\n  removeEventListener<T extends keyof SessionEventMap>(\n    type: T,\n    callback: SessionEventListener<T>,\n    options?: EventListenerOptions | boolean,\n  ) {\n    this.eventTarget.removeEventListener(type, callback, options)\n  }\n\n  dispatchEvent<T extends keyof SessionEventMap>(\n    type: T,\n    detail: SessionEventMap[T],\n  ): boolean {\n    return this.eventTarget.dispatchCustomEvent(type, detail)\n  }\n\n  async setStored(sub: string, session: Session) {\n    // Prevent tampering with the stored value\n    if (sub !== session.tokenSet.sub) {\n      throw new TypeError('Token set does not match the expected sub')\n    }\n    await super.setStored(sub, session)\n    this.dispatchEvent('updated', { sub, ...session })\n  }\n\n  override async delStored(sub: AtprotoDid, cause?: unknown): Promise<void> {\n    await super.delStored(sub, cause)\n    this.dispatchEvent('deleted', { sub, cause })\n  }\n\n  /**\n   * @param refresh When `true`, the credentials will be refreshed even if they\n   * are not expired. When `false`, the credentials will not be refreshed even\n   * if they are expired. When `undefined`, the credentials will be refreshed\n   * if, and only if, they are (about to be) expired. Defaults to `undefined`.\n   */\n  async getSession(sub: AtprotoDid, refresh?: boolean) {\n    return this.get(sub, {\n      noCache: refresh === true,\n      allowStale: refresh === false,\n    })\n  }\n\n  async get(sub: AtprotoDid, options?: GetCachedOptions): Promise<Session> {\n    const session = await this.runtime.usingLock(\n      `@atproto-oauth-client-${sub}`,\n      async () => {\n        // Make sure, even if there is no signal in the options, that the\n        // request will be cancelled after at most 30 seconds.\n        using signal = timeoutSignal(30e3, options)\n\n        using abortController = combineSignals([options?.signal, signal])\n\n        return await super.get(sub, {\n          ...options,\n          signal: abortController.signal,\n        })\n      },\n    )\n\n    if (sub !== session.tokenSet.sub) {\n      // Fool-proofing (e.g. against invalid session storage)\n      throw new Error('Token set does not match the expected sub')\n    }\n\n    return session\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 18159, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18164, "column": 0}, "map": {"version":3,"file":"types.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/types.ts"],"sourcesContent":["import {\n  oauthClientIdLoopbackSchema,\n  OAuthAuthorizationRequestParameters,\n  oauthClientIdDiscoverableSchema,\n  oauthClientMetadataSchema,\n} from '@atproto/oauth-types'\nimport { TypeOf, z } from 'zod'\n\nimport { Simplify } from './util.js'\n\n// Note: These types are not prefixed with `OAuth` because they are not specific\n// to OAuth. They are specific to this packages. OAuth specific types are in\n// `@atproto/oauth-types`.\n\nexport type AuthorizeOptions = Simplify<\n  Omit<\n    OAuthAuthorizationRequestParameters,\n    | 'client_id'\n    | 'response_mode'\n    | 'response_type'\n    | 'login_hint'\n    | 'code_challenge'\n    | 'code_challenge_method'\n  > & {\n    signal?: AbortSignal\n  }\n>\n\nexport const clientMetadataSchema = oauthClientMetadataSchema.extend({\n  client_id: z.union([\n    oauthClientIdDiscoverableSchema,\n    oauthClientIdLoopbackSchema,\n  ]),\n})\n\nexport type ClientMetadata = TypeOf<typeof clientMetadataSchema>\n"],"names":[],"mappings":";;;;;AAAA,MAAA,gDAK6B;AAC7B,MAAA,uBAA+B;AAsBlB,QAAA,oBAAoB,GAAG,cAAA,yBAAyB,CAAC,MAAM,CAAC;IACnE,SAAS,EAAE,MAAA,CAAC,CAAC,KAAK,CAAC;QACjB,cAAA,+BAA+B;QAC/B,cAAA,2BAA2B;KAC5B,CAAC;CACH,CAAC,CAAA","ignoreList":[0]}},
    {"offset": {"line": 18177, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18182, "column": 0}, "map": {"version":3,"file":"validate-client-metadata.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/validate-client-metadata.ts"],"sourcesContent":["import { Keyset } from '@atproto/jwk'\nimport {\n  OAuthClientMetadataInput,\n  assertOAuthDiscoverableClientId,\n  assertOAuthLoopbackClientId,\n} from '@atproto/oauth-types'\n\nimport { ClientMetadata, clientMetadataSchema } from './types.js'\n\nconst TOKEN_ENDPOINT_AUTH_METHOD = `token_endpoint_auth_method`\nconst TOKEN_ENDPOINT_AUTH_SIGNING_ALG = `token_endpoint_auth_signing_alg`\n\nexport function validateClientMetadata(\n  input: OAuthClientMetadataInput,\n  keyset?: Keyset,\n): ClientMetadata {\n  if (input.jwks) {\n    if (!keyset) {\n      throw new TypeError(`Keyset must not be provided when jwks is provided`)\n    }\n    for (const key of input.jwks.keys) {\n      if (!key.kid) {\n        throw new TypeError(`Key must have a \"kid\" property`)\n      } else if (!keyset.has(key.kid)) {\n        throw new TypeError(`Key with kid \"${key.kid}\" not found in keyset`)\n      }\n    }\n  }\n\n  // Allow to pass a keyset and omit the jwks/jwks_uri properties\n  if (!input.jwks && !input.jwks_uri && keyset?.size) {\n    input = { ...input, jwks: keyset.toJSON() }\n  }\n\n  const metadata = clientMetadataSchema.parse(input)\n\n  // Validate client ID\n  if (metadata.client_id.startsWith('http:')) {\n    assertOAuthLoopbackClientId(metadata.client_id)\n  } else {\n    assertOAuthDiscoverableClientId(metadata.client_id)\n  }\n\n  const scopes = metadata.scope?.split(' ')\n  if (!scopes?.includes('atproto')) {\n    throw new TypeError(`Client metadata must include the \"atproto\" scope`)\n  }\n\n  if (!metadata.response_types.includes('code')) {\n    throw new TypeError(`\"response_types\" must include \"code\"`)\n  }\n\n  if (!metadata.grant_types.includes('authorization_code')) {\n    throw new TypeError(`\"grant_types\" must include \"authorization_code\"`)\n  }\n\n  const method = metadata[TOKEN_ENDPOINT_AUTH_METHOD]\n  switch (method) {\n    case undefined:\n      throw new TypeError(`${TOKEN_ENDPOINT_AUTH_METHOD} must be provided`)\n    case 'none':\n      if (metadata[TOKEN_ENDPOINT_AUTH_SIGNING_ALG]) {\n        throw new TypeError(\n          `${TOKEN_ENDPOINT_AUTH_SIGNING_ALG} must not be provided when ${TOKEN_ENDPOINT_AUTH_METHOD} is \"${method}\"`,\n        )\n      }\n      break\n    case 'private_key_jwt':\n      if (!keyset?.size) {\n        throw new TypeError(\n          `A non-empty keyset must be provided when ${TOKEN_ENDPOINT_AUTH_METHOD} is \"${method}\"`,\n        )\n      }\n      if (!metadata[TOKEN_ENDPOINT_AUTH_SIGNING_ALG]) {\n        throw new TypeError(\n          `${TOKEN_ENDPOINT_AUTH_SIGNING_ALG} must be provided when ${TOKEN_ENDPOINT_AUTH_METHOD} is \"${method}\"`,\n        )\n      }\n      break\n    default:\n      throw new TypeError(\n        `Invalid \"token_endpoint_auth_method\" value: ${method}`,\n      )\n  }\n\n  return metadata\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 18250, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18255, "column": 0}, "map": {"version":3,"file":"oauth-client.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/oauth-client.ts"],"sourcesContent":["import {\n  assertAtprotoDid,\n  AtprotoDid,\n  DidCache,\n  DidResolverCached,\n  DidResolverCommon,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  type DidResolverCommonOptions,\n} from '@atproto-labs/did-resolver'\nimport { Fetch } from '@atproto-labs/fetch'\nimport {\n  AppViewHandleResolver,\n  CachedHandleResolver,\n  HandleCache,\n  HandleResolver,\n} from '@atproto-labs/handle-resolver'\nimport { IdentityResolver } from '@atproto-labs/identity-resolver'\nimport { SimpleStoreMemory } from '@atproto-labs/simple-store-memory'\nimport { Key, Keyset } from '@atproto/jwk'\nimport {\n  OAuthAuthorizationRequestParameters,\n  OAuthClientIdDiscoverable,\n  OAuthClientMetadata,\n  OAuthClientMetadataInput,\n  oauthClientMetadataSchema,\n  OAuthResponseMode,\n} from '@atproto/oauth-types'\n\nimport { FALLBACK_ALG } from './constants.js'\nimport { TokenRevokedError } from './errors/token-revoked-error.js'\nimport {\n  AuthorizationServerMetadataCache,\n  OAuthAuthorizationServerMetadataResolver,\n} from './oauth-authorization-server-metadata-resolver.js'\nimport { OAuthCallbackError } from './oauth-callback-error.js'\nimport {\n  OAuthProtectedResourceMetadataResolver,\n  ProtectedResourceMetadataCache,\n} from './oauth-protected-resource-metadata-resolver.js'\nimport { OAuthResolver } from './oauth-resolver.js'\nimport { DpopNonceCache, OAuthServerAgent } from './oauth-server-agent.js'\nimport { OAuthServerFactory } from './oauth-server-factory.js'\nimport { OAuthSession } from './oauth-session.js'\nimport { RuntimeImplementation } from './runtime-implementation.js'\nimport { Runtime } from './runtime.js'\nimport {\n  SessionEventMap,\n  SessionGetter,\n  SessionStore,\n} from './session-getter.js'\nimport { InternalStateData, StateStore } from './state-store.js'\nimport { AuthorizeOptions, ClientMetadata } from './types.js'\nimport { CustomEventTarget } from './util.js'\nimport { validateClientMetadata } from './validate-client-metadata.js'\n\n// Export all types needed to construct OAuthClientOptions\nexport type {\n  AuthorizationServerMetadataCache,\n  DidCache,\n  DpopNonceCache,\n  Fetch,\n  HandleCache,\n  HandleResolver,\n  InternalStateData,\n  Key,\n  Keyset,\n  OAuthClientMetadata,\n  OAuthClientMetadataInput,\n  OAuthResponseMode,\n  ProtectedResourceMetadataCache,\n  RuntimeImplementation,\n  SessionStore,\n  StateStore,\n}\n\nexport type OAuthClientOptions = {\n  // Config\n  responseMode: OAuthResponseMode\n  clientMetadata: Readonly<OAuthClientMetadataInput>\n  keyset?: Keyset | Iterable<Key | undefined | null | false>\n  /**\n   * Determines if the client will allow communicating with the OAuth Servers\n   * (Authorization & Resource), or to retrieve \"did:web\" documents, over\n   * unsafe HTTP connections. It is recommended to set this to `true` only for\n   * development purposes.\n   *\n   * @note This does not affect the identity resolution mechanism, which will\n   * allow HTTP connections to the PLC Directory (if the provided directory url\n   * is \"http:\" based).\n   * @default false\n   * @see {@link OAuthProtectedResourceMetadataResolver.allowHttpResource}\n   * @see {@link OAuthAuthorizationServerMetadataResolver.allowHttpIssuer}\n   * @see {@link DidResolverCommonOptions.allowHttp}\n   */\n  allowHttp?: boolean\n\n  // Stores\n  stateStore: StateStore\n  sessionStore: SessionStore\n  didCache?: DidCache\n  handleCache?: HandleCache\n  authorizationServerMetadataCache?: AuthorizationServerMetadataCache\n  protectedResourceMetadataCache?: ProtectedResourceMetadataCache\n  dpopNonceCache?: DpopNonceCache\n\n  // Services\n  handleResolver: HandleResolver | URL | string\n  plcDirectoryUrl?: URL | string\n  runtimeImplementation: RuntimeImplementation\n  fetch?: Fetch\n}\n\nexport type OAuthClientEventMap = SessionEventMap\n\nexport type OAuthClientFetchMetadataOptions = {\n  clientId: OAuthClientIdDiscoverable\n  fetch?: Fetch\n  signal?: AbortSignal\n}\n\nexport class OAuthClient extends CustomEventTarget<OAuthClientEventMap> {\n  static async fetchMetadata({\n    clientId,\n    fetch = globalThis.fetch,\n    signal,\n  }: OAuthClientFetchMetadataOptions) {\n    signal?.throwIfAborted()\n\n    const request = new Request(clientId, {\n      redirect: 'error',\n      signal: signal,\n    })\n    const response = await fetch(request)\n\n    if (response.status !== 200) {\n      response.body?.cancel?.()\n      throw new TypeError(`Failed to fetch client metadata: ${response.status}`)\n    }\n\n    // https://drafts.aaronpk.com/draft-parecki-oauth-client-id-metadata-document/draft-parecki-oauth-client-id-metadata-document.html#section-4.1\n    const mime = response.headers.get('content-type')?.split(';')[0].trim()\n    if (mime !== 'application/json') {\n      response.body?.cancel?.()\n      throw new TypeError(`Invalid client metadata content type: ${mime}`)\n    }\n\n    const json: unknown = await response.json()\n\n    signal?.throwIfAborted()\n\n    return oauthClientMetadataSchema.parse(json)\n  }\n\n  // Config\n  readonly clientMetadata: ClientMetadata\n  readonly responseMode: OAuthResponseMode\n  readonly keyset?: Keyset\n\n  // Services\n  readonly runtime: Runtime\n  readonly fetch: Fetch\n  readonly oauthResolver: OAuthResolver\n  readonly serverFactory: OAuthServerFactory\n\n  // Stores\n  protected readonly sessionGetter: SessionGetter\n  protected readonly stateStore: StateStore\n\n  constructor({\n    fetch = globalThis.fetch,\n    allowHttp = false,\n\n    stateStore,\n    sessionStore,\n\n    didCache = undefined,\n    dpopNonceCache = new SimpleStoreMemory({ ttl: 60e3, max: 100 }),\n    handleCache = undefined,\n    authorizationServerMetadataCache = new SimpleStoreMemory({\n      ttl: 60e3,\n      max: 100,\n    }),\n    protectedResourceMetadataCache = new SimpleStoreMemory({\n      ttl: 60e3,\n      max: 100,\n    }),\n\n    responseMode,\n    clientMetadata,\n    handleResolver,\n    plcDirectoryUrl,\n    runtimeImplementation,\n    keyset,\n  }: OAuthClientOptions) {\n    super()\n\n    this.keyset = keyset\n      ? keyset instanceof Keyset\n        ? keyset\n        : new Keyset(keyset)\n      : undefined\n    this.clientMetadata = validateClientMetadata(clientMetadata, this.keyset)\n    this.responseMode = responseMode\n\n    this.runtime = new Runtime(runtimeImplementation)\n    this.fetch = fetch\n    this.oauthResolver = new OAuthResolver(\n      new IdentityResolver(\n        new DidResolverCached(\n          new DidResolverCommon({ fetch, plcDirectoryUrl, allowHttp }),\n          didCache,\n        ),\n        new CachedHandleResolver(\n          AppViewHandleResolver.from(handleResolver, { fetch }),\n          handleCache,\n        ),\n      ),\n      new OAuthProtectedResourceMetadataResolver(\n        protectedResourceMetadataCache,\n        fetch,\n        { allowHttpResource: allowHttp },\n      ),\n      new OAuthAuthorizationServerMetadataResolver(\n        authorizationServerMetadataCache,\n        fetch,\n        { allowHttpIssuer: allowHttp },\n      ),\n    )\n    this.serverFactory = new OAuthServerFactory(\n      this.clientMetadata,\n      this.runtime,\n      this.oauthResolver,\n      this.fetch,\n      this.keyset,\n      dpopNonceCache,\n    )\n\n    this.sessionGetter = new SessionGetter(\n      sessionStore,\n      this.serverFactory,\n      this.runtime,\n    )\n    this.stateStore = stateStore\n\n    // Proxy sessionGetter events\n    for (const type of ['deleted', 'updated'] as const) {\n      this.sessionGetter.addEventListener(type, (event) => {\n        if (!this.dispatchCustomEvent(type, event.detail)) {\n          event.preventDefault()\n        }\n      })\n    }\n  }\n\n  // Exposed as public API for convenience\n  get identityResolver() {\n    return this.oauthResolver.identityResolver\n  }\n\n  // Exposed as public API for convenience\n  get didResolver() {\n    return this.identityResolver.didResolver\n  }\n\n  // Exposed as public API for convenience\n  get handleResolver() {\n    return this.identityResolver.handleResolver\n  }\n\n  get jwks() {\n    return this.keyset?.publicJwks ?? ({ keys: [] as const } as const)\n  }\n\n  async authorize(\n    input: string,\n    { signal, ...options }: AuthorizeOptions = {},\n  ): Promise<URL> {\n    const redirectUri =\n      options?.redirect_uri ?? this.clientMetadata.redirect_uris[0]\n    if (!this.clientMetadata.redirect_uris.includes(redirectUri)) {\n      // The server will enforce this, but let's catch it early\n      throw new TypeError('Invalid redirect_uri')\n    }\n\n    const { identity, metadata } = await this.oauthResolver.resolve(input, {\n      signal,\n    })\n\n    const pkce = await this.runtime.generatePKCE()\n    const dpopKey = await this.runtime.generateKey(\n      metadata.dpop_signing_alg_values_supported || [FALLBACK_ALG],\n    )\n\n    const state = await this.runtime.generateNonce()\n\n    await this.stateStore.set(state, {\n      iss: metadata.issuer,\n      dpopKey,\n      verifier: pkce.verifier,\n      appState: options?.state,\n    })\n\n    const parameters: OAuthAuthorizationRequestParameters = {\n      ...options,\n\n      client_id: this.clientMetadata.client_id,\n      redirect_uri: redirectUri,\n      code_challenge: pkce.challenge,\n      code_challenge_method: pkce.method,\n      state,\n      login_hint: identity\n        ? input // If input is a handle or a DID, use it as a login_hint\n        : undefined,\n      response_mode: this.responseMode,\n      response_type: 'code' as const,\n      scope: options?.scope ?? this.clientMetadata.scope,\n    }\n\n    const authorizationUrl = new URL(metadata.authorization_endpoint)\n\n    // Since the user will be redirected to the authorization_endpoint url using\n    // a browser, we need to make sure that the url is valid.\n    if (\n      authorizationUrl.protocol !== 'https:' &&\n      authorizationUrl.protocol !== 'http:'\n    ) {\n      throw new TypeError(\n        `Invalid authorization endpoint protocol: ${authorizationUrl.protocol}`,\n      )\n    }\n\n    if (metadata.pushed_authorization_request_endpoint) {\n      const server = await this.serverFactory.fromMetadata(metadata, dpopKey)\n      const parResponse = await server.request(\n        'pushed_authorization_request',\n        parameters,\n      )\n\n      authorizationUrl.searchParams.set(\n        'client_id',\n        this.clientMetadata.client_id,\n      )\n      authorizationUrl.searchParams.set('request_uri', parResponse.request_uri)\n      return authorizationUrl\n    } else if (metadata.require_pushed_authorization_requests) {\n      throw new Error(\n        'Server requires pushed authorization requests (PAR) but no PAR endpoint is available',\n      )\n    } else {\n      for (const [key, value] of Object.entries(parameters)) {\n        if (value) authorizationUrl.searchParams.set(key, String(value))\n      }\n\n      // Length of the URL that will be sent to the server\n      const urlLength =\n        authorizationUrl.pathname.length + authorizationUrl.search.length\n      if (urlLength < 2048) {\n        return authorizationUrl\n      } else if (!metadata.pushed_authorization_request_endpoint) {\n        throw new Error('Login URL too long')\n      }\n    }\n\n    throw new Error(\n      'Server does not support pushed authorization requests (PAR)',\n    )\n  }\n\n  /**\n   * This method allows the client to proactively revoke the request_uri it\n   * created through PAR.\n   */\n  async abortRequest(authorizeUrl: URL) {\n    const requestUri = authorizeUrl.searchParams.get('request_uri')\n    if (!requestUri) return\n\n    // @NOTE This is not implemented here because, 1) the request server should\n    // invalidate the request_uri after some delay anyways, and 2) I am not sure\n    // that the revocation endpoint is even supposed to support this (and I\n    // don't want to spend the time checking now).\n\n    // @TODO investigate actual necessity & feasibility of this feature\n  }\n\n  async callback(params: URLSearchParams): Promise<{\n    session: OAuthSession\n    state: string | null\n  }> {\n    const responseJwt = params.get('response')\n    if (responseJwt != null) {\n      // https://openid.net/specs/oauth-v2-jarm.html\n      throw new OAuthCallbackError(params, 'JARM not supported')\n    }\n\n    const issuerParam = params.get('iss')\n    const stateParam = params.get('state')\n    const errorParam = params.get('error')\n    const codeParam = params.get('code')\n\n    if (!stateParam) {\n      throw new OAuthCallbackError(params, 'Missing \"state\" parameter')\n    }\n    const stateData = await this.stateStore.get(stateParam)\n    if (stateData) {\n      // Prevent any kind of replay\n      await this.stateStore.del(stateParam)\n    } else {\n      throw new OAuthCallbackError(\n        params,\n        `Unknown authorization session \"${stateParam}\"`,\n      )\n    }\n\n    try {\n      if (errorParam != null) {\n        throw new OAuthCallbackError(params, undefined, stateData.appState)\n      }\n\n      if (!codeParam) {\n        throw new OAuthCallbackError(\n          params,\n          'Missing \"code\" query param',\n          stateData.appState,\n        )\n      }\n\n      const server = await this.serverFactory.fromIssuer(\n        stateData.iss,\n        stateData.dpopKey,\n      )\n\n      if (issuerParam != null) {\n        if (!server.issuer) {\n          throw new OAuthCallbackError(\n            params,\n            'Issuer not found in metadata',\n            stateData.appState,\n          )\n        }\n        if (server.issuer !== issuerParam) {\n          throw new OAuthCallbackError(\n            params,\n            'Issuer mismatch',\n            stateData.appState,\n          )\n        }\n      } else if (\n        server.serverMetadata.authorization_response_iss_parameter_supported\n      ) {\n        throw new OAuthCallbackError(\n          params,\n          'iss missing from the response',\n          stateData.appState,\n        )\n      }\n\n      const tokenSet = await server.exchangeCode(codeParam, stateData.verifier)\n      try {\n        await this.sessionGetter.setStored(tokenSet.sub, {\n          dpopKey: stateData.dpopKey,\n          tokenSet,\n        })\n\n        const session = this.createSession(server, tokenSet.sub)\n\n        return { session, state: stateData.appState ?? null }\n      } catch (err) {\n        await server.revoke(tokenSet.refresh_token || tokenSet.access_token)\n\n        throw err\n      }\n    } catch (err) {\n      // Make sure, whatever the underlying error, that the appState is\n      // available in the calling code\n      throw OAuthCallbackError.from(err, params, stateData.appState)\n    }\n  }\n\n  /**\n   * Load a stored session. This will refresh the token only if needed (about to\n   * expire) by default.\n   *\n   * @param refresh See {@link SessionGetter.getSession}\n   */\n  async restore(\n    sub: string,\n    refresh: boolean | 'auto' = 'auto',\n  ): Promise<OAuthSession> {\n    // sub arg is lightly typed for convenience of library user\n    assertAtprotoDid(sub)\n\n    const { dpopKey, tokenSet } = await this.sessionGetter.get(sub, {\n      noCache: refresh === true,\n      allowStale: refresh === false,\n    })\n\n    const server = await this.serverFactory.fromIssuer(tokenSet.iss, dpopKey, {\n      noCache: refresh === true,\n      allowStale: refresh === false,\n    })\n\n    return this.createSession(server, sub)\n  }\n\n  async revoke(sub: string) {\n    // sub arg is lightly typed for convenience of library user\n    assertAtprotoDid(sub)\n\n    const { dpopKey, tokenSet } = await this.sessionGetter.get(sub, {\n      allowStale: true,\n    })\n\n    // NOT using `;(await this.restore(sub, false)).signOut()` because we want\n    // the tokens to be deleted even if it was not possible to fetch the issuer\n    // data.\n    try {\n      const server = await this.serverFactory.fromIssuer(tokenSet.iss, dpopKey)\n      await server.revoke(tokenSet.access_token)\n    } finally {\n      await this.sessionGetter.delStored(sub, new TokenRevokedError(sub))\n    }\n  }\n\n  protected createSession(\n    server: OAuthServerAgent,\n    sub: AtprotoDid,\n  ): OAuthSession {\n    return new OAuthSession(server, sub, this.sessionGetter, this.fetch)\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 18587, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18592, "column": 0}, "map": {"version":3,"file":"runtime-implementation.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/runtime-implementation.ts"],"sourcesContent":["import { Key } from '@atproto/jwk'\nimport { Awaitable } from './util.js'\n\nexport type { Key }\nexport type RuntimeKeyFactory = (algs: string[]) => Key | PromiseLike<Key>\n\nexport type RuntimeRandomValues = (length: number) => Awaitable<Uint8Array>\n\nexport type DigestAlgorithm = { name: 'sha256' | 'sha384' | 'sha512' }\nexport type RuntimeDigest = (\n  data: Uint8Array,\n  alg: DigestAlgorithm,\n) => Awaitable<Uint8Array>\n\nexport type RuntimeLock = <T>(\n  name: string,\n  fn: () => Awaitable<T>,\n) => Awaitable<T>\n\nexport interface RuntimeImplementation {\n  createKey: RuntimeKeyFactory\n  getRandomValues: RuntimeRandomValues\n  digest: RuntimeDigest\n  requestLock?: RuntimeLock\n}\n"],"names":[],"mappings":"","ignoreList":[0]}},
    {"offset": {"line": 18596, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18601, "column": 0}, "map": {"version":3,"file":"state-store.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/state-store.ts"],"sourcesContent":["import { SimpleStore } from '@atproto-labs/simple-store'\nimport { Key } from '@atproto/jwk'\n\nexport type InternalStateData = {\n  iss: string\n  dpopKey: Key\n  verifier?: string\n  appState?: string\n}\n\nexport type StateStore = SimpleStore<string, InternalStateData>\n"],"names":[],"mappings":"","ignoreList":[0]}},
    {"offset": {"line": 18605, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18610, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto/oauth-client/src/index.ts"],"sourcesContent":["export * from '@atproto-labs/did-resolver'\nexport {\n  FetchError,\n  FetchRequestError,\n  FetchResponseError,\n} from '@atproto-labs/fetch'\nexport * from '@atproto-labs/handle-resolver'\n\nexport * from '@atproto/did'\nexport * from '@atproto/oauth-types'\n\nexport * from './oauth-authorization-server-metadata-resolver.js'\nexport * from './oauth-callback-error.js'\nexport * from './oauth-client.js'\nexport * from './oauth-protected-resource-metadata-resolver.js'\nexport * from './oauth-resolver-error.js'\nexport * from './oauth-response-error.js'\nexport * from './oauth-server-agent.js'\nexport * from './oauth-server-factory.js'\nexport * from './oauth-session.js'\nexport * from './runtime-implementation.js'\nexport * from './session-getter.js'\nexport * from './state-store.js'\nexport * from './types.js'\n\nexport * from './errors/token-invalid-error.js'\nexport * from './errors/token-refresh-error.js'\nexport * from './errors/token-revoked-error.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,iIAAA,SAA0C;AAC1C,IAAA,yCAI4B;AAH1B,OAAA,cAAA,CAAA,SAAA,cAAA;IAAA,YAAA;IAAA,KAAA;QAAA,OAAA,QAAA,UAAU;IAAA;AAAA,GAAA;AACV,OAAA,cAAA,CAAA,SAAA,qBAAA;IAAA,YAAA;IAAA,KAAA;QAAA,OAAA,QAAA,iBAAiB;IAAA;AAAA,GAAA;AACjB,OAAA,cAAA,CAAA,SAAA,sBAAA;IAAA,YAAA;IAAA,KAAA;QAAA,OAAA,QAAA,kBAAkB;IAAA;AAAA,GAAA;AAEpB,oIAAA,SAA6C;AAE7C,mHAAA,SAA4B;AAC5B,2HAAA,SAAoC;AAEpC,mKAAA,SAAiE;AACjE,2IAAA,SAAyC;AACzC,mIAAA,SAAiC;AACjC,iKAAA,SAA+D;AAC/D,2IAAA,SAAyC;AACzC,2IAAA,SAAyC;AACzC,yIAAA,SAAuC;AACvC,2IAAA,SAAyC;AACzC,oIAAA,SAAkC;AAClC,6IAAA,SAA2C;AAC3C,qIAAA,SAAmC;AACnC,kIAAA,SAAgC;AAChC,4HAAA,SAA0B;AAE1B,iJAAA,SAA+C;AAC/C,iJAAA,SAA+C;AAC/C,iJAAA,SAA+C","ignoreList":[0]}},
    {"offset": {"line": 18673, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18678, "column": 0}, "map": {"version":3,"file":"identity-resolver.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/identity-resolver/src/identity-resolver.ts"],"sourcesContent":["import {\n  Did,\n  DidDocument,\n  DidResolver,\n  DidService,\n  ResolveDidOptions,\n} from '@atproto-labs/did-resolver'\nimport {\n  AtprotoIdentityDidMethods,\n  HandleResolver,\n  isResolvedHandle,\n  ResolvedHandle,\n  ResolveHandleOptions,\n} from '@atproto-labs/handle-resolver'\nimport { normalizeAndEnsureValidHandle } from '@atproto/syntax'\n\nexport type ResolvedIdentity = {\n  did: NonNullable<ResolvedHandle>\n  pds: URL\n}\n\nexport type ResolveIdentityOptions = ResolveDidOptions & ResolveHandleOptions\n\nexport class IdentityResolver {\n  constructor(\n    readonly didResolver: DidResolver<AtprotoIdentityDidMethods>,\n    readonly handleResolver: HandleResolver,\n  ) {}\n\n  public async resolve(\n    input: string,\n    options?: ResolveIdentityOptions,\n  ): Promise<ResolvedIdentity> {\n    const document = isResolvedHandle(input)\n      ? await this.getDocumentFromDid(input, options)\n      : await this.getDocumentFromHandle(input, options)\n\n    const service = document.service?.find(\n      isAtprotoPersonalDataServerService<AtprotoIdentityDidMethods>,\n      document,\n    )\n\n    if (!service) {\n      throw new TypeError(\n        `No valid \"AtprotoPersonalDataServer\" service found in \"${document.id}\" DID document`,\n      )\n    }\n\n    return {\n      did: document.id,\n      pds: new URL(service.serviceEndpoint),\n    }\n  }\n\n  public async getDocumentFromDid(\n    did: NonNullable<ResolvedHandle>,\n    options?: ResolveDidOptions,\n  ): Promise<DidDocument<AtprotoIdentityDidMethods>> {\n    return this.didResolver.resolve(did, options)\n  }\n\n  public async getDocumentFromHandle(\n    input: string,\n    options?: ResolveHandleOptions,\n  ): Promise<DidDocument<AtprotoIdentityDidMethods>> {\n    const handle = normalizeAndEnsureValidHandle(input)\n\n    const did = await this.handleResolver.resolve(handle, options)\n\n    if (!did) {\n      throw new TypeError(`Handle \"${handle}\" does not resolve to a DID`)\n    }\n\n    options?.signal?.throwIfAborted()\n\n    // Note: Not using \"return this.resolveDid(did, options)\" to make the extra\n    // check for the handle in the DID document:\n\n    const document = await this.didResolver.resolve(did, options)\n\n    // Ensure that the handle is included in the document\n    if (!document.alsoKnownAs?.includes(`at://${handle}`)) {\n      throw new TypeError(\n        `Did document for \"${did}\" does not include the handle \"${handle}\"`,\n      )\n    }\n\n    return document\n  }\n}\n\nfunction isAtprotoPersonalDataServerService<M extends string>(\n  this: DidDocument<M>,\n  s: DidService,\n): s is {\n  id: '#atproto_pds' | `${Did<M>}#atproto_pds`\n  type: 'AtprotoPersonalDataServer'\n  serviceEndpoint: string\n} {\n  return (\n    typeof s.serviceEndpoint === 'string' &&\n    s.type === 'AtprotoPersonalDataServer' &&\n    (s.id.startsWith('#')\n      ? s.id === '#atproto_pds'\n      : s.id === `${this.id}#atproto_pds`)\n  )\n}\n"],"names":[],"mappings":";;;;;AAOA,MAAA,6DAMsC;AACtC,MAAA,sCAA+D;AAS/D,MAAa,gBAAgB;IAC3B,YACW,WAAmD,EACnD,cAA8B,CAAA;QADvC,OAAA,cAAA,CAAA,IAAA,EAAA,eAAA;;;;mBAAS,WAAW;WAAwC;QAC5D,OAAA,cAAA,CAAA,IAAA,EAAA,kBAAA;;;;mBAAS,cAAc;WAAgB;IACtC,CAAC;IAEG,KAAK,CAAC,OAAO,CAClB,KAAa,EACb,OAAgC,EAAA;QAEhC,MAAM,QAAQ,GAAG,CAAA,GAAA,kBAAA,gBAAgB,EAAC,KAAK,CAAC,GACpC,MAAM,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,OAAO,CAAC,GAC7C,MAAM,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAA;QAEpD,MAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,EAAE,IAAI,CACpC,kCAA6D,CAAA,CAC7D,QAAQ,CACT,CAAA;QAED,IAAI,CAAC,OAAO,EAAE,CAAC;YACb,MAAM,IAAI,SAAS,CACjB,CAAA,uDAAA,EAA0D,QAAQ,CAAC,EAAE,CAAA,cAAA,CAAgB,CACtF,CAAA;QACH,CAAC;QAED,OAAO;YACL,GAAG,EAAE,QAAQ,CAAC,EAAE;YAChB,GAAG,EAAE,IAAI,GAAG,CAAC,OAAO,CAAC,eAAe,CAAC;SACtC,CAAA;IACH,CAAC;IAEM,KAAK,CAAC,kBAAkB,CAC7B,GAAgC,EAChC,OAA2B,EAAA;QAE3B,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC,CAAA;IAC/C,CAAC;IAEM,KAAK,CAAC,qBAAqB,CAChC,KAAa,EACb,OAA8B,EAAA;QAE9B,MAAM,MAAM,GAAG,CAAA,GAAA,SAAA,6BAA6B,EAAC,KAAK,CAAC,CAAA;QAEnD,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,CAAA;QAE9D,IAAI,CAAC,GAAG,EAAE,CAAC;YACT,MAAM,IAAI,SAAS,CAAC,CAAA,QAAA,EAAW,MAAM,CAAA,2BAAA,CAA6B,CAAC,CAAA;QACrE,CAAC;QAED,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QAEjC,2EAA2E;QAC3E,4CAA4C;QAE5C,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC,CAAA;QAE7D,qDAAqD;QACrD,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAA,KAAA,EAAQ,MAAM,EAAE,CAAC,EAAE,CAAC;YACtD,MAAM,IAAI,SAAS,CACjB,CAAA,kBAAA,EAAqB,GAAG,CAAA,+BAAA,EAAkC,MAAM,CAAA,CAAA,CAAG,CACpE,CAAA;QACH,CAAC;QAED,OAAO,QAAQ,CAAA;IACjB,CAAC;CACF;AAlED,QAAA,gBAAA,GAAA,iBAkEC;AAED,SAAS,kCAAkC,CAEzC,CAAa;IAMb,OAAO,AACL,OAAO,CAAC,CAAC,eAAe,KAAK,QAAQ,IACrC,CAAC,CAAC,IAAI,KAAK,2BAA2B,IACtC,CAAC,CAAC,CAAC,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,GACjB,CAAC,CAAC,EAAE,KAAK,cAAc,GACvB,CAAC,CAAC,EAAE,KAAK,GAAG,IAAI,CAAC,EAAE,CAAA,YAAA,CAAc,CAAC,CACvC,CAAA;AACH,CAAC","ignoreList":[0]}},
    {"offset": {"line": 18735, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18740, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atproto-labs/identity-resolver/src/index.ts"],"sourcesContent":["export * from './identity-resolver.js'\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,kJAAA,SAAsC","ignoreList":[0]}},
    {"offset": {"line": 18764, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18769, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/ws/browser.js"],"sourcesContent":["'use strict';\n\nmodule.exports = function () {\n  throw new Error(\n    'ws does not work in the browser. Browser clients must use the native ' +\n      'WebSocket object'\n  );\n};\n"],"names":[],"mappings":"AAAA;AAEA,OAAO,OAAO,GAAG;IACf,MAAM,IAAI,MACR,0EACE;AAEN","ignoreList":[0]}},
    {"offset": {"line": 18773, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18779, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/uint8array/lib/index.ts"],"sourcesContent":["const textEncoder = new TextEncoder();\nconst textDecoder = new TextDecoder();\n\nconst subtle = crypto.subtle;\n\n/**\n * creates an Uint8Array of the requested size, with the contents zeroed\n */\nexport const alloc = (size: number): Uint8Array => {\n\treturn new Uint8Array(size);\n};\n\n/**\n * creates an Uint8Array of the requested size, where the contents may not be\n * zeroed out. only use if you're certain that the contents will be overwritten\n */\nexport const allocUnsafe = alloc;\n\n/**\n * compares two Uint8Array buffers\n */\nexport const compare = (a: Uint8Array, b: Uint8Array): number => {\n\tconst alen = a.length;\n\tconst blen = b.length;\n\n\tif (alen > blen) {\n\t\treturn 1;\n\t}\n\tif (alen < blen) {\n\t\treturn -1;\n\t}\n\n\tfor (let i = 0; i < alen; i++) {\n\t\tconst ax = a[i];\n\t\tconst bx = b[i];\n\n\t\tif (ax < bx) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (ax > bx) {\n\t\t\treturn 1;\n\t\t}\n\t}\n\n\treturn 0;\n};\n\n/**\n * checks if the two Uint8Array buffers are equal\n */\nexport const equals = (a: Uint8Array, b: Uint8Array): boolean => {\n\tif (a === b) {\n\t\treturn true;\n\t}\n\n\tlet len: number;\n\tif ((len = a.length) === b.length) {\n\t\twhile (len--) {\n\t\t\tif (a[len] !== b[len]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn len === -1;\n};\n\n/**\n * checks if the two Uint8Array buffers are equal, timing-safe version\n */\nexport const timingSafeEquals = (a: Uint8Array, b: Uint8Array): boolean => {\n\tlet len: number;\n\tlet out = 0;\n\tif ((len = a.length) === b.length) {\n\t\twhile (len--) {\n\t\t\tout |= a[len] ^ b[len];\n\t\t}\n\t}\n\n\treturn len === -1 && out === 0;\n};\n\n/**\n * concatenates multiple Uint8Array buffers into one\n */\nexport const concat = (arrays: Uint8Array[], size?: number): Uint8Array => {\n\tlet written = 0;\n\n\tlet len = arrays.length;\n\tlet idx: number;\n\n\tif (size === undefined) {\n\t\tfor (idx = size = 0; idx < len; idx++) {\n\t\t\tconst chunk = arrays[idx];\n\t\t\tsize += chunk.length;\n\t\t}\n\t}\n\n\tconst buffer = new Uint8Array(size);\n\n\tfor (idx = 0; idx < len; idx++) {\n\t\tconst chunk = arrays[idx];\n\n\t\tbuffer.set(chunk, written);\n\t\twritten += chunk.length;\n\t}\n\n\treturn buffer;\n};\n\n/**\n * encodes a UTF-8 string into the buffer\n */\nexport const encodeUtf8Into = (to: Uint8Array, str: string, offset?: number, length?: number): number => {\n\tlet buffer: Uint8Array;\n\n\tif (offset === undefined) {\n\t\tbuffer = to;\n\t} else if (length === undefined) {\n\t\tbuffer = to.subarray(offset);\n\t} else {\n\t\tbuffer = to.subarray(offset, offset + length);\n\t}\n\n\tconst result = textEncoder.encodeInto(str, buffer);\n\n\treturn result.written;\n};\n\n/**\n * decodes a UTF-8 string from a buffer\n */\nexport const decodeUtf8From = (from: Uint8Array, offset?: number, length?: number): string => {\n\tlet buffer: Uint8Array;\n\n\tif (offset === undefined) {\n\t\tbuffer = from;\n\t} else if (length === undefined) {\n\t\tbuffer = from.subarray(offset);\n\t} else {\n\t\tbuffer = from.subarray(offset, offset + length);\n\t}\n\n\tconst result = textDecoder.decode(buffer);\n\n\treturn result;\n};\n\n/**\n * get a SHA-256 digest of this buffer\n */\nexport const toSha256 = async (buffer: Uint8Array): Promise<Uint8Array> => {\n\treturn new Uint8Array(await subtle.digest('SHA-256', buffer));\n};\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 18887, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 18893, "column": 0}, "map": {"version":3,"file":"utils.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/multibase/lib/utils.ts"],"sourcesContent":["import { alloc, allocUnsafe } from '@atcute/uint8array';\n\nexport const createRfc4648Encode = (alphabet: string, bitsPerChar: number, pad: boolean) => {\n\treturn (bytes: Uint8Array): string => {\n\t\tconst mask = (1 << bitsPerChar) - 1;\n\t\tlet str = '';\n\n\t\tlet bits = 0; // Number of bits currently in the buffer\n\t\tlet buffer = 0; // Bits waiting to be written out, MSB first\n\t\tfor (let i = 0; i < bytes.length; ++i) {\n\t\t\t// Slurp data into the buffer:\n\t\t\tbuffer = (buffer << 8) | bytes[i];\n\t\t\tbits += 8;\n\n\t\t\t// Write out as much as we can:\n\t\t\twhile (bits > bitsPerChar) {\n\t\t\t\tbits -= bitsPerChar;\n\t\t\t\tstr += alphabet[mask & (buffer >> bits)];\n\t\t\t}\n\t\t}\n\n\t\t// Partial character:\n\t\tif (bits !== 0) {\n\t\t\tstr += alphabet[mask & (buffer << (bitsPerChar - bits))];\n\t\t}\n\n\t\t// Add padding characters until we hit a byte boundary:\n\t\tif (pad) {\n\t\t\twhile (((str.length * bitsPerChar) & 7) !== 0) {\n\t\t\t\tstr += '=';\n\t\t\t}\n\t\t}\n\n\t\treturn str;\n\t};\n};\n\nexport const createRfc4648Decode = (alphabet: string, bitsPerChar: number, pad: boolean) => {\n\t// Build the character lookup table:\n\tconst codes: Record<string, number> = {};\n\tfor (let i = 0; i < alphabet.length; ++i) {\n\t\tcodes[alphabet[i]] = i;\n\t}\n\n\treturn (str: string) => {\n\t\t// Count the padding bytes:\n\t\tlet end = str.length;\n\t\twhile (pad && str[end - 1] === '=') {\n\t\t\t--end;\n\t\t}\n\n\t\t// Allocate the output:\n\t\tconst bytes = allocUnsafe(((end * bitsPerChar) / 8) | 0);\n\n\t\t// Parse the data:\n\t\tlet bits = 0; // Number of bits currently in the buffer\n\t\tlet buffer = 0; // Bits waiting to be written out, MSB first\n\t\tlet written = 0; // Next byte to write\n\t\tfor (let i = 0; i < end; ++i) {\n\t\t\t// Read one character from the string:\n\t\t\tconst value = codes[str[i]];\n\t\t\tif (value === undefined) {\n\t\t\t\tthrow new SyntaxError(`invalid base string`);\n\t\t\t}\n\n\t\t\t// Append the bits to the buffer:\n\t\t\tbuffer = (buffer << bitsPerChar) | value;\n\t\t\tbits += bitsPerChar;\n\n\t\t\t// Write out some bits if the buffer has a byte's worth:\n\t\t\tif (bits >= 8) {\n\t\t\t\tbits -= 8;\n\t\t\t\tbytes[written++] = 0xff & (buffer >> bits);\n\t\t\t}\n\t\t}\n\n\t\t// Verify that we have received just enough bits:\n\t\tif (bits >= bitsPerChar || (0xff & (buffer << (8 - bits))) !== 0) {\n\t\t\tthrow new SyntaxError('unexpected end of data');\n\t\t}\n\n\t\treturn bytes;\n\t};\n};\n\nexport const createBtcBaseEncode = (alphabet: string) => {\n\tif (alphabet.length >= 255) {\n\t\tthrow new RangeError(`alphabet too long`);\n\t}\n\n\tconst BASE = alphabet.length;\n\tconst LEADER = alphabet.charAt(0);\n\tconst iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n\n\treturn (source: Uint8Array): string => {\n\t\tif (source.length === 0) {\n\t\t\treturn '';\n\t\t}\n\n\t\t// Skip & count leading zeroes.\n\t\tlet zeroes = 0;\n\t\tlet length = 0;\n\t\tlet pbegin = 0;\n\t\tconst pend = source.length;\n\t\twhile (pbegin !== pend && source[pbegin] === 0) {\n\t\t\tpbegin++;\n\t\t\tzeroes++;\n\t\t}\n\n\t\t// Allocate enough space in big-endian base58 representation.\n\t\tconst size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n\t\tconst b58 = alloc(size);\n\n\t\t// Process the bytes.\n\t\twhile (pbegin !== pend) {\n\t\t\tlet carry = source[pbegin];\n\n\t\t\t// Apply \"b58 = b58 * 256 + ch\".\n\t\t\tlet i = 0;\n\t\t\tfor (let it1 = size - 1; (carry !== 0 || i < length) && it1 !== -1; it1--, i++) {\n\t\t\t\tcarry += (256 * b58[it1]) >>> 0;\n\t\t\t\tb58[it1] = carry % BASE >>> 0;\n\t\t\t\tcarry = (carry / BASE) >>> 0;\n\t\t\t}\n\n\t\t\tif (carry !== 0) {\n\t\t\t\tthrow new Error('non-zero carry');\n\t\t\t}\n\n\t\t\tlength = i;\n\t\t\tpbegin++;\n\t\t}\n\n\t\t// Skip leading zeroes in base58 result.\n\t\tlet it2 = size - length;\n\t\twhile (it2 !== size && b58[it2] === 0) {\n\t\t\tit2++;\n\t\t}\n\n\t\t// Translate the result into a string.\n\t\tlet str = LEADER.repeat(zeroes);\n\t\tfor (; it2 < size; ++it2) {\n\t\t\tstr += alphabet.charAt(b58[it2]);\n\t\t}\n\n\t\treturn str;\n\t};\n};\n\nexport const createBtcBaseDecode = (alphabet: string) => {\n\tif (alphabet.length >= 255) {\n\t\tthrow new RangeError(`alphabet too long`);\n\t}\n\n\tconst BASE_MAP = allocUnsafe(256).fill(255);\n\tfor (let i = 0; i < alphabet.length; i++) {\n\t\tconst xc = alphabet.charCodeAt(i);\n\n\t\tif (BASE_MAP[xc] !== 255) {\n\t\t\tthrow new RangeError(`${alphabet[i]} is ambiguous`);\n\t\t}\n\n\t\tBASE_MAP[xc] = i;\n\t}\n\n\tconst BASE = alphabet.length;\n\tconst LEADER = alphabet.charAt(0);\n\tconst FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n\n\treturn (source: string): Uint8Array => {\n\t\tif (source.length === 0) {\n\t\t\treturn allocUnsafe(0);\n\t\t}\n\n\t\t// Skip and count leading '1's.\n\t\tlet psz = 0;\n\t\tlet zeroes = 0;\n\t\tlet length = 0;\n\n\t\twhile (source[psz] === LEADER) {\n\t\t\tzeroes++;\n\t\t\tpsz++;\n\t\t}\n\n\t\t// Allocate enough space in big-endian base256 representation.\n\t\tconst size = ((source.length - psz) * FACTOR + 1) >>> 0; // log(58) / log(256), rounded up.\n\t\tconst b256 = alloc(size);\n\n\t\t// Process the characters.\n\t\twhile (psz < source.length) {\n\t\t\t// Decode character\n\t\t\tlet carry = BASE_MAP[source.charCodeAt(psz)];\n\n\t\t\t// Invalid character\n\t\t\tif (carry === 255) {\n\t\t\t\tthrow new Error(`invalid string`);\n\t\t\t}\n\n\t\t\tlet i = 0;\n\t\t\tfor (let it3 = size - 1; (carry !== 0 || i < length) && it3 !== -1; it3--, i++) {\n\t\t\t\tcarry += (BASE * b256[it3]) >>> 0;\n\t\t\t\tb256[it3] = carry % 256 >>> 0;\n\t\t\t\tcarry = (carry / 256) >>> 0;\n\t\t\t}\n\t\t\tif (carry !== 0) {\n\t\t\t\tthrow new Error('non-zero carry');\n\t\t\t}\n\t\t\tlength = i;\n\t\t\tpsz++;\n\t\t}\n\n\t\t// Skip leading zeroes in b256.\n\t\tlet it4 = size - length;\n\t\twhile (it4 !== size && b256[it4] === 0) {\n\t\t\tit4++;\n\t\t}\n\n\t\tif (it4 === zeroes) {\n\t\t\treturn b256;\n\t\t}\n\n\t\tconst vch = allocUnsafe(zeroes + (size - it4));\n\t\tvch.fill(0, 0, zeroes);\n\t\tvch.set(b256.subarray(it4), zeroes);\n\n\t\treturn vch;\n\t};\n};\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 19086, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19092, "column": 0}, "map": {"version":3,"file":"base64-web.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/multibase/lib/bases/base64-web.ts"],"sourcesContent":["import { createRfc4648Decode, createRfc4648Encode } from '../utils.js';\n\nconst HAS_UINT8_BASE64_SUPPORT = 'fromBase64' in Uint8Array;\n\nconst BASE64_CHARSET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\nconst BASE64URL_CHARSET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_';\n\n// seems to be faster if we just check for the specific characters that are forbidden yet\n// allowed by fromBase64.\nconst WS_RE = /[\\s]/;\nconst WS_PAD_RE = /[\\s=]/;\n\n// #region base64\n/** @internal */\nexport const _fromBase64Polyfill = /*#__PURE__*/ createRfc4648Decode(BASE64_CHARSET, 6, false);\n/** @internal */\nexport const _toBase64Polyfill = /*#__PURE__*/ createRfc4648Encode(BASE64_CHARSET, 6, false);\n\n/** @internal */\nexport const _fromBase64Native = (str: string): Uint8Array => {\n\tif (str.length % 4 === 1 || WS_PAD_RE.test(str)) {\n\t\tthrow new SyntaxError(`invalid base64 string`);\n\t}\n\n\treturn Uint8Array.fromBase64(str, { alphabet: 'base64', lastChunkHandling: 'loose' });\n};\n\n/** @internal */\nexport const _toBase64Native = (bytes: Uint8Array): string => {\n\treturn bytes.toBase64({ alphabet: 'base64', omitPadding: true });\n};\n\nexport const fromBase64 = !HAS_UINT8_BASE64_SUPPORT ? _fromBase64Polyfill : _fromBase64Native;\n\nexport const toBase64 = !HAS_UINT8_BASE64_SUPPORT ? _toBase64Polyfill : _toBase64Native;\n// #endregion\n\n// #region base64pad\n/** @internal */\nexport const _fromBase64PadPolyfill = /*#__PURE__*/ createRfc4648Decode(BASE64_CHARSET, 6, true);\n/** @internal */\nexport const _toBase64PadPolyfill = /*#__PURE__*/ createRfc4648Encode(BASE64_CHARSET, 6, true);\n\n/** @internal */\nexport const _fromBase64PadNative = (str: string): Uint8Array => {\n\tif (str.length % 4 !== 0 || WS_RE.test(str)) {\n\t\tthrow new SyntaxError(`invalid base64 string`);\n\t}\n\n\treturn Uint8Array.fromBase64(str, { alphabet: 'base64', lastChunkHandling: 'strict' });\n};\n\n/** @internal */\nexport const _toBase64PadNative = (bytes: Uint8Array): string => {\n\treturn bytes.toBase64({ alphabet: 'base64', omitPadding: false });\n};\n\nexport const fromBase64Pad = !HAS_UINT8_BASE64_SUPPORT ? _fromBase64PadPolyfill : _fromBase64PadNative;\n\nexport const toBase64Pad = !HAS_UINT8_BASE64_SUPPORT ? _toBase64PadPolyfill : _toBase64PadNative;\n// #endregion\n\n// #region base64url\n/** @internal */\nexport const _fromBase64UrlPolyfill = /*#__PURE__*/ createRfc4648Decode(BASE64URL_CHARSET, 6, false);\n/** @internal */\nexport const _toBase64UrlPolyfill = /*#__PURE__*/ createRfc4648Encode(BASE64URL_CHARSET, 6, false);\n\n/** @internal */\nexport const _fromBase64UrlNative = (str: string): Uint8Array => {\n\tif (str.length % 4 === 1 || WS_PAD_RE.test(str)) {\n\t\tthrow new SyntaxError(`invalid base64 string`);\n\t}\n\n\treturn Uint8Array.fromBase64(str, { alphabet: 'base64url', lastChunkHandling: 'loose' });\n};\n\n/** @internal */\nexport const _toBase64UrlNative = (bytes: Uint8Array): string => {\n\treturn bytes.toBase64({ alphabet: 'base64url', omitPadding: true });\n};\n\nexport const fromBase64Url = !HAS_UINT8_BASE64_SUPPORT ? _fromBase64UrlPolyfill : _fromBase64UrlNative;\n\nexport const toBase64Url = !HAS_UINT8_BASE64_SUPPORT ? _toBase64UrlPolyfill : _toBase64UrlNative;\n// #endregion\n\n// #region base64urlpad\n/** @internal */\nexport const _fromBase64UrlPadPolyfill = /*#__PURE__*/ createRfc4648Decode(BASE64URL_CHARSET, 6, true);\n/** @internal */\nexport const _toBase64UrlPadPolyfill = /*#__PURE__*/ createRfc4648Encode(BASE64URL_CHARSET, 6, true);\n\n/** @internal */\nexport const _fromBase64UrlPadNative = (str: string): Uint8Array => {\n\tif (str.length % 4 !== 0 || WS_RE.test(str)) {\n\t\tthrow new SyntaxError(`invalid base64 string`);\n\t}\n\n\treturn Uint8Array.fromBase64(str, { alphabet: 'base64url', lastChunkHandling: 'strict' });\n};\n\n/** @internal */\nexport const _toBase64UrlPadNative = (bytes: Uint8Array): string => {\n\treturn bytes.toBase64({ alphabet: 'base64url', omitPadding: false });\n};\n\nexport const fromBase64UrlPad = !HAS_UINT8_BASE64_SUPPORT\n\t? _fromBase64UrlPadPolyfill\n\t: _fromBase64UrlPadNative;\n\nexport const toBase64UrlPad = !HAS_UINT8_BASE64_SUPPORT ? _toBase64UrlPadPolyfill : _toBase64UrlPadNative;\n// #endregion\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 19204, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19210, "column": 0}, "map": {"version":3,"file":"base32.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/multibase/lib/bases/base32.ts"],"sourcesContent":["import { createRfc4648Decode, createRfc4648Encode } from '../utils.js';\n\nconst BASE32_CHARSET = 'abcdefghijklmnopqrstuvwxyz234567';\n\nexport const fromBase32 = /*#__PURE__*/ createRfc4648Decode(BASE32_CHARSET, 5, false);\n\nexport const toBase32 = /*#__PURE__*/ createRfc4648Encode(BASE32_CHARSET, 5, false);\n"],"names":[],"mappings":";;;;AAAA,OAAO,EAAE,mBAAmB,EAAE,mBAAmB,EAAE,MAAM,aAAa,CAAC;;AAEvE,MAAM,cAAc,GAAG,kCAAkC,CAAC;AAEnD,MAAM,UAAU,GAAG,WAAA,EAAa,+JAAC,sBAAA,AAAmB,EAAC,cAAc,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;AAE/E,MAAM,QAAQ,GAAG,WAAA,EAAa,+JAAC,sBAAA,AAAmB,EAAC,cAAc,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC","ignoreList":[0]}},
    {"offset": {"line": 19219, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19225, "column": 0}, "map": {"version":3,"file":"bytes.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/cbor/lib/bytes.ts"],"sourcesContent":["import { fromBase64, toBase64 } from '@atcute/multibase';\n\nexport interface Bytes {\n\t$bytes: string;\n}\n\nexport class BytesWrapper implements Bytes {\n\tconstructor(public buf: Uint8Array) {}\n\n\tget $bytes(): string {\n\t\treturn toBase64(this.buf);\n\t}\n\n\ttoJSON(): Bytes {\n\t\treturn { $bytes: this.$bytes };\n\t}\n}\n\nexport const toBytes = (buf: Uint8Array): Bytes => {\n\treturn new BytesWrapper(buf);\n};\n\nexport const fromBytes = (bytes: Bytes): Uint8Array => {\n\tif (bytes instanceof BytesWrapper) {\n\t\treturn bytes.buf;\n\t}\n\n\treturn fromBase64(bytes.$bytes);\n};\n"],"names":[],"mappings":";;;;;AAAA,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;;AAMnD,MAAO,YAAY;IACL,IAAA;IAAnB,YAAmB,GAAe,CAAA;QAAf,IAAA,CAAA,GAAG,GAAH,GAAG,CAAY;IAAG,CAAC;IAEtC,IAAI,MAAM,GAAA;QACT,QAAO,yLAAA,AAAQ,EAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC3B,CAAC;IAED,MAAM,GAAA;QACL,OAAO;YAAE,MAAM,EAAE,IAAI,CAAC,MAAM;QAAA,CAAE,CAAC;IAChC,CAAC;CACD;AAEM,MAAM,OAAO,GAAG,CAAC,GAAe,EAAS,EAAE;IACjD,OAAO,IAAI,YAAY,CAAC,GAAG,CAAC,CAAC;AAC9B,CAAC,CAAC;AAEK,MAAM,SAAS,GAAG,CAAC,KAAY,EAAc,EAAE;IACrD,IAAI,KAAK,YAAY,YAAY,EAAE,CAAC;QACnC,OAAO,KAAK,CAAC,GAAG,CAAC;IAClB,CAAC;IAED,sLAAO,aAAA,AAAU,EAAC,KAAK,CAAC,MAAM,CAAC,CAAC;AACjC,CAAC,CAAC","ignoreList":[0]}},
    {"offset": {"line": 19255, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19261, "column": 0}, "map": {"version":3,"file":"cid-link.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/cbor/lib/cid-link.ts"],"sourcesContent":["import { type CID, decode, parse } from '@atcute/cid';\nimport { toBase32 } from '@atcute/multibase';\n\nexport interface CIDLink {\n\t$link: string;\n}\n\nexport class CIDLinkWrapper implements CIDLink {\n\tconstructor(public $bytes: Uint8Array) {}\n\n\tget $cid(): CID {\n\t\treturn decode(this.$bytes);\n\t}\n\n\tget $link(): string {\n\t\treturn 'b' + toBase32(this.$bytes);\n\t}\n\n\ttoJSON(): CIDLink {\n\t\treturn { $link: this.$link };\n\t}\n}\n\nexport const toCIDLink = (value: CID | Uint8Array): CIDLink => {\n\tif (value instanceof Uint8Array) {\n\t\treturn new CIDLinkWrapper(value);\n\t}\n\n\treturn new CIDLinkWrapper(value.bytes);\n};\n\nexport const fromCIDLink = (link: CIDLink): CID => {\n\tif (link instanceof CIDLinkWrapper) {\n\t\treturn link.$cid;\n\t}\n\n\treturn parse(link.$link);\n};\n"],"names":[],"mappings":";;;;;AAAA,OAAO,EAAY,MAAM,EAAE,KAAK,EAAE,MAAM,aAAa,CAAC;AACtD,OAAO,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;;;AAMvC,MAAO,cAAc;IACP,OAAA;IAAnB,YAAmB,MAAkB,CAAA;QAAlB,IAAA,CAAA,MAAM,GAAN,MAAM,CAAY;IAAG,CAAC;IAEzC,IAAI,IAAI,GAAA;QACP,+JAAO,SAAA,AAAM,EAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC5B,CAAC;IAED,IAAI,KAAK,GAAA;QACR,OAAO,GAAG,2KAAG,WAAA,AAAQ,EAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACpC,CAAC;IAED,MAAM,GAAA;QACL,OAAO;YAAE,KAAK,EAAE,IAAI,CAAC,KAAK;QAAA,CAAE,CAAC;IAC9B,CAAC;CACD;AAEM,MAAM,SAAS,GAAG,CAAC,KAAuB,EAAW,EAAE;IAC7D,IAAI,KAAK,YAAY,UAAU,EAAE,CAAC;QACjC,OAAO,IAAI,cAAc,CAAC,KAAK,CAAC,CAAC;IAClC,CAAC;IAED,OAAO,IAAI,cAAc,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;AACxC,CAAC,CAAC;AAEK,MAAM,WAAW,GAAG,CAAC,IAAa,EAAO,EAAE;IACjD,IAAI,IAAI,YAAY,cAAc,EAAE,CAAC;QACpC,OAAO,IAAI,CAAC,IAAI,CAAC;IAClB,CAAC;IAED,+JAAO,QAAA,AAAK,EAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAC1B,CAAC,CAAC","ignoreList":[0]}},
    {"offset": {"line": 19299, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19305, "column": 0}, "map": {"version":3,"file":"decode.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/cbor/lib/decode.ts"],"sourcesContent":["import { toBytes, type Bytes } from './bytes.js';\nimport { toCIDLink, type CIDLink } from './cid-link.js';\n\nconst utf8d = new TextDecoder();\n\ninterface State {\n\tb: Uint8Array;\n\tv: DataView;\n\tp: number;\n}\n\nconst readArgument = (state: State, info: number): number => {\n\tif (info < 24) {\n\t\treturn info;\n\t}\n\n\tswitch (info) {\n\t\tcase 24:\n\t\t\treturn readUint8(state);\n\t\tcase 25:\n\t\t\treturn readUint16(state);\n\t\tcase 26:\n\t\t\treturn readUint32(state);\n\t\tcase 27:\n\t\t\treturn readUint64(state);\n\t}\n\n\tthrow new Error(`invalid argument encoding; got ${info}`);\n};\n\nconst readFloat64 = (state: State): number => {\n\tconst value = state.v.getFloat64(state.p);\n\n\tstate.p += 8;\n\treturn value;\n};\n\nconst readUint8 = (state: State): number => {\n\tconst value = state.v.getUint8(state.p);\n\n\tstate.p += 1;\n\treturn value;\n};\n\nconst readUint16 = (state: State): number => {\n\tconst value = state.v.getUint16(state.p);\n\n\tstate.p += 2;\n\treturn value;\n};\n\nconst readUint32 = (state: State): number => {\n\tconst value = state.v.getUint32(state.p);\n\n\tstate.p += 4;\n\treturn value;\n};\n\nconst readUint64 = (state: State): number => {\n\tconst hi = state.v.getUint32(state.p);\n\tconst lo = state.v.getUint32(state.p + 4);\n\n\tif (hi > 0x1fffff) {\n\t\tthrow new RangeError(`can't decode integers beyond safe integer range`);\n\t}\n\n\t// prettier-ignore\n\tconst value = (hi * (2 ** 32)) + lo;\n\n\tstate.p += 8;\n\treturn value;\n};\n\nconst readString = (state: State, length: number): string => {\n\tconst slice = state.b.subarray(state.p, (state.p += length));\n\n\treturn utf8d.decode(slice);\n};\n\nconst readBytes = (state: State, length: number): Bytes => {\n\tconst slice = state.b.subarray(state.p, (state.p += length));\n\n\treturn toBytes(slice);\n};\n\nconst readCid = (state: State, length: number): CIDLink => {\n\t// CID bytes are prefixed with 0x00 for historical reasons, apparently.\n\tconst slice = state.b.subarray(state.p + 1, (state.p += length));\n\n\treturn toCIDLink(slice);\n};\n\nconst readValue = (state: State): any => {\n\tconst prelude = readUint8(state);\n\n\tconst type = prelude >> 5;\n\tconst info = prelude & 0x1f;\n\n\tif (type === 0) {\n\t\tconst value = readArgument(state, info);\n\t\treturn value;\n\t}\n\n\tif (type === 1) {\n\t\tconst value = readArgument(state, info);\n\t\treturn -1 - value;\n\t}\n\n\tif (type === 2) {\n\t\tconst len = readArgument(state, info);\n\t\treturn readBytes(state, len);\n\t}\n\n\tif (type === 3) {\n\t\tconst len = readArgument(state, info);\n\n\t\treturn readString(state, len);\n\t}\n\n\tif (type === 4) {\n\t\tconst len = readArgument(state, info);\n\t\tconst array = new Array(len);\n\n\t\tfor (let idx = 0; idx < len; idx++) {\n\t\t\tarray[idx] = readValue(state);\n\t\t}\n\n\t\treturn array;\n\t}\n\n\tif (type === 5) {\n\t\tconst len = readArgument(state, info);\n\t\tconst object: Record<string, unknown> = {};\n\n\t\tfor (let idx = 0; idx < len; idx++) {\n\t\t\tconst key = readValue(state);\n\t\t\tif (typeof key !== 'string') {\n\t\t\t\tthrow new TypeError(`expected map to only have string keys; got ${typeof key}`);\n\t\t\t}\n\n\t\t\tobject[key] = readValue(state);\n\t\t}\n\n\t\treturn object;\n\t}\n\n\tif (type === 6) {\n\t\tconst tag = readArgument(state, info);\n\n\t\tif (tag === 42) {\n\t\t\tconst prelude = readUint8(state);\n\n\t\t\tconst type = prelude >> 5;\n\t\t\tconst info = prelude & 0x1f;\n\n\t\t\tif (type !== 2) {\n\t\t\t\tthrow new TypeError(`expected cid tag to have bytes value; got ${type}`);\n\t\t\t}\n\n\t\t\tconst len = readArgument(state, info);\n\n\t\t\treturn readCid(state, len);\n\t\t}\n\n\t\tthrow new TypeError(`unsupported tag; got ${tag}`);\n\t}\n\n\tif (type === 7) {\n\t\tswitch (info) {\n\t\t\tcase 20:\n\t\t\t\treturn false;\n\t\t\tcase 21:\n\t\t\t\treturn true;\n\t\t\tcase 22:\n\t\t\t\treturn null;\n\t\t\tcase 27:\n\t\t\t\treturn readFloat64(state);\n\t\t}\n\n\t\tthrow new Error(`invalid simple value; got ${info}`);\n\t}\n\n\tthrow new TypeError(`invalid type; got ${type}`);\n};\n\nexport const decodeFirst = (buf: Uint8Array): [value: any, remainder: Uint8Array] => {\n\tconst state: State = {\n\t\tb: buf,\n\t\tv: new DataView(buf.buffer, buf.byteOffset, buf.byteLength),\n\t\tp: 0,\n\t};\n\n\tconst value = readValue(state);\n\tconst remainder = buf.subarray(state.p);\n\n\treturn [value, remainder];\n};\n\nexport const decode = (buf: Uint8Array): any => {\n\tconst [value, remainder] = decodeFirst(buf);\n\tif (remainder.length !== 0) {\n\t\tthrow new Error(`decoded value contains remainder`);\n\t}\n\n\treturn value;\n};\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 19463, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19469, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/cbor/lib/index.ts"],"sourcesContent":["export { BytesWrapper, fromBytes, toBytes, type Bytes } from './bytes.js';\nexport { CIDLinkWrapper, fromCIDLink, toCIDLink, type CIDLink } from './cid-link.js';\n\nexport { decode, decodeFirst } from './decode.js';\nexport { encode } from './encode.js';\n"],"names":[],"mappings":"","ignoreList":[0]}},
    {"offset": {"line": 19475, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19489, "column": 0}, "map": {"version":3,"file":"encode.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/cbor/lib/encode.ts"],"sourcesContent":["import { BytesWrapper, fromBytes, type Bytes } from './bytes.js';\nimport { CIDLinkWrapper, fromCIDLink, type CIDLink } from './cid-link.js';\n\nconst CHUNK_SIZE = 1024;\n\nconst utf8e = new TextEncoder();\n\ninterface State {\n\tc: Uint8Array[];\n\tb: ArrayBuffer;\n\tv: DataView;\n\tp: number;\n}\n\nconst resizeIfNeeded = (state: State, needed: number): void => {\n\tconst buf = state.b;\n\tconst pos = state.p;\n\n\tif (buf.byteLength < pos + needed) {\n\t\tstate.c.push(new Uint8Array(buf, 0, pos));\n\n\t\tstate.b = new ArrayBuffer(Math.max(CHUNK_SIZE, needed));\n\t\tstate.v = new DataView(state.b);\n\t\tstate.p = 0;\n\t}\n};\n\nconst getInfo = (arg: number): number => {\n\tif (arg < 24) {\n\t\treturn arg;\n\t} else if (arg < 0x100) {\n\t\treturn 24;\n\t} else if (arg < 0x10000) {\n\t\treturn 25;\n\t} else if (arg < 0x100000000) {\n\t\treturn 26;\n\t} else {\n\t\treturn 27;\n\t}\n};\n\nconst writeFloat64 = (state: State, val: number): void => {\n\tresizeIfNeeded(state, 8);\n\n\tstate.v.setFloat64(state.p, val);\n\tstate.p += 8;\n};\n\nconst writeUint8 = (state: State, val: number): void => {\n\tresizeIfNeeded(state, 1);\n\n\tstate.v.setUint8(state.p, val);\n\tstate.p += 1;\n};\n\nconst writeUint16 = (state: State, val: number): void => {\n\tresizeIfNeeded(state, 2);\n\n\tstate.v.setUint16(state.p, val);\n\tstate.p += 2;\n};\n\nconst writeUint32 = (state: State, val: number): void => {\n\tresizeIfNeeded(state, 4);\n\n\tstate.v.setUint32(state.p, val);\n\tstate.p += 4;\n};\n\nconst writeUint64 = (state: State, val: number): void => {\n\tconst hi = (val / 2 ** 32) | 0;\n\tconst lo = val >>> 0;\n\n\tresizeIfNeeded(state, 8);\n\n\tstate.v.setUint32(state.p, hi);\n\tstate.v.setUint32(state.p + 4, lo);\n\tstate.p += 8;\n};\n\nconst writeTypeAndArgument = (state: State, type: number, arg: number): void => {\n\tconst info = getInfo(arg);\n\n\twriteUint8(state, (type << 5) | info);\n\n\tswitch (info) {\n\t\tcase 24:\n\t\t\treturn writeUint8(state, arg);\n\t\tcase 25:\n\t\t\treturn writeUint16(state, arg);\n\t\tcase 26:\n\t\t\treturn writeUint32(state, arg);\n\t\tcase 27:\n\t\t\treturn writeUint64(state, arg);\n\t}\n};\n\nconst writeInteger = (state: State, val: number): void => {\n\tif (val < 0) {\n\t\twriteTypeAndArgument(state, 1, -val - 1);\n\t} else {\n\t\twriteTypeAndArgument(state, 0, val);\n\t}\n};\n\nconst writeFloat = (state: State, val: number): void => {\n\twriteUint8(state, 0xe0 | 27);\n\twriteFloat64(state, val);\n};\n\nconst writeNumber = (state: State, val: number): void => {\n\tif (Number.isNaN(val)) {\n\t\tthrow new RangeError(`NaN values not supported`);\n\t}\n\n\tif (val > Number.MAX_SAFE_INTEGER || val < Number.MIN_SAFE_INTEGER) {\n\t\tthrow new RangeError(`can't encode numbers beyond safe integer range`);\n\t}\n\n\tif (Number.isInteger(val)) {\n\t\twriteInteger(state, val);\n\t} else {\n\t\twriteFloat(state, val);\n\t}\n};\n\nconst writeString = (state: State, val: string): void => {\n\tconst buf = utf8e.encode(val);\n\tconst len = buf.byteLength;\n\n\twriteTypeAndArgument(state, 3, len);\n\tresizeIfNeeded(state, len);\n\n\tnew Uint8Array(state.b, state.p).set(buf);\n\n\tstate.p += len;\n};\n\nconst writeBytes = (state: State, val: Bytes): void => {\n\tconst buf = fromBytes(val);\n\tconst len = buf.byteLength;\n\n\twriteTypeAndArgument(state, 2, len);\n\tresizeIfNeeded(state, len);\n\n\tnew Uint8Array(state.b, state.p, len).set(buf);\n\n\tstate.p += len;\n};\n\nconst writeCid = (state: State, val: CIDLink): void => {\n\t// CID bytes are prefixed with 0x00 for historical reasons, apparently.\n\tconst buf = fromCIDLink(val).bytes;\n\tconst len = buf.byteLength + 1;\n\n\twriteTypeAndArgument(state, 6, 42);\n\twriteTypeAndArgument(state, 2, len);\n\n\tresizeIfNeeded(state, len);\n\n\tnew Uint8Array(state.b, state.p + 1, len - 1).set(buf);\n\n\tstate.p += len;\n};\n\nconst writeValue = (state: State, val: any): void => {\n\tif (val === undefined) {\n\t\tthrow new TypeError(`undefined values not supported`);\n\t}\n\n\tif (val === null) {\n\t\treturn writeUint8(state, 0xf6);\n\t}\n\n\tif (val === false) {\n\t\treturn writeUint8(state, 0xf4);\n\t}\n\n\tif (val === true) {\n\t\treturn writeUint8(state, 0xf5);\n\t}\n\n\tif (typeof val === 'number') {\n\t\treturn writeNumber(state, val);\n\t}\n\n\tif (typeof val === 'string') {\n\t\treturn writeString(state, val);\n\t}\n\n\tif (typeof val === 'object') {\n\t\tif (isArray(val)) {\n\t\t\tconst len = val.length;\n\n\t\t\twriteTypeAndArgument(state, 4, len);\n\n\t\t\tfor (let idx = 0; idx < len; idx++) {\n\t\t\t\tconst v = val[idx];\n\t\t\t\twriteValue(state, v);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ('$link' in val) {\n\t\t\tif (val instanceof CIDLinkWrapper || typeof val.$link === 'string') {\n\t\t\t\twriteCid(state, val);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthrow new TypeError(`unexpected cid-link value`);\n\t\t}\n\n\t\tif ('$bytes' in val) {\n\t\t\tif (val instanceof BytesWrapper || typeof val.$bytes === 'string') {\n\t\t\t\twriteBytes(state, val);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthrow new TypeError(`unexpected bytes value`);\n\t\t}\n\n\t\tif (isPlainObject(val)) {\n\t\t\tconst keys = Object.keys(val)\n\t\t\t\t.filter((key) => typeof key === 'string' && val[key] !== undefined)\n\t\t\t\t.sort(compareKeys);\n\n\t\t\tconst len = keys.length;\n\n\t\t\twriteTypeAndArgument(state, 5, len);\n\n\t\t\tfor (let idx = 0; idx < len; idx++) {\n\t\t\t\tconst key = keys[idx];\n\n\t\t\t\twriteString(state, key);\n\t\t\t\twriteValue(state, val[key]);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t}\n\n\tthrow new TypeError(`unsupported type: ${val}`);\n};\n\nconst createState = (): State => {\n\tconst buf = new ArrayBuffer(CHUNK_SIZE);\n\n\treturn {\n\t\tc: [],\n\t\tb: buf,\n\t\tv: new DataView(buf),\n\t\tp: 0,\n\t};\n};\n\nexport const encode = (value: any): Uint8Array => {\n\tconst state = createState();\n\tconst chunks = state.c;\n\n\twriteValue(state, value);\n\tchunks.push(new Uint8Array(state.b, 0, state.p));\n\n\tlet size = 0;\n\tlet written = 0;\n\n\tlet len = chunks.length;\n\tlet idx: number;\n\n\tfor (idx = 0; idx < len; idx++) {\n\t\tsize += chunks[idx].byteLength;\n\t}\n\n\tconst u8 = new Uint8Array(size);\n\n\tfor (idx = 0; idx < len; idx++) {\n\t\tconst chunk = chunks[idx];\n\n\t\tu8.set(chunk, written);\n\t\twritten += chunk.byteLength;\n\t}\n\n\treturn u8;\n};\n\nconst isArray = Array.isArray;\nconst isPlainObject = (v: any): boolean => {\n\tif (typeof v !== 'object' || v === null) {\n\t\treturn false;\n\t}\n\n\tconst proto = Object.getPrototypeOf(v);\n\treturn proto === Object.prototype || proto === null;\n};\n\nconst compareKeys = (a: string, b: string): number => {\n\tif (a.length < b.length) {\n\t\treturn -1;\n\t} else if (b.length < a.length) {\n\t\treturn 1;\n\t} else {\n\t\treturn a < b ? -1 : 1;\n\t}\n};\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 19716, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19763, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/varint/lib/index.ts"],"sourcesContent":["const MSB = 0x80;\nconst REST = 0x7f;\nconst MSBALL = ~REST;\nconst INT = 2 ** 31;\n\nconst N1 = 2 ** 7;\nconst N2 = 2 ** 14;\nconst N3 = 2 ** 21;\nconst N4 = 2 ** 28;\nconst N5 = 2 ** 35;\nconst N6 = 2 ** 42;\nconst N7 = 2 ** 49;\nconst N8 = 2 ** 56;\nconst N9 = 2 ** 63;\n\n/**\n * Encodes a varint\n * @param num Number to encode\n * @param buf Buffer to write on\n * @param offset Starting position on the buffer\n * @returns The amount of bytes written\n */\nexport const encode = (num: number, buf: Uint8Array | number[], offset = 0): number => {\n\tif (num > Number.MAX_SAFE_INTEGER) {\n\t\tthrow new RangeError('could not encode varint');\n\t}\n\n\tconst start = offset;\n\n\twhile (num >= INT) {\n\t\tbuf[offset++] = (num & 0xff) | MSB;\n\t\tnum /= 128;\n\t}\n\n\twhile (num & MSBALL) {\n\t\tbuf[offset++] = (num & 0xff) | MSB;\n\t\tnum >>>= 7;\n\t}\n\n\tbuf[offset] = num | 0;\n\treturn offset - start + 1;\n};\n\n/**\n * Decodes a varint\n * @param buf Buffer to read from\n * @param offset Starting position on the buffer\n * @returns A tuple containing the resulting number, and the amount of bytes read\n */\nexport const decode = (buf: Uint8Array | number[], offset = 0): [num: number, read: number] => {\n\t// deno-lint-ignore prefer-const\n\tlet l = buf.length;\n\n\tlet res = 0;\n\tlet shift = 0;\n\tlet counter = offset;\n\tlet b: number;\n\n\tdo {\n\t\tif (counter >= l) {\n\t\t\tthrow new RangeError('could not decode varint');\n\t\t}\n\n\t\tb = buf[counter++];\n\t\tres += shift < 28 ? (b & REST) << shift : (b & REST) * Math.pow(2, shift);\n\t\tshift += 7;\n\t} while (b >= MSB);\n\n\treturn [res, counter - offset];\n};\n\n/**\n * Returns encoding length\n * @param num The number to encode\n * @returns Amount of bytes needed for encoding\n */\nexport const encodingLength = (num: number): number => {\n\treturn num < N1\n\t\t? 1\n\t\t: num < N2\n\t\t\t? 2\n\t\t\t: num < N3\n\t\t\t\t? 3\n\t\t\t\t: num < N4\n\t\t\t\t\t? 4\n\t\t\t\t\t: num < N5\n\t\t\t\t\t\t? 5\n\t\t\t\t\t\t: num < N6\n\t\t\t\t\t\t\t? 6\n\t\t\t\t\t\t\t: num < N7\n\t\t\t\t\t\t\t\t? 7\n\t\t\t\t\t\t\t\t: num < N8\n\t\t\t\t\t\t\t\t\t? 8\n\t\t\t\t\t\t\t\t\t: num < N9\n\t\t\t\t\t\t\t\t\t\t? 9\n\t\t\t\t\t\t\t\t\t\t: 10;\n};\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 19820, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19826, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/cid/lib/index.ts"],"sourcesContent":["/**\n * @module\n * Bare minimum implementation for creating, parsing, and formatting\n * AT Protocol-blessed CIDv1 format.\n *\n * As specified by AT Protocol, the blessed format is:\n * - Multibase: `base32` (b)\n * - Multicodec: `dag-cbor` (0x71) for record, `raw` (0x55) for blobs\n * - Multihash: `sha-256` (0x12)\n */\n\nimport { fromBase32, toBase32 } from '@atcute/multibase';\nimport * as varint from '@atcute/varint';\n\n/**\n * Raw digest information\n */\nexport interface Digest {\n\tcode: number;\n\tsize: number;\n\tdigest: Uint8Array;\n\tbytes: Uint8Array;\n}\n\n/**\n * CID information\n */\nexport interface CID {\n\tversion: number;\n\tcode: number;\n\tdigest: Digest;\n\tbytes: Uint8Array;\n}\n\n/**\n * Information regarding CID buffer being inspected\n */\nexport interface InspectedCID {\n\tversion: number;\n\tcodec: number;\n\tmultihashCode: number;\n\tdigestSize: number;\n\tmultihashSize: number;\n\tsize: number;\n}\n\n/**\n * Parse a CID string\n */\nexport const parse = (cid: string): CID => {\n\tif (cid[0] !== 'b') {\n\t\tthrow new Error(`only base32 cidv1 is supported`);\n\t}\n\n\tconst bytes = fromBase32(cid.slice(1));\n\treturn decode(bytes);\n};\n\n/**\n * Provides information regarding the CID buffer\n */\nexport const inspect = (initialBytes: Uint8Array): InspectedCID => {\n\tlet offset = 0;\n\tconst next = (): number => {\n\t\tconst [i, length] = varint.decode(initialBytes.subarray(offset));\n\t\toffset += length;\n\t\treturn i;\n\t};\n\n\tlet version = next();\n\tlet codec = 0x70; // dag-pb\n\tif ((version as number) === 18) {\n\t\t// CIDv0\n\t\tversion = 0;\n\t\toffset = 0;\n\t} else {\n\t\tcodec = next();\n\t}\n\n\tif (version !== 1) {\n\t\tthrow new RangeError(`only cidv1 is supported`);\n\t}\n\n\tconst prefixSize = offset;\n\tconst multihashCode = next();\n\tconst digestSize = next();\n\tconst size = offset + digestSize;\n\tconst multihashSize = size - prefixSize;\n\n\treturn { version, codec, multihashCode, digestSize, multihashSize, size };\n};\n\n/**\n * Decode the first CID contained, and return the remainder.\n * @param bytes Buffer to decode\n * @returns A tuple containing the first CID in the buffer, and the remainder\n */\nexport const decodeFirst = (bytes: Uint8Array): [cid: CID, remainder: Uint8Array] => {\n\tconst specs = inspect(bytes);\n\tconst prefixSize = specs.size - specs.multihashSize;\n\tconst multihashBytes = bytes.subarray(prefixSize, prefixSize + specs.multihashSize);\n\n\tif (multihashBytes.byteLength !== specs.multihashSize) {\n\t\tthrow new RangeError('incorrect cid length');\n\t}\n\n\tconst digestBytes = multihashBytes.subarray(specs.multihashSize - specs.digestSize);\n\n\tconst digest: Digest = {\n\t\tcode: specs.multihashCode,\n\t\tsize: specs.multihashSize,\n\t\tdigest: digestBytes,\n\t\tbytes: multihashBytes,\n\t};\n\n\tconst cid: CID = {\n\t\tversion: 1,\n\t\tcode: specs.codec,\n\t\tdigest: digest,\n\t\tbytes: bytes.subarray(0, specs.size),\n\t};\n\n\treturn [cid, bytes.subarray(specs.size)];\n};\n\n/**\n * Decodes a CID buffer\n */\nexport const decode = (bytes: Uint8Array): CID => {\n\tconst [cid, remainder] = decodeFirst(bytes);\n\n\tif (remainder.length !== 0) {\n\t\tthrow new Error(`incorrect cid length`);\n\t}\n\n\treturn cid;\n};\n\n/**\n * Creates a CID\n */\nexport const create = async (code: number, input: Uint8Array): Promise<CID> => {\n\tconst digest = createDigest(0x12, new Uint8Array(await crypto.subtle.digest('sha-256', input)));\n\tconst bytes = encode(1, code, digest.bytes);\n\n\treturn {\n\t\tversion: 1,\n\t\tcode: code,\n\t\tdigest: digest,\n\t\tbytes: bytes,\n\t};\n};\n\n/**\n * Serialize CID into a string\n */\nexport const format = (cid: CID): string => {\n\treturn 'b' + toBase32(cid.bytes);\n};\n\nexport const createDigest = (code: number, digest: Uint8Array): Digest => {\n\tconst size = digest.byteLength;\n\tconst sizeOffset = varint.encodingLength(code);\n\tconst digestOffset = sizeOffset + varint.encodingLength(size);\n\n\tconst bytes = new Uint8Array(digestOffset + size);\n\tvarint.encode(code, bytes, 0);\n\tvarint.encode(size, bytes, sizeOffset);\n\tbytes.set(digest, digestOffset);\n\n\treturn {\n\t\tcode: code,\n\t\tsize: size,\n\t\tdigest: digest,\n\t\tbytes: bytes,\n\t};\n};\n\nexport const encode = (version: number, code: number, multihash: Uint8Array): Uint8Array => {\n\tconst codeOffset = varint.encodingLength(version);\n\tconst hashOffset = codeOffset + varint.encodingLength(code);\n\n\tconst bytes = new Uint8Array(hashOffset + multihash.byteLength);\n\tvarint.encode(version, bytes, 0);\n\tvarint.encode(code, bytes, codeOffset);\n\tbytes.set(multihash, hashOffset);\n\n\treturn bytes;\n};\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 19958, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19964, "column": 0}, "map": {"version":3,"file":"byte-reader.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/car/lib/utilities/byte-reader.ts"],"sourcesContent":["export interface SyncByteReader {\n\treadonly pos: number;\n\tupto(size: number): Uint8Array;\n\texactly(size: number, seek: boolean): Uint8Array;\n\tseek(size: number): void;\n}\n\nexport const createUint8Reader = (buf: Uint8Array): SyncByteReader => {\n\tlet pos = 0;\n\n\treturn {\n\t\tget pos() {\n\t\t\treturn pos;\n\t\t},\n\n\t\tseek(size) {\n\t\t\tpos += size;\n\t\t},\n\t\tupto(size) {\n\t\t\treturn buf.subarray(pos, pos + Math.min(size, buf.length - pos));\n\t\t},\n\t\texactly(size, seek) {\n\t\t\tif (size > buf.length - pos) {\n\t\t\t\tthrow new RangeError('unexpected end of data');\n\t\t\t}\n\n\t\t\tconst slice = buf.subarray(pos, pos + size);\n\t\t\tif (seek) {\n\t\t\t\tpos += size;\n\t\t\t}\n\n\t\t\treturn slice;\n\t\t},\n\t};\n};\n"],"names":[],"mappings":";;;AAOO,MAAM,iBAAiB,GAAG,CAAC,GAAe,EAAkB,EAAE;IACpE,IAAI,GAAG,GAAG,CAAC,CAAC;IAEZ,OAAO;QACN,IAAI,GAAG,IAAA;YACN,OAAO,GAAG,CAAC;QACZ,CAAC;QAED,IAAI,EAAC,IAAI;YACR,GAAG,IAAI,IAAI,CAAC;QACb,CAAC;QACD,IAAI,EAAC,IAAI;YACR,OAAO,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAE,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC;QAClE,CAAC;QACD,OAAO,EAAC,IAAI,EAAE,IAAI;YACjB,IAAI,IAAI,GAAG,GAAG,CAAC,MAAM,GAAG,GAAG,EAAE,CAAC;gBAC7B,MAAM,IAAI,UAAU,CAAC,wBAAwB,CAAC,CAAC;YAChD,CAAC;YAED,MAAM,KAAK,GAAG,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAE,GAAG,GAAG,IAAI,CAAC,CAAC;YAC5C,IAAI,IAAI,EAAE,CAAC;gBACV,GAAG,IAAI,IAAI,CAAC;YACb,CAAC;YAED,OAAO,KAAK,CAAC;QACd,CAAC;KACD,CAAC;AACH,CAAC,CAAC","ignoreList":[0]}},
    {"offset": {"line": 19991, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 19997, "column": 0}, "map": {"version":3,"file":"sync-car-reader.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/car/lib/utilities/sync-car-reader.ts"],"sourcesContent":["import * as CBOR from '@atcute/cbor';\nimport * as varint from '@atcute/varint';\nimport * as CID from '@atcute/cid';\n\nimport type { SyncByteReader } from './byte-reader.js';\n\ninterface CarV1Header {\n\tversion: 1;\n\troots: CBOR.CIDLink[];\n}\n\nconst isCarV1Header = (value: unknown): value is CarV1Header => {\n\tif (value === null || typeof value !== 'object') {\n\t\treturn false;\n\t}\n\n\tconst { version, roots } = value as CarV1Header;\n\treturn version === 1 && Array.isArray(roots) && roots.every((root) => root instanceof CBOR.CIDLinkWrapper);\n};\n\nconst readVarint = (reader: SyncByteReader, size: number): number => {\n\tconst buf = reader.upto(size);\n\tif (buf.length === 0) {\n\t\tthrow new RangeError(`unexpected end of data`);\n\t}\n\n\tconst [int, read] = varint.decode(buf);\n\treader.seek(read);\n\n\treturn int;\n};\n\nconst readHeader = (reader: SyncByteReader): CarV1Header => {\n\tconst length = readVarint(reader, 8);\n\tif (length === 0) {\n\t\tthrow new RangeError(`invalid car header; length=0`);\n\t}\n\n\tconst rawHeader = reader.exactly(length, true);\n\tconst header = CBOR.decode(rawHeader);\n\tif (!isCarV1Header(header)) {\n\t\tthrow new TypeError(`expected a car v1 archive`);\n\t}\n\n\treturn header;\n};\n\nconst readMultihashDigest = (reader: SyncByteReader): CID.Digest => {\n\tconst first = reader.upto(8);\n\n\tconst [code, codeOffset] = varint.decode(first);\n\tconst [size, sizeOffset] = varint.decode(first.subarray(codeOffset));\n\n\tconst offset = codeOffset + sizeOffset;\n\n\tconst bytes = reader.exactly(offset + size, true);\n\tconst digest = bytes.subarray(offset);\n\n\treturn {\n\t\tcode: code,\n\t\tsize: size,\n\t\tdigest: digest,\n\t\tbytes: bytes,\n\t};\n};\n\nconst readCid = (reader: SyncByteReader): CID.CID => {\n\tconst version = readVarint(reader, 8);\n\tif (version !== 1) {\n\t\tthrow new Error(`expected a cidv1`);\n\t}\n\n\tconst codec = readVarint(reader, 8);\n\tconst digest = readMultihashDigest(reader);\n\n\tconst cid: CID.CID = {\n\t\tversion: version,\n\t\tcode: codec,\n\t\tdigest: digest,\n\t\tbytes: CID.encode(version, codec, digest.bytes),\n\t};\n\n\treturn cid;\n};\n\nconst readBlockHeader = (reader: SyncByteReader): { cid: CID.CID; blockSize: number } => {\n\tconst start = reader.pos;\n\n\tlet size = readVarint(reader, 8);\n\tif (size === 0) {\n\t\tthrow new Error(`invalid car section; length=0`);\n\t}\n\n\tsize += reader.pos - start;\n\n\tconst cid = readCid(reader);\n\tconst blockSize = size - Number(reader.pos - start);\n\n\treturn { cid, blockSize };\n};\n\nexport const createCarReader = (reader: SyncByteReader) => {\n\tconst { roots } = readHeader(reader);\n\n\treturn {\n\t\troots,\n\t\t*iterate(): Generator<{ cid: CID.CID; bytes: Uint8Array }> {\n\t\t\twhile (reader.upto(8).length > 0) {\n\t\t\t\tconst { cid, blockSize } = readBlockHeader(reader);\n\t\t\t\tconst bytes = reader.exactly(blockSize, true);\n\n\t\t\t\tyield { cid, bytes };\n\t\t\t}\n\t\t},\n\t};\n};\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 20093, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 20099, "column": 0}, "map": {"version":3,"file":"reader.js","sources":["file:///Users/mg/event-horizon/node_modules/%40atcute/car/lib/reader.ts"],"sourcesContent":["import { createUint8Reader } from './utilities/byte-reader.js';\nimport { createCarReader } from './utilities/sync-car-reader.js';\n\nexport const readCar = (buffer: Uint8Array) => {\n\tconst reader = createUint8Reader(buffer);\n\treturn createCarReader(reader);\n};\n\n/** @deprecated Use `readCar` instead */\nexport const fromUint8Array = readCar;\n"],"names":[],"mappings":";;;;AAAA,OAAO,EAAE,iBAAiB,EAAE,MAAM,4BAA4B,CAAC;AAC/D,OAAO,EAAE,eAAe,EAAE,MAAM,gCAAgC,CAAC;;;AAE1D,MAAM,OAAO,GAAG,CAAC,MAAkB,EAAE,EAAE;IAC7C,MAAM,MAAM,iLAAG,oBAAA,AAAiB,EAAC,MAAM,CAAC,CAAC;IACzC,4LAAO,kBAAA,AAAe,EAAC,MAAM,CAAC,CAAC;AAChC,CAAC,CAAC;AAGK,MAAM,cAAc,GAAG,OAAO,CAAC","ignoreList":[0]}},
    {"offset": {"line": 20112, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 20118, "column": 0}, "map": {"version":3,"sources":["file:///Users/mg/event-horizon/node_modules/%40skyware/firehose/dist/index.js"],"sourcesContent":["import { readCar as createCarIterator } from \"@atcute/car\";\nimport { decode, decodeFirst, fromBytes, toCIDLink } from \"@atcute/cbor\";\nimport { EventEmitter } from \"node:events\";\nimport * as WS from \"ws\";\nexport class Firehose extends EventEmitter {\n    /** The relay to connect to. */\n    relay;\n    /** WebSocket connection to the relay. */\n    ws;\n    /** The current cursor. */\n    cursor = \"\";\n    autoReconnect;\n    reconnectTimeout;\n    /**\n     * Creates a new Firehose instance.\n     * @param options Optional configuration.\n     */\n    constructor(options = {}) {\n        super();\n        this.relay = options.relay ?? \"wss://bsky.network\";\n        this.cursor = options.cursor ?? \"\";\n        this.autoReconnect = options.autoReconnect ?? true;\n    }\n    /**\n     * Opens a WebSocket connection to the relay.\n     */\n    start() {\n        const cursorQueryParameter = this.cursor ? `?cursor=${this.cursor}` : \"\";\n        this.ws = new WS.WebSocket(`${this.relay}/xrpc/com.atproto.sync.subscribeRepos${cursorQueryParameter}`);\n        this.ws.on(\"open\", () => {\n            this.emit(\"open\");\n        });\n        this.ws.on(\"message\", (data) => {\n            try {\n                const message = this.parseMessage(data);\n                if (\"seq\" in message && message.seq && !isNaN(message.seq)) {\n                    this.cursor = `${message.seq}`;\n                }\n                switch (message.$type) {\n                    case \"com.atproto.sync.subscribeRepos#handle\":\n                        this.emit(\"handle\", message);\n                        break;\n                    case \"com.atproto.sync.subscribeRepos#tombstone\":\n                        this.emit(\"tombstone\", message);\n                        break;\n                    case \"com.atproto.sync.subscribeRepos#migrate\":\n                        this.emit(\"migrate\", message);\n                        break;\n                    case \"com.atproto.sync.subscribeRepos#identity\":\n                        this.emit(\"identity\", message);\n                        break;\n                    case \"com.atproto.sync.subscribeRepos#info\":\n                        this.emit(\"info\", message);\n                        break;\n                    case \"com.atproto.sync.subscribeRepos#commit\":\n                        this.emit(\"commit\", message);\n                        break;\n                    default:\n                        this.emit(\"unknown\", message);\n                        break;\n                }\n            }\n            catch (error) {\n                this.emit(\"error\", { cursor: this.cursor, error });\n            }\n            finally {\n                if (this.autoReconnect)\n                    this.preventReconnect();\n            }\n        });\n        this.ws.on(\"close\", () => {\n            this.emit(\"close\", this.cursor);\n        });\n        this.ws.on(\"error\", (error) => {\n            this.emit(\"websocketError\", { cursor: this.cursor, error });\n        });\n    }\n    /**\n     * Closes the WebSocket connection.\n     */\n    close() {\n        this.ws?.close();\n    }\n    on(event, listener) {\n        super.on(event, listener);\n        return this;\n    }\n    parseMessage(data) {\n        let buffer;\n        if (data instanceof Buffer) {\n            buffer = data;\n        }\n        else if (data instanceof ArrayBuffer) {\n            buffer = Buffer.from(data);\n        }\n        else if (Array.isArray(data)) {\n            buffer = Buffer.concat(data);\n        }\n        else {\n            throw new Error(\"Unknown message contents: \" + data);\n        }\n        const [header, remainder] = decodeFirst(buffer);\n        const [body, remainder2] = decodeFirst(remainder);\n        if (remainder2.length > 0) {\n            throw new Error(\"Excess bytes in message\");\n        }\n        const { t, op } = parseHeader(header);\n        if (op === -1)\n            throw new Error(`Error: ${body.message}\\nError code: ${body.error}`);\n        if (t === \"#commit\") {\n            const commit = body;\n            // A commit can contain no changes\n            if (!(\"blocks\" in commit) || !(commit.blocks.$bytes.length)) {\n                return {\n                    $type: \"com.atproto.sync.subscribeRepos#commit\",\n                    ...commit,\n                    blocks: new Uint8Array(),\n                    ops: [],\n                };\n            }\n            const blocks = fromBytes(commit.blocks);\n            const car = readCar(blocks);\n            const ops = commit.ops.map((op) => {\n                const action = op.action;\n                if (action === \"create\" || action === \"update\") {\n                    if (!op.cid)\n                        return;\n                    const record = car.get(op.cid.$link);\n                    if (!record)\n                        return;\n                    return { action, path: op.path, cid: op.cid.$link, record };\n                }\n                else if (action === \"delete\") {\n                    return { action, path: op.path };\n                }\n                else {\n                    throw new Error(`Unknown action: ${action}`);\n                }\n            }).filter((op) => !!op);\n            return {\n                $type: \"com.atproto.sync.subscribeRepos#commit\",\n                ...commit,\n                blocks,\n                ops,\n            };\n        }\n        return { $type: `com.atproto.sync.subscribeRepos${t}`, ...body };\n    }\n    preventReconnect() {\n        if (this.reconnectTimeout)\n            clearTimeout(this.reconnectTimeout);\n        this.reconnectTimeout = setTimeout(() => {\n            this.reconnect();\n        }, 5_000);\n    }\n    reconnect() {\n        this.ws?.removeAllListeners();\n        this.ws?.terminate();\n        this.start();\n        this.emit(\"reconnect\");\n    }\n}\nfunction parseHeader(header) {\n    if (!header || typeof header !== \"object\" || !header.t || typeof header.t !== \"string\"\n        || !header.op || typeof header.op !== \"number\")\n        throw new Error(\"Invalid header received\");\n    return { t: header.t, op: header.op };\n}\nfunction readCar(buffer) {\n    const records = new Map();\n    for (const { cid, bytes } of createCarIterator(buffer).iterate()) {\n        records.set(toCIDLink(cid).$link, decode(bytes));\n    }\n    return records;\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 20303, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}